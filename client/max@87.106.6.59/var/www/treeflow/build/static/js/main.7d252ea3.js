/*! For license information please see main.7d252ea3.js.LICENSE.txt */
(()=>{var e={14(e){e.exports=function(){return!1}},61(e){e.exports=function(e,t){return e<t}},111(e,t,n){var r=n(1069),o=0;e.exports=function(e){var t=++o;return r(e)+t}},127(e,t,n){var r=n(2125);e.exports=function(e,t){return r(e,t,"pre")}},141(e){e.exports=function(e){return void 0===e}},143(e){var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},149(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}},191(e,t,n){"use strict";var r=n(5750);e.exports=i;var o="\0";function i(e){this._isDirected=!r.has(e,"directed")||e.directed,this._isMultigraph=!!r.has(e,"multigraph")&&e.multigraph,this._isCompound=!!r.has(e,"compound")&&e.compound,this._label=void 0,this._defaultNodeLabelFn=r.constant(void 0),this._defaultEdgeLabelFn=r.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[o]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function a(e,t){e[t]?e[t]++:e[t]=1}function s(e,t){--e[t]||delete e[t]}function l(e,t,n,o){var i=""+t,a=""+n;if(!e&&i>a){var s=i;i=a,a=s}return i+"\x01"+a+"\x01"+(r.isUndefined(o)?"\0":o)}function c(e,t){return l(e,t.v,t.w,t.name)}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(e){return this._label=e,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(e){return r.isFunction(e)||(e=r.constant(e)),this._defaultNodeLabelFn=e,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return r.keys(this._nodes)},i.prototype.sources=function(){var e=this;return r.filter(this.nodes(),function(t){return r.isEmpty(e._in[t])})},i.prototype.sinks=function(){var e=this;return r.filter(this.nodes(),function(t){return r.isEmpty(e._out[t])})},i.prototype.setNodes=function(e,t){var n=arguments,o=this;return r.each(e,function(e){n.length>1?o.setNode(e,t):o.setNode(e)}),this},i.prototype.setNode=function(e,t){return r.has(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=o,this._children[e]={},this._children[o][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)},i.prototype.node=function(e){return this._nodes[e]},i.prototype.hasNode=function(e){return r.has(this._nodes,e)},i.prototype.removeNode=function(e){var t=this;if(r.has(this._nodes,e)){var n=function(e){t.removeEdge(t._edgeObjs[e])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],r.each(this.children(e),function(e){t.setParent(e)}),delete this._children[e]),r.each(r.keys(this._in[e]),n),delete this._in[e],delete this._preds[e],r.each(r.keys(this._out[e]),n),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},i.prototype.setParent=function(e,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(r.isUndefined(t))t=o;else{for(var n=t+="";!r.isUndefined(n);n=this.parent(n))if(n===e)throw new Error("Setting "+t+" as parent of "+e+" would create a cycle");this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this},i.prototype._removeFromParentsChildList=function(e){delete this._children[this._parent[e]][e]},i.prototype.parent=function(e){if(this._isCompound){var t=this._parent[e];if(t!==o)return t}},i.prototype.children=function(e){if(r.isUndefined(e)&&(e=o),this._isCompound){var t=this._children[e];if(t)return r.keys(t)}else{if(e===o)return this.nodes();if(this.hasNode(e))return[]}},i.prototype.predecessors=function(e){var t=this._preds[e];if(t)return r.keys(t)},i.prototype.successors=function(e){var t=this._sucs[e];if(t)return r.keys(t)},i.prototype.neighbors=function(e){var t=this.predecessors(e);if(t)return r.union(t,this.successors(e))},i.prototype.isLeaf=function(e){return 0===(this.isDirected()?this.successors(e):this.neighbors(e)).length},i.prototype.filterNodes=function(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var n=this;r.each(this._nodes,function(n,r){e(r)&&t.setNode(r,n)}),r.each(this._edgeObjs,function(e){t.hasNode(e.v)&&t.hasNode(e.w)&&t.setEdge(e,n.edge(e))});var o={};function i(e){var r=n.parent(e);return void 0===r||t.hasNode(r)?(o[e]=r,r):r in o?o[r]:i(r)}return this._isCompound&&r.each(t.nodes(),function(e){t.setParent(e,i(e))}),t},i.prototype.setDefaultEdgeLabel=function(e){return r.isFunction(e)||(e=r.constant(e)),this._defaultEdgeLabelFn=e,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return r.values(this._edgeObjs)},i.prototype.setPath=function(e,t){var n=this,o=arguments;return r.reduce(e,function(e,r){return o.length>1?n.setEdge(e,r,t):n.setEdge(e,r),r}),this},i.prototype.setEdge=function(){var e,t,n,o,i=!1,s=arguments[0];"object"===typeof s&&null!==s&&"v"in s?(e=s.v,t=s.w,n=s.name,2===arguments.length&&(o=arguments[1],i=!0)):(e=s,t=arguments[1],n=arguments[3],arguments.length>2&&(o=arguments[2],i=!0)),e=""+e,t=""+t,r.isUndefined(n)||(n=""+n);var c=l(this._isDirected,e,t,n);if(r.has(this._edgeLabels,c))return i&&(this._edgeLabels[c]=o),this;if(!r.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[c]=i?o:this._defaultEdgeLabelFn(e,t,n);var u=function(e,t,n,r){var o=""+t,i=""+n;if(!e&&o>i){var a=o;o=i,i=a}var s={v:o,w:i};r&&(s.name=r);return s}(this._isDirected,e,t,n);return e=u.v,t=u.w,Object.freeze(u),this._edgeObjs[c]=u,a(this._preds[t],e),a(this._sucs[e],t),this._in[t][c]=u,this._out[e][c]=u,this._edgeCount++,this},i.prototype.edge=function(e,t,n){var r=1===arguments.length?c(this._isDirected,arguments[0]):l(this._isDirected,e,t,n);return this._edgeLabels[r]},i.prototype.hasEdge=function(e,t,n){var o=1===arguments.length?c(this._isDirected,arguments[0]):l(this._isDirected,e,t,n);return r.has(this._edgeLabels,o)},i.prototype.removeEdge=function(e,t,n){var r=1===arguments.length?c(this._isDirected,arguments[0]):l(this._isDirected,e,t,n),o=this._edgeObjs[r];return o&&(e=o.v,t=o.w,delete this._edgeLabels[r],delete this._edgeObjs[r],s(this._preds[t],e),s(this._sucs[e],t),delete this._in[t][r],delete this._out[e][r],this._edgeCount--),this},i.prototype.inEdges=function(e,t){var n=this._in[e];if(n){var o=r.values(n);return t?r.filter(o,function(e){return e.v===t}):o}},i.prototype.outEdges=function(e,t){var n=this._out[e];if(n){var o=r.values(n);return t?r.filter(o,function(e){return e.w===t}):o}},i.prototype.nodeEdges=function(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t))}},247(e,t,n){var r=n(5750),o=n(8808);e.exports=function(e){return r.filter(o(e),function(t){return t.length>1||1===t.length&&e.hasEdge(t[0],t[0])})}},310(e,t,n){var r=n(1817),o=n(5990),i=n(6140);e.exports=function(e){return"function"!=typeof e.constructor||i(e)?{}:r(o(e))}},320(e){e.exports=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}},388(e,t,n){var r=n(8208),o=n(5641);function i(e,t,n){for(var o;t.length&&(o=r.last(t)).i<=n;)t.pop(),e.push(o.vs),n++;return n}e.exports=function(e,t){var n=o.partition(e,function(e){return r.has(e,"barycenter")}),a=n.lhs,s=r.sortBy(n.rhs,function(e){return-e.i}),l=[],c=0,u=0,d=0;a.sort((h=!!t,function(e,t){return e.barycenter<t.barycenter?-1:e.barycenter>t.barycenter?1:h?t.i-e.i:e.i-t.i})),d=i(l,s,d),r.forEach(a,function(e){d+=e.vs.length,l.push(e.vs),c+=e.barycenter*e.weight,u+=e.weight,d=i(l,s,d)});var h;var f={vs:r.flatten(l,!0)};u&&(f.barycenter=c/u,f.weight=u);return f}},396(e){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},438(e,t,n){var r=n(2622);e.exports=function(e){return r(this,e).get(e)}},449(e,t,n){var r=n(6924),o=n(2761);e.exports=function(e){return o(e)&&"[object Set]"==r(e)}},450(e,t,n){var r=n(755),o=n(5647),i=n(4416),a=n(6272),s=o(function(e){return i(r(e,1,a,!0))});e.exports=s},474(e,t,n){var r=n(3204),o=n(8122),i=n(6571);e.exports=function(e){return i(e)?r(e,!0):o(e)}},539(e,t,n){var r=n(9742),o=n(7498),i=n(3279);e.exports=function(e){return e&&e.length?r(e,i,o):void 0}},550(e,t,n){"use strict";var r=n(8208),o=n(5819),i=n(4308),a=n(9791),s=n(1987),l=n(8381),c=n(7938).Graph,u=n(5641);function d(e,t,n){return r.map(t,function(t){return s(e,t,n)})}function h(e,t){var n=new c;r.forEach(e,function(e){var o=e.graph().root,i=a(e,o,n,t);r.forEach(i.vs,function(t,n){e.node(t).order=n}),l(e,n,i.vs)})}function f(e,t){r.forEach(t,function(t){r.forEach(t,function(t,n){e.node(t).order=n})})}e.exports=function(e){var t=u.maxRank(e),n=d(e,r.range(1,t+1),"inEdges"),a=d(e,r.range(t-1,-1,-1),"outEdges"),s=o(e);f(e,s);for(var l,c=Number.POSITIVE_INFINITY,p=0,v=0;v<4;++p,++v){h(p%2?n:a,p%4>=2),s=u.buildLayerMatrix(e);var m=i(e,s);m<c&&(v=0,l=r.cloneDeep(s),c=m)}f(e,l)}},579(e,t,n){"use strict";e.exports=n(1153)},620(e,t,n){var r=n(6913),o=n(4052),i=n(2761);e.exports=function(e){return"string"==typeof e||!o(e)&&i(e)&&"[object String]"==r(e)}},644(e){e.exports=function(e){return e!==e}},705(e){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},723(e,t,n){var r=n(7529),o=n(7171),i=n(9096),a=n(4052);e.exports=function(e,t){return(a(e)?r:o)(e,i(t,3))}},726(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},755(e,t,n){var r=n(8895),o=n(7116);e.exports=function e(t,n,i,a,s){var l=-1,c=t.length;for(i||(i=o),s||(s=[]);++l<c;){var u=t[l];n>0&&i(u)?n>1?e(u,n-1,i,a,s):r(s,u):a||(s[s.length]=u)}return s}},793(e){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},801(e,t,n){var r=n(1141),o=n(6686),i=n(9841),a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return NaN;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=s.test(e);return n||l.test(e)?c(e.slice(2),n?2:8):a.test(e)?NaN:+e}},819(e,t,n){var r=n(755);e.exports=function(e){return(null==e?0:e.length)?r(e,1):[]}},914(e,t,n){var r=n(9841);e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},929(e,t,n){var r=n(3211),o=n(6571),i=n(9194),a=n(6686);e.exports=function(e,t,n){if(!a(n))return!1;var s=typeof t;return!!("number"==s?o(n)&&i(t,n.length):"string"==s&&t in n)&&r(n[t],e)}},1069(e,t,n){var r=n(8541);e.exports=function(e){return null==e?"":r(e)}},1097(e,t,n){var r=n(5750),o=n(191);function i(e){return r.map(e.nodes(),function(t){var n=e.node(t),o=e.parent(t),i={v:t};return r.isUndefined(n)||(i.value=n),r.isUndefined(o)||(i.parent=o),i})}function a(e){return r.map(e.edges(),function(t){var n=e.edge(t),o={v:t.v,w:t.w};return r.isUndefined(t.name)||(o.name=t.name),r.isUndefined(n)||(o.value=n),o})}e.exports={write:function(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:i(e),edges:a(e)};r.isUndefined(e.graph())||(t.value=r.clone(e.graph()));return t},read:function(e){var t=new o(e.options).setGraph(e.value);return r.each(e.nodes,function(e){t.setNode(e.v,e.value),e.parent&&t.setParent(e.v,e.parent)}),r.each(e.edges,function(e){t.setEdge({v:e.v,w:e.w,name:e.name},e.value)}),t}}},1104(e,t,n){var r=n(6614),o=n(8673);e.exports=function(e,t){return e&&r(t,o(t),e)}},1141(e,t,n){var r=n(143),o=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(o,""):e}},1143(e,t,n){var r=n(3028)(Object.keys,Object);e.exports=r},1153(e,t,n){"use strict";var r=n(5043),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,r)&&!l.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:o,type:e,key:c,ref:u,props:i,_owner:s.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},1163(e,t,n){var r=n(5647),o=n(3211),i=n(929),a=n(474),s=Object.prototype,l=s.hasOwnProperty,c=r(function(e,t){e=Object(e);var n=-1,r=t.length,c=r>2?t[2]:void 0;for(c&&i(t[0],t[1],c)&&(r=1);++n<r;)for(var u=t[n],d=a(u),h=-1,f=d.length;++h<f;){var p=d[h],v=e[p];(void 0===v||o(v,s[p])&&!l.call(e,p))&&(e[p]=u[p])}return e});e.exports=c},1170(e){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},1268(e,t,n){var r=n(5428),o=n(7574),i=n(6832),a=i&&i.isTypedArray,s=a?o(a):r;e.exports=s},1277(e,t,n){"use strict";var r=n(8208),o=n(5641),i=n(9558).positionX;e.exports=function(e){(function(e){var t=o.buildLayerMatrix(e),n=e.graph().ranksep,i=0;r.forEach(t,function(t){var o=r.max(r.map(t,function(t){return e.node(t).height}));r.forEach(t,function(t){e.node(t).y=i+o/2}),i+=o+n})})(e=o.asNonCompoundGraph(e)),r.forEach(i(e),function(t,n){e.node(n).x=t})}},1295(e,t,n){var r=n(9812),o=r?r.prototype:void 0,i=o?o.valueOf:void 0;e.exports=function(e){return i?Object(i.call(e)):{}}},1310(e){e.exports=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}},1340(e,t,n){var r=n(3211);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},1516(e,t,n){var r=n(2929);e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},1558(e){e.exports=function(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1}},1609(e,t,n){var r=n(6614),o=n(474);e.exports=function(e){return r(e,o(e))}},1629(e,t,n){var r=n(6913),o=n(6686);e.exports=function(e){if(!o(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},1632(e,t,n){var r=n(4724),o=n(6311),i=n(7168);e.exports=function(e){return o(e)?i(e):r(e)}},1714(e,t,n){var r=n(1340);e.exports=function(e,t){var n=this.__data__,o=r(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},1733(e,t,n){var r=n(1775),o=n(4664),i=n(9096);e.exports=function(e,t){var n={};return t=i(t,3),o(e,function(e,o,i){r(n,o,t(e,o,i))}),n}},1740(e,t,n){var r=n(7132);e.exports=function(e){return r(e,4)}},1775(e,t,n){var r=n(5654);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},1817(e,t,n){var r=n(6686),o=Object.create,i=function(){function e(){}return function(t){if(!r(t))return{};if(o)return o(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=i},1896(e,t,n){var r=n(2125);e.exports=function(e,t){return r(e,t,"post")}},1946(e,t,n){var r=n(1340);e.exports=function(e){return r(this.__data__,e)>-1}},1980(e){e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},1981(e,t,n){"use strict";var r=n(8208);function o(e){r.forEach(e.nodes(),function(t){i(e.node(t))}),r.forEach(e.edges(),function(t){i(e.edge(t))})}function i(e){var t=e.width;e.width=e.height,e.height=t}function a(e){e.y=-e.y}function s(e){var t=e.x;e.x=e.y,e.y=t}e.exports={adjust:function(e){var t=e.graph().rankdir.toLowerCase();"lr"!==t&&"rl"!==t||o(e)},undo:function(e){var t=e.graph().rankdir.toLowerCase();"bt"!==t&&"rl"!==t||function(e){r.forEach(e.nodes(),function(t){a(e.node(t))}),r.forEach(e.edges(),function(t){var n=e.edge(t);r.forEach(n.points,a),r.has(n,"y")&&a(n)})}(e);"lr"!==t&&"rl"!==t||(!function(e){r.forEach(e.nodes(),function(t){s(e.node(t))}),r.forEach(e.edges(),function(t){var n=e.edge(t);r.forEach(n.points,s),r.has(n,"x")&&s(n)})}(e),o(e))}}},1987(e,t,n){var r=n(8208),o=n(7938).Graph;e.exports=function(e,t,n){var i=function(e){var t;for(;e.hasNode(t=r.uniqueId("_root")););return t}(e),a=new o({compound:!0}).setGraph({root:i}).setDefaultNodeLabel(function(t){return e.node(t)});return r.forEach(e.nodes(),function(o){var s=e.node(o),l=e.parent(o);(s.rank===t||s.minRank<=t&&t<=s.maxRank)&&(a.setNode(o),a.setParent(o,l||i),r.forEach(e[n](o),function(t){var n=t.v===o?t.w:t.v,i=a.edge(n,o),s=r.isUndefined(i)?0:i.weight;a.setEdge(n,o,{weight:e.edge(t).weight+s})}),r.has(s,"minRank")&&a.setNode(o,{borderLeft:s.borderLeft[t],borderRight:s.borderRight[t]}))}),a}},2070(e,t,n){var r=n(7937)(n(6552),"Set");e.exports=r},2074(e){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}},2117(e,t,n){var r=n(6741),o=n(9057);e.exports=function(e,t){return null!=e&&o(e,t,r)}},2125(e,t,n){var r=n(5750);function o(e,t,n,i,a,s){r.has(i,t)||(i[t]=!0,n||s.push(t),r.each(a(t),function(t){o(e,t,n,i,a,s)}),n&&s.push(t))}e.exports=function(e,t,n){r.isArray(t)||(t=[t]);var i=(e.isDirected()?e.successors:e.neighbors).bind(e),a=[],s={};return r.each(t,function(t){if(!e.hasNode(t))throw new Error("Graph does not have node: "+t);o(e,t,"post"===n,s,i,a)}),a}},2154(e,t,n){var r=n(5575),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return o.call(t,e)?t[e]:void 0}},2322(e,t,n){var r=n(6913),o=n(5990),i=n(2761),a=Function.prototype,s=Object.prototype,l=a.toString,c=s.hasOwnProperty,u=l.call(Object);e.exports=function(e){if(!i(e)||"[object Object]"!=r(e))return!1;var t=o(e);if(null===t)return!0;var n=c.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&l.call(n)==u}},2330(e,t,n){"use strict";var r=n(5043);var o="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},i=r.useState,a=r.useEffect,s=r.useLayoutEffect,l=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!o(e,n)}catch(r){return!0}}var u="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=i({inst:{value:n,getSnapshot:t}}),o=r[0].inst,u=r[1];return s(function(){o.value=n,o.getSnapshot=t,c(o)&&u({inst:o})},[e,n,t]),a(function(){return c(o)&&u({inst:o}),e(function(){c(o)&&u({inst:o})})},[e]),l(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:u},2460(e,t,n){"use strict";var r=n(5758).longestPath,o=n(3088),i=n(4501);e.exports=function(e){switch(e.graph().ranker){case"network-simplex":default:s(e);break;case"tight-tree":!function(e){r(e),o(e)}(e);break;case"longest-path":a(e)}};var a=r;function s(e){i(e)}},2520(e,t,n){var r=n(5816),o=n(9096),i=n(9140),a=Math.max;e.exports=function(e,t,n){var s=null==e?0:e.length;if(!s)return-1;var l=null==n?0:i(n);return l<0&&(l=a(s+l,0)),r(e,o(t,3),l)}},2536(e,t,n){var r=n(149),o=n(2969),i=n(9096),a=n(8883),s=n(320),l=n(7574),c=n(5893),u=n(3279),d=n(4052);e.exports=function(e,t,n){t=t.length?r(t,function(e){return d(e)?function(t){return o(t,1===e.length?e[0]:e)}:e}):[u];var h=-1;t=r(t,l(i));var f=a(e,function(e,n,o){return{criteria:r(t,function(t){return t(e)}),index:++h,value:e}});return s(f,function(e,t){return c(e,t,n)})}},2541(e){e.exports=function(e){return function(){return e}}},2580(e,t,n){e.exports=n(5491)},2587(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},2597(e,t,n){var r=n(4052),o=n(9841),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!o(e))||(a.test(e)||!i.test(e)||null!=t&&e in Object(t))}},2616(e,t,n){var r=n(4008),o=n(5857)(function(e,t){return null==e?{}:r(e,t)});e.exports=o},2622(e,t,n){var r=n(705);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},2662(e,t,n){var r=n(5575);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},2717(e,t,n){var r=n(726),o=n(1817),i=n(4664),a=n(9096),s=n(5990),l=n(4052),c=n(4543),u=n(1629),d=n(6686),h=n(1268);e.exports=function(e,t,n){var f=l(e),p=f||c(e)||h(e);if(t=a(t,4),null==n){var v=e&&e.constructor;n=p?f?new v:[]:d(e)&&u(v)?o(s(e)):{}}return(p?r:i)(e,function(e,r,o){return t(n,e,r,o)}),n}},2730(e,t,n){"use strict";var r=n(5043),o=n(8853);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)a.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function v(e,t,n,r,o,i,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){m[e]=new v(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];m[t]=new v(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){m[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){m[e]=new v(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){m[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){m[e]=new v(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){m[e]=new v(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){m[e]=new v(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){m[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)});var g=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function w(e,t,n,r){var o=m.hasOwnProperty(t)?m[t]:null;(null!==o?0!==o.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,o,r)&&(n=null),r||null===o?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=null===n?3!==o.type&&"":n:(t=o.attributeName,r=o.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)}),m.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)});var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),x=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),N=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var A=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var M,L=Object.assign;function z(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var U=!1;function B(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var o=c.stack.split("\n"),i=r.stack.split("\n"),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(1!==a||1!==s)do{if(a--,0>--s||o[a]!==i[s]){var l="\n"+o[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=s);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?z(e):""}function F(e){switch(e.tag){case 5:return z(e.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function K(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case x:return"Portal";case E:return"Profiler";case k:return"StrictMode";case T:return"Suspense";case O:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case N:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case j:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case I:return null!==(t=e.displayName||null)?t:K(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return K(e(t))}catch(n){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return K(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var o=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Y(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=W(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function G(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function X(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=V(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function $(e,t){null!=(t=t.checked)&&w(e,"checked",t,!1)}function Z(e,t){$(e,t);var n=V(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Q(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&G(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+V(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(r&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function oe(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:V(n)}}function ie(e,t){var n=V(t.value),r=V(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),o=ve(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}Object.keys(fe).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var ge=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function we(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function _e(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var xe=null,Se=null,ke=null;function Ee(e){if(e=bo(e)){if("function"!==typeof xe)throw Error(i(280));var t=e.stateNode;t&&(t=xo(t),xe(e.stateNode,e.type,t))}}function Ce(e){Se?ke?ke.push(e):ke=[e]:Se=e}function Ne(){if(Se){var e=Se,t=ke;if(ke=Se=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function je(e,t){return e(t)}function Te(){}var Oe=!1;function Ie(e,t,n){if(Oe)return e(t,n);Oe=!0;try{return je(e,t,n)}finally{Oe=!1,(null!==Se||null!==ke)&&(Te(),Ne())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var r=xo(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Ae=!1;if(u)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Ae=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(ue){Ae=!1}function De(e,t,n,r,o,i,a,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Me=!1,Le=null,ze=!1,Ue=null,Be={onError:function(e){Me=!0,Le=e}};function Fe(e,t,n,r,o,i,a,s,l){Me=!1,Le=null,De.apply(Be,arguments)}function Ke(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(Ke(e)!==e)throw Error(i(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ke(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(null===o)break;var a=o.alternate;if(null===a){if(null!==(r=o.return)){n=r;continue}break}if(o.child===a.child){for(a=o.child;a;){if(a===n)return Ve(o),e;if(a===r)return Ve(o),t;a=a.sibling}throw Error(i(188))}if(n.return!==r.return)n=o,r=a;else{for(var s=!1,l=o.child;l;){if(l===n){s=!0,n=o,r=a;break}if(l===r){s=!0,r=o,n=a;break}l=l.sibling}if(!s){for(l=a.child;l;){if(l===n){s=!0,n=a,r=o;break}if(l===r){s=!0,r=a,n=o;break}l=l.sibling}if(!s)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Ye=o.unstable_scheduleCallback,Ge=o.unstable_cancelCallback,Xe=o.unstable_shouldYield,Je=o.unstable_requestPaint,$e=o.unstable_now,Ze=o.unstable_getCurrentPriorityLevel,Qe=o.unstable_ImmediatePriority,et=o.unstable_UserBlockingPriority,tt=o.unstable_NormalPriority,nt=o.unstable_LowPriority,rt=o.unstable_IdlePriority,ot=null,it=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,o=e.suspendedLanes,i=e.pingedLanes,a=268435455&n;if(0!==a){var s=a&~o;0!==s?r=dt(s):0!==(i&=a)&&(r=dt(i))}else 0!==(a=n&~o)?r=dt(a):0!==i&&(r=dt(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&o)&&((o=r&-r)>=(i=t&-t)||16===o&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)o=1<<(n=31-at(t)),r|=e[n],t&=~o;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var wt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var _t,xt,St,kt,Et,Ct=!1,Nt=[],jt=null,Tt=null,Ot=null,It=new Map,Pt=new Map,At=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":jt=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":Ot=null;break;case"pointerover":case"pointerout":It.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function Mt(e,t,n,r,o,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},null!==t&&(null!==(t=bo(t))&&xt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function Lt(e){var t=wo(e.target);if(null!==t){var n=Ke(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=qe(n)))return e.blockedOn=t,void Et(e.priority,function(){St(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function zt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bo(n))&&xt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function Ut(e,t,n){zt(e)&&n.delete(t)}function Bt(){Ct=!1,null!==jt&&zt(jt)&&(jt=null),null!==Tt&&zt(Tt)&&(Tt=null),null!==Ot&&zt(Ot)&&(Ot=null),It.forEach(Ut),Pt.forEach(Ut)}function Ft(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Bt)))}function Kt(e){function t(t){return Ft(t,e)}if(0<Nt.length){Ft(Nt[0],e);for(var n=1;n<Nt.length;n++){var r=Nt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==jt&&Ft(jt,e),null!==Tt&&Ft(Tt,e),null!==Ot&&Ft(Ot,e),It.forEach(t),Pt.forEach(t),n=0;n<At.length;n++)(r=At[n]).blockedOn===e&&(r.blockedOn=null);for(;0<At.length&&null===(n=At[0]).blockedOn;)Lt(n),null===n.blockedOn&&At.shift()}var qt=b.ReactCurrentBatchConfig,Vt=!0;function Wt(e,t,n,r){var o=wt,i=qt.transition;qt.transition=null;try{wt=1,Yt(e,t,n,r)}finally{wt=o,qt.transition=i}}function Ht(e,t,n,r){var o=wt,i=qt.transition;qt.transition=null;try{wt=4,Yt(e,t,n,r)}finally{wt=o,qt.transition=i}}function Yt(e,t,n,r){if(Vt){var o=Xt(e,t,n,r);if(null===o)Vr(e,t,r,Gt,n),Dt(e,r);else if(function(e,t,n,r,o){switch(t){case"focusin":return jt=Mt(jt,e,t,n,r,o),!0;case"dragenter":return Tt=Mt(Tt,e,t,n,r,o),!0;case"mouseover":return Ot=Mt(Ot,e,t,n,r,o),!0;case"pointerover":var i=o.pointerId;return It.set(i,Mt(It.get(i)||null,e,t,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,Pt.set(i,Mt(Pt.get(i)||null,e,t,n,r,o)),!0}return!1}(o,e,t,n,r))r.stopPropagation();else if(Dt(e,r),4&t&&-1<Rt.indexOf(e)){for(;null!==o;){var i=bo(o);if(null!==i&&_t(i),null===(i=Xt(e,t,n,r))&&Vr(e,t,r,Gt,n),i===o)break;o=i}null!==o&&r.stopPropagation()}else Vr(e,t,r,null,n)}}var Gt=null;function Xt(e,t,n,r){if(Gt=null,null!==(e=wo(e=_e(r))))if(null===(t=Ke(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function Jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case Qe:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var $t=null,Zt=null,Qt=null;function en(){if(Qt)return Qt;var e,t,n=Zt,r=n.length,o="value"in $t?$t.value:$t.textContent,i=o.length;for(e=0;e<r&&n[e]===o[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===o[i-t];t++);return Qt=o.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,r,o,i){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(o):o[a]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,sn,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=on(cn),dn=L({},cn,{view:0,detail:0}),hn=on(dn),fn=L({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,sn=e.screenY-ln.screenY):sn=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),pn=on(fn),vn=on(L({},fn,{dataTransfer:0})),mn=on(L({},dn,{relatedTarget:0})),gn=on(L({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=L({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),wn=on(yn),bn=on(L({},cn,{data:0})),_n={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function En(){return kn}var Cn=L({},dn,{key:function(e){if(e.key){var t=_n[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?xn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Nn=on(Cn),jn=on(L({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=on(L({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),On=on(L({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),In=L({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=on(In),An=[9,13,27,32],Rn=u&&"CompositionEvent"in window,Dn=null;u&&"documentMode"in document&&(Dn=document.documentMode);var Mn=u&&"TextEvent"in window&&!Dn,Ln=u&&(!Rn||Dn&&8<Dn&&11>=Dn),zn=String.fromCharCode(32),Un=!1;function Bn(e,t){switch(e){case"keyup":return-1!==An.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Kn=!1;var qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qn[e.type]:"textarea"===t}function Wn(e,t,n,r){Ce(r),0<(t=Hr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hn=null,Yn=null;function Gn(e){zr(e,0)}function Xn(e){if(Y(_o(e)))return e}function Jn(e,t){if("change"===e)return t}var $n=!1;if(u){var Zn;if(u){var Qn="oninput"in document;if(!Qn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Qn="function"===typeof er.oninput}Zn=Qn}else Zn=!1;$n=Zn&&(!document.documentMode||9<document.documentMode)}function tr(){Hn&&(Hn.detachEvent("onpropertychange",nr),Yn=Hn=null)}function nr(e){if("value"===e.propertyName&&Xn(Yn)){var t=[];Wn(t,Yn,e,_e(e)),Ie(Gn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Yn=n,(Hn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function or(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xn(Yn)}function ir(e,t){if("click"===e)return Xn(t)}function ar(e,t){if("input"===e||"change"===e)return Xn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!d.call(t,o)||!sr(e[o],t[o]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=G((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=void 0===r.end?i:Math.min(r.end,o),!e.extend&&i>r&&(o=r,r=i,i=o),o=ur(n,i);var a=ur(n,r);o&&a&&(1!==e.rangeCount||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(o.node,o.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=u&&"documentMode"in document&&11>=document.documentMode,mr=null,gr=null,yr=null,wr=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;wr||null==mr||mr!==G(r)||("selectionStart"in(r=mr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=Hr(gr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function _r(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var xr={animationend:_r("Animation","AnimationEnd"),animationiteration:_r("Animation","AnimationIteration"),animationstart:_r("Animation","AnimationStart"),transitionend:_r("Transition","TransitionEnd")},Sr={},kr={};function Er(e){if(Sr[e])return Sr[e];if(!xr[e])return e;var t,n=xr[e];for(t in n)if(n.hasOwnProperty(t)&&t in kr)return Sr[e]=n[t];return e}u&&(kr=document.createElement("div").style,"AnimationEvent"in window||(delete xr.animationend.animation,delete xr.animationiteration.animation,delete xr.animationstart.animation),"TransitionEvent"in window||delete xr.transitionend.transition);var Cr=Er("animationend"),Nr=Er("animationiteration"),jr=Er("animationstart"),Tr=Er("transitionend"),Or=new Map,Ir="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pr(e,t){Or.set(e,t),l(t,[e])}for(var Ar=0;Ar<Ir.length;Ar++){var Rr=Ir[Ar];Pr(Rr.toLowerCase(),"on"+(Rr[0].toUpperCase()+Rr.slice(1)))}Pr(Cr,"onAnimationEnd"),Pr(Nr,"onAnimationIteration"),Pr(jr,"onAnimationStart"),Pr("dblclick","onDoubleClick"),Pr("focusin","onFocus"),Pr("focusout","onBlur"),Pr(Tr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dr));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,o,a,s,l,c){if(Fe.apply(this,arguments),Me){if(!Me)throw Error(i(198));var u=Le;Me=!1,Le=null,ze||(ze=!0,Ue=u)}}(r,t,void 0,e),e.currentTarget=null}function zr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==i&&o.isPropagationStopped())break e;Lr(o,s,c),i=l}else for(a=0;a<r.length;a++){if(l=(s=r[a]).instance,c=s.currentTarget,s=s.listener,l!==i&&o.isPropagationStopped())break e;Lr(o,s,c),i=l}}}if(ze)throw e=Ue,ze=!1,Ue=null,e}function Ur(e,t){var n=t[mo];void 0===n&&(n=t[mo]=new Set);var r=e+"__bubble";n.has(r)||(qr(t,e,2,!1),n.add(r))}function Br(e,t,n){var r=0;t&&(r|=4),qr(n,e,r,t)}var Fr="_reactListening"+Math.random().toString(36).slice(2);function Kr(e){if(!e[Fr]){e[Fr]=!0,a.forEach(function(t){"selectionchange"!==t&&(Mr.has(t)||Br(t,!1,e),Br(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Fr]||(t[Fr]=!0,Br("selectionchange",!1,t))}}function qr(e,t,n,r){switch(Jt(t)){case 1:var o=Wt;break;case 4:o=Ht;break;default:o=Yt}n=o.bind(null,t,n,e),o=void 0,!Ae||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),r?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Vr(e,t,n,r,o){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===o||8===s.nodeType&&s.parentNode===o)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===o||8===l.nodeType&&l.parentNode===o))return;a=a.return}for(;null!==s;){if(null===(a=wo(s)))return;if(5===(l=a.tag)||6===l){r=i=a;continue e}s=s.parentNode}}r=r.return}Ie(function(){var r=i,o=_e(n),a=[];e:{var s=Or.get(e);if(void 0!==s){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Nn;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Tn;break;case Cr:case Nr:case jr:l=gn;break;case Tr:l=On;break;case"scroll":l=hn;break;case"wheel":l=Pn;break;case"copy":case"cut":case"paste":l=wn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=jn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==s?s+"Capture":null:s;u=[];for(var f,p=r;null!==p;){var v=(f=p).stateNode;if(5===f.tag&&null!==v&&(f=v,null!==h&&(null!=(v=Pe(p,h))&&u.push(Wr(p,v,f)))),d)break;p=p.return}0<u.length&&(s=new l(s,c,null,n,o),a.push({event:s,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===be||!(c=n.relatedTarget||n.fromElement)||!wo(c)&&!c[vo])&&(l||s)&&(s=o.window===o?o:(s=o.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?wo(c):null)&&(c!==(d=Ke(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=pn,v="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=jn,v="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?s:_o(l),f=null==c?s:_o(c),(s=new u(v,p+"leave",l,n,o)).target=d,s.relatedTarget=f,v=null,wo(o)===r&&((u=new u(h,p+"enter",c,n,o)).target=f,u.relatedTarget=d,v=u),d=v,l&&c)e:{for(h=c,p=0,f=u=l;f;f=Yr(f))p++;for(f=0,v=h;v;v=Yr(v))f++;for(;0<p-f;)u=Yr(u),p--;for(;0<f-p;)h=Yr(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=Yr(u),h=Yr(h)}u=null}else u=null;null!==l&&Gr(a,s,l,u,!1),null!==c&&null!==d&&Gr(a,d,c,u,!0)}if("select"===(l=(s=r?_o(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var m=Jn;else if(Vn(s))if($n)m=ar;else{m=or;var g=rr}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=ir);switch(m&&(m=m(e,r))?Wn(a,m,n,o):(g&&g(e,s,r),"focusout"===e&&(g=s._wrapperState)&&g.controlled&&"number"===s.type&&ee(s,"number",s.value)),g=r?_o(r):window,e){case"focusin":(Vn(g)||"true"===g.contentEditable)&&(mr=g,gr=r,yr=null);break;case"focusout":yr=gr=mr=null;break;case"mousedown":wr=!0;break;case"contextmenu":case"mouseup":case"dragend":wr=!1,br(a,n,o);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":br(a,n,o)}var y;if(Rn)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Kn?Bn(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(Ln&&"ko"!==n.locale&&(Kn||"onCompositionStart"!==w?"onCompositionEnd"===w&&Kn&&(y=en()):(Zt="value"in($t=o)?$t.value:$t.textContent,Kn=!0)),0<(g=Hr(r,w)).length&&(w=new bn(w,e,null,n,o),a.push({event:w,listeners:g}),y?w.data=y:null!==(y=Fn(n))&&(w.data=y))),(y=Mn?function(e,t){switch(e){case"compositionend":return Fn(t);case"keypress":return 32!==t.which?null:(Un=!0,zn);case"textInput":return(e=t.data)===zn&&Un?null:e;default:return null}}(e,n):function(e,t){if(Kn)return"compositionend"===e||!Rn&&Bn(e,t)?(e=en(),Qt=Zt=$t=null,Kn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Hr(r,"onBeforeInput")).length&&(o=new bn("onBeforeInput","beforeinput",null,n,o),a.push({event:o,listeners:r}),o.data=y))}zr(a,t)})}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hr(e,t){for(var n=t+"Capture",r=[];null!==e;){var o=e,i=o.stateNode;5===o.tag&&null!==i&&(o=i,null!=(i=Pe(e,n))&&r.unshift(Wr(e,i,o)),null!=(i=Pe(e,t))&&r.push(Wr(e,i,o))),e=e.return}return r}function Yr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gr(e,t,n,r,o){for(var i=t._reactName,a=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==c&&(s=c,o?null!=(l=Pe(n,i))&&a.unshift(Wr(n,l,s)):o||null!=(l=Pe(n,i))&&a.push(Wr(n,l,s))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Xr=/\r\n?/g,Jr=/\u0000|\uFFFD/g;function $r(e){return("string"===typeof e?e:""+e).replace(Xr,"\n").replace(Jr,"")}function Zr(e,t,n){if(t=$r(t),$r(e)!==t&&n)throw Error(i(425))}function Qr(){}var eo=null,to=null;function no(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ro="function"===typeof setTimeout?setTimeout:void 0,oo="function"===typeof clearTimeout?clearTimeout:void 0,io="function"===typeof Promise?Promise:void 0,ao="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof io?function(e){return io.resolve(null).then(e).catch(so)}:ro;function so(e){setTimeout(function(){throw e})}function lo(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)){if(0===r)return e.removeChild(o),void Kt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=o}while(n);Kt(t)}function co(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function uo(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ho=Math.random().toString(36).slice(2),fo="__reactFiber$"+ho,po="__reactProps$"+ho,vo="__reactContainer$"+ho,mo="__reactEvents$"+ho,go="__reactListeners$"+ho,yo="__reactHandles$"+ho;function wo(e){var t=e[fo];if(t)return t;for(var n=e.parentNode;n;){if(t=n[vo]||n[fo]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=uo(e);null!==e;){if(n=e[fo])return n;e=uo(e)}return t}n=(e=n).parentNode}return null}function bo(e){return!(e=e[fo]||e[vo])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function _o(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function xo(e){return e[po]||null}var So=[],ko=-1;function Eo(e){return{current:e}}function Co(e){0>ko||(e.current=So[ko],So[ko]=null,ko--)}function No(e,t){ko++,So[ko]=e.current,e.current=t}var jo={},To=Eo(jo),Oo=Eo(!1),Io=jo;function Po(e,t){var n=e.type.contextTypes;if(!n)return jo;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o,i={};for(o in n)i[o]=t[o];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Ao(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ro(){Co(Oo),Co(To)}function Do(e,t,n){if(To.current!==jo)throw Error(i(168));No(To,t),No(Oo,n)}function Mo(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in t))throw Error(i(108,q(e)||"Unknown",o));return L({},n,r)}function Lo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||jo,Io=To.current,No(To,e),No(Oo,Oo.current),!0}function zo(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Mo(e,t,Io),r.__reactInternalMemoizedMergedChildContext=e,Co(Oo),Co(To),No(To,e)):Co(Oo),No(Oo,n)}var Uo=null,Bo=!1,Fo=!1;function Ko(e){null===Uo?Uo=[e]:Uo.push(e)}function qo(){if(!Fo&&null!==Uo){Fo=!0;var e=0,t=wt;try{var n=Uo;for(wt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Uo=null,Bo=!1}catch(o){throw null!==Uo&&(Uo=Uo.slice(e+1)),Ye(Qe,qo),o}finally{wt=t,Fo=!1}}return null}var Vo=[],Wo=0,Ho=null,Yo=0,Go=[],Xo=0,Jo=null,$o=1,Zo="";function Qo(e,t){Vo[Wo++]=Yo,Vo[Wo++]=Ho,Ho=e,Yo=t}function ei(e,t,n){Go[Xo++]=$o,Go[Xo++]=Zo,Go[Xo++]=Jo,Jo=e;var r=$o;e=Zo;var o=32-at(r)-1;r&=~(1<<o),n+=1;var i=32-at(t)+o;if(30<i){var a=o-o%5;i=(r&(1<<a)-1).toString(32),r>>=a,o-=a,$o=1<<32-at(t)+o|n<<o|r,Zo=i+e}else $o=1<<i|n<<o|r,Zo=e}function ti(e){null!==e.return&&(Qo(e,1),ei(e,1,0))}function ni(e){for(;e===Ho;)Ho=Vo[--Wo],Vo[Wo]=null,Yo=Vo[--Wo],Vo[Wo]=null;for(;e===Jo;)Jo=Go[--Xo],Go[Xo]=null,Zo=Go[--Xo],Go[Xo]=null,$o=Go[--Xo],Go[Xo]=null}var ri=null,oi=null,ii=!1,ai=null;function si(e,t){var n=Oc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function li(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ri=e,oi=co(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ri=e,oi=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Jo?{id:$o,overflow:Zo}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Oc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ri=e,oi=null,!0);default:return!1}}function ci(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ui(e){if(ii){var t=oi;if(t){var n=t;if(!li(e,t)){if(ci(e))throw Error(i(418));t=co(n.nextSibling);var r=ri;t&&li(e,t)?si(r,n):(e.flags=-4097&e.flags|2,ii=!1,ri=e)}}else{if(ci(e))throw Error(i(418));e.flags=-4097&e.flags|2,ii=!1,ri=e}}}function di(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ri=e}function hi(e){if(e!==ri)return!1;if(!ii)return di(e),ii=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!no(e.type,e.memoizedProps)),t&&(t=oi)){if(ci(e))throw fi(),Error(i(418));for(;t;)si(e,t),t=co(t.nextSibling)}if(di(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){oi=co(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}oi=null}}else oi=ri?co(e.stateNode.nextSibling):null;return!0}function fi(){for(var e=oi;e;)e=co(e.nextSibling)}function pi(){oi=ri=null,ii=!1}function vi(e){null===ai?ai=[e]:ai.push(e)}var mi=b.ReactCurrentBatchConfig;function gi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var o=r,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=o.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function yi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function wi(e){return(0,e._init)(e._payload)}function bi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Mc(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===S?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===P&&wi(i)===t.type)?((r=o(t,n.props)).ref=gi(e,t,n),r.return=e,r):((r=Ac(n.type,n.key,n.props,null,e.mode,r)).ref=gi(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Lc(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=Rc(n,e.mode,r,i)).return=e,t):((t=o(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Mc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case _:return(n=Ac(t.type,t.key,t.props,null,e.mode,n)).ref=gi(e,null,t),n.return=e,n;case x:return(t=Lc(t,e.mode,n)).return=e,t;case P:return h(e,(0,t._init)(t._payload),n)}if(te(t)||D(t))return(t=Rc(t,e.mode,n,null)).return=e,t;yi(e,t)}return null}function f(e,t,n,r){var o=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==o?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case _:return n.key===o?c(e,t,n,r):null;case x:return n.key===o?u(e,t,n,r):null;case P:return f(e,t,(o=n._init)(n._payload),r)}if(te(n)||D(n))return null!==o?null:d(e,t,n,r,null);yi(e,n)}return null}function p(e,t,n,r,o){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,o);if("object"===typeof r&&null!==r){switch(r.$$typeof){case _:return c(t,e=e.get(null===r.key?n:r.key)||null,r,o);case x:return u(t,e=e.get(null===r.key?n:r.key)||null,r,o);case P:return p(e,t,n,(0,r._init)(r._payload),o)}if(te(r)||D(r))return d(t,e=e.get(n)||null,r,o,null);yi(t,r)}return null}function v(o,i,s,l){for(var c=null,u=null,d=i,v=i=0,m=null;null!==d&&v<s.length;v++){d.index>v?(m=d,d=null):m=d.sibling;var g=f(o,d,s[v],l);if(null===g){null===d&&(d=m);break}e&&d&&null===g.alternate&&t(o,d),i=a(g,i,v),null===u?c=g:u.sibling=g,u=g,d=m}if(v===s.length)return n(o,d),ii&&Qo(o,v),c;if(null===d){for(;v<s.length;v++)null!==(d=h(o,s[v],l))&&(i=a(d,i,v),null===u?c=d:u.sibling=d,u=d);return ii&&Qo(o,v),c}for(d=r(o,d);v<s.length;v++)null!==(m=p(d,o,v,s[v],l))&&(e&&null!==m.alternate&&d.delete(null===m.key?v:m.key),i=a(m,i,v),null===u?c=m:u.sibling=m,u=m);return e&&d.forEach(function(e){return t(o,e)}),ii&&Qo(o,v),c}function m(o,s,l,c){var u=D(l);if("function"!==typeof u)throw Error(i(150));if(null==(l=u.call(l)))throw Error(i(151));for(var d=u=null,v=s,m=s=0,g=null,y=l.next();null!==v&&!y.done;m++,y=l.next()){v.index>m?(g=v,v=null):g=v.sibling;var w=f(o,v,y.value,c);if(null===w){null===v&&(v=g);break}e&&v&&null===w.alternate&&t(o,v),s=a(w,s,m),null===d?u=w:d.sibling=w,d=w,v=g}if(y.done)return n(o,v),ii&&Qo(o,m),u;if(null===v){for(;!y.done;m++,y=l.next())null!==(y=h(o,y.value,c))&&(s=a(y,s,m),null===d?u=y:d.sibling=y,d=y);return ii&&Qo(o,m),u}for(v=r(o,v);!y.done;m++,y=l.next())null!==(y=p(v,o,m,y.value,c))&&(e&&null!==y.alternate&&v.delete(null===y.key?m:y.key),s=a(y,s,m),null===d?u=y:d.sibling=y,d=y);return e&&v.forEach(function(e){return t(o,e)}),ii&&Qo(o,m),u}return function e(r,i,a,l){if("object"===typeof a&&null!==a&&a.type===S&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case _:e:{for(var c=a.key,u=i;null!==u;){if(u.key===c){if((c=a.type)===S){if(7===u.tag){n(r,u.sibling),(i=o(u,a.props.children)).return=r,r=i;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===P&&wi(c)===u.type){n(r,u.sibling),(i=o(u,a.props)).ref=gi(r,u,a),i.return=r,r=i;break e}n(r,u);break}t(r,u),u=u.sibling}a.type===S?((i=Rc(a.props.children,r.mode,l,a.key)).return=r,r=i):((l=Ac(a.type,a.key,a.props,null,r.mode,l)).ref=gi(r,i,a),l.return=r,r=l)}return s(r);case x:e:{for(u=a.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===a.containerInfo&&i.stateNode.implementation===a.implementation){n(r,i.sibling),(i=o(i,a.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Lc(a,r.mode,l)).return=r,r=i}return s(r);case P:return e(r,i,(u=a._init)(a._payload),l)}if(te(a))return v(r,i,a,l);if(D(a))return m(r,i,a,l);yi(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==i&&6===i.tag?(n(r,i.sibling),(i=o(i,a)).return=r,r=i):(n(r,i),(i=Mc(a,r.mode,l)).return=r,r=i),s(r)):n(r,i)}}var _i=bi(!0),xi=bi(!1),Si=Eo(null),ki=null,Ei=null,Ci=null;function Ni(){Ci=Ei=ki=null}function ji(e){var t=Si.current;Co(Si),e._currentValue=t}function Ti(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Oi(e,t){ki=e,Ci=Ei=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ws=!0),e.firstContext=null)}function Ii(e){var t=e._currentValue;if(Ci!==e)if(e={context:e,memoizedValue:t,next:null},null===Ei){if(null===ki)throw Error(i(308));Ei=e,ki.dependencies={lanes:0,firstContext:e}}else Ei=Ei.next=e;return t}var Pi=null;function Ai(e){null===Pi?Pi=[e]:Pi.push(e)}function Ri(e,t,n,r){var o=t.interleaved;return null===o?(n.next=n,Ai(t)):(n.next=o.next,o.next=n),t.interleaved=n,Di(e,r)}function Di(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Mi=!1;function Li(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ui(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Bi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Nl)){var o=r.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),r.pending=t,Di(e,n)}return null===(o=r.interleaved)?(t.next=t,Ai(r)):(t.next=o.next,o.next=t),r.interleaved=t,Di(e,n)}function Fi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Ki(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var o=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?o=i=a:i=i.next=a,n=n.next}while(null!==n);null===i?o=i=t:i=i.next=t}else o=i=t;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function qi(e,t,n,r){var o=e.updateQueue;Mi=!1;var i=o.firstBaseUpdate,a=o.lastBaseUpdate,s=o.shared.pending;if(null!==s){o.shared.pending=null;var l=s,c=l.next;l.next=null,null===a?i=c:a.next=c,a=l;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l))}if(null!==i){var d=o.baseState;for(a=0,u=c=l=null,s=i;;){var h=s.lane,f=s.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,v=s;switch(h=t,f=n,v.tag){case 1:if("function"===typeof(p=v.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=v.payload)?p.call(f,d,h):p)||void 0===h)break e;d=L({},d,h);break e;case 2:Mi=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(h=o.effects)?o.effects=[s]:h.push(s))}else f={eventTime:f,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,a|=h;if(null===(s=s.next)){if(null===(s=o.shared.pending))break;s=(h=s).next,h.next=null,o.lastBaseUpdate=h,o.shared.pending=null}}if(null===u&&(l=d),o.baseState=l,o.firstBaseUpdate=c,o.lastBaseUpdate=u,null!==(t=o.shared.interleaved)){o=t;do{a|=o.lane,o=o.next}while(o!==t)}else null===i&&(o.shared.lanes=0);Dl|=a,e.lanes=a,e.memoizedState=d}}function Vi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(null!==o){if(r.callback=null,r=n,"function"!==typeof o)throw Error(i(191,o));o.call(r)}}}var Wi={},Hi=Eo(Wi),Yi=Eo(Wi),Gi=Eo(Wi);function Xi(e){if(e===Wi)throw Error(i(174));return e}function Ji(e,t){switch(No(Gi,t),No(Yi,e),No(Hi,Wi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Co(Hi),No(Hi,t)}function $i(){Co(Hi),Co(Yi),Co(Gi)}function Zi(e){Xi(Gi.current);var t=Xi(Hi.current),n=le(t,e.type);t!==n&&(No(Yi,e),No(Hi,n))}function Qi(e){Yi.current===e&&(Co(Hi),Co(Yi))}var ea=Eo(0);function ta(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var na=[];function ra(){for(var e=0;e<na.length;e++)na[e]._workInProgressVersionPrimary=null;na.length=0}var oa=b.ReactCurrentDispatcher,ia=b.ReactCurrentBatchConfig,aa=0,sa=null,la=null,ca=null,ua=!1,da=!1,ha=0,fa=0;function pa(){throw Error(i(321))}function va(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function ma(e,t,n,r,o,a){if(aa=a,sa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,oa.current=null===e||null===e.memoizedState?Qa:es,e=n(r,o),da){a=0;do{if(da=!1,ha=0,25<=a)throw Error(i(301));a+=1,ca=la=null,t.updateQueue=null,oa.current=ts,e=n(r,o)}while(da)}if(oa.current=Za,t=null!==la&&null!==la.next,aa=0,ca=la=sa=null,ua=!1,t)throw Error(i(300));return e}function ga(){var e=0!==ha;return ha=0,e}function ya(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ca?sa.memoizedState=ca=e:ca=ca.next=e,ca}function wa(){if(null===la){var e=sa.alternate;e=null!==e?e.memoizedState:null}else e=la.next;var t=null===ca?sa.memoizedState:ca.next;if(null!==t)ca=t,la=e;else{if(null===e)throw Error(i(310));e={memoizedState:(la=e).memoizedState,baseState:la.baseState,baseQueue:la.baseQueue,queue:la.queue,next:null},null===ca?sa.memoizedState=ca=e:ca=ca.next=e}return ca}function ba(e,t){return"function"===typeof t?t(e):t}function _a(e){var t=wa(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=la,o=r.baseQueue,a=n.pending;if(null!==a){if(null!==o){var s=o.next;o.next=a.next,a.next=s}r.baseQueue=o=a,n.pending=null}if(null!==o){a=o.next,r=r.baseState;var l=s=null,c=null,u=a;do{var d=u.lane;if((aa&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,s=r):c=c.next=h,sa.lanes|=d,Dl|=d}u=u.next}while(null!==u&&u!==a);null===c?s=r:c.next=l,sr(r,t.memoizedState)||(ws=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){o=e;do{a=o.lane,sa.lanes|=a,Dl|=a,o=o.next}while(o!==e)}else null===o&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function xa(e){var t=wa(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,a=t.memoizedState;if(null!==o){n.pending=null;var s=o=o.next;do{a=e(a,s.action),s=s.next}while(s!==o);sr(a,t.memoizedState)||(ws=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Sa(){}function ka(e,t){var n=sa,r=wa(),o=t(),a=!sr(r.memoizedState,o);if(a&&(r.memoizedState=o,ws=!0),r=r.queue,Ma(Na.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==ca&&1&ca.memoizedState.tag){if(n.flags|=2048,Ia(9,Ca.bind(null,n,r,o,t),void 0,null),null===jl)throw Error(i(349));0!==(30&aa)||Ea(n,t,o)}return o}function Ea(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ca(e,t,n,r){t.value=n,t.getSnapshot=r,ja(t)&&Ta(e)}function Na(e,t,n){return n(function(){ja(t)&&Ta(e)})}function ja(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Ta(e){var t=Di(e,1);null!==t&&tc(t,e,1,-1)}function Oa(e){var t=ya();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ba,lastRenderedState:e},t.queue=e,e=e.dispatch=Ga.bind(null,sa,e),[t.memoizedState,e]}function Ia(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Pa(){return wa().memoizedState}function Aa(e,t,n,r){var o=ya();sa.flags|=e,o.memoizedState=Ia(1|t,n,void 0,void 0===r?null:r)}function Ra(e,t,n,r){var o=wa();r=void 0===r?null:r;var i=void 0;if(null!==la){var a=la.memoizedState;if(i=a.destroy,null!==r&&va(r,a.deps))return void(o.memoizedState=Ia(t,n,i,r))}sa.flags|=e,o.memoizedState=Ia(1|t,n,i,r)}function Da(e,t){return Aa(8390656,8,e,t)}function Ma(e,t){return Ra(2048,8,e,t)}function La(e,t){return Ra(4,2,e,t)}function za(e,t){return Ra(4,4,e,t)}function Ua(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ba(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ra(4,4,Ua.bind(null,t,e),n)}function Fa(){}function Ka(e,t){var n=wa();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&va(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function qa(e,t){var n=wa();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&va(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Va(e,t,n){return 0===(21&aa)?(e.baseState&&(e.baseState=!1,ws=!0),e.memoizedState=n):(sr(n,t)||(n=vt(),sa.lanes|=n,Dl|=n,e.baseState=!0),t)}function Wa(e,t){var n=wt;wt=0!==n&&4>n?n:4,e(!0);var r=ia.transition;ia.transition={};try{e(!1),t()}finally{wt=n,ia.transition=r}}function Ha(){return wa().memoizedState}function Ya(e,t,n){var r=ec(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Xa(e))Ja(t,n);else if(null!==(n=Ri(e,t,n,r))){tc(n,e,r,Ql()),$a(n,t,r)}}function Ga(e,t,n){var r=ec(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Xa(e))Ja(t,o);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=i(a,n);if(o.hasEagerState=!0,o.eagerState=s,sr(s,a)){var l=t.interleaved;return null===l?(o.next=o,Ai(t)):(o.next=l.next,l.next=o),void(t.interleaved=o)}}catch(c){}null!==(n=Ri(e,t,o,r))&&(tc(n,e,r,o=Ql()),$a(n,t,r))}}function Xa(e){var t=e.alternate;return e===sa||null!==t&&t===sa}function Ja(e,t){da=ua=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function $a(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Za={readContext:Ii,useCallback:pa,useContext:pa,useEffect:pa,useImperativeHandle:pa,useInsertionEffect:pa,useLayoutEffect:pa,useMemo:pa,useReducer:pa,useRef:pa,useState:pa,useDebugValue:pa,useDeferredValue:pa,useTransition:pa,useMutableSource:pa,useSyncExternalStore:pa,useId:pa,unstable_isNewReconciler:!1},Qa={readContext:Ii,useCallback:function(e,t){return ya().memoizedState=[e,void 0===t?null:t],e},useContext:Ii,useEffect:Da,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Aa(4194308,4,Ua.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Aa(4194308,4,e,t)},useInsertionEffect:function(e,t){return Aa(4,2,e,t)},useMemo:function(e,t){var n=ya();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ya();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ya.bind(null,sa,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ya().memoizedState=e},useState:Oa,useDebugValue:Fa,useDeferredValue:function(e){return ya().memoizedState=e},useTransition:function(){var e=Oa(!1),t=e[0];return e=Wa.bind(null,e[1]),ya().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=sa,o=ya();if(ii){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===jl)throw Error(i(349));0!==(30&aa)||Ea(r,t,n)}o.memoizedState=n;var a={value:n,getSnapshot:t};return o.queue=a,Da(Na.bind(null,r,a,e),[e]),r.flags|=2048,Ia(9,Ca.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=ya(),t=jl.identifierPrefix;if(ii){var n=Zo;t=":"+t+"R"+(n=($o&~(1<<32-at($o)-1)).toString(32)+n),0<(n=ha++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=fa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:Ii,useCallback:Ka,useContext:Ii,useEffect:Ma,useImperativeHandle:Ba,useInsertionEffect:La,useLayoutEffect:za,useMemo:qa,useReducer:_a,useRef:Pa,useState:function(){return _a(ba)},useDebugValue:Fa,useDeferredValue:function(e){return Va(wa(),la.memoizedState,e)},useTransition:function(){return[_a(ba)[0],wa().memoizedState]},useMutableSource:Sa,useSyncExternalStore:ka,useId:Ha,unstable_isNewReconciler:!1},ts={readContext:Ii,useCallback:Ka,useContext:Ii,useEffect:Ma,useImperativeHandle:Ba,useInsertionEffect:La,useLayoutEffect:za,useMemo:qa,useReducer:xa,useRef:Pa,useState:function(){return xa(ba)},useDebugValue:Fa,useDeferredValue:function(e){var t=wa();return null===la?t.memoizedState=e:Va(t,la.memoizedState,e)},useTransition:function(){return[xa(ba)[0],wa().memoizedState]},useMutableSource:Sa,useSyncExternalStore:ka,useId:Ha,unstable_isNewReconciler:!1};function ns(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function rs(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var os={isMounted:function(e){return!!(e=e._reactInternals)&&Ke(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ql(),o=ec(e),i=Ui(r,o);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Bi(e,i,o))&&(tc(t,e,o,r),Fi(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ql(),o=ec(e),i=Ui(r,o);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Bi(e,i,o))&&(tc(t,e,o,r),Fi(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ql(),r=ec(e),o=Ui(n,r);o.tag=2,void 0!==t&&null!==t&&(o.callback=t),null!==(t=Bi(e,o,r))&&(tc(t,e,r,n),Fi(t,e,r))}};function is(e,t,n,r,o,i,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,a):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(o,i))}function as(e,t,n){var r=!1,o=jo,i=t.contextType;return"object"===typeof i&&null!==i?i=Ii(i):(o=Ao(t)?Io:To.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Po(e,o):jo),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=os,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function ss(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&os.enqueueReplaceState(t,t.state,null)}function ls(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},Li(e);var i=t.contextType;"object"===typeof i&&null!==i?o.context=Ii(i):(i=Ao(t)?Io:To.current,o.context=Po(e,i)),o.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(rs(e,t,i,n),o.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(t=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&os.enqueueReplaceState(o,o.state,null),qi(e,n,o,r),o.state=e.memoizedState),"function"===typeof o.componentDidMount&&(e.flags|=4194308)}function cs(e,t){try{var n="",r=t;do{n+=F(r),r=r.return}while(r);var o=n}catch(i){o="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:o,digest:null}}function us(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ds(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var hs="function"===typeof WeakMap?WeakMap:Map;function fs(e,t,n){(n=Ui(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ql||(ql=!0,Vl=r),ds(0,t)},n}function ps(e,t,n){(n=Ui(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){ds(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){ds(0,t),"function"!==typeof r&&(null===Wl?Wl=new Set([this]):Wl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function vs(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hs;var o=new Set;r.set(t,o)}else void 0===(o=r.get(t))&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=kc.bind(null,e,t,n),t.then(e,e))}function ms(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function gs(e,t,n,r,o){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ui(-1,1)).tag=2,Bi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=o,e)}var ys=b.ReactCurrentOwner,ws=!1;function bs(e,t,n,r){t.child=null===e?xi(t,null,n,r):_i(t,e.child,n,r)}function _s(e,t,n,r,o){n=n.render;var i=t.ref;return Oi(t,o),r=ma(e,t,n,r,i,o),n=ga(),null===e||ws?(ii&&n&&ti(t),t.flags|=1,bs(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,qs(e,t,o))}function xs(e,t,n,r,o){if(null===e){var i=n.type;return"function"!==typeof i||Ic(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Ac(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Ss(e,t,i,r,o))}if(i=e.child,0===(e.lanes&o)){var a=i.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(a,r)&&e.ref===t.ref)return qs(e,t,o)}return t.flags|=1,(e=Pc(i,r)).ref=t.ref,e.return=t,t.child=e}function Ss(e,t,n,r,o){if(null!==e){var i=e.memoizedProps;if(lr(i,r)&&e.ref===t.ref){if(ws=!1,t.pendingProps=r=i,0===(e.lanes&o))return t.lanes=e.lanes,qs(e,t,o);0!==(131072&e.flags)&&(ws=!0)}}return Cs(e,t,n,r,o)}function ks(e,t,n){var r=t.pendingProps,o=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},No(Pl,Il),Il|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,No(Pl,Il),Il|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,No(Pl,Il),Il|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,No(Pl,Il),Il|=r;return bs(e,t,o,n),t.child}function Es(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Cs(e,t,n,r,o){var i=Ao(n)?Io:To.current;return i=Po(t,i),Oi(t,o),n=ma(e,t,n,r,i,o),r=ga(),null===e||ws?(ii&&r&&ti(t),t.flags|=1,bs(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,qs(e,t,o))}function Ns(e,t,n,r,o){if(Ao(n)){var i=!0;Lo(t)}else i=!1;if(Oi(t,o),null===t.stateNode)Ks(e,t),as(t,n,r),ls(t,n,r,o),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ii(c):c=Po(t,c=Ao(n)?Io:To.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||l!==c)&&ss(t,a,r,c),Mi=!1;var h=t.memoizedState;a.state=h,qi(t,r,a,o),l=t.memoizedState,s!==r||h!==l||Oo.current||Mi?("function"===typeof u&&(rs(t,n,u,r),l=t.memoizedState),(s=Mi||is(t,n,s,r,h,l,c))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=c,r=s):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,zi(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:ns(t.type,s),a.props=c,d=t.pendingProps,h=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ii(l):l=Po(t,l=Ao(n)?Io:To.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==d||h!==l)&&ss(t,a,r,l),Mi=!1,h=t.memoizedState,a.state=h,qi(t,r,a,o);var p=t.memoizedState;s!==d||h!==p||Oo.current||Mi?("function"===typeof f&&(rs(t,n,f,r),p=t.memoizedState),(c=Mi||is(t,n,c,r,h,p,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=l,r=c):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return js(e,t,n,r,i,o)}function js(e,t,n,r,o,i){Es(e,t);var a=0!==(128&t.flags);if(!r&&!a)return o&&zo(t,n,!1),qs(e,t,i);r=t.stateNode,ys.current=t;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=_i(t,e.child,null,i),t.child=_i(t,null,s,i)):bs(e,t,s,i),t.memoizedState=r.state,o&&zo(t,n,!0),t.child}function Ts(e){var t=e.stateNode;t.pendingContext?Do(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Do(0,t.context,!1),Ji(e,t.containerInfo)}function Os(e,t,n,r,o){return pi(),vi(o),t.flags|=256,bs(e,t,n,r),t.child}var Is,Ps,As,Rs={dehydrated:null,treeContext:null,retryLane:0};function Ds(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ms(e,t,n){var r,o=t.pendingProps,a=ea.current,s=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),No(ea,1&a),null===e)return ui(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=o.children,e=o.fallback,s?(o=t.mode,s=t.child,l={mode:"hidden",children:l},0===(1&o)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Dc(l,o,0,null),e=Rc(e,o,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ds(n),t.memoizedState=Rs,e):Ls(t,l));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,o,a,s){if(n)return 256&t.flags?(t.flags&=-257,zs(e,t,s,r=us(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,o=t.mode,r=Dc({mode:"visible",children:r.children},o,0,null),(a=Rc(a,o,s,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&_i(t,e.child,null,s),t.child.memoizedState=Ds(s),t.memoizedState=Rs,a);if(0===(1&t.mode))return zs(e,t,s,null);if("$!"===o.data){if(r=o.nextSibling&&o.nextSibling.dataset)var l=r.dgst;return r=l,zs(e,t,s,r=us(a=Error(i(419)),r,void 0))}if(l=0!==(s&e.childLanes),ws||l){if(null!==(r=jl)){switch(s&-s){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(o=0!==(o&(r.suspendedLanes|s))?0:o)&&o!==a.retryLane&&(a.retryLane=o,Di(e,o),tc(r,e,o,-1))}return pc(),zs(e,t,s,r=us(Error(i(421))))}return"$?"===o.data?(t.flags|=128,t.child=e.child,t=Cc.bind(null,e),o._reactRetry=t,null):(e=a.treeContext,oi=co(o.nextSibling),ri=t,ii=!0,ai=null,null!==e&&(Go[Xo++]=$o,Go[Xo++]=Zo,Go[Xo++]=Jo,$o=e.id,Zo=e.overflow,Jo=t),t=Ls(t,r.children),t.flags|=4096,t)}(e,t,l,o,r,a,n);if(s){s=o.fallback,l=t.mode,r=(a=e.child).sibling;var c={mode:"hidden",children:o.children};return 0===(1&l)&&t.child!==a?((o=t.child).childLanes=0,o.pendingProps=c,t.deletions=null):(o=Pc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==r?s=Pc(r,s):(s=Rc(s,l,n,null)).flags|=2,s.return=t,o.return=t,o.sibling=s,t.child=o,o=s,s=t.child,l=null===(l=e.child.memoizedState)?Ds(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~n,t.memoizedState=Rs,o}return e=(s=e.child).sibling,o=Pc(s,{mode:"visible",children:o.children}),0===(1&t.mode)&&(o.lanes=n),o.return=t,o.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=o,t.memoizedState=null,o}function Ls(e,t){return(t=Dc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function zs(e,t,n,r){return null!==r&&vi(r),_i(t,e.child,null,n),(e=Ls(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Us(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ti(e.return,t,n)}function Bs(e,t,n,r,o){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function Fs(e,t,n){var r=t.pendingProps,o=r.revealOrder,i=r.tail;if(bs(e,t,r.children,n),0!==(2&(r=ea.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Us(e,n,t);else if(19===e.tag)Us(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(No(ea,r),0===(1&t.mode))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===ta(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),Bs(t,!1,o,n,i);break;case"backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===ta(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}Bs(t,!0,n,null,i);break;case"together":Bs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ks(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Dl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Pc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Vs(e,t){if(!ii)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ws(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=14680064&o.subtreeFlags,r|=14680064&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Hs(e,t,n){var r=t.pendingProps;switch(ni(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ws(t),null;case 1:case 17:return Ao(t.type)&&Ro(),Ws(t),null;case 3:return r=t.stateNode,$i(),Co(Oo),Co(To),ra(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ai&&(ic(ai),ai=null))),Ws(t),null;case 5:Qi(t);var o=Xi(Gi.current);if(n=t.type,null!==e&&null!=t.stateNode)Ps(e,t,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return Ws(t),null}if(e=Xi(Hi.current),hi(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[fo]=t,r[po]=a,e=0!==(1&t.mode),n){case"dialog":Ur("cancel",r),Ur("close",r);break;case"iframe":case"object":case"embed":Ur("load",r);break;case"video":case"audio":for(o=0;o<Dr.length;o++)Ur(Dr[o],r);break;case"source":Ur("error",r);break;case"img":case"image":case"link":Ur("error",r),Ur("load",r);break;case"details":Ur("toggle",r);break;case"input":J(r,a),Ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Ur("invalid",r);break;case"textarea":oe(r,a),Ur("invalid",r)}for(var l in ye(n,a),o=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==a.suppressHydrationWarning&&Zr(r.textContent,c,e),o=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Zr(r.textContent,c,e),o=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ur("scroll",r)}switch(n){case"input":H(r),Q(r,a,!0);break;case"textarea":H(r),ae(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=Qr)}r=o,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===o.nodeType?o:o.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[fo]=t,e[po]=r,Is(e,t),t.stateNode=e;e:{switch(l=we(n,r),n){case"dialog":Ur("cancel",e),Ur("close",e),o=r;break;case"iframe":case"object":case"embed":Ur("load",e),o=r;break;case"video":case"audio":for(o=0;o<Dr.length;o++)Ur(Dr[o],e);o=r;break;case"source":Ur("error",e),o=r;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),o=r;break;case"details":Ur("toggle",e),o=r;break;case"input":J(e,r),o=X(e,r),Ur("invalid",e);break;case"option":default:o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=L({},r,{value:void 0}),Ur("invalid",e);break;case"textarea":oe(e,r),o=re(e,r),Ur("invalid",e)}for(a in ye(n,o),c=o)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?me(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===a?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=u&&"onScroll"===a&&Ur("scroll",e):null!=u&&w(e,a,u,l))}switch(n){case"input":H(e),Q(e,r,!1);break;case"textarea":H(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+V(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof o.onClick&&(e.onclick=Qr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ws(t),null;case 6:if(e&&null!=t.stateNode)As(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=Xi(Gi.current),Xi(Hi.current),hi(t)){if(r=t.stateNode,n=t.memoizedProps,r[fo]=t,(a=r.nodeValue!==n)&&null!==(e=ri))switch(e.tag){case 3:Zr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zr(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[fo]=t,t.stateNode=r}return Ws(t),null;case 13:if(Co(ea),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ii&&null!==oi&&0!==(1&t.mode)&&0===(128&t.flags))fi(),pi(),t.flags|=98560,a=!1;else if(a=hi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(i(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(i(317));a[fo]=t}else pi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ws(t),a=!1}else null!==ai&&(ic(ai),ai=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ea.current)?0===Al&&(Al=3):pc())),null!==t.updateQueue&&(t.flags|=4),Ws(t),null);case 4:return $i(),null===e&&Kr(t.stateNode.containerInfo),Ws(t),null;case 10:return ji(t.type._context),Ws(t),null;case 19:if(Co(ea),null===(a=t.memoizedState))return Ws(t),null;if(r=0!==(128&t.flags),null===(l=a.rendering))if(r)Vs(a,!1);else{if(0!==Al||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ta(e))){for(t.flags|=128,Vs(a,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return No(ea,1&ea.current|2),t.child}e=e.sibling}null!==a.tail&&$e()>Fl&&(t.flags|=128,r=!0,Vs(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ta(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Vs(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!ii)return Ws(t),null}else 2*$e()-a.renderingStartTime>Fl&&1073741824!==n&&(t.flags|=128,r=!0,Vs(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=$e(),t.sibling=null,n=ea.current,No(ea,r?1&n|2:1&n),t):(Ws(t),null);case 22:case 23:return uc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Il)&&(Ws(t),6&t.subtreeFlags&&(t.flags|=8192)):Ws(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Ys(e,t){switch(ni(t),t.tag){case 1:return Ao(t.type)&&Ro(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return $i(),Co(Oo),Co(To),ra(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Qi(t),null;case 13:if(Co(ea),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));pi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Co(ea),null;case 4:return $i(),null;case 10:return ji(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}Is=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ps=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,Xi(Hi.current);var i,a=null;switch(n){case"input":o=X(e,o),r=X(e,r),a=[];break;case"select":o=L({},o,{value:void 0}),r=L({},r,{value:void 0}),a=[];break;case"textarea":o=re(e,o),r=re(e,r),a=[];break;default:"function"!==typeof o.onClick&&"function"===typeof r.onClick&&(e.onclick=Qr)}for(u in ye(n,r),n=null,o)if(!r.hasOwnProperty(u)&&o.hasOwnProperty(u)&&null!=o[u])if("style"===u){var l=o[u];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=o?o[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ur("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},As=function(e,t,n,r){n!==r&&(t.flags|=4)};var Gs=!1,Xs=!1,Js="function"===typeof WeakSet?WeakSet:Set,$s=null;function Zs(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Sc(e,t,r)}else n.current=null}function Qs(e,t,n){try{n()}catch(r){Sc(e,t,r)}}var el=!1;function tl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var o=r=r.next;do{if((o.tag&e)===e){var i=o.destroy;o.destroy=void 0,void 0!==i&&Qs(t,n,i)}o=o.next}while(o!==r)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function rl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fo],delete t[po],delete t[mo],delete t[go],delete t[yo])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function il(e){return 5===e.tag||3===e.tag||4===e.tag}function al(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||il(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function sl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Qr));else if(4!==r&&null!==(e=e.child))for(sl(e,t,n),e=e.sibling;null!==e;)sl(e,t,n),e=e.sibling}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}var cl=null,ul=!1;function dl(e,t,n){for(n=n.child;null!==n;)hl(e,t,n),n=n.sibling}function hl(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(ot,n)}catch(s){}switch(n.tag){case 5:Xs||Zs(n,t);case 6:var r=cl,o=ul;cl=null,dl(e,t,n),ul=o,null!==(cl=r)&&(ul?(e=cl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):cl.removeChild(n.stateNode));break;case 18:null!==cl&&(ul?(e=cl,n=n.stateNode,8===e.nodeType?lo(e.parentNode,n):1===e.nodeType&&lo(e,n),Kt(e)):lo(cl,n.stateNode));break;case 4:r=cl,o=ul,cl=n.stateNode.containerInfo,ul=!0,dl(e,t,n),cl=r,ul=o;break;case 0:case 11:case 14:case 15:if(!Xs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){o=r=r.next;do{var i=o,a=i.destroy;i=i.tag,void 0!==a&&(0!==(2&i)||0!==(4&i))&&Qs(n,t,a),o=o.next}while(o!==r)}dl(e,t,n);break;case 1:if(!Xs&&(Zs(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Sc(n,t,s)}dl(e,t,n);break;case 21:dl(e,t,n);break;case 22:1&n.mode?(Xs=(r=Xs)||null!==n.memoizedState,dl(e,t,n),Xs=r):dl(e,t,n);break;default:dl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Js),t.forEach(function(t){var r=Nc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function pl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var o=n[r];try{var a=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:cl=l.stateNode,ul=!1;break e;case 3:case 4:cl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===cl)throw Error(i(160));hl(a,s,o),cl=null,ul=!1;var c=o.alternate;null!==c&&(c.return=null),o.return=null}catch(u){Sc(o,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vl(t,e),t=t.sibling}function vl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pl(t,e),ml(e),4&r){try{tl(3,e,e.return),nl(3,e)}catch(m){Sc(e,e.return,m)}try{tl(5,e,e.return)}catch(m){Sc(e,e.return,m)}}break;case 1:pl(t,e),ml(e),512&r&&null!==n&&Zs(n,n.return);break;case 5:if(pl(t,e),ml(e),512&r&&null!==n&&Zs(n,n.return),32&e.flags){var o=e.stateNode;try{he(o,"")}catch(m){Sc(e,e.return,m)}}if(4&r&&null!=(o=e.stateNode)){var a=e.memoizedProps,s=null!==n?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&$(o,a),we(l,s);var u=we(l,a);for(s=0;s<c.length;s+=2){var d=c[s],h=c[s+1];"style"===d?me(o,h):"dangerouslySetInnerHTML"===d?de(o,h):"children"===d?he(o,h):w(o,d,h,u)}switch(l){case"input":Z(o,a);break;case"textarea":ie(o,a);break;case"select":var f=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!a.multiple;var p=a.value;null!=p?ne(o,!!a.multiple,p,!1):f!==!!a.multiple&&(null!=a.defaultValue?ne(o,!!a.multiple,a.defaultValue,!0):ne(o,!!a.multiple,a.multiple?[]:"",!1))}o[po]=a}catch(m){Sc(e,e.return,m)}}break;case 6:if(pl(t,e),ml(e),4&r){if(null===e.stateNode)throw Error(i(162));o=e.stateNode,a=e.memoizedProps;try{o.nodeValue=a}catch(m){Sc(e,e.return,m)}}break;case 3:if(pl(t,e),ml(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Kt(t.containerInfo)}catch(m){Sc(e,e.return,m)}break;case 4:default:pl(t,e),ml(e);break;case 13:pl(t,e),ml(e),8192&(o=e.child).flags&&(a=null!==o.memoizedState,o.stateNode.isHidden=a,!a||null!==o.alternate&&null!==o.alternate.memoizedState||(Bl=$e())),4&r&&fl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Xs=(u=Xs)||d,pl(t,e),Xs=u):pl(t,e),ml(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for($s=e,d=e.child;null!==d;){for(h=$s=d;null!==$s;){switch(p=(f=$s).child,f.tag){case 0:case 11:case 14:case 15:tl(4,f,f.return);break;case 1:Zs(f,f.return);var v=f.stateNode;if("function"===typeof v.componentWillUnmount){r=f,n=f.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(m){Sc(r,n,m)}}break;case 5:Zs(f,f.return);break;case 22:if(null!==f.memoizedState){bl(h);continue}}null!==p?(p.return=f,$s=p):bl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{o=h.stateNode,u?"function"===typeof(a=o.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=h.stateNode,s=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=ve("display",s))}catch(m){Sc(e,e.return,m)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(m){Sc(e,e.return,m)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:pl(t,e),ml(e),4&r&&fl(e);case 21:}}function ml(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(il(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var o=r.stateNode;32&r.flags&&(he(o,""),r.flags&=-33),ll(e,al(e),o);break;case 3:case 4:var a=r.stateNode.containerInfo;sl(e,al(e),a);break;default:throw Error(i(161))}}catch(s){Sc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function gl(e,t,n){$s=e,yl(e,t,n)}function yl(e,t,n){for(var r=0!==(1&e.mode);null!==$s;){var o=$s,i=o.child;if(22===o.tag&&r){var a=null!==o.memoizedState||Gs;if(!a){var s=o.alternate,l=null!==s&&null!==s.memoizedState||Xs;s=Gs;var c=Xs;if(Gs=a,(Xs=l)&&!c)for($s=o;null!==$s;)l=(a=$s).child,22===a.tag&&null!==a.memoizedState?_l(o):null!==l?(l.return=a,$s=l):_l(o);for(;null!==i;)$s=i,yl(i,t,n),i=i.sibling;$s=o,Gs=s,Xs=c}wl(e)}else 0!==(8772&o.subtreeFlags)&&null!==i?(i.return=o,$s=i):wl(e)}}function wl(e){for(;null!==$s;){var t=$s;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Xs||nl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Xs)if(null===n)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:ns(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Vi(t,a,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Vi(t,s,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Kt(h)}}}break;default:throw Error(i(163))}Xs||512&t.flags&&rl(t)}catch(f){Sc(t,t.return,f)}}if(t===e){$s=null;break}if(null!==(n=t.sibling)){n.return=t.return,$s=n;break}$s=t.return}}function bl(e){for(;null!==$s;){var t=$s;if(t===e){$s=null;break}var n=t.sibling;if(null!==n){n.return=t.return,$s=n;break}$s=t.return}}function _l(e){for(;null!==$s;){var t=$s;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{nl(4,t)}catch(l){Sc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var o=t.return;try{r.componentDidMount()}catch(l){Sc(t,o,l)}}var i=t.return;try{rl(t)}catch(l){Sc(t,i,l)}break;case 5:var a=t.return;try{rl(t)}catch(l){Sc(t,a,l)}}}catch(l){Sc(t,t.return,l)}if(t===e){$s=null;break}var s=t.sibling;if(null!==s){s.return=t.return,$s=s;break}$s=t.return}}var xl,Sl=Math.ceil,kl=b.ReactCurrentDispatcher,El=b.ReactCurrentOwner,Cl=b.ReactCurrentBatchConfig,Nl=0,jl=null,Tl=null,Ol=0,Il=0,Pl=Eo(0),Al=0,Rl=null,Dl=0,Ml=0,Ll=0,zl=null,Ul=null,Bl=0,Fl=1/0,Kl=null,ql=!1,Vl=null,Wl=null,Hl=!1,Yl=null,Gl=0,Xl=0,Jl=null,$l=-1,Zl=0;function Ql(){return 0!==(6&Nl)?$e():-1!==$l?$l:$l=$e()}function ec(e){return 0===(1&e.mode)?1:0!==(2&Nl)&&0!==Ol?Ol&-Ol:null!==mi.transition?(0===Zl&&(Zl=vt()),Zl):0!==(e=wt)?e:e=void 0===(e=window.event)?16:Jt(e.type)}function tc(e,t,n,r){if(50<Xl)throw Xl=0,Jl=null,Error(i(185));gt(e,n,r),0!==(2&Nl)&&e===jl||(e===jl&&(0===(2&Nl)&&(Ml|=n),4===Al&&ac(e,Ol)),nc(e,r),1===n&&0===Nl&&0===(1&t.mode)&&(Fl=$e()+500,Bo&&qo()))}function nc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-at(i),s=1<<a,l=o[a];-1===l?0!==(s&n)&&0===(s&r)||(o[a]=ft(s,t)):l<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var r=ht(e,e===jl?Ol:0);if(0===r)null!==n&&Ge(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ge(n),1===t)0===e.tag?function(e){Bo=!0,Ko(e)}(sc.bind(null,e)):Ko(sc.bind(null,e)),ao(function(){0===(6&Nl)&&qo()}),n=null;else{switch(bt(r)){case 1:n=Qe;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=jc(n,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function rc(e,t){if($l=-1,Zl=0,0!==(6&Nl))throw Error(i(327));var n=e.callbackNode;if(_c()&&e.callbackNode!==n)return null;var r=ht(e,e===jl?Ol:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=vc(e,r);else{t=r;var o=Nl;Nl|=2;var a=fc();for(jl===e&&Ol===t||(Kl=null,Fl=$e()+500,dc(e,t));;)try{gc();break}catch(l){hc(e,l)}Ni(),kl.current=a,Nl=o,null!==Tl?t=0:(jl=null,Ol=0,t=Al)}if(0!==t){if(2===t&&(0!==(o=pt(e))&&(r=o,t=oc(e,o))),1===t)throw n=Rl,dc(e,0),ac(e,r),nc(e,$e()),n;if(6===t)ac(e,r);else{if(o=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!sr(i(),o))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)&&(2===(t=vc(e,r))&&(0!==(a=pt(e))&&(r=a,t=oc(e,a))),1===t))throw n=Rl,dc(e,0),ac(e,r),nc(e,$e()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:bc(e,Ul,Kl);break;case 3:if(ac(e,r),(130023424&r)===r&&10<(t=Bl+500-$e())){if(0!==ht(e,0))break;if(((o=e.suspendedLanes)&r)!==r){Ql(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=ro(bc.bind(null,e,Ul,Kl),t);break}bc(e,Ul,Kl);break;case 4:if(ac(e,r),(4194240&r)===r)break;for(t=e.eventTimes,o=-1;0<r;){var s=31-at(r);a=1<<s,(s=t[s])>o&&(o=s),r&=~a}if(r=o,10<(r=(120>(r=$e()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Sl(r/1960))-r)){e.timeoutHandle=ro(bc.bind(null,e,Ul,Kl),r);break}bc(e,Ul,Kl);break;default:throw Error(i(329))}}}return nc(e,$e()),e.callbackNode===n?rc.bind(null,e):null}function oc(e,t){var n=zl;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=vc(e,t))&&(t=Ul,Ul=n,null!==t&&ic(t)),e}function ic(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function ac(e,t){for(t&=~Ll,t&=~Ml,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function sc(e){if(0!==(6&Nl))throw Error(i(327));_c();var t=ht(e,0);if(0===(1&t))return nc(e,$e()),null;var n=vc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=oc(e,r))}if(1===n)throw n=Rl,dc(e,0),ac(e,t),nc(e,$e()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bc(e,Ul,Kl),nc(e,$e()),null}function lc(e,t){var n=Nl;Nl|=1;try{return e(t)}finally{0===(Nl=n)&&(Fl=$e()+500,Bo&&qo())}}function cc(e){null!==Yl&&0===Yl.tag&&0===(6&Nl)&&_c();var t=Nl;Nl|=1;var n=Cl.transition,r=wt;try{if(Cl.transition=null,wt=1,e)return e()}finally{wt=r,Cl.transition=n,0===(6&(Nl=t))&&qo()}}function uc(){Il=Pl.current,Co(Pl)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,oo(n)),null!==Tl)for(n=Tl.return;null!==n;){var r=n;switch(ni(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ro();break;case 3:$i(),Co(Oo),Co(To),ra();break;case 5:Qi(r);break;case 4:$i();break;case 13:case 19:Co(ea);break;case 10:ji(r.type._context);break;case 22:case 23:uc()}n=n.return}if(jl=e,Tl=e=Pc(e.current,null),Ol=Il=t,Al=0,Rl=null,Ll=Ml=Dl=0,Ul=zl=null,null!==Pi){for(t=0;t<Pi.length;t++)if(null!==(r=(n=Pi[t]).interleaved)){n.interleaved=null;var o=r.next,i=n.pending;if(null!==i){var a=i.next;i.next=o,r.next=a}n.pending=r}Pi=null}return e}function hc(e,t){for(;;){var n=Tl;try{if(Ni(),oa.current=Za,ua){for(var r=sa.memoizedState;null!==r;){var o=r.queue;null!==o&&(o.pending=null),r=r.next}ua=!1}if(aa=0,ca=la=sa=null,da=!1,ha=0,El.current=null,null===n||null===n.return){Al=1,Rl=t,Tl=null;break}e:{var a=e,s=n.return,l=n,c=t;if(t=Ol,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=ms(s);if(null!==p){p.flags&=-257,gs(p,s,l,0,t),1&p.mode&&vs(a,u,t),c=u;var v=(t=p).updateQueue;if(null===v){var m=new Set;m.add(c),t.updateQueue=m}else v.add(c);break e}if(0===(1&t)){vs(a,u,t),pc();break e}c=Error(i(426))}else if(ii&&1&l.mode){var g=ms(s);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),gs(g,s,l,0,t),vi(cs(c,l));break e}}a=c=cs(c,l),4!==Al&&(Al=2),null===zl?zl=[a]:zl.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Ki(a,fs(0,c,t));break e;case 1:l=c;var y=a.type,w=a.stateNode;if(0===(128&a.flags)&&("function"===typeof y.getDerivedStateFromError||null!==w&&"function"===typeof w.componentDidCatch&&(null===Wl||!Wl.has(w)))){a.flags|=65536,t&=-t,a.lanes|=t,Ki(a,ps(a,l,t));break e}}a=a.return}while(null!==a)}wc(n)}catch(b){t=b,Tl===n&&null!==n&&(Tl=n=n.return);continue}break}}function fc(){var e=kl.current;return kl.current=Za,null===e?Za:e}function pc(){0!==Al&&3!==Al&&2!==Al||(Al=4),null===jl||0===(268435455&Dl)&&0===(268435455&Ml)||ac(jl,Ol)}function vc(e,t){var n=Nl;Nl|=2;var r=fc();for(jl===e&&Ol===t||(Kl=null,dc(e,t));;)try{mc();break}catch(o){hc(e,o)}if(Ni(),Nl=n,kl.current=r,null!==Tl)throw Error(i(261));return jl=null,Ol=0,Al}function mc(){for(;null!==Tl;)yc(Tl)}function gc(){for(;null!==Tl&&!Xe();)yc(Tl)}function yc(e){var t=xl(e.alternate,e,Il);e.memoizedProps=e.pendingProps,null===t?wc(e):Tl=t,El.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Hs(n,t,Il)))return void(Tl=n)}else{if(null!==(n=Ys(n,t)))return n.flags&=32767,void(Tl=n);if(null===e)return Al=6,void(Tl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Tl=t);Tl=t=e}while(null!==t);0===Al&&(Al=5)}function bc(e,t,n){var r=wt,o=Cl.transition;try{Cl.transition=null,wt=1,function(e,t,n,r){do{_c()}while(null!==Yl);if(0!==(6&Nl))throw Error(i(327));n=e.finishedWork;var o=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-at(n),i=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~i}}(e,a),e===jl&&(Tl=jl=null,Ol=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Hl||(Hl=!0,jc(tt,function(){return _c(),null})),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Cl.transition,Cl.transition=null;var s=wt;wt=1;var l=Nl;Nl|=4,El.current=null,function(e,t){if(eo=Vt,fr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var o=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(_){n=null;break e}var s=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==o&&3!==h.nodeType||(l=s+o),h!==a||0!==r&&3!==h.nodeType||(c=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===o&&(l=s),f===a&&++d===r&&(c=s),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(to={focusedElem:e,selectionRange:n},Vt=!1,$s=t;null!==$s;)if(e=(t=$s).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,$s=e;else for(;null!==$s;){t=$s;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var m=v.memoizedProps,g=v.memoizedState,y=t.stateNode,w=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:ns(t.type,m),g);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(i(163))}}catch(_){Sc(t,t.return,_)}if(null!==(e=t.sibling)){e.return=t.return,$s=e;break}$s=t.return}v=el,el=!1}(e,n),vl(n,e),pr(to),Vt=!!eo,to=eo=null,e.current=n,gl(n,e,o),Je(),Nl=l,wt=s,Cl.transition=a}else e.current=n;if(Hl&&(Hl=!1,Yl=e,Gl=o),a=e.pendingLanes,0===a&&(Wl=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(ot,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),nc(e,$e()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(ql)throw ql=!1,e=Vl,Vl=null,e;0!==(1&Gl)&&0!==e.tag&&_c(),a=e.pendingLanes,0!==(1&a)?e===Jl?Xl++:(Xl=0,Jl=e):Xl=0,qo()}(e,t,n,r)}finally{Cl.transition=o,wt=r}return null}function _c(){if(null!==Yl){var e=bt(Gl),t=Cl.transition,n=wt;try{if(Cl.transition=null,wt=16>e?16:e,null===Yl)var r=!1;else{if(e=Yl,Yl=null,Gl=0,0!==(6&Nl))throw Error(i(331));var o=Nl;for(Nl|=4,$s=e.current;null!==$s;){var a=$s,s=a.child;if(0!==(16&$s.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for($s=u;null!==$s;){var d=$s;switch(d.tag){case 0:case 11:case 15:tl(8,d,a)}var h=d.child;if(null!==h)h.return=d,$s=h;else for(;null!==$s;){var f=(d=$s).sibling,p=d.return;if(ol(d),d===u){$s=null;break}if(null!==f){f.return=p,$s=f;break}$s=p}}}var v=a.alternate;if(null!==v){var m=v.child;if(null!==m){v.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(null!==m)}}$s=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,$s=s;else e:for(;null!==$s;){if(0!==(2048&(a=$s).flags))switch(a.tag){case 0:case 11:case 15:tl(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,$s=y;break e}$s=a.return}}var w=e.current;for($s=w;null!==$s;){var b=(s=$s).child;if(0!==(2064&s.subtreeFlags)&&null!==b)b.return=s,$s=b;else e:for(s=w;null!==$s;){if(0!==(2048&(l=$s).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(x){Sc(l,l.return,x)}if(l===s){$s=null;break e}var _=l.sibling;if(null!==_){_.return=l.return,$s=_;break e}$s=l.return}}if(Nl=o,qo(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(ot,e)}catch(x){}r=!0}return r}finally{wt=n,Cl.transition=t}}return!1}function xc(e,t,n){e=Bi(e,t=fs(0,t=cs(n,t),1),1),t=Ql(),null!==e&&(gt(e,1,t),nc(e,t))}function Sc(e,t,n){if(3===e.tag)xc(e,e,n);else for(;null!==t;){if(3===t.tag){xc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Wl||!Wl.has(r))){t=Bi(t,e=ps(t,e=cs(n,e),1),1),e=Ql(),null!==t&&(gt(t,1,e),nc(t,e));break}}t=t.return}}function kc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=Ql(),e.pingedLanes|=e.suspendedLanes&n,jl===e&&(Ol&n)===n&&(4===Al||3===Al&&(130023424&Ol)===Ol&&500>$e()-Bl?dc(e,0):Ll|=n),nc(e,t)}function Ec(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=Ql();null!==(e=Di(e,t))&&(gt(e,t,n),nc(e,n))}function Cc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ec(e,n)}function Nc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;null!==o&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Ec(e,n)}function jc(e,t){return Ye(e,t)}function Tc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oc(e,t,n,r){return new Tc(e,t,n,r)}function Ic(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var n=e.alternate;return null===n?((n=Oc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ac(e,t,n,r,o,a){var s=2;if(r=e,"function"===typeof e)Ic(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case S:return Rc(n.children,o,a,t);case k:s=8,o|=8;break;case E:return(e=Oc(12,n,t,2|o)).elementType=E,e.lanes=a,e;case T:return(e=Oc(13,n,t,o)).elementType=T,e.lanes=a,e;case O:return(e=Oc(19,n,t,o)).elementType=O,e.lanes=a,e;case A:return Dc(n,o,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:s=10;break e;case N:s=9;break e;case j:s=11;break e;case I:s=14;break e;case P:s=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Oc(s,n,t,o)).elementType=e,t.type=r,t.lanes=a,t}function Rc(e,t,n,r){return(e=Oc(7,e,r,t)).lanes=n,e}function Dc(e,t,n,r){return(e=Oc(22,e,r,t)).elementType=A,e.lanes=n,e.stateNode={isHidden:!1},e}function Mc(e,t,n){return(e=Oc(6,e,null,t)).lanes=n,e}function Lc(e,t,n){return(t=Oc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zc(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Uc(e,t,n,r,o,i,a,s,l){return e=new zc(e,t,n,s,l),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Oc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Li(i),e}function Bc(e){if(!e)return jo;e:{if(Ke(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ao(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Ao(n))return Mo(e,n,t)}return t}function Fc(e,t,n,r,o,i,a,s,l){return(e=Uc(n,r,!0,e,0,i,0,s,l)).context=Bc(null),n=e.current,(i=Ui(r=Ql(),o=ec(n))).callback=void 0!==t&&null!==t?t:null,Bi(n,i,o),e.current.lanes=o,gt(e,o,r),nc(e,r),e}function Kc(e,t,n,r){var o=t.current,i=Ql(),a=ec(o);return n=Bc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ui(i,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Bi(o,t,a))&&(tc(e,o,a,i),Fi(e,o,a)),a}function qc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Vc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Wc(e,t){Vc(e,t),(e=e.alternate)&&Vc(e,t)}xl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Oo.current)ws=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ws=!1,function(e,t,n){switch(t.tag){case 3:Ts(t),pi();break;case 5:Zi(t);break;case 1:Ao(t.type)&&Lo(t);break;case 4:Ji(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;No(Si,r._currentValue),r._currentValue=o;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(No(ea,1&ea.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ms(e,t,n):(No(ea,1&ea.current),null!==(e=qs(e,t,n))?e.sibling:null);No(ea,1&ea.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Fs(e,t,n);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),No(ea,ea.current),r)break;return null;case 22:case 23:return t.lanes=0,ks(e,t,n)}return qs(e,t,n)}(e,t,n);ws=0!==(131072&e.flags)}else ws=!1,ii&&0!==(1048576&t.flags)&&ei(t,Yo,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ks(e,t),e=t.pendingProps;var o=Po(t,To.current);Oi(t,n),o=ma(null,t,r,e,o,n);var a=ga();return t.flags|=1,"object"===typeof o&&null!==o&&"function"===typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ao(r)?(a=!0,Lo(t)):a=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,Li(t),o.updater=os,t.stateNode=o,o._reactInternals=t,ls(t,r,e,n),t=js(null,t,r,!0,a,n)):(t.tag=0,ii&&a&&ti(t),bs(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ks(e,t),e=t.pendingProps,r=(o=r._init)(r._payload),t.type=r,o=t.tag=function(e){if("function"===typeof e)return Ic(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===j)return 11;if(e===I)return 14}return 2}(r),e=ns(r,e),o){case 0:t=Cs(null,t,r,e,n);break e;case 1:t=Ns(null,t,r,e,n);break e;case 11:t=_s(null,t,r,e,n);break e;case 14:t=xs(null,t,r,ns(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,Cs(e,t,r,o=t.elementType===r?o:ns(r,o),n);case 1:return r=t.type,o=t.pendingProps,Ns(e,t,r,o=t.elementType===r?o:ns(r,o),n);case 3:e:{if(Ts(t),null===e)throw Error(i(387));r=t.pendingProps,o=(a=t.memoizedState).element,zi(e,t),qi(t,r,null,n);var s=t.memoizedState;if(r=s.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Os(e,t,r,n,o=cs(Error(i(423)),t));break e}if(r!==o){t=Os(e,t,r,n,o=cs(Error(i(424)),t));break e}for(oi=co(t.stateNode.containerInfo.firstChild),ri=t,ii=!0,ai=null,n=xi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pi(),r===o){t=qs(e,t,n);break e}bs(e,t,r,n)}t=t.child}return t;case 5:return Zi(t),null===e&&ui(t),r=t.type,o=t.pendingProps,a=null!==e?e.memoizedProps:null,s=o.children,no(r,o)?s=null:null!==a&&no(r,a)&&(t.flags|=32),Es(e,t),bs(e,t,s,n),t.child;case 6:return null===e&&ui(t),null;case 13:return Ms(e,t,n);case 4:return Ji(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=_i(t,null,r,n):bs(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,_s(e,t,r,o=t.elementType===r?o:ns(r,o),n);case 7:return bs(e,t,t.pendingProps,n),t.child;case 8:case 12:return bs(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,a=t.memoizedProps,s=o.value,No(Si,r._currentValue),r._currentValue=s,null!==a)if(sr(a.value,s)){if(a.children===o.children&&!Oo.current){t=qs(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){s=a.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===a.tag){(c=Ui(-1,n&-n)).tag=2;var u=a.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),Ti(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===a.tag)s=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(i(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Ti(s,n,t),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===t){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}bs(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,Oi(t,n),r=r(o=Ii(o)),t.flags|=1,bs(e,t,r,n),t.child;case 14:return o=ns(r=t.type,t.pendingProps),xs(e,t,r,o=ns(r.type,o),n);case 15:return Ss(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:ns(r,o),Ks(e,t),t.tag=1,Ao(r)?(e=!0,Lo(t)):e=!1,Oi(t,n),as(t,r,o),ls(t,r,o,n),js(null,t,r,!0,e,n);case 19:return Fs(e,t,n);case 22:return ks(e,t,n)}throw Error(i(156,t.tag))};var Hc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Gc(e){this._internalRoot=e}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $c(){}function Zc(e,t,n,r,o){var i=n._reactRootContainer;if(i){var a=i;if("function"===typeof o){var s=o;o=function(){var e=qc(a);s.call(e)}}Kc(t,a,e,o)}else a=function(e,t,n,r,o){if(o){if("function"===typeof r){var i=r;r=function(){var e=qc(a);i.call(e)}}var a=Fc(t,r,e,0,null,!1,0,"",$c);return e._reactRootContainer=a,e[vo]=a.current,Kr(8===e.nodeType?e.parentNode:e),cc(),a}for(;o=e.lastChild;)e.removeChild(o);if("function"===typeof r){var s=r;r=function(){var e=qc(l);s.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",$c);return e._reactRootContainer=l,e[vo]=l.current,Kr(8===e.nodeType?e.parentNode:e),cc(function(){Kc(t,l,n,r)}),l}(n,t,e,o,r);return qc(a)}Gc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Kc(e,t,null,null)},Gc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;cc(function(){Kc(null,e,null,null)}),t[vo]=null}},Gc.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<At.length&&0!==t&&t<At[n].priority;n++);At.splice(n,0,e),0===n&&Lt(e)}},_t=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),nc(t,$e()),0===(6&Nl)&&(Fl=$e()+500,qo()))}break;case 13:cc(function(){var t=Di(e,1);if(null!==t){var n=Ql();tc(t,e,1,n)}}),Wc(e,1)}},xt=function(e){if(13===e.tag){var t=Di(e,134217728);if(null!==t)tc(t,e,134217728,Ql());Wc(e,134217728)}},St=function(e){if(13===e.tag){var t=ec(e),n=Di(e,t);if(null!==n)tc(n,e,t,Ql());Wc(e,t)}},kt=function(){return wt},Et=function(e,t){var n=wt;try{return wt=e,t()}finally{wt=n}},xe=function(e,t,n){switch(t){case"input":if(Z(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=xo(r);if(!o)throw Error(i(90));Y(r),Z(r,o)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},je=lc,Te=cc;var Qc={usingClientEntryPoint:!1,Events:[bo,_o,xo,Ce,Ne,lc]},eu={findFiberByHostInstance:wo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tu={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nu.isDisabled&&nu.supportsFiber)try{ot=nu.inject(tu),it=nu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Qc,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xc(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Xc(e))throw Error(i(299));var n=!1,r="",o=Hc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=Uc(e,1,!1,null,0,n,0,r,o),e[vo]=t.current,Kr(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return cc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(i(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Xc(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,o=!1,a="",s=Hc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(o=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Fc(t,null,e,1,null!=n?n:null,o,0,a,s),e[vo]=t.current,Kr(e),r)for(e=0;e<r.length;e++)o=(o=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Gc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(i(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(i(40));return!!e._reactRootContainer&&(cc(function(){Zc(null,null,e,!1,function(){e._reactRootContainer=null,e[vo]=null})}),!0)},t.unstable_batchedUpdates=lc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jc(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return Zc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},2759(e,t,n){var r=n(9421),o=n(5652),i=n(9096),a=n(6487),s=n(4052);e.exports=function(e,t,n){var l=s(e)?r:a,c=arguments.length<3;return l(e,i(t,4),n,c,o)}},2761(e){e.exports=function(e){return null!=e&&"object"==typeof e}},2777(e,t,n){var r=n(5193),o=n(2761),i=Object.prototype,a=i.hasOwnProperty,s=i.propertyIsEnumerable,l=r(function(){return arguments}())?r:function(e){return o(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=l},2786(e,t,n){"use strict";var r=n(8208),o=n(5641);e.exports={run:function(e){e.graph().dummyChains=[],r.forEach(e.edges(),function(t){!function(e,t){var n,r,i,a=t.v,s=e.node(a).rank,l=t.w,c=e.node(l).rank,u=t.name,d=e.edge(t),h=d.labelRank;if(c===s+1)return;for(e.removeEdge(t),i=0,++s;s<c;++i,++s)d.points=[],r={width:0,height:0,edgeLabel:d,edgeObj:t,rank:s},n=o.addDummyNode(e,"edge",r,"_d"),s===h&&(r.width=d.width,r.height=d.height,r.dummy="edge-label",r.labelpos=d.labelpos),e.setEdge(a,n,{weight:d.weight},u),0===i&&e.graph().dummyChains.push(n),a=n;e.setEdge(a,l,{weight:d.weight},u)}(e,t)})},undo:function(e){r.forEach(e.graph().dummyChains,function(t){var n,r=e.node(t),o=r.edgeLabel;for(e.setEdge(r.edgeObj,o);r.dummy;)n=e.successors(t)[0],e.removeNode(t),o.points.push({x:r.x,y:r.y}),"edge-label"===r.dummy&&(o.x=r.x,o.y=r.y,o.width=r.width,o.height=r.height),t=n,r=e.node(t)})}}},2866(e,t,n){var r=n(2969);e.exports=function(e){return function(t){return r(t,e)}}},2929(e,t,n){var r=n(6552).Uint8Array;e.exports=r},2969(e,t,n){var r=n(5324),o=n(914);e.exports=function(e,t){for(var n=0,i=(t=r(t,e)).length;null!=e&&n<i;)e=e[o(t[n++])];return n&&n==i?e:void 0}},3028(e){e.exports=function(e,t){return function(n){return e(t(n))}}},3088(e,t,n){"use strict";var r=n(8208),o=n(7938).Graph,i=n(5758).slack;function a(e,t){return r.forEach(e.nodes(),function n(o){r.forEach(t.nodeEdges(o),function(r){var a=r.v,s=o===a?r.w:a;e.hasNode(s)||i(t,r)||(e.setNode(s,{}),e.setEdge(o,s,{}),n(s))})}),e.nodeCount()}function s(e,t){return r.minBy(t.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return i(t,n)})}function l(e,t,n){r.forEach(e.nodes(),function(e){t.node(e).rank+=n})}e.exports=function(e){var t,n,r=new o({directed:!1}),c=e.nodes()[0],u=e.nodeCount();r.setNode(c,{});for(;a(r,e)<u;)t=s(r,e),n=r.hasNode(t.v)?i(e,t):-i(e,t),l(r,e,n);return r}},3097(e,t,n){var r=n(2969);e.exports=function(e,t,n){var o=null==e?void 0:r(e,t);return void 0===o?n:o}},3130(e,t,n){var r=n(8208),o=n(7938).Graph,i=n(6684);e.exports=function(e,t){if(e.nodeCount()<=1)return[];var n=function(e,t){var n=new o,a=0,s=0;r.forEach(e.nodes(),function(e){n.setNode(e,{v:e,in:0,out:0})}),r.forEach(e.edges(),function(e){var r=n.edge(e.v,e.w)||0,o=t(e),i=r+o;n.setEdge(e.v,e.w,i),s=Math.max(s,n.node(e.v).out+=o),a=Math.max(a,n.node(e.w).in+=o)});var c=r.range(s+a+3).map(function(){return new i}),u=a+1;return r.forEach(n.nodes(),function(e){l(c,u,n.node(e))}),{graph:n,buckets:c,zeroIdx:u}}(e,t||a),c=function(e,t,n){var r,o=[],i=t[t.length-1],a=t[0];for(;e.nodeCount();){for(;r=a.dequeue();)s(e,t,n,r);for(;r=i.dequeue();)s(e,t,n,r);if(e.nodeCount())for(var l=t.length-2;l>0;--l)if(r=t[l].dequeue()){o=o.concat(s(e,t,n,r,!0));break}}return o}(n.graph,n.buckets,n.zeroIdx);return r.flatten(r.map(c,function(t){return e.outEdges(t.v,t.w)}),!0)};var a=r.constant(1);function s(e,t,n,o,i){var a=i?[]:void 0;return r.forEach(e.inEdges(o.v),function(r){var o=e.edge(r),s=e.node(r.v);i&&a.push({v:r.v,w:r.w}),s.out-=o,l(t,n,s)}),r.forEach(e.outEdges(o.v),function(r){var o=e.edge(r),i=r.w,a=e.node(i);a.in-=o,l(t,n,a)}),e.removeNode(o.v),a}function l(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}},3204(e,t,n){var r=n(3343),o=n(2777),i=n(4052),a=n(4543),s=n(9194),l=n(1268),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=i(e),u=!n&&o(e),d=!n&&!u&&a(e),h=!n&&!u&&!d&&l(e),f=n||u||d||h,p=f?r(e.length,String):[],v=p.length;for(var m in e)!t&&!c.call(e,m)||f&&("length"==m||d&&("offset"==m||"parent"==m)||h&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||s(m,v))||p.push(m);return p}},3211(e){e.exports=function(e,t){return e===t||e!==e&&t!==t}},3223(e,t,n){var r=n(3868),o=n(4353),i=n(8710),a=n(1980),s=n(310),l=n(2777),c=n(4052),u=n(6272),d=n(4543),h=n(1629),f=n(6686),p=n(2322),v=n(1268),m=n(3737),g=n(1609);e.exports=function(e,t,n,y,w,b,_){var x=m(e,n),S=m(t,n),k=_.get(S);if(k)r(e,n,k);else{var E=b?b(x,S,n+"",e,t,_):void 0,C=void 0===E;if(C){var N=c(S),j=!N&&d(S),T=!N&&!j&&v(S);E=S,N||j||T?c(x)?E=x:u(x)?E=a(x):j?(C=!1,E=o(S,!0)):T?(C=!1,E=i(S,!0)):E=[]:p(S)||l(S)?(E=x,l(x)?E=g(x):f(x)&&!h(x)||(E=s(S))):C=!1}C&&(_.set(S,E),w(E,S,y,b,_),_.delete(S)),r(e,n,E)}}},3253(e,t,n){var r=n(5538),o=n(3868),i=n(4258),a=n(3223),s=n(6686),l=n(474),c=n(3737);e.exports=function e(t,n,u,d,h){t!==n&&i(n,function(i,l){if(h||(h=new r),s(i))a(t,n,l,u,e,d,h);else{var f=d?d(c(t,l),i,l+"",t,n,h):void 0;void 0===f&&(f=i),o(t,l,f)}},l)}},3279(e){e.exports=function(e){return e}},3331(e,t,n){var r=n(9676),o=n(929),i=n(7303);e.exports=function(e){return function(t,n,a){return a&&"number"!=typeof a&&o(t,n,a)&&(n=a=void 0),t=i(t),void 0===n?(n=t,t=0):n=i(n),a=void 0===a?t<n?1:-1:i(a),r(t,n,a,e)}}},3343(e){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},3366(e,t,n){var r=n(7894),o=n(9057);e.exports=function(e,t){return null!=e&&o(e,t,r)}},3411(e,t,n){var r=n(149),o=n(9096),i=n(8883),a=n(4052);e.exports=function(e,t){return(a(e)?r:i)(e,o(t,3))}},3440(e,t,n){var r=n(6552)["__core-js_shared__"];e.exports=r},3516(e){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},3577(e,t,n){e.exports={graphlib:n(7938),layout:n(6675),debug:n(3774),util:{time:n(5641).time,notime:n(5641).notime},version:n(5185)}},3668(e,t,n){var r=n(8902),o=n(2587),i=n(8114);e.exports=function(e,t,n,a,s,l){var c=1&n,u=e.length,d=t.length;if(u!=d&&!(c&&d>u))return!1;var h=l.get(e),f=l.get(t);if(h&&f)return h==t&&f==e;var p=-1,v=!0,m=2&n?new r:void 0;for(l.set(e,t),l.set(t,e);++p<u;){var g=e[p],y=t[p];if(a)var w=c?a(y,g,p,t,e,l):a(g,y,p,e,t,l);if(void 0!==w){if(w)continue;v=!1;break}if(m){if(!o(t,function(e,t){if(!i(m,t)&&(g===e||s(g,e,n,a,l)))return m.push(t)})){v=!1;break}}else if(g!==y&&!s(g,y,n,a,l)){v=!1;break}}return l.delete(e),l.delete(t),v}},3713(e,t,n){var r=n(6140),o=n(1143),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=[];for(var n in Object(e))i.call(e,n)&&"constructor"!=n&&t.push(n);return t}},3737(e){e.exports=function(e,t){if(("constructor"!==t||"function"!==typeof e[t])&&"__proto__"!=t)return e[t]}},3774(e,t,n){var r=n(8208),o=n(5641),i=n(7938).Graph;e.exports={debugOrdering:function(e){var t=o.buildLayerMatrix(e),n=new i({compound:!0,multigraph:!0}).setGraph({});return r.forEach(e.nodes(),function(t){n.setNode(t,{label:t}),n.setParent(t,"layer"+e.node(t).rank)}),r.forEach(e.edges(),function(e){n.setEdge(e.v,e.w,{},e.name)}),r.forEach(t,function(e,t){var o="layer"+t;n.setNode(o,{rank:"same"}),r.reduce(e,function(e,t){return n.setEdge(e,t,{style:"invis"}),t})}),n}}},3781(e,t,n){var r=n(9417),o=n(8673);e.exports=function(e){for(var t=o(e),n=t.length;n--;){var i=t[n],a=e[i];t[n]=[i,a,r(a)]}return t}},3868(e,t,n){var r=n(1775),o=n(3211);e.exports=function(e,t,n){(void 0!==n&&!o(e[t],n)||void 0===n&&!(t in e))&&r(e,t,n)}},3892(e){e.exports=function(e){return this.__data__.has(e)}},3932(e,t,n){var r=n(396),o=n(2866),i=n(2597),a=n(914);e.exports=function(e){return i(e)?r(a(e)):o(e)}},4008(e,t,n){var r=n(7449),o=n(3366);e.exports=function(e,t){return r(e,t,function(t,n){return o(e,n)})}},4020(e){e.exports=function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}},4052(e){var t=Array.isArray;e.exports=t},4065(e){e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},4079(e,t,n){var r=n(8259),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,a=r(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(o,function(e,n,r,o){t.push(r?o.replace(i,"$1"):n||e)}),t});e.exports=a},4160(e){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}},4190(e,t,n){var r=n(1340);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},4202(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,m={};function g(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function y(){}function w(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=g.prototype;var b=w.prototype=new y;b.constructor=w,v(b,g.prototype),b.isPureReactComponent=!0;var _=Array.isArray,x=Object.prototype.hasOwnProperty,S={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,r){var o,i={},a=null,s=null;if(null!=t)for(o in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)x.call(t,o)&&!k.hasOwnProperty(o)&&(i[o]=t[o]);var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(o in l=e.defaultProps)void 0===i[o]&&(i[o]=l[o]);return{$$typeof:n,type:e,key:a,ref:s,props:i,_owner:S.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var N=/\/+/g;function j(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function T(e,t,o,i,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return a=a(l=e),e=""===i?"."+j(l,0):i,_(a)?(o="",null!=e&&(o=e.replace(N,"$&/")+"/"),T(a,t,o,"",function(e){return e})):null!=a&&(C(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,o+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(N,"$&/")+"/")+e)),t.push(a)),1;if(l=0,i=""===i?".":i+":",_(e))for(var c=0;c<e.length;c++){var u=i+j(s=e[c],c);l+=T(s,t,o,u,a)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(s=e.next()).done;)l+=T(s=s.value,t,o,u=i+j(s,c++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function O(e,t,n){if(null==e)return e;var r=[],o=0;return T(e,r,"","",function(e){return t.call(n,e,o++)}),r}function I(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},A={transition:null},R={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:A,ReactCurrentOwner:S};function D(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:O,forEach:function(e,t,n){O(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return O(e,function(){t++}),t},toArray:function(e){return O(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=o,t.Profiler=a,t.PureComponent=w,t.StrictMode=i,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=D,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=v({},e.props),i=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=S.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)x.call(t,c)&&!k.hasOwnProperty(c)&&(o[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)o.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];o.children=l}return{$$typeof:n,type:e.type,key:i,ref:a,props:o,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:I}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=A.transition;A.transition={};try{e()}finally{A.transition=t}},t.unstable_act=D,t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return P.current.useTransition()},t.version="18.3.1"},4258(e,t,n){var r=n(5906)();e.exports=r},4262(e,t,n){var r=n(8895),o=n(4052);e.exports=function(e,t,n){var i=t(e);return o(e)?i:r(i,n(e))}},4308(e,t,n){"use strict";var r=n(8208);function o(e,t,n){for(var o=r.zipObject(n,r.map(n,function(e,t){return t})),i=r.flatten(r.map(t,function(t){return r.sortBy(r.map(e.outEdges(t),function(t){return{pos:o[t.w],weight:e.edge(t).weight}}),"pos")}),!0),a=1;a<n.length;)a<<=1;var s=2*a-1;a-=1;var l=r.map(new Array(s),function(){return 0}),c=0;return r.forEach(i.forEach(function(e){var t=e.pos+a;l[t]+=e.weight;for(var n=0;t>0;)t%2&&(n+=l[t+1]),l[t=t-1>>1]+=e.weight;c+=e.weight*n})),c}e.exports=function(e,t){for(var n=0,r=1;r<t.length;++r)n+=o(e,t[r-1],t[r]);return n}},4320(e,t,n){var r=n(3713),o=n(6924),i=n(2777),a=n(4052),s=n(6571),l=n(4543),c=n(6140),u=n(1268),d=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(s(e)&&(a(e)||"string"==typeof e||"function"==typeof e.splice||l(e)||u(e)||i(e)))return!e.length;var t=o(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!r(e).length;for(var n in e)if(d.call(e,n))return!1;return!0}},4353(e,t,n){e=n.nmd(e);var r=n(6552),o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,a=i&&i.exports===o?r.Buffer:void 0,s=a?a.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=s?s(n):new e.constructor(n);return e.copy(r),r}},4391(e,t,n){"use strict";var r=n(7950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4416(e,t,n){var r=n(8902),o=n(5866),i=n(1558),a=n(8114),s=n(8182),l=n(2074);e.exports=function(e,t,n){var c=-1,u=o,d=e.length,h=!0,f=[],p=f;if(n)h=!1,u=i;else if(d>=200){var v=t?null:s(e);if(v)return l(v);h=!1,u=a,p=new r}else p=t?[]:f;e:for(;++c<d;){var m=e[c],g=t?t(m):m;if(m=n||0!==m?m:0,h&&g===g){for(var y=p.length;y--;)if(p[y]===g)continue e;t&&p.push(g),f.push(m)}else u(p,g,n)||(p!==f&&p.push(g),f.push(m))}return f}},4428(e,t,n){var r=n(5750);function o(){this._arr=[],this._keyIndices={}}e.exports=o,o.prototype.size=function(){return this._arr.length},o.prototype.keys=function(){return this._arr.map(function(e){return e.key})},o.prototype.has=function(e){return r.has(this._keyIndices,e)},o.prototype.priority=function(e){var t=this._keyIndices[e];if(void 0!==t)return this._arr[t].priority},o.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},o.prototype.add=function(e,t){var n=this._keyIndices;if(e=String(e),!r.has(n,e)){var o=this._arr,i=o.length;return n[e]=i,o.push({key:e,priority:t}),this._decrease(i),!0}return!1},o.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},o.prototype.decrease=function(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+t);this._arr[n].priority=t,this._decrease(n)},o.prototype._heapify=function(e){var t=this._arr,n=2*e,r=n+1,o=e;n<t.length&&(o=t[n].priority<t[o].priority?n:o,r<t.length&&(o=t[r].priority<t[o].priority?r:o),o!==e&&(this._swap(e,o),this._heapify(o)))},o.prototype._decrease=function(e){for(var t,n=this._arr,r=n[e].priority;0!==e&&!(n[t=e>>1].priority<r);)this._swap(e,t),e=t},o.prototype._swap=function(e,t){var n=this._arr,r=this._keyIndices,o=n[e],i=n[t];n[e]=i,n[t]=o,r[i.key]=e,r[o.key]=t}},4501(e,t,n){"use strict";var r=n(8208),o=n(3088),i=n(5758).slack,a=n(5758).longestPath,s=n(7938).alg.preorder,l=n(7938).alg.postorder,c=n(5641).simplify;function u(e){e=c(e),a(e);var t,n=o(e);for(f(n),d(n,e);t=v(n);)g(n,e,t,m(n,e,t))}function d(e,t){var n=l(e,e.nodes());n=n.slice(0,n.length-1),r.forEach(n,function(n){!function(e,t,n){var r=e.node(n),o=r.parent;e.edge(n,o).cutvalue=h(e,t,n)}(e,t,n)})}function h(e,t,n){var o=e.node(n).parent,i=!0,a=t.edge(n,o),s=0;return a||(i=!1,a=t.edge(o,n)),s=a.weight,r.forEach(t.nodeEdges(n),function(r){var a,l,c=r.v===n,u=c?r.w:r.v;if(u!==o){var d=c===i,h=t.edge(r).weight;if(s+=d?h:-h,a=n,l=u,e.hasEdge(a,l)){var f=e.edge(n,u).cutvalue;s+=d?-f:f}}}),s}function f(e,t){arguments.length<2&&(t=e.nodes()[0]),p(e,{},1,t)}function p(e,t,n,o,i){var a=n,s=e.node(o);return t[o]=!0,r.forEach(e.neighbors(o),function(i){r.has(t,i)||(n=p(e,t,n,i,o))}),s.low=a,s.lim=n++,i?s.parent=i:delete s.parent,n}function v(e){return r.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function m(e,t,n){var o=n.v,a=n.w;t.hasEdge(o,a)||(o=n.w,a=n.v);var s=e.node(o),l=e.node(a),c=s,u=!1;s.lim>l.lim&&(c=l,u=!0);var d=r.filter(t.edges(),function(t){return u===y(e,e.node(t.v),c)&&u!==y(e,e.node(t.w),c)});return r.minBy(d,function(e){return i(t,e)})}function g(e,t,n,o){var i=n.v,a=n.w;e.removeEdge(i,a),e.setEdge(o.v,o.w,{}),f(e),d(e,t),function(e,t){var n=r.find(e.nodes(),function(e){return!t.node(e).parent}),o=s(e,n);o=o.slice(1),r.forEach(o,function(n){var r=e.node(n).parent,o=t.edge(n,r),i=!1;o||(o=t.edge(r,n),i=!0),t.node(n).rank=t.node(r).rank+(i?o.minlen:-o.minlen)})}(e,t)}function y(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}e.exports=u,u.initLowLimValues=f,u.initCutValues=d,u.calcCutValue=h,u.leaveEdge=v,u.enterEdge=m,u.exchangeEdges=g},4543(e,t,n){e=n.nmd(e);var r=n(6552),o=n(14),i=t&&!t.nodeType&&t,a=i&&e&&!e.nodeType&&e,s=a&&a.exports===i?r.Buffer:void 0,l=(s?s.isBuffer:void 0)||o;e.exports=l},4545(e,t,n){var r=n(7160);e.exports=function(){this.__data__=new r,this.size=0}},4552(e,t,n){var r=n(9812),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=i.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(l){}var o=a.call(e);return r&&(t?e[s]=n:delete e[s]),o}},4570(e,t,n){var r=n(5647),o=n(929);e.exports=function(e){return r(function(t,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,s&&o(n[0],n[1],s)&&(a=i<3?void 0:a,i=1),t=Object(t);++r<i;){var l=n[r];l&&e(t,l,r,a)}return t})}},4657(e){e.exports=function(e,t){return null==e?void 0:e[t]}},4664(e,t,n){var r=n(4258),o=n(8673);e.exports=function(e,t){return e&&r(e,t,o)}},4677(e,t,n){var r=n(3253),o=n(4570)(function(e,t,n){r(e,t,n)});e.exports=o},4724(e,t,n){var r=n(396)("length");e.exports=r},4757(e,t,n){var r=n(6552);e.exports=function(){return r.Date.now()}},4816(e,t,n){var r=n(7251),o=n(7159),i=n(438),a=n(9394),s=n(6874);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=o,l.prototype.get=i,l.prototype.has=a,l.prototype.set=s,e.exports=l},5029(e,t,n){var r=n(6989),o=n(3097),i=n(3366),a=n(2597),s=n(9417),l=n(1310),c=n(914);e.exports=function(e,t){return a(e)&&s(t)?l(c(e),t):function(n){var a=o(n,e);return void 0===a&&a===t?i(n,e):r(t,a,3)}}},5043(e,t,n){"use strict";e.exports=n(4202)},5051(e){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},5111(e,t,n){var r=n(3279);e.exports=function(e){return"function"==typeof e?e:r}},5119(e,t,n){var r=n(6614),o=n(474);e.exports=function(e,t){return e&&r(t,o(t),e)}},5146(e,t,n){var r=n(8208),o=n(5641);function i(e,t,n,a,s,l,c){var u=e.children(c);if(u.length){var d=o.addBorderNode(e,"_bt"),h=o.addBorderNode(e,"_bb"),f=e.node(c);e.setParent(d,c),f.borderTop=d,e.setParent(h,c),f.borderBottom=h,r.forEach(u,function(r){i(e,t,n,a,s,l,r);var o=e.node(r),u=o.borderTop?o.borderTop:r,f=o.borderBottom?o.borderBottom:r,p=o.borderTop?a:2*a,v=u!==f?1:s-l[c]+1;e.setEdge(d,u,{weight:p,minlen:v,nestingEdge:!0}),e.setEdge(f,h,{weight:p,minlen:v,nestingEdge:!0})}),e.parent(c)||e.setEdge(t,d,{weight:0,minlen:s+l[c]})}else c!==t&&e.setEdge(t,c,{weight:0,minlen:n})}e.exports={run:function(e){var t=o.addDummyNode(e,"root",{},"_root"),n=function(e){var t={};function n(o,i){var a=e.children(o);a&&a.length&&r.forEach(a,function(e){n(e,i+1)}),t[o]=i}return r.forEach(e.children(),function(e){n(e,1)}),t}(e),a=r.max(r.values(n))-1,s=2*a+1;e.graph().nestingRoot=t,r.forEach(e.edges(),function(t){e.edge(t).minlen*=s});var l=function(e){return r.reduce(e.edges(),function(t,n){return t+e.edge(n).weight},0)}(e)+1;r.forEach(e.children(),function(r){i(e,t,s,l,a,n,r)}),e.graph().nodeRankFactor=s},cleanup:function(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,r.forEach(e.edges(),function(t){e.edge(t).nestingEdge&&e.removeEdge(t)})}}},5185(e){e.exports="0.8.5"},5193(e,t,n){var r=n(6913),o=n(2761);e.exports=function(e){return o(e)&&"[object Arguments]"==r(e)}},5204(e,t,n){var r=n(7937)(n(6552),"Map");e.exports=r},5324(e,t,n){var r=n(4052),o=n(2597),i=n(4079),a=n(1069);e.exports=function(e,t){return r(e)?e:o(e,t)?[e]:i(a(e))}},5387(e,t,n){var r=n(7937)(n(6552),"Promise");e.exports=r},5428(e,t,n){var r=n(6913),o=n(6173),i=n(2761),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&o(e.length)&&!!a[r(e)]}},5491(e,t,n){var r=n(726),o=n(5652),i=n(5111),a=n(4052);e.exports=function(e,t){return(a(e)?r:o)(e,i(t))}},5538(e,t,n){var r=n(7160),o=n(4545),i=n(793),a=n(7760),s=n(3892),l=n(6788);function c(e){var t=this.__data__=new r(e);this.size=t.size}c.prototype.clear=o,c.prototype.delete=i,c.prototype.get=a,c.prototype.has=s,c.prototype.set=l,e.exports=c},5575(e,t,n){var r=n(7937)(Object,"create");e.exports=r},5636(e,t,n){var r=n(1170),o=Math.max;e.exports=function(e,t,n){return t=o(void 0===t?e.length-1:t,0),function(){for(var i=arguments,a=-1,s=o(i.length-t,0),l=Array(s);++a<s;)l[a]=i[t+a];a=-1;for(var c=Array(t+1);++a<t;)c[a]=i[a];return c[t]=n(l),r(e,this,c)}}},5640(e,t,n){var r=n(3713),o=n(6924),i=n(6571),a=n(620),s=n(1632);e.exports=function(e){if(null==e)return 0;if(i(e))return a(e)?s(e):e.length;var t=o(e);return"[object Map]"==t||"[object Set]"==t?e.size:r(e).length}},5641(e,t,n){"use strict";var r=n(8208),o=n(7938).Graph;function i(e,t,n,o){var i;do{i=r.uniqueId(o)}while(e.hasNode(i));return n.dummy=t,e.setNode(i,n),i}function a(e){return r.max(r.map(e.nodes(),function(t){var n=e.node(t).rank;if(!r.isUndefined(n))return n}))}e.exports={addDummyNode:i,simplify:function(e){var t=(new o).setGraph(e.graph());return r.forEach(e.nodes(),function(n){t.setNode(n,e.node(n))}),r.forEach(e.edges(),function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},o=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+o.weight,minlen:Math.max(r.minlen,o.minlen)})}),t},asNonCompoundGraph:function(e){var t=new o({multigraph:e.isMultigraph()}).setGraph(e.graph());return r.forEach(e.nodes(),function(n){e.children(n).length||t.setNode(n,e.node(n))}),r.forEach(e.edges(),function(n){t.setEdge(n,e.edge(n))}),t},successorWeights:function(e){var t=r.map(e.nodes(),function(t){var n={};return r.forEach(e.outEdges(t),function(t){n[t.w]=(n[t.w]||0)+e.edge(t).weight}),n});return r.zipObject(e.nodes(),t)},predecessorWeights:function(e){var t=r.map(e.nodes(),function(t){var n={};return r.forEach(e.inEdges(t),function(t){n[t.v]=(n[t.v]||0)+e.edge(t).weight}),n});return r.zipObject(e.nodes(),t)},intersectRect:function(e,t){var n,r,o=e.x,i=e.y,a=t.x-o,s=t.y-i,l=e.width/2,c=e.height/2;if(!a&&!s)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(s)*l>Math.abs(a)*c?(s<0&&(c=-c),n=c*a/s,r=c):(a<0&&(l=-l),n=l,r=l*s/a);return{x:o+n,y:i+r}},buildLayerMatrix:function(e){var t=r.map(r.range(a(e)+1),function(){return[]});return r.forEach(e.nodes(),function(n){var o=e.node(n),i=o.rank;r.isUndefined(i)||(t[i][o.order]=n)}),t},normalizeRanks:function(e){var t=r.min(r.map(e.nodes(),function(t){return e.node(t).rank}));r.forEach(e.nodes(),function(n){var o=e.node(n);r.has(o,"rank")&&(o.rank-=t)})},removeEmptyRanks:function(e){var t=r.min(r.map(e.nodes(),function(t){return e.node(t).rank})),n=[];r.forEach(e.nodes(),function(r){var o=e.node(r).rank-t;n[o]||(n[o]=[]),n[o].push(r)});var o=0,i=e.graph().nodeRankFactor;r.forEach(n,function(t,n){r.isUndefined(t)&&n%i!==0?--o:o&&r.forEach(t,function(t){e.node(t).rank+=o})})},addBorderNode:function(e,t,n,r){var o={width:0,height:0};arguments.length>=4&&(o.rank=n,o.order=r);return i(e,"border",o,t)},maxRank:a,partition:function(e,t){var n={lhs:[],rhs:[]};return r.forEach(e,function(e){t(e)?n.lhs.push(e):n.rhs.push(e)}),n},time:function(e,t){var n=r.now();try{return t()}finally{console.log(e+" time: "+(r.now()-n)+"ms")}},notime:function(e,t){return t()}}},5647(e,t,n){var r=n(3279),o=n(5636),i=n(6350);e.exports=function(e,t){return i(o(e,t,r),e+"")}},5652(e,t,n){var r=n(4664),o=n(6516)(r);e.exports=o},5654(e,t,n){var r=n(7937),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();e.exports=o},5673(e,t,n){"use strict";var r=n(8208),o=n(3130);e.exports={run:function(e){var t="greedy"===e.graph().acyclicer?o(e,function(e){return function(t){return e.edge(t).weight}}(e)):function(e){var t=[],n={},o={};function i(a){r.has(o,a)||(o[a]=!0,n[a]=!0,r.forEach(e.outEdges(a),function(e){r.has(n,e.w)?t.push(e):i(e.w)}),delete n[a])}return r.forEach(e.nodes(),i),t}(e);r.forEach(t,function(t){var n=e.edge(t);e.removeEdge(t),n.forwardName=t.name,n.reversed=!0,e.setEdge(t.w,t.v,n,r.uniqueId("rev"))})},undo:function(e){r.forEach(e.edges(),function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}}},5713(e){e.exports=function(){}},5750(e,t,n){var r;try{r={clone:n(1740),constant:n(2541),each:n(2580),filter:n(723),has:n(2117),isArray:n(4052),isEmpty:n(4320),isFunction:n(1629),isUndefined:n(141),keys:n(8673),map:n(3411),reduce:n(2759),size:n(5640),transform:n(2717),union:n(450),values:n(6727)}}catch(o){}r||(r=window._),e.exports=r},5752(e,t,n){var r=n(9395),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,i,a,s){var l=1&n,c=r(e),u=c.length;if(u!=r(t).length&&!l)return!1;for(var d=u;d--;){var h=c[d];if(!(l?h in t:o.call(t,h)))return!1}var f=s.get(e),p=s.get(t);if(f&&p)return f==t&&p==e;var v=!0;s.set(e,t),s.set(t,e);for(var m=l;++d<u;){var g=e[h=c[d]],y=t[h];if(i)var w=l?i(y,g,h,t,e,s):i(g,y,h,e,t,s);if(!(void 0===w?g===y||a(g,y,n,i,s):w)){v=!1;break}m||(m="constructor"==h)}if(v&&!m){var b=e.constructor,_=t.constructor;b==_||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof _&&_ instanceof _||(v=!1)}return s.delete(e),s.delete(t),v}},5758(e,t,n){"use strict";var r=n(8208);e.exports={longestPath:function(e){var t={};r.forEach(e.sources(),function n(o){var i=e.node(o);if(r.has(t,o))return i.rank;t[o]=!0;var a=r.min(r.map(e.outEdges(o),function(t){return n(t.w)-e.edge(t).minlen}));return a!==Number.POSITIVE_INFINITY&&void 0!==a&&null!==a||(a=0),i.rank=a})},slack:function(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}}},5791(e,t,n){var r=n(6924),o=n(2761);e.exports=function(e){return o(e)&&"[object Map]"==r(e)}},5797(e,t,n){var r=n(4816);function o(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=e.apply(this,r);return n.cache=i.set(o,a)||i,a};return n.cache=new(o.Cache||r),n}o.Cache=r,e.exports=o},5816(e){e.exports=function(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}},5819(e,t,n){"use strict";var r=n(8208);e.exports=function(e){var t={},n=r.filter(e.nodes(),function(t){return!e.children(t).length}),o=r.max(r.map(n,function(t){return e.node(t).rank})),i=r.map(r.range(o+1),function(){return[]});var a=r.sortBy(n,function(t){return e.node(t).rank});return r.forEach(a,function n(o){if(r.has(t,o))return;t[o]=!0;var a=e.node(o);i[a.rank].push(o),r.forEach(e.successors(o),n)}),i}},5822(e,t,n){var r=n(5750),o=n(4428);e.exports=function(e,t,n,r){return function(e,t,n,r){var i,a,s={},l=new o,c=function(e){var t=e.v!==i?e.v:e.w,r=s[t],o=n(e),c=a.distance+o;if(o<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+o);c<r.distance&&(r.distance=c,r.predecessor=i,l.decrease(t,c))};e.nodes().forEach(function(e){var n=e===t?0:Number.POSITIVE_INFINITY;s[e]={distance:n},l.add(e,n)});for(;l.size()>0&&(i=l.removeMin(),(a=s[i]).distance!==Number.POSITIVE_INFINITY);)r(i).forEach(c);return s}(e,String(t),n||i,r||function(t){return e.outEdges(t)})};var i=r.constant(1)},5857(e,t,n){var r=n(819),o=n(5636),i=n(6350);e.exports=function(e){return i(o(e,void 0,r),e+"")}},5866(e,t,n){var r=n(8468);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},5893(e,t,n){var r=n(6599);e.exports=function(e,t,n){for(var o=-1,i=e.criteria,a=t.criteria,s=i.length,l=n.length;++o<s;){var c=r(i[o],a[o]);if(c)return o>=l?c:c*("desc"==n[o]?-1:1)}return e.index-t.index}},5906(e){e.exports=function(e){return function(t,n,r){for(var o=-1,i=Object(t),a=r(t),s=a.length;s--;){var l=a[e?s:++o];if(!1===n(i[l],l,i))break}return t}}},5921(e,t,n){var r=n(449),o=n(7574),i=n(6832),a=i&&i.isSet,s=a?o(a):r;e.exports=s},5972(e,t,n){var r=n(8208),o=n(5641);function i(e,t,n,r,i,a){var s={width:0,height:0,rank:a,borderType:t},l=i[t][a-1],c=o.addDummyNode(e,"border",s,n);i[t][a]=c,e.setParent(c,r),l&&e.setEdge(l,c,{weight:1})}e.exports=function(e){r.forEach(e.children(),function t(n){var o=e.children(n),a=e.node(n);if(o.length&&r.forEach(o,t),r.has(a,"minRank")){a.borderLeft=[],a.borderRight=[];for(var s=a.minRank,l=a.maxRank+1;s<l;++s)i(e,"borderLeft","_bl",n,a,s),i(e,"borderRight","_br",n,a,s)}})}},5990(e,t,n){var r=n(3028)(Object.getPrototypeOf,Object);e.exports=r},5992(e,t,n){var r=n(5750);e.exports=function(e){var t,n={},o=[];function i(o){r.has(n,o)||(n[o]=!0,t.push(o),r.each(e.successors(o),i),r.each(e.predecessors(o),i))}return r.each(e.nodes(),function(e){t=[],i(e),t.length&&o.push(t)}),o}},6095(e){var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},6140(e){var t=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}},6173(e){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},6179(e){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},6272(e,t,n){var r=n(6571),o=n(2761);e.exports=function(e){return o(e)&&r(e)}},6297(e,t,n){var r=n(8208);e.exports=function(e,t){return r.map(t,function(t){var n=e.inEdges(t);if(n.length){var o=r.reduce(n,function(t,n){var r=e.edge(n),o=e.node(n.v);return{sum:t.sum+r.weight*o.order,weight:t.weight+r.weight}},{sum:0,weight:0});return{v:t,barycenter:o.sum/o.weight,weight:o.weight}}return{v:t}})}},6311(e){var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return t.test(e)}},6326(e,t,n){var r=n(8895),o=n(5990),i=n(9621),a=n(7828),s=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,i(e)),e=o(e);return t}:a;e.exports=s},6350(e,t,n){var r=n(8325),o=n(6578)(r);e.exports=o},6368(e,t,n){var r=n(5750),o=n(191),i=n(4428);e.exports=function(e,t){var n,a=new o,s={},l=new i;function c(e){var r=e.v===n?e.w:e.v,o=l.priority(r);if(void 0!==o){var i=t(e);i<o&&(s[r]=n,l.decrease(r,i))}}if(0===e.nodeCount())return a;r.each(e.nodes(),function(e){l.add(e,Number.POSITIVE_INFINITY),a.setNode(e)}),l.decrease(e.nodes()[0],0);var u=!1;for(;l.size()>0;){if(n=l.removeMin(),r.has(s,n))a.setEdge(n,s[n]);else{if(u)throw new Error("Input graph is not connected: "+e);u=!0}e.nodeEdges(n).forEach(c)}return a}},6399(e,t,n){var r=n(5538),o=n(3668),i=n(9987),a=n(5752),s=n(6924),l=n(4052),c=n(4543),u=n(1268),d="[object Arguments]",h="[object Array]",f="[object Object]",p=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,v,m,g){var y=l(e),w=l(t),b=y?h:s(e),_=w?h:s(t),x=(b=b==d?f:b)==f,S=(_=_==d?f:_)==f,k=b==_;if(k&&c(e)){if(!c(t))return!1;y=!0,x=!1}if(k&&!x)return g||(g=new r),y||u(e)?o(e,t,n,v,m,g):i(e,t,b,n,v,m,g);if(!(1&n)){var E=x&&p.call(e,"__wrapped__"),C=S&&p.call(t,"__wrapped__");if(E||C){var N=E?e.value():e,j=C?t.value():t;return g||(g=new r),m(N,j,n,v,g)}}return!!k&&(g||(g=new r),a(e,t,n,v,m,g))}},6434(e,t,n){var r=n(7132);e.exports=function(e){return r(e,5)}},6467(e,t,n){var r=n(8208);e.exports=function(e){var t=function(e){var t={},n=0;function o(i){var a=n;r.forEach(e.children(i),o),t[i]={low:a,lim:n++}}return r.forEach(e.children(),o),t}(e);r.forEach(e.graph().dummyChains,function(n){for(var r=e.node(n),o=r.edgeObj,i=function(e,t,n,r){var o,i,a=[],s=[],l=Math.min(t[n].low,t[r].low),c=Math.max(t[n].lim,t[r].lim);o=n;do{o=e.parent(o),a.push(o)}while(o&&(t[o].low>l||c>t[o].lim));i=o,o=r;for(;(o=e.parent(o))!==i;)s.push(o);return{path:a.concat(s.reverse()),lca:i}}(e,t,o.v,o.w),a=i.path,s=i.lca,l=0,c=a[l],u=!0;n!==o.w;){if(r=e.node(n),u){for(;(c=a[l])!==s&&e.node(c).maxRank<r.rank;)l++;c===s&&(u=!1)}if(!u){for(;l<a.length-1&&e.node(c=a[l+1]).minRank<=r.rank;)l++;c=a[l]}e.setParent(n,c),n=e.successors(n)[0]}})}},6487(e){e.exports=function(e,t,n,r,o){return o(e,function(e,o,i){n=r?(r=!1,e):t(n,e,o,i)}),n}},6516(e,t,n){var r=n(6571);e.exports=function(e,t){return function(n,o){if(null==n)return n;if(!r(n))return e(n,o);for(var i=n.length,a=t?i:-1,s=Object(n);(t?a--:++a<i)&&!1!==o(s[a],a,s););return n}}},6532(e,t,n){var r=n(5538),o=n(6989);e.exports=function(e,t,n,i){var a=n.length,s=a,l=!i;if(null==e)return!s;for(e=Object(e);a--;){var c=n[a];if(l&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++a<s;){var u=(c=n[a])[0],d=e[u],h=c[1];if(l&&c[2]){if(void 0===d&&!(u in e))return!1}else{var f=new r;if(i)var p=i(d,h,u,e,t,f);if(!(void 0===p?o(h,d,3,i,f):p))return!1}}return!0}},6552(e,t,n){var r=n(7105),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();e.exports=i},6571(e,t,n){var r=n(1629),o=n(6173);e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},6578(e){var t=Date.now;e.exports=function(e){var n=0,r=0;return function(){var o=t(),i=16-(o-r);if(r=o,i>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}},6599(e,t,n){var r=n(9841);e.exports=function(e,t){if(e!==t){var n=void 0!==e,o=null===e,i=e===e,a=r(e),s=void 0!==t,l=null===t,c=t===t,u=r(t);if(!l&&!u&&!a&&e>t||a&&s&&c&&!l&&!u||o&&s&&c||!n&&c||!i)return 1;if(!o&&!a&&!u&&e<t||u&&n&&i&&!o&&!a||l&&n&&i||!s&&i||!c)return-1}return 0}},6600(e,t,n){var r=n(7937)(n(6552),"WeakMap");e.exports=r},6604(e,t,n){var r=n(3331)();e.exports=r},6614(e,t,n){var r=n(8420),o=n(1775);e.exports=function(e,t,n,i){var a=!n;n||(n={});for(var s=-1,l=t.length;++s<l;){var c=t[s],u=i?i(n[c],e[c],c,n,e):void 0;void 0===u&&(u=e[c]),a?o(n,c,u):r(n,c,u)}return n}},6675(e,t,n){"use strict";var r=n(8208),o=n(5673),i=n(2786),a=n(2460),s=n(5641).normalizeRanks,l=n(6467),c=n(5641).removeEmptyRanks,u=n(5146),d=n(5972),h=n(1981),f=n(550),p=n(1277),v=n(5641),m=n(7938).Graph;e.exports=function(e,t){var n=t&&t.debugTiming?v.time:v.notime;n("layout",function(){var t=n("  buildLayoutGraph",function(){return function(e){var t=new m({multigraph:!0,compound:!0}),n=C(e.graph());return t.setGraph(r.merge({},y,E(n,g),r.pick(n,w))),r.forEach(e.nodes(),function(n){var o=C(e.node(n));t.setNode(n,r.defaults(E(o,b),_)),t.setParent(n,e.parent(n))}),r.forEach(e.edges(),function(n){var o=C(e.edge(n));t.setEdge(n,r.merge({},S,E(o,x),r.pick(o,k)))}),t}(e)});n("  runLayout",function(){!function(e,t){t("    makeSpaceForEdgeLabels",function(){!function(e){var t=e.graph();t.ranksep/=2,r.forEach(e.edges(),function(n){var r=e.edge(n);r.minlen*=2,"c"!==r.labelpos.toLowerCase()&&("TB"===t.rankdir||"BT"===t.rankdir?r.width+=r.labeloffset:r.height+=r.labeloffset)})}(e)}),t("    removeSelfEdges",function(){!function(e){r.forEach(e.edges(),function(t){if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}(e)}),t("    acyclic",function(){o.run(e)}),t("    nestingGraph.run",function(){u.run(e)}),t("    rank",function(){a(v.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){!function(e){r.forEach(e.edges(),function(t){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v),o={rank:(e.node(t.w).rank-r.rank)/2+r.rank,e:t};v.addDummyNode(e,"edge-proxy",o,"_ep")}})}(e)}),t("    removeEmptyRanks",function(){c(e)}),t("    nestingGraph.cleanup",function(){u.cleanup(e)}),t("    normalizeRanks",function(){s(e)}),t("    assignRankMinMax",function(){!function(e){var t=0;r.forEach(e.nodes(),function(n){var o=e.node(n);o.borderTop&&(o.minRank=e.node(o.borderTop).rank,o.maxRank=e.node(o.borderBottom).rank,t=r.max(t,o.maxRank))}),e.graph().maxRank=t}(e)}),t("    removeEdgeLabelProxies",function(){!function(e){r.forEach(e.nodes(),function(t){var n=e.node(t);"edge-proxy"===n.dummy&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}(e)}),t("    normalize.run",function(){i.run(e)}),t("    parentDummyChains",function(){l(e)}),t("    addBorderSegments",function(){d(e)}),t("    order",function(){f(e)}),t("    insertSelfEdges",function(){!function(e){var t=v.buildLayerMatrix(e);r.forEach(t,function(t){var n=0;r.forEach(t,function(t,o){var i=e.node(t);i.order=o+n,r.forEach(i.selfEdges,function(t){v.addDummyNode(e,"selfedge",{width:t.label.width,height:t.label.height,rank:i.rank,order:o+ ++n,e:t.e,label:t.label},"_se")}),delete i.selfEdges})})}(e)}),t("    adjustCoordinateSystem",function(){h.adjust(e)}),t("    position",function(){p(e)}),t("    positionSelfEdges",function(){!function(e){r.forEach(e.nodes(),function(t){var n=e.node(t);if("selfedge"===n.dummy){var r=e.node(n.e.v),o=r.x+r.width/2,i=r.y,a=n.x-o,s=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{x:o+a,y:i},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],n.label.x=n.x,n.label.y=n.y}})}(e)}),t("    removeBorderNodes",function(){!function(e){r.forEach(e.nodes(),function(t){if(e.children(t).length){var n=e.node(t),o=e.node(n.borderTop),i=e.node(n.borderBottom),a=e.node(r.last(n.borderLeft)),s=e.node(r.last(n.borderRight));n.width=Math.abs(s.x-a.x),n.height=Math.abs(i.y-o.y),n.x=a.x+n.width/2,n.y=o.y+n.height/2}}),r.forEach(e.nodes(),function(t){"border"===e.node(t).dummy&&e.removeNode(t)})}(e)}),t("    normalize.undo",function(){i.undo(e)}),t("    fixupEdgeLabelCoords",function(){!function(e){r.forEach(e.edges(),function(t){var n=e.edge(t);if(r.has(n,"x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}})}(e)}),t("    undoCoordinateSystem",function(){h.undo(e)}),t("    translateGraph",function(){!function(e){var t=Number.POSITIVE_INFINITY,n=0,o=Number.POSITIVE_INFINITY,i=0,a=e.graph(),s=a.marginx||0,l=a.marginy||0;function c(e){var r=e.x,a=e.y,s=e.width,l=e.height;t=Math.min(t,r-s/2),n=Math.max(n,r+s/2),o=Math.min(o,a-l/2),i=Math.max(i,a+l/2)}r.forEach(e.nodes(),function(t){c(e.node(t))}),r.forEach(e.edges(),function(t){var n=e.edge(t);r.has(n,"x")&&c(n)}),t-=s,o-=l,r.forEach(e.nodes(),function(n){var r=e.node(n);r.x-=t,r.y-=o}),r.forEach(e.edges(),function(n){var i=e.edge(n);r.forEach(i.points,function(e){e.x-=t,e.y-=o}),r.has(i,"x")&&(i.x-=t),r.has(i,"y")&&(i.y-=o)}),a.width=n-t+s,a.height=i-o+l}(e)}),t("    assignNodeIntersects",function(){!function(e){r.forEach(e.edges(),function(t){var n,r,o=e.edge(t),i=e.node(t.v),a=e.node(t.w);o.points?(n=o.points[0],r=o.points[o.points.length-1]):(o.points=[],n=a,r=i),o.points.unshift(v.intersectRect(i,n)),o.points.push(v.intersectRect(a,r))})}(e)}),t("    reversePoints",function(){!function(e){r.forEach(e.edges(),function(t){var n=e.edge(t);n.reversed&&n.points.reverse()})}(e)}),t("    acyclic.undo",function(){o.undo(e)})}(t,n)}),n("  updateInputGraph",function(){!function(e,t){r.forEach(e.nodes(),function(n){var r=e.node(n),o=t.node(n);r&&(r.x=o.x,r.y=o.y,t.children(n).length&&(r.width=o.width,r.height=o.height))}),r.forEach(e.edges(),function(n){var o=e.edge(n),i=t.edge(n);o.points=i.points,r.has(i,"x")&&(o.x=i.x,o.y=i.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}(e,t)})})};var g=["nodesep","edgesep","ranksep","marginx","marginy"],y={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},w=["acyclicer","ranker","rankdir","align"],b=["width","height"],_={width:0,height:0},x=["minlen","weight","width","height","labeloffset"],S={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},k=["labelpos"];function E(e,t){return r.mapValues(r.pick(e,t),Number)}function C(e){var t={};return r.forEach(e,function(e,n){t[n.toLowerCase()]=e}),t}},6684(e){function t(){var e={};e._next=e._prev=e,this._sentinel=e}function n(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function r(e,t){if("_next"!==e&&"_prev"!==e)return t}e.exports=t,t.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return n(t),t},t.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&n(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t},t.prototype.toString=function(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,r)),n=n._prev;return"["+e.join(", ")+"]"}},6686(e){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},6704(e){e.exports=function(e){return this.__data__.has(e)}},6727(e,t,n){var r=n(6983),o=n(8673);e.exports=function(e){return null==e?[]:r(e,o(e))}},6741(e){var t=Object.prototype.hasOwnProperty;e.exports=function(e,n){return null!=e&&t.call(e,n)}},6745(e,t,n){var r=n(9742),o=n(61),i=n(3279);e.exports=function(e){return e&&e.length?r(e,i,o):void 0}},6788(e,t,n){var r=n(7160),o=n(5204),i=n(4816);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var a=n.__data__;if(!o||a.length<199)return a.push([e,t]),this.size=++n.size,this;n=this.__data__=new i(a)}return n.set(e,t),this.size=n.size,this}},6806(e,t,n){var r=n(1516);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},6832(e,t,n){e=n.nmd(e);var r=n(7105),o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,a=i&&i.exports===o&&r.process,s=function(){try{var e=i&&i.require&&i.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(t){}}();e.exports=s},6874(e,t,n){var r=n(2622);e.exports=function(e,t){var n=r(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}},6913(e,t,n){var r=n(9812),o=n(4552),i=n(6095),a=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?o(e):i(e)}},6924(e,t,n){var r=n(7685),o=n(5204),i=n(5387),a=n(2070),s=n(6600),l=n(6913),c=n(6996),u="[object Map]",d="[object Promise]",h="[object Set]",f="[object WeakMap]",p="[object DataView]",v=c(r),m=c(o),g=c(i),y=c(a),w=c(s),b=l;(r&&b(new r(new ArrayBuffer(1)))!=p||o&&b(new o)!=u||i&&b(i.resolve())!=d||a&&b(new a)!=h||s&&b(new s)!=f)&&(b=function(e){var t=l(e),n="[object Object]"==t?e.constructor:void 0,r=n?c(n):"";if(r)switch(r){case v:return p;case m:return u;case g:return d;case y:return h;case w:return f}return t}),e.exports=b},6945(e,t,n){var r=n(5750);e.exports=function(e,t,n){return function(e,t,n){var r={},o=e.nodes();return o.forEach(function(e){r[e]={},r[e][e]={distance:0},o.forEach(function(t){e!==t&&(r[e][t]={distance:Number.POSITIVE_INFINITY})}),n(e).forEach(function(n){var o=n.v===e?n.w:n.v,i=t(n);r[e][o]={distance:i,predecessor:e}})}),o.forEach(function(e){var t=r[e];o.forEach(function(n){var i=r[n];o.forEach(function(n){var r=i[e],o=t[n],a=i[n],s=r.distance+o.distance;s<a.distance&&(a.distance=s,a.predecessor=o.predecessor)})})}),r}(e,t||o,n||function(t){return e.outEdges(t)})};var o=r.constant(1)},6954(e,t,n){var r=n(1629),o=n(7857),i=n(6686),a=n(6996),s=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,u=l.toString,d=c.hasOwnProperty,h=RegExp("^"+u.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||o(e))&&(r(e)?h:s).test(a(e))}},6983(e,t,n){var r=n(149);e.exports=function(e,t){return r(t,function(t){return e[t]})}},6989(e,t,n){var r=n(6399),o=n(2761);e.exports=function e(t,n,i,a,s){return t===n||(null==t||null==n||!o(t)&&!o(n)?t!==t&&n!==n:r(t,n,i,a,e,s))}},6996(e){var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(n){}try{return e+""}catch(n){}}return""}},7105(e,t,n){var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},7116(e,t,n){var r=n(9812),o=n(2777),i=n(4052),a=r?r.isConcatSpreadable:void 0;e.exports=function(e){return i(e)||o(e)||!!(a&&e&&e[a])}},7132(e,t,n){var r=n(5538),o=n(726),i=n(8420),a=n(1104),s=n(5119),l=n(4353),c=n(1980),u=n(8124),d=n(9075),h=n(9395),f=n(8592),p=n(6924),v=n(8268),m=n(8630),g=n(310),y=n(4052),w=n(4543),b=n(7887),_=n(6686),x=n(5921),S=n(8673),k=n(474),E="[object Arguments]",C="[object Function]",N="[object Object]",j={};j[E]=j["[object Array]"]=j["[object ArrayBuffer]"]=j["[object DataView]"]=j["[object Boolean]"]=j["[object Date]"]=j["[object Float32Array]"]=j["[object Float64Array]"]=j["[object Int8Array]"]=j["[object Int16Array]"]=j["[object Int32Array]"]=j["[object Map]"]=j["[object Number]"]=j[N]=j["[object RegExp]"]=j["[object Set]"]=j["[object String]"]=j["[object Symbol]"]=j["[object Uint8Array]"]=j["[object Uint8ClampedArray]"]=j["[object Uint16Array]"]=j["[object Uint32Array]"]=!0,j["[object Error]"]=j[C]=j["[object WeakMap]"]=!1,e.exports=function e(t,n,T,O,I,P){var A,R=1&n,D=2&n,M=4&n;if(T&&(A=I?T(t,O,I,P):T(t)),void 0!==A)return A;if(!_(t))return t;var L=y(t);if(L){if(A=v(t),!R)return c(t,A)}else{var z=p(t),U=z==C||"[object GeneratorFunction]"==z;if(w(t))return l(t,R);if(z==N||z==E||U&&!I){if(A=D||U?{}:g(t),!R)return D?d(t,s(A,t)):u(t,a(A,t))}else{if(!j[z])return I?t:{};A=m(t,z,R)}}P||(P=new r);var B=P.get(t);if(B)return B;P.set(t,A),x(t)?t.forEach(function(r){A.add(e(r,n,T,r,t,P))}):b(t)&&t.forEach(function(r,o){A.set(o,e(r,n,T,o,t,P))});var F=L?void 0:(M?D?f:h:D?k:S)(t);return o(F||t,function(r,o){F&&(r=t[o=r]),i(A,o,e(r,n,T,o,t,P))}),A}},7159(e,t,n){var r=n(2622);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},7160(e,t,n){var r=n(7563),o=n(9935),i=n(4190),a=n(1946),s=n(1714);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=o,l.prototype.get=i,l.prototype.has=a,l.prototype.set=s,e.exports=l},7168(e){var t="\\ud800-\\udfff",n="["+t+"]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",o="\\ud83c[\\udffb-\\udfff]",i="[^"+t+"]",a="(?:\\ud83c[\\udde6-\\uddff]){2}",s="[\\ud800-\\udbff][\\udc00-\\udfff]",l="(?:"+r+"|"+o+")"+"?",c="[\\ufe0e\\ufe0f]?",u=c+l+("(?:\\u200d(?:"+[i,a,s].join("|")+")"+c+l+")*"),d="(?:"+[i+r+"?",r,a,s,n].join("|")+")",h=RegExp(o+"(?="+o+")|"+d+u,"g");e.exports=function(e){for(var t=h.lastIndex=0;h.test(e);)++t;return t}},7171(e,t,n){var r=n(5652);e.exports=function(e,t){var n=[];return r(e,function(e,r,o){t(e,r,o)&&n.push(e)}),n}},7234(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,o=e[r];if(!(0<i(o,t)))break e;e[r]=t,e[n]=o,n=r}}function r(e){return 0===e.length?null:e[0]}function o(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,o=e.length,a=o>>>1;r<a;){var s=2*(r+1)-1,l=e[s],c=s+1,u=e[c];if(0>i(l,n))c<o&&0>i(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[s]=n,r=s);else{if(!(c<o&&0>i(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,v=!1,m=!1,g="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(u);null!==t;){if(null===t.callback)o(u);else{if(!(t.startTime<=e))break;o(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function _(e){if(m=!1,b(e),!v)if(null!==r(c))v=!0,A(x);else{var t=r(u);null!==t&&R(_,t.startTime-e)}}function x(e,n){v=!1,m&&(m=!1,y(C),C=-1),p=!0;var i=f;try{for(b(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!T());){var a=h.callback;if("function"===typeof a){h.callback=null,f=h.priorityLevel;var s=a(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?h.callback=s:h===r(c)&&o(c),b(n)}else o(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&R(_,d.startTime-n),l=!1}return l}finally{h=null,f=i,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,k=!1,E=null,C=-1,N=5,j=-1;function T(){return!(t.unstable_now()-j<N)}function O(){if(null!==E){var e=t.unstable_now();j=e;var n=!0;try{n=E(!0,e)}finally{n?S():(k=!1,E=null)}}else k=!1}if("function"===typeof w)S=function(){w(O)};else if("undefined"!==typeof MessageChannel){var I=new MessageChannel,P=I.port2;I.port1.onmessage=O,S=function(){P.postMessage(null)}}else S=function(){g(O,0)};function A(e){E=e,k||(k=!0,S())}function R(e,n){C=g(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||p||(v=!0,A(x))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,o,i){var a=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?a+i:a:i=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:o,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>a?(e.sortIndex=i,n(u,e),null===r(c)&&e===r(u)&&(m?(y(C),C=-1):m=!0,R(_,i-a))):(e.sortIndex=s,n(c,e),v||p||(v=!0,A(x))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},7251(e,t,n){var r=n(8724),o=n(7160),i=n(5204);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||o),string:new r}}},7303(e,t,n){var r=n(801),o=1/0;e.exports=function(e){return e?(e=r(e))===o||e===-1/0?17976931348623157e292*(e<0?-1:1):e===e?e:0:0===e?e:0}},7424(e,t,n){var r=n(755),o=n(2536),i=n(5647),a=n(929),s=i(function(e,t){if(null==e)return[];var n=t.length;return n>1&&a(e,t[0],t[1])?t=[]:n>2&&a(t[0],t[1],t[2])&&(t=[t[0]]),o(e,r(t,1),[])});e.exports=s},7449(e,t,n){var r=n(2969),o=n(9261),i=n(5324);e.exports=function(e,t,n){for(var a=-1,s=t.length,l={};++a<s;){var c=t[a],u=r(e,c);n(u,c)&&o(l,i(c,e),u)}return l}},7498(e){e.exports=function(e,t){return e>t}},7529(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var a=e[n];t(a,n,e)&&(i[o++]=a)}return i}},7563(e){e.exports=function(){this.__data__=[],this.size=0}},7574(e){e.exports=function(e){return function(t){return e(t)}}},7615(e,t,n){var r=n(5575);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},7685(e,t,n){var r=n(7937)(n(6552),"DataView");e.exports=r},7717(e,t,n){var r=n(4258),o=n(5111),i=n(474);e.exports=function(e,t){return null==e?e:r(e,o(t),i)}},7760(e){e.exports=function(e){return this.__data__.get(e)}},7828(e){e.exports=function(){return[]}},7857(e,t,n){var r=n(3440),o=function(){var e=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!o&&o in e}},7887(e,t,n){var r=n(5791),o=n(7574),i=n(6832),a=i&&i.isMap,s=a?o(a):r;e.exports=s},7894(e){e.exports=function(e,t){return null!=e&&t in Object(e)}},7937(e,t,n){var r=n(6954),o=n(4657);e.exports=function(e,t){var n=o(e,t);return r(n)?n:void 0}},7938(e,t,n){var r;try{r=n(9207)}catch(o){}r||(r=window.graphlib),e.exports=r},7950(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(2730)},8114(e){e.exports=function(e,t){return e.has(t)}},8122(e,t,n){var r=n(6686),o=n(6140),i=n(3516),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=o(e),n=[];for(var s in e)("constructor"!=s||!t&&a.call(e,s))&&n.push(s);return n}},8124(e,t,n){var r=n(6614),o=n(9621);e.exports=function(e,t){return r(e,o(e),t)}},8129(e,t,n){var r=n(8420),o=n(9377);e.exports=function(e,t){return o(e||[],t||[],r)}},8182(e,t,n){var r=n(2070),o=n(5713),i=n(2074),a=r&&1/i(new r([,-0]))[1]==1/0?function(e){return new r(e)}:o;e.exports=a},8208(e,t,n){var r;try{r={cloneDeep:n(6434),constant:n(2541),defaults:n(1163),each:n(2580),filter:n(723),find:n(8990),flatten:n(819),forEach:n(5491),forIn:n(7717),has:n(2117),isUndefined:n(141),last:n(4065),map:n(3411),mapValues:n(1733),max:n(539),merge:n(4677),min:n(6745),minBy:n(9364),now:n(4757),pick:n(2616),range:n(6604),reduce:n(2759),sortBy:n(7424),uniqueId:n(111),values:n(6727),zipObject:n(8129)}}catch(o){}r||(r=window._),e.exports=r},8259(e,t,n){var r=n(5797);e.exports=function(e){var t=r(e,function(e){return 500===n.size&&n.clear(),e}),n=t.cache;return t}},8268(e){var t=Object.prototype.hasOwnProperty;e.exports=function(e){var n=e.length,r=new e.constructor(n);return n&&"string"==typeof e[0]&&t.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},8311(e){e.exports="2.1.8"},8325(e,t,n){var r=n(2541),o=n(5654),i=n(3279),a=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i;e.exports=a},8353(e,t,n){var r=n(5750);function o(e){var t={},n={},o=[];if(r.each(e.sinks(),function a(s){if(r.has(n,s))throw new i;r.has(t,s)||(n[s]=!0,t[s]=!0,r.each(e.predecessors(s),a),delete n[s],o.push(s))}),r.size(t)!==e.nodeCount())throw new i;return o}function i(){}e.exports=o,o.CycleException=i,i.prototype=new Error},8381(e,t,n){var r=n(8208);e.exports=function(e,t,n){var o,i={};r.forEach(n,function(n){for(var r,a,s=e.parent(n);s;){if((r=e.parent(s))?(a=i[r],i[r]=s):(a=o,o=s),a&&a!==s)return void t.setEdge(a,s);s=r}})}},8396(e,t,n){"use strict";var r=n(8208);e.exports=function(e,t){var n={};return r.forEach(e,function(e,t){var o=n[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:t};r.isUndefined(e.barycenter)||(o.barycenter=e.barycenter,o.weight=e.weight)}),r.forEach(t.edges(),function(e){var t=n[e.v],o=n[e.w];r.isUndefined(t)||r.isUndefined(o)||(o.indegree++,t.out.push(n[e.w]))}),function(e){var t=[];function n(e){return function(t){t.merged||(r.isUndefined(t.barycenter)||r.isUndefined(e.barycenter)||t.barycenter>=e.barycenter)&&function(e,t){var n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight);t.weight&&(n+=t.barycenter*t.weight,r+=t.weight);e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}(e,t)}}function o(t){return function(n){n.in.push(t),0===--n.indegree&&e.push(n)}}for(;e.length;){var i=e.pop();t.push(i),r.forEach(i.in.reverse(),n(i)),r.forEach(i.out,o(i))}return r.map(r.filter(t,function(e){return!e.merged}),function(e){return r.pick(e,["vs","i","barycenter","weight"])})}(r.filter(n,function(e){return!e.indegree}))}},8420(e,t,n){var r=n(1775),o=n(3211),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var a=e[t];i.call(e,t)&&o(a,n)&&(void 0!==n||t in e)||r(e,t,n)}},8443(e,t,n){"use strict";e.exports=n(9717)},8468(e,t,n){var r=n(5816),o=n(644),i=n(4020);e.exports=function(e,t,n){return t===t?i(e,t,n):r(e,o,n)}},8541(e,t,n){var r=n(9812),o=n(149),i=n(4052),a=n(9841),s=r?r.prototype:void 0,l=s?s.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(i(t))return o(t,e)+"";if(a(t))return l?l.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},8582(e,t,n){e.exports={components:n(5992),dijkstra:n(5822),dijkstraAll:n(8976),findCycles:n(247),floydWarshall:n(6945),isAcyclic:n(9825),postorder:n(1896),preorder:n(127),prim:n(6368),tarjan:n(8808),topsort:n(8353)}},8592(e,t,n){var r=n(4262),o=n(6326),i=n(474);e.exports=function(e){return r(e,i,o)}},8630(e,t,n){var r=n(1516),o=n(6806),i=n(8962),a=n(1295),s=n(8710);e.exports=function(e,t,n){var l=e.constructor;switch(t){case"[object ArrayBuffer]":return r(e);case"[object Boolean]":case"[object Date]":return new l(+e);case"[object DataView]":return o(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(e,n);case"[object Map]":case"[object Set]":return new l;case"[object Number]":case"[object String]":return new l(e);case"[object RegExp]":return i(e);case"[object Symbol]":return a(e)}}},8673(e,t,n){var r=n(3204),o=n(3713),i=n(6571);e.exports=function(e){return i(e)?r(e):o(e)}},8710(e,t,n){var r=n(1516);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},8724(e,t,n){var r=n(7615),o=n(5051),i=n(2154),a=n(8734),s=n(2662);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=o,l.prototype.get=i,l.prototype.has=a,l.prototype.set=s,e.exports=l},8734(e,t,n){var r=n(5575),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:o.call(t,e)}},8808(e,t,n){var r=n(5750);e.exports=function(e){var t=0,n=[],o={},i=[];function a(s){var l=o[s]={onStack:!0,lowlink:t,index:t++};if(n.push(s),e.successors(s).forEach(function(e){r.has(o,e)?o[e].onStack&&(l.lowlink=Math.min(l.lowlink,o[e].index)):(a(e),l.lowlink=Math.min(l.lowlink,o[e].lowlink))}),l.lowlink===l.index){var c,u=[];do{c=n.pop(),o[c].onStack=!1,u.push(c)}while(s!==c);i.push(u)}}return e.nodes().forEach(function(e){r.has(o,e)||a(e)}),i}},8853(e,t,n){"use strict";e.exports=n(7234)},8883(e,t,n){var r=n(5652),o=n(6571);e.exports=function(e,t){var n=-1,i=o(e)?Array(e.length):[];return r(e,function(e,r,o){i[++n]=t(e,r,o)}),i}},8895(e){e.exports=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},8902(e,t,n){var r=n(4816),o=n(6179),i=n(6704);function a(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}a.prototype.add=a.prototype.push=o,a.prototype.has=i,e.exports=a},8962(e){var t=/\w*$/;e.exports=function(e){var n=new e.constructor(e.source,t.exec(e));return n.lastIndex=e.lastIndex,n}},8976(e,t,n){var r=n(5822),o=n(5750);e.exports=function(e,t,n){return o.transform(e.nodes(),function(o,i){o[i]=r(e,i,t,n)},{})}},8990(e,t,n){var r=n(9995)(n(2520));e.exports=r},9057(e,t,n){var r=n(5324),o=n(2777),i=n(4052),a=n(9194),s=n(6173),l=n(914);e.exports=function(e,t,n){for(var c=-1,u=(t=r(t,e)).length,d=!1;++c<u;){var h=l(t[c]);if(!(d=null!=e&&n(e,h)))break;e=e[h]}return d||++c!=u?d:!!(u=null==e?0:e.length)&&s(u)&&a(h,u)&&(i(e)||o(e))}},9075(e,t,n){var r=n(6614),o=n(6326);e.exports=function(e,t){return r(e,o(e),t)}},9096(e,t,n){var r=n(9256),o=n(5029),i=n(3279),a=n(4052),s=n(3932);e.exports=function(e){return"function"==typeof e?e:null==e?i:"object"==typeof e?a(e)?o(e[0],e[1]):r(e):s(e)}},9140(e,t,n){var r=n(7303);e.exports=function(e){var t=r(e),n=t%1;return t===t?n?t-n:t:0}},9194(e){var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,n){var r=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&t.test(e))&&e>-1&&e%1==0&&e<n}},9207(e,t,n){var r=n(9383);e.exports={Graph:r.Graph,json:n(1097),alg:n(8582),version:r.version}},9256(e,t,n){var r=n(6532),o=n(3781),i=n(1310);e.exports=function(e){var t=o(e);return 1==t.length&&t[0][2]?i(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},9261(e,t,n){var r=n(8420),o=n(5324),i=n(9194),a=n(6686),s=n(914);e.exports=function(e,t,n,l){if(!a(e))return e;for(var c=-1,u=(t=o(t,e)).length,d=u-1,h=e;null!=h&&++c<u;){var f=s(t[c]),p=n;if("__proto__"===f||"constructor"===f||"prototype"===f)return e;if(c!=d){var v=h[f];void 0===(p=l?l(v,f,h):void 0)&&(p=a(v)?v:i(t[c+1])?[]:{})}r(h,f,p),h=h[f]}return e}},9364(e,t,n){var r=n(9742),o=n(9096),i=n(61);e.exports=function(e,t){return e&&e.length?r(e,o(t,2),i):void 0}},9377(e){e.exports=function(e,t,n){for(var r=-1,o=e.length,i=t.length,a={};++r<o;){var s=r<i?t[r]:void 0;n(a,e[r],s)}return a}},9383(e,t,n){e.exports={Graph:n(191),version:n(8311)}},9394(e,t,n){var r=n(2622);e.exports=function(e){return r(this,e).has(e)}},9395(e,t,n){var r=n(4262),o=n(9621),i=n(8673);e.exports=function(e){return r(e,i,o)}},9417(e,t,n){var r=n(6686);e.exports=function(e){return e===e&&!r(e)}},9421(e){e.exports=function(e,t,n,r){var o=-1,i=null==e?0:e.length;for(r&&i&&(n=e[++o]);++o<i;)n=t(n,e[o],o,e);return n}},9461(e,t,n){"use strict";e.exports=n(2330)},9507(){},9558(e,t,n){"use strict";var r=n(8208),o=n(7938).Graph,i=n(5641);function a(e,t){var n={};return r.reduce(t,function(t,o){var i=0,a=0,s=t.length,c=r.last(o);return r.forEach(o,function(t,u){var d=function(e,t){if(e.node(t).dummy)return r.find(e.predecessors(t),function(t){return e.node(t).dummy})}(e,t),h=d?e.node(d).order:s;(d||t===c)&&(r.forEach(o.slice(a,u+1),function(t){r.forEach(e.predecessors(t),function(r){var o=e.node(r),a=o.order;!(a<i||h<a)||o.dummy&&e.node(t).dummy||l(n,r,t)})}),a=u+1,i=h)}),o}),n}function s(e,t){var n={};function o(t,o,i,a,s){var c;r.forEach(r.range(o,i),function(o){c=t[o],e.node(c).dummy&&r.forEach(e.predecessors(c),function(t){var r=e.node(t);r.dummy&&(r.order<a||r.order>s)&&l(n,t,c)})})}return r.reduce(t,function(t,n){var i,a=-1,s=0;return r.forEach(n,function(r,l){if("border"===e.node(r).dummy){var c=e.predecessors(r);c.length&&(i=e.node(c[0]).order,o(n,s,l,a,i),s=l,a=i)}o(n,s,n.length,i,t.length)}),n}),n}function l(e,t,n){if(t>n){var r=t;t=n,n=r}var o=e[t];o||(e[t]=o={}),o[n]=!0}function c(e,t,n){if(t>n){var o=t;t=n,n=o}return r.has(e[t],n)}function u(e,t,n,o){var i={},a={},s={};return r.forEach(t,function(e){r.forEach(e,function(e,t){i[e]=e,a[e]=e,s[e]=t})}),r.forEach(t,function(e){var t=-1;r.forEach(e,function(e){var l=o(e);if(l.length){l=r.sortBy(l,function(e){return s[e]});for(var u=(l.length-1)/2,d=Math.floor(u),h=Math.ceil(u);d<=h;++d){var f=l[d];a[e]===e&&t<s[f]&&!c(n,e,f)&&(a[f]=e,a[e]=i[e]=i[f],t=s[f])}}})}),{root:i,align:a}}function d(e,t,n,i,a){var s={},l=function(e,t,n,i){var a=new o,s=e.graph(),l=function(e,t,n){return function(o,i,a){var s,l=o.node(i),c=o.node(a),u=0;if(u+=l.width/2,r.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":s=-l.width/2;break;case"r":s=l.width/2}if(s&&(u+=n?s:-s),s=0,u+=(l.dummy?t:e)/2,u+=(c.dummy?t:e)/2,u+=c.width/2,r.has(c,"labelpos"))switch(c.labelpos.toLowerCase()){case"l":s=c.width/2;break;case"r":s=-c.width/2}return s&&(u+=n?s:-s),s=0,u}}(s.nodesep,s.edgesep,i);return r.forEach(t,function(t){var o;r.forEach(t,function(t){var r=n[t];if(a.setNode(r),o){var i=n[o],s=a.edge(i,r);a.setEdge(i,r,Math.max(l(e,t,o),s||0))}o=t})}),a}(e,t,n,a),c=a?"borderLeft":"borderRight";function u(e,t){for(var n=l.nodes(),r=n.pop(),o={};r;)o[r]?e(r):(o[r]=!0,n.push(r),n=n.concat(t(r))),r=n.pop()}return u(function(e){s[e]=l.inEdges(e).reduce(function(e,t){return Math.max(e,s[t.v]+l.edge(t))},0)},l.predecessors.bind(l)),u(function(t){var n=l.outEdges(t).reduce(function(e,t){return Math.min(e,s[t.w]-l.edge(t))},Number.POSITIVE_INFINITY),r=e.node(t);n!==Number.POSITIVE_INFINITY&&r.borderType!==c&&(s[t]=Math.max(s[t],n))},l.successors.bind(l)),r.forEach(i,function(e){s[e]=s[n[e]]}),s}function h(e,t){return r.minBy(r.values(t),function(t){var n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return r.forIn(t,function(t,r){var i=function(e,t){return e.node(t).width}(e,r)/2;n=Math.max(t+i,n),o=Math.min(t-i,o)}),n-o})}function f(e,t){var n=r.values(t),o=r.min(n),i=r.max(n);r.forEach(["u","d"],function(n){r.forEach(["l","r"],function(a){var s,l=n+a,c=e[l];if(c!==t){var u=r.values(c);(s="l"===a?o-r.min(u):i-r.max(u))&&(e[l]=r.mapValues(c,function(e){return e+s}))}})})}function p(e,t){return r.mapValues(e.ul,function(n,o){if(t)return e[t.toLowerCase()][o];var i=r.sortBy(r.map(e,o));return(i[1]+i[2])/2})}e.exports={positionX:function(e){var t,n=i.buildLayerMatrix(e),o=r.merge(a(e,n),s(e,n)),l={};r.forEach(["u","d"],function(i){t="u"===i?n:r.values(n).reverse(),r.forEach(["l","r"],function(n){"r"===n&&(t=r.map(t,function(e){return r.values(e).reverse()}));var a=("u"===i?e.predecessors:e.successors).bind(e),s=u(e,t,o,a),c=d(e,t,s.root,s.align,"r"===n);"r"===n&&(c=r.mapValues(c,function(e){return-e})),l[i+n]=c})});var c=h(e,l);return f(l,c),p(l,e.graph().align)},findType1Conflicts:a,findType2Conflicts:s,addConflict:l,hasConflict:c,verticalAlignment:u,horizontalCompaction:d,alignCoordinates:f,findSmallestWidthAlignment:h,balance:p}},9621(e,t,n){var r=n(7529),o=n(7828),i=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(e){return null==e?[]:(e=Object(e),r(a(e),function(t){return i.call(e,t)}))}:o;e.exports=s},9676(e){var t=Math.ceil,n=Math.max;e.exports=function(e,r,o,i){for(var a=-1,s=n(t((r-e)/(o||1)),0),l=Array(s);s--;)l[i?s:++a]=e,e+=o;return l}},9717(e,t,n){"use strict";var r=n(5043),o=n(9461);var i="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},a=o.useSyncExternalStore,s=r.useRef,l=r.useEffect,c=r.useMemo,u=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var d=s(null);if(null===d.current){var h={hasValue:!1,value:null};d.current=h}else h=d.current;d=c(function(){function e(e){if(!l){if(l=!0,a=e,e=r(e),void 0!==o&&h.hasValue){var t=h.value;if(o(t,e))return s=t}return s=e}if(t=s,i(a,e))return t;var n=r(e);return void 0!==o&&o(t,n)?(a=e,t):(a=e,s=n)}var a,s,l=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,n,r,o]);var f=a(e,d[0],d[1]);return l(function(){h.hasValue=!0,h.value=f},[f]),u(f),f}},9742(e,t,n){var r=n(9841);e.exports=function(e,t,n){for(var o=-1,i=e.length;++o<i;){var a=e[o],s=t(a);if(null!=s&&(void 0===l?s===s&&!r(s):n(s,l)))var l=s,c=a}return c}},9791(e,t,n){var r=n(8208),o=n(6297),i=n(8396),a=n(388);e.exports=function e(t,n,s,l){var c=t.children(n),u=t.node(n),d=u?u.borderLeft:void 0,h=u?u.borderRight:void 0,f={};d&&(c=r.filter(c,function(e){return e!==d&&e!==h}));var p=o(t,c);r.forEach(p,function(n){if(t.children(n.v).length){var o=e(t,n.v,s,l);f[n.v]=o,r.has(o,"barycenter")&&(i=n,a=o,r.isUndefined(i.barycenter)?(i.barycenter=a.barycenter,i.weight=a.weight):(i.barycenter=(i.barycenter*i.weight+a.barycenter*a.weight)/(i.weight+a.weight),i.weight+=a.weight))}var i,a});var v=i(p,s);!function(e,t){r.forEach(e,function(e){e.vs=r.flatten(e.vs.map(function(e){return t[e]?t[e].vs:e}),!0)})}(v,f);var m=a(v,l);if(d&&(m.vs=r.flatten([d,m.vs,h],!0),t.predecessors(d).length)){var g=t.node(t.predecessors(d)[0]),y=t.node(t.predecessors(h)[0]);r.has(m,"barycenter")||(m.barycenter=0,m.weight=0),m.barycenter=(m.barycenter*m.weight+g.order+y.order)/(m.weight+2),m.weight+=2}return m}},9812(e,t,n){var r=n(6552).Symbol;e.exports=r},9825(e,t,n){var r=n(8353);e.exports=function(e){try{r(e)}catch(t){if(t instanceof r.CycleException)return!1;throw t}return!0}},9841(e,t,n){var r=n(6913),o=n(2761);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==r(e)}},9935(e,t,n){var r=n(1340),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():o.call(t,n,1),--this.size,!0)}},9987(e,t,n){var r=n(9812),o=n(2929),i=n(3211),a=n(3668),s=n(4160),l=n(2074),c=r?r.prototype:void 0,u=c?c.valueOf:void 0;e.exports=function(e,t,n,r,c,d,h){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!d(new o(e),new o(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var f=s;case"[object Set]":var p=1&r;if(f||(f=l),e.size!=t.size&&!p)return!1;var v=h.get(e);if(v)return v==t;r|=2,h.set(e,t);var m=a(f(e),f(t),r,c,d,h);return h.delete(e),m;case"[object Symbol]":if(u)return u.call(e)==u.call(t)}return!1}},9995(e,t,n){var r=n(9096),o=n(6571),i=n(8673);e.exports=function(e){return function(t,n,a){var s=Object(t);if(!o(t)){var l=r(n,3);t=i(t),n=function(e){return l(s[e],e,s)}}var c=e(t,n,a);return c>-1?s[l?t[c]:c]:void 0}}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r](i,i.exports,n),i.loaded=!0,i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";var e=n(5043),t=n(4391);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function i(e,t,n){return(t=o(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var l={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},c=e.createContext&&e.createContext(l),u=function(){return u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},u.apply(this,arguments)},d=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};function h(t){return t&&t.map(function(t,n){return e.createElement(t.tag,u({key:n},t.attr),h(t.child))})}function f(t){return function(n){return e.createElement(p,u({attr:u({},t.attr)},n),h(t.child))}}function p(t){var n=function(n){var r,o=t.attr,i=t.size,a=t.title,s=d(t,["attr","size","title"]),l=i||n.size||"1em";return n.className&&(r=n.className),t.className&&(r=(r?r+" ":"")+t.className),e.createElement("svg",u({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,o,s,{className:r,style:u(u({color:t.color||n.color},n.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),a&&e.createElement("title",null,a),t.children)};return void 0!==c?e.createElement(c.Consumer,null,function(e){return n(e)}):n(l)}function v(e){return f({tag:"svg",attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M248 8C111.03 8 0 119.03 0 256s111.03 248 248 248 248-111.03 248-248S384.97 8 248 8zm0 432c-101.69 0-184-82.29-184-184 0-101.69 82.29-184 184-184 101.69 0 184 82.29 184 184 0 101.69-82.29 184-184 184zm0-312c-70.69 0-128 57.31-128 128s57.31 128 128 128 128-57.31 128-128-57.31-128-128-128zm0 192c-35.29 0-64-28.71-64-64s28.71-64 64-64 64 28.71 64 64-28.71 64-64 64z"}}]})(e)}function m(e){return f({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"}}]})(e)}function g(e){return f({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"}}]})(e)}function y(e){return f({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"}}]})(e)}function w(e){return f({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"}}]})(e)}function b(e){return f({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"}}]})(e)}function _(e){return f({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"}}]})(e)}function x(e){return f({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"}}]})(e)}function S(e){return f({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M328 256c0 39.8-32.2 72-72 72s-72-32.2-72-72 32.2-72 72-72 72 32.2 72 72zm104-72c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm-352 0c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72z"}}]})(e)}function k(e){return f({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M437.2 403.5L320 215V64h8c13.3 0 24-10.7 24-24V24c0-13.3-10.7-24-24-24H120c-13.3 0-24 10.7-24 24v16c0 13.3 10.7 24 24 24h8v151L10.8 403.5C-18.5 450.6 15.3 512 70.9 512h306.2c55.7 0 89.4-61.5 60.1-108.5zM137.9 320l48.2-77.6c3.7-5.2 5.8-11.6 5.8-18.4V64h64v160c0 6.9 2.2 13.2 5.8 18.4l48.2 77.6h-172z"}}]})(e)}function E(e){return f({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M96.06 454.35c.01 6.29 1.87 12.45 5.36 17.69l17.09 25.69a31.99 31.99 0 0 0 26.64 14.28h61.71a31.99 31.99 0 0 0 26.64-14.28l17.09-25.69a31.989 31.989 0 0 0 5.36-17.69l.04-38.35H96.01l.05 38.35zM0 176c0 44.37 16.45 84.85 43.56 115.78 16.52 18.85 42.36 58.23 52.21 91.45.04.26.07.52.11.78h160.24c.04-.26.07-.51.11-.78 9.85-33.22 35.69-72.6 52.21-91.45C335.55 260.85 352 220.37 352 176 352 78.61 272.91-.3 175.45 0 73.44.31 0 82.97 0 176zm176-80c-44.11 0-80 35.89-80 80 0 8.84-7.16 16-16 16s-16-7.16-16-16c0-61.76 50.24-112 112-112 8.84 0 16 7.16 16 16s-7.16 16-16 16z"}}]})(e)}function C(e){return f({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z"}}]})(e)}function N(e){return f({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"}}]})(e)}function j(e){return f({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M416 320h-96c-17.6 0-32-14.4-32-32s14.4-32 32-32h96s96-107 96-160-43-96-96-96-96 43-96 96c0 25.5 22.2 63.4 45.3 96H320c-52.9 0-96 43.1-96 96s43.1 96 96 96h96c17.6 0 32 14.4 32 32s-14.4 32-32 32H185.5c-16 24.8-33.8 47.7-47.3 64H416c52.9 0 96-43.1 96-96s-43.1-96-96-96zm0-256c17.7 0 32 14.3 32 32s-14.3 32-32 32-32-14.3-32-32 14.3-32 32-32zM96 256c-53 0-96 43-96 96s96 160 96 160 96-107 96-160-43-96-96-96zm0 128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"}}]})(e)}function T(e){return f({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M496 384H160v-16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v16H16c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h80v16c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-16h336c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm0-160h-80v-16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v16H16c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h336v16c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-16h80c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm0-160H288V48c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v16H16C7.2 64 0 71.2 0 80v32c0 8.8 7.2 16 16 16h208v16c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-16h208c8.8 0 16-7.2 16-16V80c0-8.8-7.2-16-16-16z"}}]})(e)}function O(e){return f({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"}}]})(e)}function I(e){return f({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"}}]})(e)}function P(e){return f({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"}}]})(e)}function A(e){return f({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M507.73 109.1c-2.24-9.03-13.54-12.09-20.12-5.51l-74.36 74.36-67.88-11.31-11.31-67.88 74.36-74.36c6.62-6.62 3.43-17.9-5.66-20.16-47.38-11.74-99.55.91-136.58 37.93-39.64 39.64-50.55 97.1-34.05 147.2L18.74 402.76c-24.99 24.99-24.99 65.51 0 90.5 24.99 24.99 65.51 24.99 90.5 0l213.21-213.21c50.12 16.71 107.47 5.68 147.37-34.22 37.07-37.07 49.7-89.32 37.91-136.73zM64 472c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24z"}}]})(e)}function R(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function D(e){if("string"===typeof e||"number"===typeof e)return""+e;let t="";if(Array.isArray(e))for(let n,r=0;r<e.length;r++)""!==(n=D(e[r]))&&(t+=(t&&" ")+n);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var M=n(8443);const L=e=>{let t;const n=new Set,r=(e,r)=>{const o="function"===typeof e?e(t):e;if(!Object.is(o,t)){const e=t;t=(null!=r?r:"object"!==typeof o||null===o)?o:Object.assign({},t,o),n.forEach(n=>n(t,e))}},o=()=>t,i={setState:r,getState:o,getInitialState:()=>a,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{"production"!=={NODE_ENV:"production"}.MODE&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},a=t=e(r,o,i);return i},z=e=>e?L(e):L;const{useDebugValue:U}=e,{useSyncExternalStoreWithSelector:B}=M,F=e=>e;function K(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:F,n=arguments.length>2?arguments[2]:void 0;const r=B(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return U(r),r}const q=(e,t)=>{const n=z(e),r=function(e){return K(n,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:t)};return Object.assign(r,n),r};function V(e,t){if(Object.is(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,r]of e)if(!Object.is(r,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}var W={value:()=>{}};function H(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new Y(r)}function Y(e){this._=e}function G(e,t){for(var n,r=0,o=e.length;r<o;++r)if((n=e[r]).name===t)return n.value}function X(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=W,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}Y.prototype=H.prototype={constructor:Y,on:function(e,t){var n,r,o=this._,i=(r=o,(e+"").trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!r.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}})),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!==typeof t)throw new Error("invalid callback: "+t);for(;++a<s;)if(n=(e=i[a]).type)o[n]=X(o[n],e.name,t);else if(null==t)for(n in o)o[n]=X(o[n],e.name,null);return this}for(;++a<s;)if((n=(e=i[a]).type)&&(n=G(o[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Y(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,o=new Array(n),i=0;i<n;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,n=(r=this._[e]).length;i<n;++i)r[i].value.apply(t,o)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,i=r.length;o<i;++o)r[o].value.apply(t,n)}};const J=H;function $(){}function Z(e){return null==e?$:function(){return this.querySelector(e)}}function Q(){return[]}function ee(e){return null==e?Q:function(){return this.querySelectorAll(e)}}function te(e){return function(){return null==(t=e.apply(this,arguments))?[]:Array.isArray(t)?t:Array.from(t);var t}}function ne(e){return function(){return this.matches(e)}}function re(e){return function(t){return t.matches(e)}}var oe=Array.prototype.find;function ie(){return this.firstElementChild}var ae=Array.prototype.filter;function se(){return Array.from(this.children)}function le(e){return new Array(e.length)}function ce(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function ue(e,t,n,r,o,i){for(var a,s=0,l=t.length,c=i.length;s<c;++s)(a=t[s])?(a.__data__=i[s],r[s]=a):n[s]=new ce(e,i[s]);for(;s<l;++s)(a=t[s])&&(o[s]=a)}function de(e,t,n,r,o,i,a){var s,l,c,u=new Map,d=t.length,h=i.length,f=new Array(d);for(s=0;s<d;++s)(l=t[s])&&(f[s]=c=a.call(l,l.__data__,s,t)+"",u.has(c)?o[s]=l:u.set(c,l));for(s=0;s<h;++s)c=a.call(e,i[s],s,i)+"",(l=u.get(c))?(r[s]=l,l.__data__=i[s],u.delete(c)):n[s]=new ce(e,i[s]);for(s=0;s<d;++s)(l=t[s])&&u.get(f[s])===l&&(o[s]=l)}function he(e){return e.__data__}function fe(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function pe(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}ce.prototype={constructor:ce,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var ve="http://www.w3.org/1999/xhtml";const me={svg:"http://www.w3.org/2000/svg",xhtml:ve,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ge(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),me.hasOwnProperty(t)?{space:me[t],local:e}:e}function ye(e){return function(){this.removeAttribute(e)}}function we(e){return function(){this.removeAttributeNS(e.space,e.local)}}function be(e,t){return function(){this.setAttribute(e,t)}}function _e(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function xe(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function Se(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function ke(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Ee(e){return function(){this.style.removeProperty(e)}}function Ce(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Ne(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function je(e,t){return e.style.getPropertyValue(t)||ke(e).getComputedStyle(e,null).getPropertyValue(t)}function Te(e){return function(){delete this[e]}}function Oe(e,t){return function(){this[e]=t}}function Ie(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function Pe(e){return e.trim().split(/^|\s+/)}function Ae(e){return e.classList||new Re(e)}function Re(e){this._node=e,this._names=Pe(e.getAttribute("class")||"")}function De(e,t){for(var n=Ae(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function Me(e,t){for(var n=Ae(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function Le(e){return function(){De(this,e)}}function ze(e){return function(){Me(this,e)}}function Ue(e,t){return function(){(t.apply(this,arguments)?De:Me)(this,e)}}function Be(){this.textContent=""}function Fe(e){return function(){this.textContent=e}}function Ke(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function qe(){this.innerHTML=""}function Ve(e){return function(){this.innerHTML=e}}function We(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function He(){this.nextSibling&&this.parentNode.appendChild(this)}function Ye(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ge(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===ve&&t.documentElement.namespaceURI===ve?t.createElement(e):t.createElementNS(n,e)}}function Xe(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Je(e){var t=ge(e);return(t.local?Xe:Ge)(t)}function $e(){return null}function Ze(){var e=this.parentNode;e&&e.removeChild(this)}function Qe(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function et(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function tt(e){return function(){var t=this.__on;if(t){for(var n,r=0,o=-1,i=t.length;r<i;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++o]=n:this.removeEventListener(n.type,n.listener,n.options);++o?t.length=o:delete this.__on}}}function nt(e,t,n){return function(){var r,o=this.__on,i=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(o)for(var a=0,s=o.length;a<s;++a)if((r=o[a]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),void(r.value=t);this.addEventListener(e.type,i,n),r={type:e.type,name:e.name,value:t,listener:i,options:n},o?o.push(r):this.__on=[r]}}function rt(e,t,n){var r=ke(e),o=r.CustomEvent;"function"===typeof o?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function ot(e,t){return function(){return rt(this,e,t)}}function it(e,t){return function(){return rt(this,e,t.apply(this,arguments))}}Re.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var at=[null];function st(e,t){this._groups=e,this._parents=t}function lt(){return new st([[document.documentElement]],at)}st.prototype=lt.prototype={constructor:st,select:function(e){"function"!==typeof e&&(e=Z(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i,a,s=t[o],l=s.length,c=r[o]=new Array(l),u=0;u<l;++u)(i=s[u])&&(a=e.call(i,i.__data__,u,s))&&("__data__"in i&&(a.__data__=i.__data__),c[u]=a);return new st(r,this._parents)},selectAll:function(e){e="function"===typeof e?te(e):ee(e);for(var t=this._groups,n=t.length,r=[],o=[],i=0;i<n;++i)for(var a,s=t[i],l=s.length,c=0;c<l;++c)(a=s[c])&&(r.push(e.call(a,a.__data__,c,s)),o.push(a));return new st(r,o)},selectChild:function(e){return this.select(null==e?ie:function(e){return function(){return oe.call(this.children,e)}}("function"===typeof e?e:re(e)))},selectChildren:function(e){return this.selectAll(null==e?se:function(e){return function(){return ae.call(this.children,e)}}("function"===typeof e?e:re(e)))},filter:function(e){"function"!==typeof e&&(e=ne(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i,a=t[o],s=a.length,l=r[o]=[],c=0;c<s;++c)(i=a[c])&&e.call(i,i.__data__,c,a)&&l.push(i);return new st(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,he);var n,r=t?de:ue,o=this._parents,i=this._groups;"function"!==typeof e&&(n=e,e=function(){return n});for(var a=i.length,s=new Array(a),l=new Array(a),c=new Array(a),u=0;u<a;++u){var d=o[u],h=i[u],f=h.length,p=fe(e.call(d,d&&d.__data__,u,o)),v=p.length,m=l[u]=new Array(v),g=s[u]=new Array(v);r(d,h,m,g,c[u]=new Array(f),p,t);for(var y,w,b=0,_=0;b<v;++b)if(y=m[b]){for(b>=_&&(_=b+1);!(w=g[_])&&++_<v;);y._next=w||null}}return(s=new st(s,o))._enter=l,s._exit=c,s},enter:function(){return new st(this._enter||this._groups.map(le),this._parents)},exit:function(){return new st(this._exit||this._groups.map(le),this._parents)},join:function(e,t,n){var r=this.enter(),o=this,i=this.exit();return"function"===typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(o=t(o))&&(o=o.selection()),null==n?i.remove():n(i),r&&o?r.merge(o).order():o},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,i=r.length,a=Math.min(o,i),s=new Array(o),l=0;l<a;++l)for(var c,u=n[l],d=r[l],h=u.length,f=s[l]=new Array(h),p=0;p<h;++p)(c=u[p]||d[p])&&(f[p]=c);for(;l<o;++l)s[l]=n[l];return new st(s,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,o=e[t],i=o.length-1,a=o[i];--i>=0;)(r=o[i])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=pe);for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var a,s=n[i],l=s.length,c=o[i]=new Array(l),u=0;u<l;++u)(a=s[u])&&(c[u]=a);c.sort(t)}return new st(o,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length;o<i;++o){var a=r[o];if(a)return a}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o,i=t[n],a=0,s=i.length;a<s;++a)(o=i[a])&&e.call(o,o.__data__,a,i);return this},attr:function(e,t){var n=ge(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?we:ye:"function"===typeof t?n.local?Se:xe:n.local?_e:be)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?Ee:"function"===typeof t?Ne:Ce)(e,t,null==n?"":n)):je(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?Te:"function"===typeof t?Ie:Oe)(e,t)):this.node()[e]},classed:function(e,t){var n=Pe(e+"");if(arguments.length<2){for(var r=Ae(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each(("function"===typeof t?Ue:t?Le:ze)(n,t))},text:function(e){return arguments.length?this.each(null==e?Be:("function"===typeof e?Ke:Fe)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?qe:("function"===typeof e?We:Ve)(e)):this.node().innerHTML},raise:function(){return this.each(He)},lower:function(){return this.each(Ye)},append:function(e){var t="function"===typeof e?e:Je(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"===typeof e?e:Je(e),r=null==t?$e:"function"===typeof t?t:Z(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(Ze)},clone:function(e){return this.select(e?et:Qe)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,o,i=function(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}(e+""),a=i.length;if(!(arguments.length<2)){for(s=t?nt:tt,r=0;r<a;++r)this.each(s(i[r],t,n));return this}var s=this.node().__on;if(s)for(var l,c=0,u=s.length;c<u;++c)for(r=0,l=s[c];r<a;++r)if((o=i[r]).type===l.type&&o.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"===typeof t?it:ot)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r,o=e[t],i=0,a=o.length;i<a;++i)(r=o[i])&&(yield r)}};const ct=lt;function ut(e){return"string"===typeof e?new st([[document.querySelector(e)]],[document.documentElement]):new st([[e]],at)}const dt={passive:!1},ht={capture:!0,passive:!1};function ft(e){e.stopImmediatePropagation()}function pt(e){e.preventDefault(),e.stopImmediatePropagation()}function vt(e){var t=e.document.documentElement,n=ut(e).on("dragstart.drag",pt,ht);"onselectstart"in t?n.on("selectstart.drag",pt,ht):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function mt(e,t){var n=e.document.documentElement,r=ut(e).on("dragstart.drag",null);t&&(r.on("click.drag",pt,ht),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function gt(e){return((e=Math.exp(e))+1/e)/2}const yt=function e(t,n,r){function o(e,o){var i,a,s=e[0],l=e[1],c=e[2],u=o[0],d=o[1],h=o[2],f=u-s,p=d-l,v=f*f+p*p;if(v<1e-12)a=Math.log(h/c)/t,i=function(e){return[s+e*f,l+e*p,c*Math.exp(t*e*a)]};else{var m=Math.sqrt(v),g=(h*h-c*c+r*v)/(2*c*n*m),y=(h*h-c*c-r*v)/(2*h*n*m),w=Math.log(Math.sqrt(g*g+1)-g),b=Math.log(Math.sqrt(y*y+1)-y);a=(b-w)/t,i=function(e){var r,o=e*a,i=gt(w),u=c/(n*m)*(i*(r=t*o+w,((r=Math.exp(2*r))-1)/(r+1))-function(e){return((e=Math.exp(e))-1/e)/2}(w));return[s+u*f,l+u*p,c*i/gt(t*o+w)]}}return i.duration=1e3*a*t/Math.SQRT2,i}return o.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},o}(Math.SQRT2,2,4);function wt(e,t){if(e=function(e){let t;for(;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}var bt,_t,xt=0,St=0,kt=0,Et=0,Ct=0,Nt=0,jt="object"===typeof performance&&performance.now?performance:Date,Tt="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Ot(){return Ct||(Tt(It),Ct=jt.now()+Nt)}function It(){Ct=0}function Pt(){this._call=this._time=this._next=null}function At(e,t,n){var r=new Pt;return r.restart(e,t,n),r}function Rt(){Ct=(Et=jt.now())+Nt,xt=St=0;try{!function(){Ot(),++xt;for(var e,t=bt;t;)(e=Ct-t._time)>=0&&t._call.call(void 0,e),t=t._next;--xt}()}finally{xt=0,function(){var e,t,n=bt,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:bt=t);_t=e,Mt(r)}(),Ct=0}}function Dt(){var e=jt.now(),t=e-Et;t>1e3&&(Nt-=t,Et=e)}function Mt(e){xt||(St&&(St=clearTimeout(St)),e-Ct>24?(e<1/0&&(St=setTimeout(Rt,e-jt.now()-Nt)),kt&&(kt=clearInterval(kt))):(kt||(Et=jt.now(),kt=setInterval(Dt,1e3)),xt=1,Tt(Rt)))}function Lt(e,t,n){var r=new Pt;return t=null==t?0:+t,r.restart(n=>{r.stop(),e(n+t)},t,n),r}Pt.prototype=At.prototype={constructor:Pt,restart:function(e,t,n){if("function"!==typeof e)throw new TypeError("callback is not a function");n=(null==n?Ot():+n)+(null==t?0:+t),this._next||_t===this||(_t?_t._next=this:bt=this,_t=this),this._call=e,this._time=n,Mt()},stop:function(){this._call&&(this._call=null,this._time=1/0,Mt())}};var zt=J("start","end","cancel","interrupt"),Ut=[];function Bt(e,t,n,r,o,i){var a=e.__transition;if(a){if(n in a)return}else e.__transition={};!function(e,t,n){var r,o=e.__transition;function i(e){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=e&&a(e-n.delay)}function a(i){var c,u,d,h;if(1!==n.state)return l();for(c in o)if((h=o[c]).name===n.name){if(3===h.state)return Lt(a);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete o[c]):+c<t&&(h.state=6,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete o[c])}if(Lt(function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(i))}),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(d=n.tween.length),c=0,u=-1;c<d;++c)(h=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(r[++u]=h);r.length=u+1}}function s(t){for(var o=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(l),n.state=5,1),i=-1,a=r.length;++i<a;)r[i].call(e,o);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){for(var r in n.state=6,n.timer.stop(),delete o[t],o)return;delete e.__transition}o[t]=n,n.timer=At(i,0,n.time)}(e,n,{name:t,index:r,group:o,on:zt,tween:Ut,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:0})}function Ft(e,t){var n=qt(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function Kt(e,t){var n=qt(e,t);if(n.state>3)throw new Error("too late; already running");return n}function qt(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Vt(e,t){var n,r,o,i=e.__transition,a=!0;if(i){for(o in t=null==t?null:t+"",i)(n=i[o]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete i[o]):a=!1;a&&delete e.__transition}}function Wt(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Ht,Yt=180/Math.PI,Gt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Xt(e,t,n,r,o,i){var a,s,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*Yt,skewX:Math.atan(l)*Yt,scaleX:a,scaleY:s}}function Jt(e,t,n,r){function o(e){return e.length?e.pop()+" ":""}return function(i,a){var s=[],l=[];return i=e(i),a=e(a),function(e,r,o,i,a,s){if(e!==o||r!==i){var l=a.push("translate(",null,t,null,n);s.push({i:l-4,x:Wt(e,o)},{i:l-2,x:Wt(r,i)})}else(o||i)&&a.push("translate("+o+t+i+n)}(i.translateX,i.translateY,a.translateX,a.translateY,s,l),function(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(o(n)+"rotate(",null,r)-2,x:Wt(e,t)})):t&&n.push(o(n)+"rotate("+t+r)}(i.rotate,a.rotate,s,l),function(e,t,n,i){e!==t?i.push({i:n.push(o(n)+"skewX(",null,r)-2,x:Wt(e,t)}):t&&n.push(o(n)+"skewX("+t+r)}(i.skewX,a.skewX,s,l),function(e,t,n,r,i,a){if(e!==n||t!==r){var s=i.push(o(i)+"scale(",null,",",null,")");a.push({i:s-4,x:Wt(e,n)},{i:s-2,x:Wt(t,r)})}else 1===n&&1===r||i.push(o(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,a.scaleX,a.scaleY,s,l),i=a=null,function(e){for(var t,n=-1,r=l.length;++n<r;)s[(t=l[n]).i]=t.x(e);return s.join("")}}}var $t=Jt(function(e){const t=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Gt:Xt(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),Zt=Jt(function(e){return null==e?Gt:(Ht||(Ht=document.createElementNS("http://www.w3.org/2000/svg","g")),Ht.setAttribute("transform",e),(e=Ht.transform.baseVal.consolidate())?Xt((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):Gt)},", ",")",")");function Qt(e,t){var n,r;return function(){var o=Kt(this,e),i=o.tween;if(i!==n)for(var a=0,s=(r=n=i).length;a<s;++a)if(r[a].name===t){(r=r.slice()).splice(a,1);break}o.tween=r}}function en(e,t,n){var r,o;if("function"!==typeof n)throw new Error;return function(){var i=Kt(this,e),a=i.tween;if(a!==r){o=(r=a).slice();for(var s={name:t,value:n},l=0,c=o.length;l<c;++l)if(o[l].name===t){o[l]=s;break}l===c&&o.push(s)}i.tween=o}}function tn(e,t,n){var r=e._id;return e.each(function(){var e=Kt(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)}),function(e){return qt(e,r).value[t]}}function nn(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function rn(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function on(){}var an=.7,sn=1/an,ln="\\s*([+-]?\\d+)\\s*",cn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",un="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",dn=/^#([0-9a-f]{3,8})$/,hn=new RegExp("^rgb\\(".concat(ln,",").concat(ln,",").concat(ln,"\\)$")),fn=new RegExp("^rgb\\(".concat(un,",").concat(un,",").concat(un,"\\)$")),pn=new RegExp("^rgba\\(".concat(ln,",").concat(ln,",").concat(ln,",").concat(cn,"\\)$")),vn=new RegExp("^rgba\\(".concat(un,",").concat(un,",").concat(un,",").concat(cn,"\\)$")),mn=new RegExp("^hsl\\(".concat(cn,",").concat(un,",").concat(un,"\\)$")),gn=new RegExp("^hsla\\(".concat(cn,",").concat(un,",").concat(un,",").concat(cn,"\\)$")),yn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function wn(){return this.rgb().formatHex()}function bn(){return this.rgb().formatRgb()}function _n(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=dn.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?xn(t):3===n?new En(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Sn(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Sn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=hn.exec(e))?new En(t[1],t[2],t[3],1):(t=fn.exec(e))?new En(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=pn.exec(e))?Sn(t[1],t[2],t[3],t[4]):(t=vn.exec(e))?Sn(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=mn.exec(e))?In(t[1],t[2]/100,t[3]/100,1):(t=gn.exec(e))?In(t[1],t[2]/100,t[3]/100,t[4]):yn.hasOwnProperty(e)?xn(yn[e]):"transparent"===e?new En(NaN,NaN,NaN,0):null}function xn(e){return new En(e>>16&255,e>>8&255,255&e,1)}function Sn(e,t,n,r){return r<=0&&(e=t=n=NaN),new En(e,t,n,r)}function kn(e,t,n,r){return 1===arguments.length?((o=e)instanceof on||(o=_n(o)),o?new En((o=o.rgb()).r,o.g,o.b,o.opacity):new En):new En(e,t,n,null==r?1:r);var o}function En(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Cn(){return"#".concat(On(this.r)).concat(On(this.g)).concat(On(this.b))}function Nn(){const e=jn(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(Tn(this.r),", ").concat(Tn(this.g),", ").concat(Tn(this.b)).concat(1===e?")":", ".concat(e,")"))}function jn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Tn(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function On(e){return((e=Tn(e))<16?"0":"")+e.toString(16)}function In(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new An(e,t,n,r)}function Pn(e){if(e instanceof An)return new An(e.h,e.s,e.l,e.opacity);if(e instanceof on||(e=_n(e)),!e)return new An;if(e instanceof An)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),i=Math.max(t,n,r),a=NaN,s=i-o,l=(i+o)/2;return s?(a=t===i?(n-r)/s+6*(n<r):n===i?(r-t)/s+2:(t-n)/s+4,s/=l<.5?i+o:2-i-o,a*=60):s=l>0&&l<1?0:a,new An(a,s,l,e.opacity)}function An(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Rn(e){return(e=(e||0)%360)<0?e+360:e}function Dn(e){return Math.max(0,Math.min(1,e||0))}function Mn(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Ln(e,t,n,r,o){var i=e*e,a=i*e;return((1-3*e+3*i-a)*t+(4-6*i+3*a)*n+(1+3*e+3*i-3*a)*r+a*o)/6}nn(on,_n,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:wn,formatHex:wn,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Pn(this).formatHsl()},formatRgb:bn,toString:bn}),nn(En,kn,rn(on,{brighter(e){return e=null==e?sn:Math.pow(sn,e),new En(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?an:Math.pow(an,e),new En(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new En(Tn(this.r),Tn(this.g),Tn(this.b),jn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Cn,formatHex:Cn,formatHex8:function(){return"#".concat(On(this.r)).concat(On(this.g)).concat(On(this.b)).concat(On(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:Nn,toString:Nn})),nn(An,function(e,t,n,r){return 1===arguments.length?Pn(e):new An(e,t,n,null==r?1:r)},rn(on,{brighter(e){return e=null==e?sn:Math.pow(sn,e),new An(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?an:Math.pow(an,e),new An(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new En(Mn(e>=240?e-240:e+120,o,r),Mn(e,o,r),Mn(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new An(Rn(this.h),Dn(this.s),Dn(this.l),jn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=jn(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(Rn(this.h),", ").concat(100*Dn(this.s),"%, ").concat(100*Dn(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));const zn=e=>()=>e;function Un(e,t){return function(n){return e+n*t}}function Bn(e){return 1===(e=+e)?Fn:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):zn(isNaN(t)?n:t)}}function Fn(e,t){var n=t-e;return n?Un(e,n):zn(isNaN(e)?t:e)}const Kn=function e(t){var n=Bn(t);function r(e,t){var r=n((e=kn(e)).r,(t=kn(t)).r),o=n(e.g,t.g),i=n(e.b,t.b),a=Fn(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=o(t),e.b=i(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function qn(e){return function(t){var n,r,o=t.length,i=new Array(o),a=new Array(o),s=new Array(o);for(n=0;n<o;++n)r=kn(t[n]),i[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return i=e(i),a=e(a),s=e(s),r.opacity=1,function(e){return r.r=i(e),r.g=a(e),r.b=s(e),r+""}}}qn(function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),o=e[r],i=e[r+1],a=r>0?e[r-1]:2*o-i,s=r<t-1?e[r+2]:2*i-o;return Ln((n-r/t)*t,a,o,i,s)}}),qn(function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),o=e[(r+t-1)%t],i=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return Ln((n-r/t)*t,o,i,a,s)}});var Vn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Wn=new RegExp(Vn.source,"g");function Hn(e,t){var n,r,o,i=Vn.lastIndex=Wn.lastIndex=0,a=-1,s=[],l=[];for(e+="",t+="";(n=Vn.exec(e))&&(r=Wn.exec(t));)(o=r.index)>i&&(o=t.slice(i,o),s[a]?s[a]+=o:s[++a]=o),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:Wt(n,r)})),i=Wn.lastIndex;return i<t.length&&(o=t.slice(i),s[a]?s[a]+=o:s[++a]=o),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)s[(n=l[r]).i]=n.x(e);return s.join("")})}function Yn(e,t){var n;return("number"===typeof t?Wt:t instanceof _n?Kn:(n=_n(t))?(t=n,Kn):Hn)(e,t)}function Gn(e){return function(){this.removeAttribute(e)}}function Xn(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Jn(e,t,n){var r,o,i=n+"";return function(){var a=this.getAttribute(e);return a===i?null:a===r?o:o=t(r=a,n)}}function $n(e,t,n){var r,o,i=n+"";return function(){var a=this.getAttributeNS(e.space,e.local);return a===i?null:a===r?o:o=t(r=a,n)}}function Zn(e,t,n){var r,o,i;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttribute(e))===(s=l+"")?null:a===r&&s===o?i:(o=s,i=t(r=a,l));this.removeAttribute(e)}}function Qn(e,t,n){var r,o,i;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttributeNS(e.space,e.local))===(s=l+"")?null:a===r&&s===o?i:(o=s,i=t(r=a,l));this.removeAttributeNS(e.space,e.local)}}function er(e,t){var n,r;function o(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&function(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}(e,o)),n}return o._value=t,o}function tr(e,t){var n,r;function o(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&function(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}(e,o)),n}return o._value=t,o}function nr(e,t){return function(){Ft(this,e).delay=+t.apply(this,arguments)}}function rr(e,t){return t=+t,function(){Ft(this,e).delay=t}}function or(e,t){return function(){Kt(this,e).duration=+t.apply(this,arguments)}}function ir(e,t){return t=+t,function(){Kt(this,e).duration=t}}var ar=ct.prototype.constructor;function sr(e){return function(){this.style.removeProperty(e)}}var lr=0;function cr(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function ur(){return++lr}var dr=ct.prototype;cr.prototype=function(e){return ct().transition(e)}.prototype={constructor:cr,select:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=Z(e));for(var r=this._groups,o=r.length,i=new Array(o),a=0;a<o;++a)for(var s,l,c=r[a],u=c.length,d=i[a]=new Array(u),h=0;h<u;++h)(s=c[h])&&(l=e.call(s,s.__data__,h,c))&&("__data__"in s&&(l.__data__=s.__data__),d[h]=l,Bt(d[h],t,n,h,d,qt(s,n)));return new cr(i,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=ee(e));for(var r=this._groups,o=r.length,i=[],a=[],s=0;s<o;++s)for(var l,c=r[s],u=c.length,d=0;d<u;++d)if(l=c[d]){for(var h,f=e.call(l,l.__data__,d,c),p=qt(l,n),v=0,m=f.length;v<m;++v)(h=f[v])&&Bt(h,t,n,v,f,p);i.push(f),a.push(l)}return new cr(i,a,t,n)},selectChild:dr.selectChild,selectChildren:dr.selectChildren,filter:function(e){"function"!==typeof e&&(e=ne(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i,a=t[o],s=a.length,l=r[o]=[],c=0;c<s;++c)(i=a[c])&&e.call(i,i.__data__,c,a)&&l.push(i);return new cr(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,i=Math.min(r,o),a=new Array(r),s=0;s<i;++s)for(var l,c=t[s],u=n[s],d=c.length,h=a[s]=new Array(d),f=0;f<d;++f)(l=c[f]||u[f])&&(h[f]=l);for(;s<r;++s)a[s]=t[s];return new cr(a,this._parents,this._name,this._id)},selection:function(){return new ar(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=ur(),r=this._groups,o=r.length,i=0;i<o;++i)for(var a,s=r[i],l=s.length,c=0;c<l;++c)if(a=s[c]){var u=qt(a,t);Bt(a,e,n,c,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new cr(r,this._parents,e,n)},call:dr.call,nodes:dr.nodes,node:dr.node,size:dr.size,empty:dr.empty,each:dr.each,on:function(e,t){var n=this._id;return arguments.length<2?qt(this.node(),n).on.on(e):this.each(function(e,t,n){var r,o,i=function(e){return(e+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})}(t)?Ft:Kt;return function(){var a=i(this,e),s=a.on;s!==r&&(o=(r=s).copy()).on(t,n),a.on=o}}(n,e,t))},attr:function(e,t){var n=ge(e),r="transform"===n?Zt:Yn;return this.attrTween(e,"function"===typeof t?(n.local?Qn:Zn)(n,r,tn(this,"attr."+e,t)):null==t?(n.local?Xn:Gn)(n):(n.local?$n:Jn)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!==typeof t)throw new Error;var r=ge(e);return this.tween(n,(r.local?er:tr)(r,t))},style:function(e,t,n){var r="transform"===(e+="")?$t:Yn;return null==t?this.styleTween(e,function(e,t){var n,r,o;return function(){var i=je(this,e),a=(this.style.removeProperty(e),je(this,e));return i===a?null:i===n&&a===r?o:o=t(n=i,r=a)}}(e,r)).on("end.style."+e,sr(e)):"function"===typeof t?this.styleTween(e,function(e,t,n){var r,o,i;return function(){var a=je(this,e),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(e),l=s=je(this,e)),a===l?null:a===r&&l===o?i:(o=l,i=t(r=a,s))}}(e,r,tn(this,"style."+e,t))).each(function(e,t){var n,r,o,i,a="style."+t,s="end."+a;return function(){var l=Kt(this,e),c=l.on,u=null==l.value[a]?i||(i=sr(t)):void 0;c===n&&o===u||(r=(n=c).copy()).on(s,o=u),l.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,o,i=n+"";return function(){var a=je(this,e);return a===i?null:a===r?o:o=t(r=a,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!==typeof t)throw new Error;return this.tween(r,function(e,t,n){var r,o;function i(){var i=t.apply(this,arguments);return i!==o&&(r=(o=i)&&function(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}(e,i,n)),r}return i._value=t,i}(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"===typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(tn(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!==typeof e)throw new Error;return this.tween(t,function(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&function(e){return function(t){this.textContent=e.call(this,t)}}(r)),t}return r._value=e,r}(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,o=qt(this.node(),n).tween,i=0,a=o.length;i<a;++i)if((r=o[i]).name===e)return r.value;return null}return this.each((null==t?Qt:en)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?nr:rr)(t,e)):qt(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?or:ir)(t,e)):qt(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!==typeof t)throw new Error;return function(){Kt(this,e).ease=t}}(t,e)):qt(this.node(),t).ease},easeVarying:function(e){if("function"!==typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!==typeof n)throw new Error;Kt(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(i,a){var s={value:a},l={value:function(){0===--o&&i()}};n.each(function(){var n=Kt(this,r),o=n.on;o!==e&&((t=(e=o).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),n.on=t}),0===o&&i()})},[Symbol.iterator]:dr[Symbol.iterator]};var hr={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function fr(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error("transition ".concat(t," not found"));return n}ct.prototype.interrupt=function(e){return this.each(function(){Vt(this,e)})},ct.prototype.transition=function(e){var t,n;e instanceof cr?(t=e._id,e=e._name):(t=ur(),(n=hr).time=Ot(),e=null==e?null:e+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var a,s=r[i],l=s.length,c=0;c<l;++c)(a=s[c])&&Bt(a,e,t,c,s,n||fr(a,t));return new cr(r,this._parents,e,t)};const pr=e=>()=>e;function vr(e,t){let{sourceEvent:n,target:r,transform:o,dispatch:i}=t;Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:i}})}function mr(e,t,n){this.k=e,this.x=t,this.y=n}mr.prototype={constructor:mr,scale:function(e){return 1===e?this:new mr(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new mr(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var gr=new mr(1,0,0);function yr(e){e.stopImmediatePropagation()}function wr(e){e.preventDefault(),e.stopImmediatePropagation()}function br(e){return(!e.ctrlKey||"wheel"===e.type)&&!e.button}function _r(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function xr(){return this.__zoom||gr}function Sr(e){return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function kr(){return navigator.maxTouchPoints||"ontouchstart"in this}function Er(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],a=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a))}mr.prototype;const Cr=e=>()=>e;function Nr(e,t){let{sourceEvent:n,subject:r,target:o,identifier:i,active:a,x:s,y:l,dx:c,dy:u,dispatch:d}=t;Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:d}})}function jr(e){return!e.ctrlKey&&!e.button}function Tr(){return this.parentNode}function Or(e,t){return null==t?{x:e.x,y:e.y}:t}function Ir(){return navigator.maxTouchPoints||"ontouchstart"in this}Nr.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var Pr=n(7950);const Ar=["position","children","className","style"],Rr=["x","y","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","children","className"],Dr=["type","position","isValidConnection","isConnectable","isConnectableStart","isConnectableEnd","id","onConnect","children","className","onMouseDown","onTouchStart"],Mr=["nodes","edges","defaultNodes","defaultEdges","className","nodeTypes","edgeTypes","onNodeClick","onEdgeClick","onInit","onMove","onMoveStart","onMoveEnd","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","onNodeMouseEnter","onNodeMouseMove","onNodeMouseLeave","onNodeContextMenu","onNodeDoubleClick","onNodeDragStart","onNodeDrag","onNodeDragStop","onNodesDelete","onEdgesDelete","onSelectionChange","onSelectionDragStart","onSelectionDrag","onSelectionDragStop","onSelectionContextMenu","onSelectionStart","onSelectionEnd","connectionMode","connectionLineType","connectionLineStyle","connectionLineComponent","connectionLineContainerStyle","deleteKeyCode","selectionKeyCode","selectionOnDrag","selectionMode","panActivationKeyCode","multiSelectionKeyCode","zoomActivationKeyCode","snapToGrid","snapGrid","onlyRenderVisibleElements","selectNodesOnDrag","nodesDraggable","nodesConnectable","nodesFocusable","nodeOrigin","edgesFocusable","edgesUpdatable","elementsSelectable","defaultViewport","minZoom","maxZoom","translateExtent","preventScrolling","nodeExtent","defaultMarkerColor","zoomOnScroll","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnScrollMode","zoomOnDoubleClick","panOnDrag","onPaneClick","onPaneMouseEnter","onPaneMouseMove","onPaneMouseLeave","onPaneScroll","onPaneContextMenu","children","onEdgeContextMenu","onEdgeDoubleClick","onEdgeMouseEnter","onEdgeMouseMove","onEdgeMouseLeave","onEdgeUpdate","onEdgeUpdateStart","onEdgeUpdateEnd","onReconnect","onReconnectStart","onReconnectEnd","reconnectRadius","edgeUpdaterRadius","onNodesChange","onEdgesChange","noDragClassName","noWheelClassName","noPanClassName","fitView","fitViewOptions","connectOnClick","attributionPosition","proOptions","defaultEdgeOptions","elevateNodesOnSelect","elevateEdgesOnSelect","disableKeyboardA11y","autoPanOnConnect","autoPanOnNodeDrag","connectionRadius","isValidConnection","onError","style","id","nodeDragThreshold"],Lr=(0,e.createContext)(null),zr=Lr.Provider,Ur=e=>'Node type "'.concat(e,'" not found. Using fallback type "default".'),Br=()=>"The React Flow parent container needs a width and a height to render the graph.",Fr=()=>"Only child nodes can use a parent extent.",Kr=()=>"Can't create edge. An edge needs a source and a target.",qr=e=>'Marker type "'.concat(e,"\" doesn't exist."),Vr=(e,t)=>"Couldn't create edge for ".concat(e?"target":"source",' handle id: "').concat(e?t.targetHandle:t.sourceHandle,'", edge id: ').concat(t.id,"."),Wr=()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",Hr=e=>'Edge type "'.concat(e,'" not found. Using fallback type "default".'),Yr=e=>'Node with id "'.concat(e,'" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.'),Gr=(()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001")();function Xr(t,n){const r=(0,e.useContext)(Lr);if(null===r)throw new Error(Gr);return K(r,t,n)}const Jr=()=>{const t=(0,e.useContext)(Lr);if(null===t)throw new Error(Gr);return(0,e.useMemo)(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe,destroy:t.destroy}),[t])},$r=e=>e.userSelectionActive?"none":"all";function Zr(t){let{position:n,children:r,className:o,style:i}=t,a=R(t,Ar);const l=Xr($r),c="".concat(n).split("-");return e.createElement("div",s({className:D(["react-flow__panel",o,...c]),style:s(s({},i),{},{pointerEvents:l})},a),r)}function Qr(t){let{proOptions:n,position:r="bottom-right"}=t;return null!==n&&void 0!==n&&n.hideAttribution?null:e.createElement(Zr,{position:r,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},e.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}var eo=(0,e.memo)(t=>{let{x:n,y:r,label:o,labelStyle:i={},labelShowBg:a=!0,labelBgStyle:l={},labelBgPadding:c=[2,4],labelBgBorderRadius:u=2,children:d,className:h}=t,f=R(t,Rr);const p=(0,e.useRef)(null),[v,m]=(0,e.useState)({x:0,y:0,width:0,height:0}),g=D(["react-flow__edge-textwrapper",h]);return(0,e.useEffect)(()=>{if(p.current){const e=p.current.getBBox();m({x:e.x,y:e.y,width:e.width,height:e.height})}},[o]),"undefined"!==typeof o&&o?e.createElement("g",s({transform:"translate(".concat(n-v.width/2," ").concat(r-v.height/2,")"),className:g,visibility:v.width?"visible":"hidden"},f),a&&e.createElement("rect",{width:v.width+2*c[0],x:-c[0],y:-c[1],height:v.height+2*c[1],className:"react-flow__edge-textbg",style:l,rx:u,ry:u}),e.createElement("text",{className:"react-flow__edge-text",y:v.height/2,dy:"0.3em",ref:p,style:i},o),d):null});const to=e=>({width:e.offsetWidth,height:e.offsetHeight}),no=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(e,t),n)},ro=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},t=arguments.length>1?arguments[1]:void 0;return{x:no(e.x,t[0][0],t[1][0]),y:no(e.y,t[0][1],t[1][1])}},oo=(e,t,n)=>e<t?no(Math.abs(e-t),1,50)/50:e>n?-no(Math.abs(e-n),1,50)/50:0,io=(e,t)=>[20*oo(e.x,35,t.width-35),20*oo(e.y,35,t.height-35)],ao=e=>{var t,n;return(null===(t=e.getRootNode)||void 0===t?void 0:t.call(e))||(null===(n=window)||void 0===n?void 0:n.document)},so=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),lo=e=>{let{x:t,y:n,width:r,height:o}=e;return{x:t,y:n,x2:t+r,y2:n+o}},co=e=>{let{x:t,y:n,x2:r,y2:o}=e;return{x:t,y:n,width:r-t,height:o-n}},uo=e=>s(s({},e.positionAbsolute||{x:0,y:0}),{},{width:e.width||0,height:e.height||0}),ho=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},fo=e=>!isNaN(e)&&isFinite(e),po=Symbol.for("internals"),vo=["Enter"," ","Escape"],mo=(e,t)=>{0};function go(e){var t;const n=(e=>"nativeEvent"in e)(e)?e.nativeEvent:e,r=(null===(t=n.composedPath)||void 0===t||null===(t=t.call(n))||void 0===t?void 0:t[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(null===r||void 0===r?void 0:r.nodeName)||(null===r||void 0===r?void 0:r.hasAttribute("contenteditable"))||!(null===r||void 0===r||!r.closest(".nokey"))}const yo=e=>"clientX"in e,wo=(e,t)=>{var n,r,o,i;const a=yo(e),s=a?e.clientX:null===(n=e.touches)||void 0===n?void 0:n[0].clientX,l=a?e.clientY:null===(r=e.touches)||void 0===r?void 0:r[0].clientY;return{x:s-(null!==(o=null===t||void 0===t?void 0:t.left)&&void 0!==o?o:0),y:l-(null!==(i=null===t||void 0===t?void 0:t.top)&&void 0!==i?i:0)}},bo=()=>{var e;return"undefined"!==typeof navigator&&(null===(e=navigator)||void 0===e||null===(e=e.userAgent)||void 0===e?void 0:e.indexOf("Mac"))>=0},_o=t=>{let{id:n,path:r,labelX:o,labelY:i,label:a,labelStyle:s,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:h,markerEnd:f,markerStart:p,interactionWidth:v=20}=t;return e.createElement(e.Fragment,null,e.createElement("path",{id:n,style:h,d:r,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:p}),v&&e.createElement("path",{d:r,fill:"none",strokeOpacity:0,strokeWidth:v,className:"react-flow__edge-interaction"}),a&&fo(o)&&fo(i)?e.createElement(eo,{x:o,y:i,label:a,labelStyle:s,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d}):null)};_o.displayName="BaseEdge";function xo(e,t,n){return void 0===n?n:r=>{const o=t().edges.find(t=>t.id===e);o&&n(r,s({},o))}}function So(e){let{sourceX:t,sourceY:n,targetX:r,targetY:o}=e;const i=Math.abs(r-t)/2,a=r<t?r+i:r-i,s=Math.abs(o-n)/2;return[a,o<n?o+s:o-s,i,s]}function ko(e){let{sourceX:t,sourceY:n,targetX:r,targetY:o,sourceControlX:i,sourceControlY:a,targetControlX:s,targetControlY:l}=e;const c=.125*t+.375*i+.375*s+.125*r,u=.125*n+.375*a+.375*l+.125*o;return[c,u,Math.abs(c-t),Math.abs(u-n)]}var Eo,Co,No,jo,To,Oo;function Io(e){let{pos:t,x1:n,y1:r,x2:o,y2:i}=e;return t===Oo.Left||t===Oo.Right?[.5*(n+o),r]:[n,.5*(r+i)]}function Po(e){let{sourceX:t,sourceY:n,sourcePosition:r=Oo.Bottom,targetX:o,targetY:i,targetPosition:a=Oo.Top}=e;const[s,l]=Io({pos:r,x1:t,y1:n,x2:o,y2:i}),[c,u]=Io({pos:a,x1:o,y1:i,x2:t,y2:n}),[d,h,f,p]=ko({sourceX:t,sourceY:n,targetX:o,targetY:i,sourceControlX:s,sourceControlY:l,targetControlX:c,targetControlY:u});return["M".concat(t,",").concat(n," C").concat(s,",").concat(l," ").concat(c,",").concat(u," ").concat(o,",").concat(i),d,h,f,p]}!function(e){e.Strict="strict",e.Loose="loose"}(Eo||(Eo={})),function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"}(Co||(Co={})),function(e){e.Partial="partial",e.Full="full"}(No||(No={})),function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"}(jo||(jo={})),function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"}(To||(To={})),function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"}(Oo||(Oo={}));const Ao=(0,e.memo)(t=>{let{sourceX:n,sourceY:r,targetX:o,targetY:i,sourcePosition:a=Oo.Bottom,targetPosition:s=Oo.Top,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:f,style:p,markerEnd:v,markerStart:m,interactionWidth:g}=t;const[y,w,b]=Po({sourceX:n,sourceY:r,sourcePosition:a,targetX:o,targetY:i,targetPosition:s});return e.createElement(_o,{path:y,labelX:w,labelY:b,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:f,style:p,markerEnd:v,markerStart:m,interactionWidth:g})});Ao.displayName="SimpleBezierEdge";const Ro={[Oo.Left]:{x:-1,y:0},[Oo.Right]:{x:1,y:0},[Oo.Top]:{x:0,y:-1},[Oo.Bottom]:{x:0,y:1}},Do=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Mo(e){let{source:t,sourcePosition:n=Oo.Bottom,target:r,targetPosition:o=Oo.Top,center:i,offset:a}=e;const s=Ro[n],l=Ro[o],c={x:t.x+s.x*a,y:t.y+s.y*a},u={x:r.x+l.x*a,y:r.y+l.y*a},d=(e=>{let{source:t,sourcePosition:n=Oo.Bottom,target:r}=e;return n===Oo.Left||n===Oo.Right?t.x<r.x?{x:1,y:0}:{x:-1,y:0}:t.y<r.y?{x:0,y:1}:{x:0,y:-1}})({source:c,sourcePosition:n,target:u}),h=0!==d.x?"x":"y",f=d[h];let p,v,m=[];const g={x:0,y:0},y={x:0,y:0},[w,b,_,x]=So({sourceX:t.x,sourceY:t.y,targetX:r.x,targetY:r.y});if(s[h]*l[h]===-1){var S,k;p=null!==(S=i.x)&&void 0!==S?S:w,v=null!==(k=i.y)&&void 0!==k?k:b;const e=[{x:p,y:c.y},{x:p,y:u.y}],t=[{x:c.x,y:v},{x:u.x,y:v}];m=s[h]===f?"x"===h?e:t:"x"===h?t:e}else{const e=[{x:c.x,y:u.y}],i=[{x:u.x,y:c.y}];if(m="x"===h?s.x===f?i:e:s.y===f?e:i,n===o){const e=Math.abs(t[h]-r[h]);if(e<=a){const n=Math.min(a-1,a-e);s[h]===f?g[h]=(c[h]>t[h]?-1:1)*n:y[h]=(u[h]>r[h]?-1:1)*n}}if(n!==o){const t="x"===h?"y":"x",n=s[h]===l[t],r=c[t]>u[t],o=c[t]<u[t];(1===s[h]&&(!n&&r||n&&o)||1!==s[h]&&(!n&&o||n&&r))&&(m="x"===h?e:i)}const d={x:c.x+g.x,y:c.y+g.y},w={x:u.x+y.x,y:u.y+y.y};Math.max(Math.abs(d.x-m[0].x),Math.abs(w.x-m[0].x))>=Math.max(Math.abs(d.y-m[0].y),Math.abs(w.y-m[0].y))?(p=(d.x+w.x)/2,v=m[0].y):(p=m[0].x,v=(d.y+w.y)/2)}return[[t,{x:c.x+g.x,y:c.y+g.y},...m,{x:u.x+y.x,y:u.y+y.y},r],p,v,_,x]}function Lo(e){let{sourceX:t,sourceY:n,sourcePosition:r=Oo.Bottom,targetX:o,targetY:i,targetPosition:a=Oo.Top,borderRadius:s=5,centerX:l,centerY:c,offset:u=20}=e;const[d,h,f,p,v]=Mo({source:{x:t,y:n},sourcePosition:r,target:{x:o,y:i},targetPosition:a,center:{x:l,y:c},offset:u}),m=d.reduce((e,t,n)=>{let r="";return r=n>0&&n<d.length-1?function(e,t,n,r){const o=Math.min(Do(e,t)/2,Do(t,n)/2,r),{x:i,y:a}=t;if(e.x===i&&i===n.x||e.y===a&&a===n.y)return"L".concat(i," ").concat(a);if(e.y===a){const t=e.x<n.x?-1:1,r=e.y<n.y?1:-1;return"L ".concat(i+o*t,",").concat(a,"Q ").concat(i,",").concat(a," ").concat(i,",").concat(a+o*r)}const s=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return"L ".concat(i,",").concat(a+o*l,"Q ").concat(i,",").concat(a," ").concat(i+o*s,",").concat(a)}(d[n-1],t,d[n+1],s):"".concat(0===n?"M":"L").concat(t.x," ").concat(t.y),e+=r},"");return[m,h,f,p,v]}const zo=(0,e.memo)(t=>{let{sourceX:n,sourceY:r,targetX:o,targetY:i,label:a,labelStyle:s,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:h,sourcePosition:f=Oo.Bottom,targetPosition:p=Oo.Top,markerEnd:v,markerStart:m,pathOptions:g,interactionWidth:y}=t;const[w,b,_]=Lo({sourceX:n,sourceY:r,sourcePosition:f,targetX:o,targetY:i,targetPosition:p,borderRadius:null===g||void 0===g?void 0:g.borderRadius,offset:null===g||void 0===g?void 0:g.offset});return e.createElement(_o,{path:w,labelX:b,labelY:_,label:a,labelStyle:s,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:h,markerEnd:v,markerStart:m,interactionWidth:y})});zo.displayName="SmoothStepEdge";const Uo=(0,e.memo)(t=>{var n;return e.createElement(zo,s(s({},t),{},{pathOptions:(0,e.useMemo)(()=>{var e;return{borderRadius:0,offset:null===(e=t.pathOptions)||void 0===e?void 0:e.offset}},[null===(n=t.pathOptions)||void 0===n?void 0:n.offset])}))});Uo.displayName="StepEdge";const Bo=(0,e.memo)(t=>{let{sourceX:n,sourceY:r,targetX:o,targetY:i,label:a,labelStyle:s,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:h,markerEnd:f,markerStart:p,interactionWidth:v}=t;const[m,g,y]=function(e){let{sourceX:t,sourceY:n,targetX:r,targetY:o}=e;const[i,a,s,l]=So({sourceX:t,sourceY:n,targetX:r,targetY:o});return["M ".concat(t,",").concat(n,"L ").concat(r,",").concat(o),i,a,s,l]}({sourceX:n,sourceY:r,targetX:o,targetY:i});return e.createElement(_o,{path:m,labelX:g,labelY:y,label:a,labelStyle:s,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:h,markerEnd:f,markerStart:p,interactionWidth:v})});function Fo(e,t){return e>=0?.5*e:25*t*Math.sqrt(-e)}function Ko(e){let{pos:t,x1:n,y1:r,x2:o,y2:i,c:a}=e;switch(t){case Oo.Left:return[n-Fo(n-o,a),r];case Oo.Right:return[n+Fo(o-n,a),r];case Oo.Top:return[n,r-Fo(r-i,a)];case Oo.Bottom:return[n,r+Fo(i-r,a)]}}function qo(e){let{sourceX:t,sourceY:n,sourcePosition:r=Oo.Bottom,targetX:o,targetY:i,targetPosition:a=Oo.Top,curvature:s=.25}=e;const[l,c]=Ko({pos:r,x1:t,y1:n,x2:o,y2:i,c:s}),[u,d]=Ko({pos:a,x1:o,y1:i,x2:t,y2:n,c:s}),[h,f,p,v]=ko({sourceX:t,sourceY:n,targetX:o,targetY:i,sourceControlX:l,sourceControlY:c,targetControlX:u,targetControlY:d});return["M".concat(t,",").concat(n," C").concat(l,",").concat(c," ").concat(u,",").concat(d," ").concat(o,",").concat(i),h,f,p,v]}Bo.displayName="StraightEdge";const Vo=(0,e.memo)(t=>{let{sourceX:n,sourceY:r,targetX:o,targetY:i,sourcePosition:a=Oo.Bottom,targetPosition:s=Oo.Top,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:f,style:p,markerEnd:v,markerStart:m,pathOptions:g,interactionWidth:y}=t;const[w,b,_]=qo({sourceX:n,sourceY:r,sourcePosition:a,targetX:o,targetY:i,targetPosition:s,curvature:null===g||void 0===g?void 0:g.curvature});return e.createElement(_o,{path:w,labelX:b,labelY:_,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:f,style:p,markerEnd:v,markerStart:m,interactionWidth:y})});Vo.displayName="BezierEdge";const Wo=(0,e.createContext)(null),Ho=Wo.Provider;Wo.Consumer;const Yo=e=>{let{source:t,sourceHandle:n,target:r,targetHandle:o}=e;return"reactflow__edge-".concat(t).concat(n||"","-").concat(r).concat(o||"")},Go=(e,t)=>{if("undefined"===typeof e)return"";if("string"===typeof e)return e;const n=t?"".concat(t,"__"):"";return"".concat(n).concat(Object.keys(e).sort().map(t=>"".concat(t,"=").concat(e[t])).join("&"))},Xo=(e,t,n,r)=>{let{x:o,y:i}=e,[a,s,l]=t,[c,u]=r;const d={x:(o-a)/l,y:(i-s)/l};return n?{x:c*Math.round(d.x/c),y:u*Math.round(d.y/u)}:d},Jo=(e,t)=>{let{x:n,y:r}=e,[o,i,a]=t;return{x:n*a+o,y:r*a+i}},$o=function(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0];if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const o=(null!==(t=e.width)&&void 0!==t?t:0)*r[0],i=(null!==(n=e.height)&&void 0!==n?n:0)*r[1],a={x:e.position.x-o,y:e.position.y-i};return s(s({},a),{},{positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-o,y:e.positionAbsolute.y-i}:a})},Zo=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0];if(0===e.length)return{x:0,y:0,width:0,height:0};const n=e.reduce((e,n)=>{const{x:r,y:o}=$o(n,t).positionAbsolute;return so(e,lo({x:r,y:o,width:n.width||0,height:n.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return co(n)},Qo=function(e,t){let[n,r,o]=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,1],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[0,0];const l={x:(t.x-n)/o,y:(t.y-r)/o,width:t.width/o,height:t.height/o},c=[];return e.forEach(e=>{const{width:t,height:n,selectable:r=!0,hidden:o=!1}=e;if(a&&!r||o)return!1;const{positionAbsolute:u}=$o(e,s),d={x:u.x,y:u.y,width:t||0,height:n||0},h=ho(l,d);("undefined"===typeof t||"undefined"===typeof n||null===t||null===n||i&&h>0||h>=(t||0)*(n||0)||e.dragging)&&c.push(e)}),c},ei=(e,t)=>{const n=e.map(e=>e.id);return t.filter(e=>n.includes(e.source)||n.includes(e.target))},ti=function(e,t,n,r,o){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.1;const a=t/(e.width*(1+i)),s=n/(e.height*(1+i)),l=Math.min(a,s),c=no(l,r,o);return{x:t/2-(e.x+e.width/2)*c,y:n/2-(e.y+e.height/2)*c,zoom:c}},ni=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.transition().duration(t)};function ri(e,t,n,r){return(t[n]||[]).reduce((t,o)=>{var i,a,s,l;"".concat(e.id,"-").concat(o.id,"-").concat(n)!==r&&t.push({id:o.id||null,type:n,nodeId:e.id,x:(null!==(i=null===(a=e.positionAbsolute)||void 0===a?void 0:a.x)&&void 0!==i?i:0)+o.x+o.width/2,y:(null!==(s=null===(l=e.positionAbsolute)||void 0===l?void 0:l.y)&&void 0!==s?s:0)+o.y+o.height/2});return t},[])}const oi={source:null,target:null,sourceHandle:null,targetHandle:null},ii=()=>({handleDomNode:null,isValid:!1,connection:oi,endHandle:null});function ai(e,t,n,r,o,i,a){const l="target"===o,c=a.querySelector('.react-flow__handle[data-id="'.concat(null===e||void 0===e?void 0:e.nodeId,"-").concat(null===e||void 0===e?void 0:e.id,"-").concat(null===e||void 0===e?void 0:e.type,'"]')),u=s(s({},ii()),{},{handleDomNode:c});if(c){const e=si(void 0,c),o=c.getAttribute("data-nodeid"),a=c.getAttribute("data-handleid"),s=c.classList.contains("connectable"),d=c.classList.contains("connectableend"),h={source:l?o:n,sourceHandle:l?a:r,target:l?n:o,targetHandle:l?r:a};u.connection=h;s&&d&&(t===Eo.Strict?l&&"source"===e||!l&&"target"===e:o!==n||a!==r)&&(u.endHandle={nodeId:o,handleId:a,type:e},u.isValid=i(h))}return u}function si(e,t){return e||(null!==t&&void 0!==t&&t.classList.contains("target")?"target":null!==t&&void 0!==t&&t.classList.contains("source")?"source":null)}function li(e){null===e||void 0===e||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function ci(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function ui(e){let{event:t,handleId:n,nodeId:r,onConnect:o,isTarget:i,getState:a,setState:s,isValidConnection:l,edgeUpdaterType:c,onReconnectEnd:u}=e;const d=ao(t.target),{connectionMode:h,domNode:f,autoPanOnConnect:p,connectionRadius:v,onConnectStart:m,panBy:g,getNodes:y,cancelConnection:w}=a();let b,_=0;const{x:x,y:S}=wo(t),k=null===d||void 0===d?void 0:d.elementFromPoint(x,S),E=si(c,k),C=null===f||void 0===f?void 0:f.getBoundingClientRect();if(!C||!E)return;let N,j=wo(t,C),T=!1,O=null,I=!1,P=null;const A=function(e){let{nodes:t,nodeId:n,handleId:r,handleType:o}=e;return t.reduce((e,t)=>{if(t[po]){const{handleBounds:i}=t[po];let a=[],s=[];i&&(a=ri(t,i,"source","".concat(n,"-").concat(r,"-").concat(o)),s=ri(t,i,"target","".concat(n,"-").concat(r,"-").concat(o))),e.push(...a,...s)}return e},[])}({nodes:y(),nodeId:r,handleId:n,handleType:E}),R=()=>{if(!p)return;const[e,t]=io(j,C);g({x:e,y:t}),_=requestAnimationFrame(R)};function D(e){const{transform:t}=a();j=wo(e,C);const{handle:o,validHandleResult:c}=function(e,t,n,r,o,i){const{x:a,y:s}=wo(e),l=t.elementsFromPoint(a,s).find(e=>e.classList.contains("react-flow__handle"));if(l){const e=l.getAttribute("data-nodeid");if(e){const t=si(void 0,l),r=l.getAttribute("data-handleid"),a=i({nodeId:e,id:r,type:t});if(a){const i=o.find(n=>n.nodeId===e&&n.type===t&&n.id===r);return{handle:{id:r,type:t,nodeId:e,x:(null===i||void 0===i?void 0:i.x)||n.x,y:(null===i||void 0===i?void 0:i.y)||n.y},validHandleResult:a}}}}let c=[],u=1/0;if(o.forEach(e=>{const t=Math.sqrt((e.x-n.x)**2+(e.y-n.y)**2);if(t<=r){const n=i(e);t<=u&&(t<u?c=[{handle:e,validHandleResult:n}]:t===u&&c.push({handle:e,validHandleResult:n}),u=t)}}),!c.length)return{handle:null,validHandleResult:ii()};if(1===c.length)return c[0];const d=c.some(e=>{let{validHandleResult:t}=e;return t.isValid}),h=c.some(e=>{let{handle:t}=e;return"target"===t.type});return c.find(e=>{let{handle:t,validHandleResult:n}=e;return h?"target"===t.type:!d||n.isValid})||c[0]}(e,d,Xo(j,t,!1,[1,1]),v,A,e=>ai(e,h,r,n,i?"target":"source",l,d));if(b=o,T||(R(),T=!0),P=c.handleDomNode,O=c.connection,I=c.isValid,s({connectionPosition:b&&I?Jo({x:b.x,y:b.y},t):j,connectionStatus:ci(!!b,I),connectionEndHandle:c.endHandle}),!b&&!I&&!P)return li(N);O.source!==O.target&&P&&(li(N),N=P,P.classList.add("connecting","react-flow__handle-connecting"),P.classList.toggle("valid",I),P.classList.toggle("react-flow__handle-valid",I))}function M(e){var t,n;(b||P)&&O&&I&&(null===o||void 0===o||o(O)),null===(t=(n=a()).onConnectEnd)||void 0===t||t.call(n,e),c&&(null===u||void 0===u||u(e)),li(N),w(),cancelAnimationFrame(_),T=!1,I=!1,O=null,P=null,d.removeEventListener("mousemove",D),d.removeEventListener("mouseup",M),d.removeEventListener("touchmove",D),d.removeEventListener("touchend",M)}s({connectionPosition:j,connectionStatus:null,connectionNodeId:r,connectionHandleId:n,connectionHandleType:E,connectionStartHandle:{nodeId:r,handleId:n,type:E},connectionEndHandle:null}),null===m||void 0===m||m(t,{nodeId:r,handleId:n,handleType:E}),d.addEventListener("mousemove",D),d.addEventListener("mouseup",M),d.addEventListener("touchmove",D),d.addEventListener("touchend",M)}const di=()=>!0,hi=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),fi=(0,e.forwardRef)((t,n)=>{let{type:r="source",position:o=Oo.Top,isValidConnection:i,isConnectable:a=!0,isConnectableStart:l=!0,isConnectableEnd:c=!0,id:u,onConnect:d,children:h,className:f,onMouseDown:p,onTouchStart:v}=t,m=R(t,Dr);const g=u||null,y="target"===r,w=Jr(),b=(0,e.useContext)(Wo),{connectOnClick:_,noPanClassName:x}=Xr(hi,V),{connecting:S,clickConnecting:k}=Xr(((e,t,n)=>r=>{const{connectionStartHandle:o,connectionEndHandle:i,connectionClickStartHandle:a}=r;return{connecting:(null===o||void 0===o?void 0:o.nodeId)===e&&(null===o||void 0===o?void 0:o.handleId)===t&&(null===o||void 0===o?void 0:o.type)===n||(null===i||void 0===i?void 0:i.nodeId)===e&&(null===i||void 0===i?void 0:i.handleId)===t&&(null===i||void 0===i?void 0:i.type)===n,clickConnecting:(null===a||void 0===a?void 0:a.nodeId)===e&&(null===a||void 0===a?void 0:a.handleId)===t&&(null===a||void 0===a?void 0:a.type)===n}})(b,g,r),V);var E,C;b||(null===(E=(C=w.getState()).onError)||void 0===E||E.call(C,"010",Wr()));const N=e=>{const{defaultEdgeOptions:t,onConnect:n,hasDefaultEdges:r}=w.getState(),o=s(s({},t),e);if(r){const{edges:e,setEdges:t}=w.getState();t(((e,t)=>{if(!e.source||!e.target)return mo(0,Kr()),t;let n;var r;return n="id"in(r=e)&&"source"in r&&"target"in r?s({},e):s(s({},e),{},{id:Yo(e)}),((e,t)=>t.some(t=>t.source===e.source&&t.target===e.target&&(t.sourceHandle===e.sourceHandle||!t.sourceHandle&&!e.sourceHandle)&&(t.targetHandle===e.targetHandle||!t.targetHandle&&!e.targetHandle)))(n,t)?t:t.concat(n)})(o,e))}null===n||void 0===n||n(o),null===d||void 0===d||d(o)},j=e=>{if(!b)return;const t=yo(e);l&&(t&&0===e.button||!t)&&ui({event:e,handleId:g,nodeId:b,onConnect:N,isTarget:y,getState:w.getState,setState:w.setState,isValidConnection:i||w.getState().isValidConnection||di}),t?null===p||void 0===p||p(e):null===v||void 0===v||v(e)};return e.createElement("div",s({"data-handleid":g,"data-nodeid":b,"data-handlepos":o,"data-id":"".concat(b,"-").concat(g,"-").concat(r),className:D(["react-flow__handle","react-flow__handle-".concat(o),"nodrag",x,f,{source:!y,target:y,connectable:a,connectablestart:l,connectableend:c,connecting:k,connectionindicator:a&&(l&&!S||c&&S)}]),onMouseDown:j,onTouchStart:j,onClick:_?e=>{const{onClickConnectStart:t,onClickConnectEnd:n,connectionClickStartHandle:o,connectionMode:a,isValidConnection:s}=w.getState();if(!b||!o&&!l)return;if(!o)return null===t||void 0===t||t(e,{nodeId:b,handleId:g,handleType:r}),void w.setState({connectionClickStartHandle:{nodeId:b,type:r,handleId:g}});const c=ao(e.target),u=i||s||di,{connection:d,isValid:h}=ai({nodeId:b,id:g,type:r},a,o.nodeId,o.handleId||null,o.type,u,c);h&&N(d),null===n||void 0===n||n(e),w.setState({connectionClickStartHandle:null})}:void 0,ref:n},m),h)});fi.displayName="Handle";var pi=(0,e.memo)(fi);const vi=t=>{let{data:n,isConnectable:r,targetPosition:o=Oo.Top,sourcePosition:i=Oo.Bottom}=t;return e.createElement(e.Fragment,null,e.createElement(pi,{type:"target",position:o,isConnectable:r}),null===n||void 0===n?void 0:n.label,e.createElement(pi,{type:"source",position:i,isConnectable:r}))};vi.displayName="DefaultNode";var mi=(0,e.memo)(vi);const gi=t=>{let{data:n,isConnectable:r,sourcePosition:o=Oo.Bottom}=t;return e.createElement(e.Fragment,null,null===n||void 0===n?void 0:n.label,e.createElement(pi,{type:"source",position:o,isConnectable:r}))};gi.displayName="InputNode";var yi=(0,e.memo)(gi);const wi=t=>{let{data:n,isConnectable:r,targetPosition:o=Oo.Top}=t;return e.createElement(e.Fragment,null,e.createElement(pi,{type:"target",position:o,isConnectable:r}),null===n||void 0===n?void 0:n.label)};wi.displayName="OutputNode";var bi=(0,e.memo)(wi);const _i=()=>null;_i.displayName="GroupNode";const xi=e=>({selectedNodes:e.getNodes().filter(e=>e.selected),selectedEdges:e.edges.filter(e=>e.selected).map(e=>s({},e))}),Si=e=>e.id;function ki(e,t){return V(e.selectedNodes.map(Si),t.selectedNodes.map(Si))&&V(e.selectedEdges.map(Si),t.selectedEdges.map(Si))}const Ei=(0,e.memo)(t=>{let{onSelectionChange:n}=t;const r=Jr(),{selectedNodes:o,selectedEdges:i}=Xr(xi,ki);return(0,e.useEffect)(()=>{const e={nodes:o,edges:i};null===n||void 0===n||n(e),r.getState().onSelectionChange.forEach(t=>t(e))},[o,i,n]),null});Ei.displayName="SelectionListener";const Ci=e=>!!e.onSelectionChange;function Ni(t){let{onSelectionChange:n}=t;const r=Xr(Ci);return n||r?e.createElement(Ei,{onSelectionChange:n}):null}const ji=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Ti(t,n){(0,e.useEffect)(()=>{"undefined"!==typeof t&&n(t)},[t])}function Oi(t,n,r){(0,e.useEffect)(()=>{"undefined"!==typeof n&&r({[t]:n})},[n])}const Ii=t=>{let{nodes:n,edges:r,defaultNodes:o,defaultEdges:i,onConnect:a,onConnectStart:l,onConnectEnd:c,onClickConnectStart:u,onClickConnectEnd:d,nodesDraggable:h,nodesConnectable:f,nodesFocusable:p,edgesFocusable:v,edgesUpdatable:m,elevateNodesOnSelect:g,minZoom:y,maxZoom:w,nodeExtent:b,onNodesChange:_,onEdgesChange:x,elementsSelectable:S,connectionMode:k,snapGrid:E,snapToGrid:C,translateExtent:N,connectOnClick:j,defaultEdgeOptions:T,fitView:O,fitViewOptions:I,onNodesDelete:P,onEdgesDelete:A,onNodeDrag:R,onNodeDragStart:D,onNodeDragStop:M,onSelectionDrag:L,onSelectionDragStart:z,onSelectionDragStop:U,noPanClassName:B,nodeOrigin:F,rfId:K,autoPanOnConnect:q,autoPanOnNodeDrag:W,onError:H,connectionRadius:Y,isValidConnection:G,nodeDragThreshold:X}=t;const{setNodes:J,setEdges:$,setDefaultNodesAndEdges:Z,setMinZoom:Q,setMaxZoom:ee,setTranslateExtent:te,setNodeExtent:ne,reset:re}=Xr(ji,V),oe=Jr();return(0,e.useEffect)(()=>{const e=null===i||void 0===i?void 0:i.map(e=>s(s({},e),T));return Z(o,e),()=>{re()}},[]),Oi("defaultEdgeOptions",T,oe.setState),Oi("connectionMode",k,oe.setState),Oi("onConnect",a,oe.setState),Oi("onConnectStart",l,oe.setState),Oi("onConnectEnd",c,oe.setState),Oi("onClickConnectStart",u,oe.setState),Oi("onClickConnectEnd",d,oe.setState),Oi("nodesDraggable",h,oe.setState),Oi("nodesConnectable",f,oe.setState),Oi("nodesFocusable",p,oe.setState),Oi("edgesFocusable",v,oe.setState),Oi("edgesUpdatable",m,oe.setState),Oi("elementsSelectable",S,oe.setState),Oi("elevateNodesOnSelect",g,oe.setState),Oi("snapToGrid",C,oe.setState),Oi("snapGrid",E,oe.setState),Oi("onNodesChange",_,oe.setState),Oi("onEdgesChange",x,oe.setState),Oi("connectOnClick",j,oe.setState),Oi("fitViewOnInit",O,oe.setState),Oi("fitViewOnInitOptions",I,oe.setState),Oi("onNodesDelete",P,oe.setState),Oi("onEdgesDelete",A,oe.setState),Oi("onNodeDrag",R,oe.setState),Oi("onNodeDragStart",D,oe.setState),Oi("onNodeDragStop",M,oe.setState),Oi("onSelectionDrag",L,oe.setState),Oi("onSelectionDragStart",z,oe.setState),Oi("onSelectionDragStop",U,oe.setState),Oi("noPanClassName",B,oe.setState),Oi("nodeOrigin",F,oe.setState),Oi("rfId",K,oe.setState),Oi("autoPanOnConnect",q,oe.setState),Oi("autoPanOnNodeDrag",W,oe.setState),Oi("onError",H,oe.setState),Oi("connectionRadius",Y,oe.setState),Oi("isValidConnection",G,oe.setState),Oi("nodeDragThreshold",X,oe.setState),Ti(n,J),Ti(r,$),Ti(y,Q),Ti(w,ee),Ti(N,te),Ti(b,ne),null},Pi={display:"none"},Ai={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Ri="react-flow__node-desc",Di="react-flow__edge-desc",Mi=e=>e.ariaLiveMessage;function Li(t){let{rfId:n}=t;const r=Xr(Mi);return e.createElement("div",{id:"".concat("react-flow__aria-live","-").concat(n),"aria-live":"assertive","aria-atomic":"true",style:Ai},r)}function zi(t){let{rfId:n,disableKeyboardA11y:r}=t;return e.createElement(e.Fragment,null,e.createElement("div",{id:"".concat(Ri,"-").concat(n),style:Pi},"Press enter or space to select a node.",!r&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),e.createElement("div",{id:"".concat(Di,"-").concat(n),style:Pi},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!r&&e.createElement(Li,{rfId:n}))}var Ui=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{actInsideInputWithModifier:!0};const[r,o]=(0,e.useState)(!1),i=(0,e.useRef)(!1),a=(0,e.useRef)(new Set([])),[s,l]=(0,e.useMemo)(()=>{if(null!==t){const e=(Array.isArray(t)?t:[t]).filter(e=>"string"===typeof e).map(e=>e.split("+")),n=e.reduce((e,t)=>e.concat(...t),[]);return[e,n]}return[[],[]]},[t]);return(0,e.useEffect)(()=>{const e="undefined"!==typeof document?document:null,r=(null===n||void 0===n?void 0:n.target)||e;if(null!==t){const e=e=>{i.current=e.ctrlKey||e.metaKey||e.shiftKey;if((!i.current||i.current&&!n.actInsideInputWithModifier)&&go(e))return!1;const t=Fi(e.code,l);a.current.add(e[t]),Bi(s,a.current,!1)&&(e.preventDefault(),o(!0))},t=e=>{if((!i.current||i.current&&!n.actInsideInputWithModifier)&&go(e))return!1;const t=Fi(e.code,l);Bi(s,a.current,!0)?(o(!1),a.current.clear()):a.current.delete(e[t]),"Meta"===e.key&&a.current.clear(),i.current=!1},c=()=>{a.current.clear(),o(!1)};return null===r||void 0===r||r.addEventListener("keydown",e),null===r||void 0===r||r.addEventListener("keyup",t),window.addEventListener("blur",c),()=>{null===r||void 0===r||r.removeEventListener("keydown",e),null===r||void 0===r||r.removeEventListener("keyup",t),window.removeEventListener("blur",c)}}},[t,o]),r};function Bi(e,t,n){return e.filter(e=>n||e.length===t.size).some(e=>e.every(e=>t.has(e)))}function Fi(e,t){return t.includes(e)?"code":"key"}function Ki(e,t,n,r){var o,i,a,s,l,c,u,d;const h=e.parentNode||e.parentId;if(!h)return n;const f=t.get(h),p=$o(f,r);return Ki(f,t,{x:(null!==(o=n.x)&&void 0!==o?o:0)+p.x,y:(null!==(i=n.y)&&void 0!==i?i:0)+p.y,z:(null!==(a=null===(s=f[po])||void 0===s?void 0:s.z)&&void 0!==a?a:0)>(null!==(l=n.z)&&void 0!==l?l:0)?null!==(c=null===(u=f[po])||void 0===u?void 0:u.z)&&void 0!==c?c:0:null!==(d=n.z)&&void 0!==d?d:0},r)}function qi(e,t,n){e.forEach(r=>{const o=r.parentNode||r.parentId;if(o&&!e.has(o))throw new Error("Parent node ".concat(o," not found"));if(o||null!==n&&void 0!==n&&n[r.id]){var i,a;const{x:o,y:l,z:c}=Ki(r,e,s(s({},r.position),{},{z:null!==(i=null===(a=r[po])||void 0===a?void 0:a.z)&&void 0!==i?i:0}),t);r.positionAbsolute={x:o,y:l},r[po].z=c,null!==n&&void 0!==n&&n[r.id]&&(r[po].isParent=!0)}})}function Vi(e,t,n,r){const o=new Map,i={},a=r?1e3:0;return e.forEach(e=>{var n;const r=(fo(e.zIndex)?e.zIndex:0)+(e.selected?a:0),l=t.get(e.id),c=s(s({},e),{},{positionAbsolute:{x:e.position.x,y:e.position.y}}),u=e.parentNode||e.parentId;u&&(i[u]=!0);const d=(null===l||void 0===l?void 0:l.type)&&(null===l||void 0===l?void 0:l.type)!==e.type;Object.defineProperty(c,po,{enumerable:!1,value:{handleBounds:d||null===l||void 0===l||null===(n=l[po])||void 0===n?void 0:n.handleBounds,z:r}}),o.set(e.id,c)}),qi(o,n,i),o}function Wi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{getNodes:n,width:r,height:o,minZoom:i,maxZoom:a,d3Zoom:s,d3Selection:l,fitViewOnInitDone:c,fitViewOnInit:u,nodeOrigin:d}=e(),h=t.initial&&!c&&u;if(s&&l&&(h||!t.initial)){const e=n().filter(e=>{var n;const r=t.includeHiddenNodes?e.width&&e.height:!e.hidden;return null!==(n=t.nodes)&&void 0!==n&&n.length?r&&t.nodes.some(t=>t.id===e.id):r}),c=e.every(e=>e.width&&e.height);if(e.length>0&&c){var f,p,v;const n=Zo(e,d),{x:c,y:u,zoom:h}=ti(n,r,o,null!==(f=t.minZoom)&&void 0!==f?f:i,null!==(p=t.maxZoom)&&void 0!==p?p:a,null!==(v=t.padding)&&void 0!==v?v:.1),m=gr.translate(c,u).scale(h);return"number"===typeof t.duration&&t.duration>0?s.transform(ni(l,t.duration),m):s.transform(l,m),!0}}return!1}function Hi(e,t){return e.forEach(e=>{const n=t.get(e.id);n&&t.set(n.id,s(s({},n),{},{[po]:n[po],selected:e.selected}))}),new Map(t)}function Yi(e,t){return t.map(t=>{const n=e.find(e=>e.id===t.id);return n&&(t.selected=n.selected),t})}function Gi(e){let{changedNodes:t,changedEdges:n,get:r,set:o}=e;const{nodeInternals:i,edges:a,onNodesChange:s,onEdgesChange:l,hasDefaultNodes:c,hasDefaultEdges:u}=r();null!==t&&void 0!==t&&t.length&&(c&&o({nodeInternals:Hi(t,i)}),null===s||void 0===s||s(t)),null!==n&&void 0!==n&&n.length&&(u&&o({edges:Yi(n,a)}),null===l||void 0===l||l(n))}const Xi=()=>{},Ji={zoomIn:Xi,zoomOut:Xi,zoomTo:Xi,getZoom:()=>1,setViewport:Xi,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Xi,fitBounds:Xi,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},$i=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection});function Zi(){const t=(()=>{const t=Jr(),{d3Zoom:n,d3Selection:r}=Xr($i,V),o=(0,e.useMemo)(()=>r&&n?{zoomIn:e=>n.scaleBy(ni(r,null===e||void 0===e?void 0:e.duration),1.2),zoomOut:e=>n.scaleBy(ni(r,null===e||void 0===e?void 0:e.duration),1/1.2),zoomTo:(e,t)=>n.scaleTo(ni(r,null===t||void 0===t?void 0:t.duration),e),getZoom:()=>t.getState().transform[2],setViewport:(e,o)=>{var i,a,s;const[l,c,u]=t.getState().transform,d=gr.translate(null!==(i=e.x)&&void 0!==i?i:l,null!==(a=e.y)&&void 0!==a?a:c).scale(null!==(s=e.zoom)&&void 0!==s?s:u);n.transform(ni(r,null===o||void 0===o?void 0:o.duration),d)},getViewport:()=>{const[e,n,r]=t.getState().transform;return{x:e,y:n,zoom:r}},fitView:e=>Wi(t.getState,e),setCenter:(e,o,i)=>{const{width:a,height:s,maxZoom:l}=t.getState(),c="undefined"!==typeof(null===i||void 0===i?void 0:i.zoom)?i.zoom:l,u=a/2-e*c,d=s/2-o*c,h=gr.translate(u,d).scale(c);n.transform(ni(r,null===i||void 0===i?void 0:i.duration),h)},fitBounds:(e,o)=>{var i;const{width:a,height:s,minZoom:l,maxZoom:c}=t.getState(),{x:u,y:d,zoom:h}=ti(e,a,s,l,c,null!==(i=null===o||void 0===o?void 0:o.padding)&&void 0!==i?i:.1),f=gr.translate(u,d).scale(h);n.transform(ni(r,null===o||void 0===o?void 0:o.duration),f)},project:e=>{const{transform:n,snapToGrid:r,snapGrid:o}=t.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Xo(e,n,r,o)},screenToFlowPosition:e=>{const{transform:n,snapToGrid:r,snapGrid:o,domNode:i}=t.getState();if(!i)return e;const{x:a,y:s}=i.getBoundingClientRect(),l={x:e.x-a,y:e.y-s};return Xo(l,n,r,o)},flowToScreenPosition:e=>{const{transform:n,domNode:r}=t.getState();if(!r)return e;const{x:o,y:i}=r.getBoundingClientRect(),a=Jo(e,n);return{x:a.x+o,y:a.y+i}},viewportInitialized:!0}:Ji,[n,r]);return o})(),n=Jr(),r=(0,e.useCallback)(()=>n.getState().getNodes().map(e=>s({},e)),[]),o=(0,e.useCallback)(e=>n.getState().nodeInternals.get(e),[]),i=(0,e.useCallback)(()=>{const{edges:e=[]}=n.getState();return e.map(e=>s({},e))},[]),a=(0,e.useCallback)(e=>{const{edges:t=[]}=n.getState();return t.find(t=>t.id===e)},[]),l=(0,e.useCallback)(e=>{const{getNodes:t,setNodes:r,hasDefaultNodes:o,onNodesChange:i}=n.getState(),a=t(),s="function"===typeof e?e(a):e;if(o)r(s);else if(i){const e=0===s.length?a.map(e=>({type:"remove",id:e.id})):s.map(e=>({item:e,type:"reset"}));i(e)}},[]),c=(0,e.useCallback)(e=>{const{edges:t=[],setEdges:r,hasDefaultEdges:o,onEdgesChange:i}=n.getState(),a="function"===typeof e?e(t):e;if(o)r(a);else if(i){i(0===a.length?t.map(e=>({type:"remove",id:e.id})):a.map(e=>({item:e,type:"reset"})))}},[]),u=(0,e.useCallback)(e=>{const t=Array.isArray(e)?e:[e],{getNodes:r,setNodes:o,hasDefaultNodes:i,onNodesChange:a}=n.getState();if(i){o([...r(),...t])}else if(a){const e=t.map(e=>({item:e,type:"add"}));a(e)}},[]),d=(0,e.useCallback)(e=>{const t=Array.isArray(e)?e:[e],{edges:r=[],setEdges:o,hasDefaultEdges:i,onEdgesChange:a}=n.getState();if(i)o([...r,...t]);else if(a){a(t.map(e=>({item:e,type:"add"})))}},[]),h=(0,e.useCallback)(()=>{const{getNodes:e,edges:t=[],transform:r}=n.getState(),[o,i,a]=r;return{nodes:e().map(e=>s({},e)),edges:t.map(e=>s({},e)),viewport:{x:o,y:i,zoom:a}}},[]),f=(0,e.useCallback)(e=>{let{nodes:t,edges:r}=e;const{nodeInternals:o,getNodes:i,edges:a,hasDefaultNodes:s,hasDefaultEdges:l,onNodesDelete:c,onEdgesDelete:u,onNodesChange:d,onEdgesChange:h}=n.getState(),f=(t||[]).map(e=>e.id),p=(r||[]).map(e=>e.id),v=i().reduce((e,t)=>{const n=t.parentNode||t.parentId,r=!f.includes(t.id)&&n&&e.find(e=>e.id===n);return("boolean"!==typeof t.deletable||t.deletable)&&(f.includes(t.id)||r)&&e.push(t),e},[]),m=a.filter(e=>"boolean"!==typeof e.deletable||e.deletable),g=m.filter(e=>p.includes(e.id));if(v||g){const e=ei(v,m),t=[...g,...e],r=t.reduce((e,t)=>(e.includes(t.id)||e.push(t.id),e),[]);if((l||s)&&(l&&n.setState({edges:a.filter(e=>!r.includes(e.id))}),s&&(v.forEach(e=>{o.delete(e.id)}),n.setState({nodeInternals:new Map(o)}))),r.length>0&&(null===u||void 0===u||u(t),h&&h(r.map(e=>({id:e,type:"remove"})))),v.length>0&&(null===c||void 0===c||c(v),d)){d(v.map(e=>({id:e.id,type:"remove"})))}}},[]),p=(0,e.useCallback)(e=>{const t=fo((r=e).width)&&fo(r.height)&&fo(r.x)&&fo(r.y);var r;const o=t?null:n.getState().nodeInternals.get(e.id);if(!t&&!o)return[null,null,t];return[t?e:uo(o),o,t]},[]),v=(0,e.useCallback)(function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;const[o,i,a]=p(e);return o?(r||n.getState().getNodes()).filter(e=>{if(!a&&(e.id===i.id||!e.positionAbsolute))return!1;const n=uo(e),r=ho(n,o);return t&&r>0||r>=o.width*o.height}):[]},[]),m=(0,e.useCallback)(function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const[r]=p(e);if(!r)return!1;const o=ho(r,t);return n&&o>0||o>=r.width*r.height},[]);return(0,e.useMemo)(()=>s(s({},t),{},{getNodes:r,getNode:o,getEdges:i,getEdge:a,setNodes:l,setEdges:c,addNodes:u,addEdges:d,toObject:h,deleteElements:f,getIntersectingNodes:v,isNodeIntersecting:m}),[t,r,o,i,a,l,c,u,d,h,f,v,m])}const Qi={actInsideInputWithModifier:!1};const ea={position:"absolute",width:"100%",height:"100%",top:0,left:0},ta=e=>({x:e.x,y:e.y,zoom:e.k}),na=(e,t)=>e.target.closest(".".concat(t)),ra=(e,t)=>2===t&&Array.isArray(e)&&e.includes(2),oa=e=>{const t=e.ctrlKey&&bo()?10:1;return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*t},ia=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),aa=t=>{let{onMove:n,onMoveStart:r,onMoveEnd:o,onPaneContextMenu:i,zoomOnScroll:a=!0,zoomOnPinch:s=!0,panOnScroll:l=!1,panOnScrollSpeed:c=.5,panOnScrollMode:u=Co.Free,zoomOnDoubleClick:d=!0,elementsSelectable:h,panOnDrag:f=!0,defaultViewport:p,translateExtent:v,minZoom:m,maxZoom:g,zoomActivationKeyCode:y,preventScrolling:w=!0,children:b,noWheelClassName:_,noPanClassName:x}=t;const S=(0,e.useRef)(),k=Jr(),E=(0,e.useRef)(!1),C=(0,e.useRef)(!1),N=(0,e.useRef)(null),j=(0,e.useRef)({x:0,y:0,zoom:0}),{d3Zoom:T,d3Selection:O,d3ZoomHandler:I,userSelectionActive:P}=Xr(ia,V),A=Ui(y),R=(0,e.useRef)(0),D=(0,e.useRef)(!1),M=(0,e.useRef)();return function(t){const n=Jr();(0,e.useEffect)(()=>{let e;const r=()=>{if(!t.current)return;const e=to(t.current);var r,o;0!==e.height&&0!==e.width||null===(r=(o=n.getState()).onError)||void 0===r||r.call(o,"004",Br()),n.setState({width:e.width||500,height:e.height||500})};return r(),window.addEventListener("resize",r),t.current&&(e=new ResizeObserver(()=>r()),e.observe(t.current)),()=>{window.removeEventListener("resize",r),e&&t.current&&e.unobserve(t.current)}},[])}(N),(0,e.useEffect)(()=>{if(N.current){const e=N.current.getBoundingClientRect(),t=function(){var e,t,n,r=br,o=_r,i=Er,a=Sr,s=kr,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,d=yt,h=J("start","zoom","end"),f=0,p=10;function v(e){e.property("__zoom",xr).on("wheel.zoom",x,{passive:!1}).on("mousedown.zoom",S).on("dblclick.zoom",k).filter(s).on("touchstart.zoom",E).on("touchmove.zoom",C).on("touchend.zoom touchcancel.zoom",N).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(e,t){return(t=Math.max(l[0],Math.min(l[1],t)))===e.k?e:new mr(t,e.x,e.y)}function g(e,t,n){var r=t[0]-n[0]*e.k,o=t[1]-n[1]*e.k;return r===e.x&&o===e.y?e:new mr(e.k,r,o)}function y(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function w(e,t,n,r){e.on("start.zoom",function(){b(this,arguments).event(r).start()}).on("interrupt.zoom end.zoom",function(){b(this,arguments).event(r).end()}).tween("zoom",function(){var e=this,i=arguments,a=b(e,i).event(r),s=o.apply(e,i),l=null==n?y(s):"function"===typeof n?n.apply(e,i):n,c=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),u=e.__zoom,h="function"===typeof t?t.apply(e,i):t,f=d(u.invert(l).concat(c/u.k),h.invert(l).concat(c/h.k));return function(e){if(1===e)e=h;else{var t=f(e),n=c/t[2];e=new mr(n,l[0]-t[0]*n,l[1]-t[1]*n)}a.zoom(null,e)}})}function b(e,t,n){return!n&&e.__zooming||new _(e,t)}function _(e,t){this.that=e,this.args=t,this.active=0,this.sourceEvent=null,this.extent=o.apply(e,t),this.taps=0}function x(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(r.apply(this,arguments)){var s=b(this,n).event(e),u=this.__zoom,d=Math.max(l[0],Math.min(l[1],u.k*Math.pow(2,a.apply(this,arguments)))),h=wt(e);if(s.wheel)s.mouse[0][0]===h[0]&&s.mouse[0][1]===h[1]||(s.mouse[1]=u.invert(s.mouse[0]=h)),clearTimeout(s.wheel);else{if(u.k===d)return;s.mouse=[h,u.invert(h)],Vt(this),s.start()}wr(e),s.wheel=setTimeout(function(){s.wheel=null,s.end()},150),s.zoom("mouse",i(g(m(u,d),s.mouse[0],s.mouse[1]),s.extent,c))}}function S(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),a=1;a<t;a++)o[a-1]=arguments[a];if(!n&&r.apply(this,arguments)){var s=e.currentTarget,l=b(this,o,!0).event(e),u=ut(e.view).on("mousemove.zoom",function(e){if(wr(e),!l.moved){var t=e.clientX-h,n=e.clientY-p;l.moved=t*t+n*n>f}l.event(e).zoom("mouse",i(g(l.that.__zoom,l.mouse[0]=wt(e,s),l.mouse[1]),l.extent,c))},!0).on("mouseup.zoom",function(e){u.on("mousemove.zoom mouseup.zoom",null),mt(e.view,l.moved),wr(e),l.event(e).end()},!0),d=wt(e,s),h=e.clientX,p=e.clientY;vt(e.view),yr(e),l.mouse=[d,this.__zoom.invert(d)],Vt(this),l.start()}}function k(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];if(r.apply(this,arguments)){var s=this.__zoom,l=wt(e.changedTouches?e.changedTouches[0]:e,this),d=s.invert(l),h=s.k*(e.shiftKey?.5:2),f=i(g(m(s,h),l,d),o.apply(this,n),c);wr(e),u>0?ut(this).transition().duration(u).call(w,f,l,e):ut(this).call(v.transform,f,l,e)}}function E(n){for(var o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];if(r.apply(this,arguments)){var s,l,c,u,d=n.touches,h=d.length,f=b(this,i,n.changedTouches.length===h).event(n);for(yr(n),l=0;l<h;++l)u=[u=wt(c=d[l],this),this.__zoom.invert(u),c.identifier],f.touch0?f.touch1||f.touch0[2]===u[2]||(f.touch1=u,f.taps=0):(f.touch0=u,s=!0,f.taps=1+!!e);e&&(e=clearTimeout(e)),s&&(f.taps<2&&(t=u[0],e=setTimeout(function(){e=null},500)),Vt(this),f.start())}}function C(e){if(this.__zooming){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o,a,s,l,u=b(this,n).event(e),d=e.changedTouches,h=d.length;for(wr(e),o=0;o<h;++o)s=wt(a=d[o],this),u.touch0&&u.touch0[2]===a.identifier?u.touch0[0]=s:u.touch1&&u.touch1[2]===a.identifier&&(u.touch1[0]=s);if(a=u.that.__zoom,u.touch1){var f=u.touch0[0],p=u.touch0[1],v=u.touch1[0],y=u.touch1[1],w=(w=v[0]-f[0])*w+(w=v[1]-f[1])*w,_=(_=y[0]-p[0])*_+(_=y[1]-p[1])*_;a=m(a,Math.sqrt(w/_)),s=[(f[0]+v[0])/2,(f[1]+v[1])/2],l=[(p[0]+y[0])/2,(p[1]+y[1])/2]}else{if(!u.touch0)return;s=u.touch0[0],l=u.touch0[1]}u.zoom("touch",i(g(a,s,l),u.extent,c))}}function N(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];if(this.__zooming){var a,s,l=b(this,o).event(e),c=e.changedTouches,u=c.length;for(yr(e),n&&clearTimeout(n),n=setTimeout(function(){n=null},500),a=0;a<u;++a)s=c[a],l.touch0&&l.touch0[2]===s.identifier?delete l.touch0:l.touch1&&l.touch1[2]===s.identifier&&delete l.touch1;if(l.touch1&&!l.touch0&&(l.touch0=l.touch1,delete l.touch1),l.touch0)l.touch0[1]=this.__zoom.invert(l.touch0[0]);else if(l.end(),2===l.taps&&(s=wt(s,this),Math.hypot(t[0]-s[0],t[1]-s[1])<p)){var d=ut(this).on("dblclick.zoom");d&&d.apply(this,arguments)}}}return v.transform=function(e,t,n,r){var o=e.selection?e.selection():e;o.property("__zoom",xr),e!==o?w(e,t,n,r):o.interrupt().each(function(){b(this,arguments).event(r).start().zoom(null,"function"===typeof t?t.apply(this,arguments):t).end()})},v.scaleBy=function(e,t,n,r){v.scaleTo(e,function(){return this.__zoom.k*("function"===typeof t?t.apply(this,arguments):t)},n,r)},v.scaleTo=function(e,t,n,r){v.transform(e,function(){var e=o.apply(this,arguments),r=this.__zoom,a=null==n?y(e):"function"===typeof n?n.apply(this,arguments):n,s=r.invert(a),l="function"===typeof t?t.apply(this,arguments):t;return i(g(m(r,l),a,s),e,c)},n,r)},v.translateBy=function(e,t,n,r){v.transform(e,function(){return i(this.__zoom.translate("function"===typeof t?t.apply(this,arguments):t,"function"===typeof n?n.apply(this,arguments):n),o.apply(this,arguments),c)},null,r)},v.translateTo=function(e,t,n,r,a){v.transform(e,function(){var e=o.apply(this,arguments),a=this.__zoom,s=null==r?y(e):"function"===typeof r?r.apply(this,arguments):r;return i(gr.translate(s[0],s[1]).scale(a.k).translate("function"===typeof t?-t.apply(this,arguments):-t,"function"===typeof n?-n.apply(this,arguments):-n),e,c)},r,a)},_.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return 1===++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0===--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var t=ut(this.that).datum();h.call(e,this.that,new vr(e,{sourceEvent:this.sourceEvent,target:v,type:e,transform:this.that.__zoom,dispatch:h}),t)}},v.wheelDelta=function(e){return arguments.length?(a="function"===typeof e?e:pr(+e),v):a},v.filter=function(e){return arguments.length?(r="function"===typeof e?e:pr(!!e),v):r},v.touchable=function(e){return arguments.length?(s="function"===typeof e?e:pr(!!e),v):s},v.extent=function(e){return arguments.length?(o="function"===typeof e?e:pr([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),v):o},v.scaleExtent=function(e){return arguments.length?(l[0]=+e[0],l[1]=+e[1],v):[l[0],l[1]]},v.translateExtent=function(e){return arguments.length?(c[0][0]=+e[0][0],c[1][0]=+e[1][0],c[0][1]=+e[0][1],c[1][1]=+e[1][1],v):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},v.constrain=function(e){return arguments.length?(i=e,v):i},v.duration=function(e){return arguments.length?(u=+e,v):u},v.interpolate=function(e){return arguments.length?(d=e,v):d},v.on=function(){var e=h.on.apply(h,arguments);return e===h?v:e},v.clickDistance=function(e){return arguments.length?(f=(e=+e)*e,v):Math.sqrt(f)},v.tapDistance=function(e){return arguments.length?(p=+e,v):p},v}().scaleExtent([m,g]).translateExtent(v),n=ut(N.current).call(t),r=gr.translate(p.x,p.y).scale(no(p.zoom,m,g)),o=[[0,0],[e.width,e.height]],i=t.constrain()(r,o,v);t.transform(n,i),t.wheelDelta(oa),k.setState({d3Zoom:t,d3Selection:n,d3ZoomHandler:n.on("wheel.zoom"),transform:[i.x,i.y,i.k],domNode:N.current.closest(".react-flow")})}},[]),(0,e.useEffect)(()=>{O&&T&&(!l||A||P?"undefined"!==typeof I&&O.on("wheel.zoom",function(e,t){if(!w&&"wheel"===e.type&&!e.ctrlKey||na(e,_))return null;e.preventDefault(),I.call(this,e,t)},{passive:!1}):O.on("wheel.zoom",e=>{if(na(e,_))return!1;e.preventDefault(),e.stopImmediatePropagation();const t=O.property("__zoom").k||1;if(e.ctrlKey&&s){const n=wt(e),r=oa(e),o=t*Math.pow(2,r);return void T.scaleTo(O,o,n,e)}const i=1===e.deltaMode?20:1;let a=u===Co.Vertical?0:e.deltaX*i,l=u===Co.Horizontal?0:e.deltaY*i;!bo()&&e.shiftKey&&u!==Co.Vertical&&(a=e.deltaY*i,l=0),T.translateBy(O,-a/t*c,-l/t*c,{internal:!0});const d=ta(O.property("__zoom")),{onViewportChangeStart:h,onViewportChange:f,onViewportChangeEnd:p}=k.getState();clearTimeout(M.current),D.current||(D.current=!0,null===r||void 0===r||r(e,d),null===h||void 0===h||h(d)),D.current&&(null===n||void 0===n||n(e,d),null===f||void 0===f||f(d),M.current=setTimeout(()=>{null===o||void 0===o||o(e,d),null===p||void 0===p||p(d),D.current=!1},150))},{passive:!1}))},[P,l,u,O,T,I,A,s,w,_,r,n,o]),(0,e.useEffect)(()=>{T&&T.on("start",e=>{var t,n;if(!e.sourceEvent||e.sourceEvent.internal)return null;R.current=null===(t=e.sourceEvent)||void 0===t?void 0:t.button;const{onViewportChangeStart:o}=k.getState(),i=ta(e.transform);E.current=!0,j.current=i,"mousedown"===(null===(n=e.sourceEvent)||void 0===n?void 0:n.type)&&k.setState({paneDragging:!0}),null===o||void 0===o||o(i),null===r||void 0===r||r(e.sourceEvent,i)})},[T,r]),(0,e.useEffect)(()=>{T&&(P&&!E.current?T.on("zoom",null):P||T.on("zoom",e=>{var t,r;const{onViewportChange:o}=k.getState();if(k.setState({transform:[e.transform.x,e.transform.y,e.transform.k]}),C.current=!(!i||!ra(f,null!==(t=R.current)&&void 0!==t?t:0)),(n||o)&&(null===(r=e.sourceEvent)||void 0===r||!r.internal)){const t=ta(e.transform);null===o||void 0===o||o(t),null===n||void 0===n||n(e.sourceEvent,t)}}))},[P,T,n,f,i]),(0,e.useEffect)(()=>{T&&T.on("end",e=>{var t;if(!e.sourceEvent||e.sourceEvent.internal)return null;const{onViewportChangeEnd:n}=k.getState();if(E.current=!1,k.setState({paneDragging:!1}),i&&ra(f,null!==(t=R.current)&&void 0!==t?t:0)&&!C.current&&i(e.sourceEvent),C.current=!1,(o||n)&&(r=j.current,a=e.transform,r.x!==a.x||r.y!==a.y||r.zoom!==a.k)){const t=ta(e.transform);j.current=t,clearTimeout(S.current),S.current=setTimeout(()=>{null===n||void 0===n||n(t),null===o||void 0===o||o(e.sourceEvent,t)},l?150:0)}var r,a})},[T,l,f,o,i]),(0,e.useEffect)(()=>{T&&T.filter(e=>{const t=A||a,n=s&&e.ctrlKey;if((!0===f||Array.isArray(f)&&f.includes(1))&&1===e.button&&"mousedown"===e.type&&(na(e,"react-flow__node")||na(e,"react-flow__edge")))return!0;if(!f&&!t&&!l&&!d&&!s)return!1;if(P)return!1;if(!d&&"dblclick"===e.type)return!1;if(na(e,_)&&"wheel"===e.type)return!1;if(na(e,x)&&("wheel"!==e.type||l&&"wheel"===e.type&&!A))return!1;if(!s&&e.ctrlKey&&"wheel"===e.type)return!1;if(!t&&!l&&!n&&"wheel"===e.type)return!1;if(!f&&("mousedown"===e.type||"touchstart"===e.type))return!1;if(Array.isArray(f)&&!f.includes(e.button)&&"mousedown"===e.type)return!1;const r=Array.isArray(f)&&f.includes(e.button)||!e.button||e.button<=1;return(!e.ctrlKey||"wheel"===e.type)&&r})},[P,T,a,s,l,d,f,h,A]),e.createElement("div",{className:"react-flow__renderer",ref:N,style:ea},b)},sa=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function la(){const{userSelectionActive:t,userSelectionRect:n}=Xr(sa,V);return t&&n?e.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:n.width,height:n.height,transform:"translate(".concat(n.x,"px, ").concat(n.y,"px)")}}):null}function ca(e,t){const n=t.parentNode||t.parentId,r=e.find(e=>e.id===n);if(r){const e=t.position.x+t.width-r.width,n=t.position.y+t.height-r.height;if(e>0||n>0||t.position.x<0||t.position.y<0){var o,i;if(r.style=s({},r.style)||{},r.style.width=null!==(o=r.style.width)&&void 0!==o?o:r.width,r.style.height=null!==(i=r.style.height)&&void 0!==i?i:r.height,e>0&&(r.style.width+=e),n>0&&(r.style.height+=n),t.position.x<0){const e=Math.abs(t.position.x);r.position.x=r.position.x-e,r.style.width+=e,t.position.x=0}if(t.position.y<0){const e=Math.abs(t.position.y);r.position.y=r.position.y-e,r.style.height+=e,t.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function ua(e,t){if(e.some(e=>"reset"===e.type))return e.filter(e=>"reset"===e.type).map(e=>e.item);const n=e.filter(e=>"add"===e.type).map(e=>e.item);return t.reduce((t,n)=>{const r=e.filter(e=>e.id===n.id);if(0===r.length)return t.push(n),t;const o=s({},n);for(const e of r)if(e)switch(e.type){case"select":o.selected=e.selected;break;case"position":"undefined"!==typeof e.position&&(o.position=e.position),"undefined"!==typeof e.positionAbsolute&&(o.positionAbsolute=e.positionAbsolute),"undefined"!==typeof e.dragging&&(o.dragging=e.dragging),o.expandParent&&ca(t,o);break;case"dimensions":"undefined"!==typeof e.dimensions&&(o.width=e.dimensions.width,o.height=e.dimensions.height),"undefined"!==typeof e.updateStyle&&(o.style=s(s({},o.style||{}),e.dimensions)),"boolean"===typeof e.resizing&&(o.resizing=e.resizing),o.expandParent&&ca(t,o);break;case"remove":return t}return t.push(o),t},n)}function da(e,t){return ua(e,t)}const ha=(e,t)=>({id:e,type:"select",selected:t});function fa(e,t){return e.reduce((e,n)=>{const r=t.includes(n.id);return!n.selected&&r?(n.selected=!0,e.push(ha(n.id,!0))):n.selected&&!r&&(n.selected=!1,e.push(ha(n.id,!1))),e},[])}const pa=(e,t)=>n=>{n.target===t.current&&(null===e||void 0===e||e(n))},va=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),ma=(0,e.memo)(t=>{let{isSelecting:n,selectionMode:r=No.Full,panOnDrag:o,onSelectionStart:i,onSelectionEnd:a,onPaneClick:l,onPaneContextMenu:c,onPaneScroll:u,onPaneMouseEnter:d,onPaneMouseMove:h,onPaneMouseLeave:f,children:p}=t;const v=(0,e.useRef)(null),m=Jr(),g=(0,e.useRef)(0),y=(0,e.useRef)(0),w=(0,e.useRef)(),{userSelectionActive:b,elementsSelectable:_,dragging:x}=Xr(va,V),S=()=>{m.setState({userSelectionActive:!1,userSelectionRect:null}),g.current=0,y.current=0},k=e=>{null===l||void 0===l||l(e),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1})},E=u?e=>u(e):void 0,C=_&&(n||b);return e.createElement("div",{className:D(["react-flow__pane",{dragging:x,selection:n}]),onClick:C?void 0:pa(k,v),onContextMenu:pa(e=>{Array.isArray(o)&&null!==o&&void 0!==o&&o.includes(2)?e.preventDefault():null===c||void 0===c||c(e)},v),onWheel:pa(E,v),onMouseEnter:C?void 0:d,onMouseDown:C?e=>{const{resetSelectedElements:t,domNode:r}=m.getState();if(w.current=null===r||void 0===r?void 0:r.getBoundingClientRect(),!_||!n||0!==e.button||e.target!==v.current||!w.current)return;const{x:o,y:a}=wo(e,w.current);t(),m.setState({userSelectionRect:{width:0,height:0,startX:o,startY:a,x:o,y:a}}),null===i||void 0===i||i(e)}:void 0,onMouseMove:C?e=>{var t,o;const{userSelectionRect:i,nodeInternals:a,edges:l,transform:c,onNodesChange:u,onEdgesChange:d,nodeOrigin:h,getNodes:f}=m.getState();if(!n||!w.current||!i)return;m.setState({userSelectionActive:!0,nodesSelectionActive:!1});const p=wo(e,w.current),v=null!==(t=i.startX)&&void 0!==t?t:0,b=null!==(o=i.startY)&&void 0!==o?o:0,_=s(s({},i),{},{x:p.x<v?p.x:v,y:p.y<b?p.y:b,width:Math.abs(p.x-v),height:Math.abs(p.y-b)}),x=f(),S=Qo(a,_,c,r===No.Partial,!0,h),k=ei(S,l).map(e=>e.id),E=S.map(e=>e.id);if(g.current!==E.length){g.current=E.length;const e=fa(x,E);e.length&&(null===u||void 0===u||u(e))}if(y.current!==k.length){y.current=k.length;const e=fa(l,k);e.length&&(null===d||void 0===d||d(e))}m.setState({userSelectionRect:_})}:h,onMouseUp:C?e=>{if(0!==e.button)return;const{userSelectionRect:t}=m.getState();!b&&t&&e.target===v.current&&(null===k||void 0===k||k(e)),m.setState({nodesSelectionActive:g.current>0}),S(),null===a||void 0===a||a(e)}:void 0,onMouseLeave:C?e=>{b&&(m.setState({nodesSelectionActive:g.current>0}),null===a||void 0===a||a(e)),S()}:f,ref:v,style:ea},p,e.createElement(la,null))});function ga(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const r=t.get(n);return!!r&&(!!r.selected||ga(r,t))}function ya(e,t,n){let r=e;do{var o;if(null!==(o=r)&&void 0!==o&&o.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function wa(e,t,n,r){return Array.from(e.values()).filter(n=>(n.selected||n.id===r)&&(!n.parentNode||n.parentId||!ga(n,e))&&(n.draggable||t&&"undefined"===typeof n.draggable)).map(e=>{var t,r,o,i;return{id:e.id,position:e.position||{x:0,y:0},positionAbsolute:e.positionAbsolute||{x:0,y:0},distance:{x:n.x-(null!==(t=null===(r=e.positionAbsolute)||void 0===r?void 0:r.x)&&void 0!==t?t:0),y:n.y-(null!==(o=null===(i=e.positionAbsolute)||void 0===i?void 0:i.y)&&void 0!==o?o:0)},delta:{x:0,y:0},extent:e.extent,parentNode:e.parentNode||e.parentId,parentId:e.parentNode||e.parentId,width:e.width,height:e.height,expandParent:e.expandParent}})}function ba(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[0,0],i=arguments.length>5?arguments[5]:void 0;const a=function(e,t){return t&&"parent"!==t?[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]:t}(e,e.extent||r);let s=a;const l=e.parentNode||e.parentId;if("parent"!==e.extent||e.expandParent){if(e.extent&&l&&"parent"!==e.extent){const t=n.get(l),{x:r,y:i}=$o(t,o).positionAbsolute;s=[[e.extent[0][0]+r,e.extent[0][1]+i],[e.extent[1][0]+r,e.extent[1][1]+i]]}}else if(l&&e.width&&e.height){const t=n.get(l),{x:r,y:i}=$o(t,o).positionAbsolute;s=t&&fo(r)&&fo(i)&&fo(t.width)&&fo(t.height)?[[r+e.width*o[0],i+e.height*o[1]],[r+t.width-e.width+e.width*o[0],i+t.height-e.height+e.height*o[1]]]:s}else null===i||void 0===i||i("005",Fr()),s=a;let c={x:0,y:0};if(l){const e=n.get(l);c=$o(e,o).positionAbsolute}const u=s&&"parent"!==s?ro(t,s):t;return{position:{x:u.x-c.x,y:u.y-c.y},positionAbsolute:u}}function _a(e){let{nodeId:t,dragItems:n,nodeInternals:r}=e;const o=n.map(e=>s(s({},r.get(e.id)),{},{position:e.position,positionAbsolute:e.positionAbsolute}));return[t?o.find(e=>e.id===t):o[0],o]}ma.displayName="Pane";const xa=(e,t,n,r)=>{const o=t.querySelectorAll(e);if(!o||!o.length)return null;const i=Array.from(o),a=t.getBoundingClientRect(),l=a.width*r[0],c=a.height*r[1];return i.map(e=>{const t=e.getBoundingClientRect();return s({id:e.getAttribute("data-handleid"),position:e.getAttribute("data-handlepos"),x:(t.left-a.left-l)/n,y:(t.top-a.top-c)/n},to(e))})};function Sa(e,t,n){return void 0===n?n:r=>{const o=t().nodeInternals.get(e);o&&n(r,s({},o))}}function ka(e){let{id:t,store:n,unselect:r=!1,nodeRef:o}=e;const{addSelectedNodes:i,unselectNodesAndEdges:a,multiSelectionActive:s,nodeInternals:l,onError:c}=n.getState(),u=l.get(t);u?(n.setState({nodesSelectionActive:!1}),u.selected?(r||u.selected&&s)&&(a({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var e;return null===o||void 0===o||null===(e=o.current)||void 0===e?void 0:e.blur()})):i([t])):null===c||void 0===c||c("012",Yr(t))}function Ea(e){return(t,n,r)=>null===e||void 0===e?void 0:e(t,r)}function Ca(t){let{nodeRef:n,disabled:r=!1,noDragClassName:o,handleSelector:i,nodeId:a,isSelectable:l,selectNodesOnDrag:c}=t;const u=Jr(),[d,h]=(0,e.useState)(!1),f=(0,e.useRef)([]),p=(0,e.useRef)({x:null,y:null}),v=(0,e.useRef)(0),m=(0,e.useRef)(null),g=(0,e.useRef)({x:0,y:0}),y=(0,e.useRef)(null),w=(0,e.useRef)(!1),b=(0,e.useRef)(!1),_=(0,e.useRef)(!1),x=function(){const t=Jr(),n=(0,e.useCallback)(e=>{let{sourceEvent:n}=e;const{transform:r,snapGrid:o,snapToGrid:i}=t.getState(),a=n.touches?n.touches[0].clientX:n.clientX,l=n.touches?n.touches[0].clientY:n.clientY,c={x:(a-r[0])/r[2],y:(l-r[1])/r[2]};return s({xSnapped:i?o[0]*Math.round(c.x/o[0]):c.x,ySnapped:i?o[1]*Math.round(c.y/o[1]):c.y},c)},[]);return n}();return(0,e.useEffect)(()=>{if(null!==n&&void 0!==n&&n.current){const e=ut(n.current),t=e=>{let{x:t,y:n}=e;const{nodeInternals:r,onNodeDrag:o,onSelectionDrag:i,updateNodePositions:s,nodeExtent:l,snapGrid:c,snapToGrid:d,nodeOrigin:v,onError:m}=u.getState();p.current={x:t,y:n};let g=!1,w={x:0,y:0,x2:0,y2:0};if(f.current.length>1&&l){const e=Zo(f.current,v);w=lo(e)}if(f.current=f.current.map(e=>{const o={x:t-e.distance.x,y:n-e.distance.y};d&&(o.x=c[0]*Math.round(o.x/c[0]),o.y=c[1]*Math.round(o.y/c[1]));const i=[[l[0][0],l[0][1]],[l[1][0],l[1][1]]];var a,s;f.current.length>1&&l&&!e.extent&&(i[0][0]=e.positionAbsolute.x-w.x+l[0][0],i[1][0]=e.positionAbsolute.x+(null!==(a=e.width)&&void 0!==a?a:0)-w.x2+l[1][0],i[0][1]=e.positionAbsolute.y-w.y+l[0][1],i[1][1]=e.positionAbsolute.y+(null!==(s=e.height)&&void 0!==s?s:0)-w.y2+l[1][1]);const u=ba(e,o,r,i,v,m);return g=g||e.position.x!==u.position.x||e.position.y!==u.position.y,e.position=u.position,e.positionAbsolute=u.positionAbsolute,e}),!g)return;s(f.current,!0,!0),h(!0);const b=a?o:Ea(i);if(b&&y.current){const[e,t]=_a({nodeId:a,dragItems:f.current,nodeInternals:r});b(y.current,e,t)}},s=()=>{if(!m.current)return;const[e,n]=io(g.current,m.current);if(0!==e||0!==n){var r,o;const{transform:i,panBy:a}=u.getState();p.current.x=(null!==(r=p.current.x)&&void 0!==r?r:0)-e/i[2],p.current.y=(null!==(o=p.current.y)&&void 0!==o?o:0)-n/i[2],a({x:e,y:n})&&t(p.current)}v.current=requestAnimationFrame(s)},d=e=>{const{nodeInternals:t,multiSelectionActive:r,nodesDraggable:o,unselectNodesAndEdges:i,onNodeDragStart:s,onSelectionDragStart:d}=u.getState();b.current=!0;const h=a?s:Ea(d);var v;c&&l||r||!a||(null!==(v=t.get(a))&&void 0!==v&&v.selected||i());a&&l&&c&&ka({id:a,store:u,nodeRef:n});const m=x(e);if(p.current=m,f.current=wa(t,o,m,a),h&&f.current){const[n,r]=_a({nodeId:a,dragItems:f.current,nodeInternals:t});h(e.sourceEvent,n,r)}};if(!r){const r=function(){var e,t,n,r,o=jr,i=Tr,a=Or,s=Ir,l={},c=J("start","drag","end"),u=0,d=0;function h(e){e.on("mousedown.drag",f).filter(s).on("touchstart.drag",m).on("touchmove.drag",g,dt).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(a,s){if(!r&&o.call(this,a,s)){var l=w(this,i.call(this,a,s),a,s,"mouse");l&&(ut(a.view).on("mousemove.drag",p,ht).on("mouseup.drag",v,ht),vt(a.view),ft(a),n=!1,e=a.clientX,t=a.clientY,l("start",a))}}function p(r){if(pt(r),!n){var o=r.clientX-e,i=r.clientY-t;n=o*o+i*i>d}l.mouse("drag",r)}function v(e){ut(e.view).on("mousemove.drag mouseup.drag",null),mt(e.view,n),pt(e),l.mouse("end",e)}function m(e,t){if(o.call(this,e,t)){var n,r,a=e.changedTouches,s=i.call(this,e,t),l=a.length;for(n=0;n<l;++n)(r=w(this,s,e,t,a[n].identifier,a[n]))&&(ft(e),r("start",e,a[n]))}}function g(e){var t,n,r=e.changedTouches,o=r.length;for(t=0;t<o;++t)(n=l[r[t].identifier])&&(pt(e),n("drag",e,r[t]))}function y(e){var t,n,o=e.changedTouches,i=o.length;for(r&&clearTimeout(r),r=setTimeout(function(){r=null},500),t=0;t<i;++t)(n=l[o[t].identifier])&&(ft(e),n("end",e,o[t]))}function w(e,t,n,r,o,i){var s,d,f,p=c.copy(),v=wt(i||n,t);if(null!=(f=a.call(e,new Nr("beforestart",{sourceEvent:n,target:h,identifier:o,active:u,x:v[0],y:v[1],dx:0,dy:0,dispatch:p}),r)))return s=f.x-v[0]||0,d=f.y-v[1]||0,function n(i,a,c){var m,g=v;switch(i){case"start":l[o]=n,m=u++;break;case"end":delete l[o],--u;case"drag":v=wt(c||a,t),m=u}p.call(i,e,new Nr(i,{sourceEvent:a,subject:f,target:h,identifier:o,active:m,x:v[0]+s,y:v[1]+d,dx:v[0]-g[0],dy:v[1]-g[1],dispatch:p}),r)}}return h.filter=function(e){return arguments.length?(o="function"===typeof e?e:Cr(!!e),h):o},h.container=function(e){return arguments.length?(i="function"===typeof e?e:Cr(e),h):i},h.subject=function(e){return arguments.length?(a="function"===typeof e?e:Cr(e),h):a},h.touchable=function(e){return arguments.length?(s="function"===typeof e?e:Cr(!!e),h):s},h.on=function(){var e=c.on.apply(c,arguments);return e===c?h:e},h.clickDistance=function(e){return arguments.length?(d=(e=+e)*e,h):Math.sqrt(d)},h}().on("start",e=>{const{domNode:t,nodeDragThreshold:n}=u.getState();0===n&&d(e),_.current=!1;const r=x(e);p.current=r,m.current=(null===t||void 0===t?void 0:t.getBoundingClientRect())||null,g.current=wo(e.sourceEvent,m.current)}).on("drag",e=>{const n=x(e),{autoPanOnNodeDrag:r,nodeDragThreshold:o}=u.getState();if("touchmove"===e.sourceEvent.type&&e.sourceEvent.touches.length>1&&(_.current=!0),!_.current){if(!w.current&&b.current&&r&&(w.current=!0,s()),!b.current){var i,a,l,c;const t=n.xSnapped-(null!==(i=null===p||void 0===p||null===(a=p.current)||void 0===a?void 0:a.x)&&void 0!==i?i:0),r=n.ySnapped-(null!==(l=null===p||void 0===p||null===(c=p.current)||void 0===c?void 0:c.y)&&void 0!==l?l:0);Math.sqrt(t*t+r*r)>o&&d(e)}(p.current.x!==n.xSnapped||p.current.y!==n.ySnapped)&&f.current&&b.current&&(y.current=e.sourceEvent,g.current=wo(e.sourceEvent,m.current),t(n))}}).on("end",e=>{if(b.current&&!_.current&&(h(!1),w.current=!1,b.current=!1,cancelAnimationFrame(v.current),f.current)){const{updateNodePositions:t,nodeInternals:n,onNodeDragStop:r,onSelectionDragStop:o}=u.getState(),i=a?r:Ea(o);if(t(f.current,!1,!1),i){const[t,r]=_a({nodeId:a,dragItems:f.current,nodeInternals:n});i(e.sourceEvent,t,r)}}}).filter(e=>{const t=e.target;return!e.button&&(!o||!ya(t,".".concat(o),n))&&(!i||ya(t,i,n))});return e.call(r),()=>{e.on(".drag",null)}}e.on(".drag",null)}},[n,r,o,i,l,u,a,c,x]),d}function Na(){const t=Jr();return(0,e.useCallback)(e=>{const{nodeInternals:n,nodeExtent:r,updateNodePositions:o,getNodes:i,snapToGrid:a,snapGrid:s,onError:l,nodesDraggable:c}=t.getState(),u=i().filter(e=>e.selected&&(e.draggable||c&&"undefined"===typeof e.draggable)),d=a?s[0]:5,h=a?s[1]:5,f=e.isShiftPressed?4:1,p=e.x*d*f,v=e.y*h*f;o(u.map(e=>{if(e.positionAbsolute){const t={x:e.positionAbsolute.x+p,y:e.positionAbsolute.y+v};a&&(t.x=s[0]*Math.round(t.x/s[0]),t.y=s[1]*Math.round(t.y/s[1]));const{positionAbsolute:o,position:i}=ba(e,t,n,r,void 0,l);e.position=i,e.positionAbsolute=o}return e}),!0,!1)},[])}const ja={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Ta=t=>{const n=n=>{let{id:r,type:o,data:i,xPos:a,yPos:l,xPosOrigin:c,yPosOrigin:u,selected:d,onClick:h,onMouseEnter:f,onMouseMove:p,onMouseLeave:v,onContextMenu:m,onDoubleClick:g,style:y,className:w,isDraggable:b,isSelectable:_,isConnectable:x,isFocusable:S,selectNodesOnDrag:k,sourcePosition:E,targetPosition:C,hidden:N,resizeObserver:j,dragHandle:T,zIndex:O,isParent:I,noDragClassName:P,noPanClassName:A,initialized:R,disableKeyboardA11y:M,ariaLabel:L,rfId:z,hasHandleBounds:U}=n;const B=Jr(),F=(0,e.useRef)(null),K=(0,e.useRef)(null),q=(0,e.useRef)(E),V=(0,e.useRef)(C),W=(0,e.useRef)(o),H=_||b||h||f||p||v,Y=Na(),G=Sa(r,B.getState,f),X=Sa(r,B.getState,p),J=Sa(r,B.getState,v),$=Sa(r,B.getState,m),Z=Sa(r,B.getState,g);(0,e.useEffect)(()=>()=>{K.current&&(null===j||void 0===j||j.unobserve(K.current),K.current=null)},[]),(0,e.useEffect)(()=>{if(F.current&&!N){const e=F.current;R&&U&&K.current===e||(K.current&&(null===j||void 0===j||j.unobserve(K.current)),null===j||void 0===j||j.observe(e),K.current=e)}},[N,R,U]),(0,e.useEffect)(()=>{const e=W.current!==o,t=q.current!==E,n=V.current!==C;F.current&&(e||t||n)&&(e&&(W.current=o),t&&(q.current=E),n&&(V.current=C),B.getState().updateNodeDimensions([{id:r,nodeElement:F.current,forceUpdate:!0}]))},[r,o,E,C]);const Q=Ca({nodeRef:F,disabled:N||!b,noDragClassName:P,handleSelector:T,nodeId:r,isSelectable:_,selectNodesOnDrag:k});return N?null:e.createElement("div",{className:D(["react-flow__node","react-flow__node-".concat(o),{[A]:b},w,{selected:d,selectable:_,parent:I,dragging:Q}]),ref:F,style:s({zIndex:O,transform:"translate(".concat(c,"px,").concat(u,"px)"),pointerEvents:H?"all":"none",visibility:R?"visible":"hidden"},y),"data-id":r,"data-testid":"rf__node-".concat(r),onMouseEnter:G,onMouseMove:X,onMouseLeave:J,onContextMenu:$,onClick:e=>{const{nodeDragThreshold:t}=B.getState();if(_&&(!k||!b||t>0)&&ka({id:r,store:B,nodeRef:F}),h){const t=B.getState().nodeInternals.get(r);t&&h(e,s({},t))}},onDoubleClick:Z,onKeyDown:S?e=>{if(!go(e)&&!M)if(vo.includes(e.key)&&_){const t="Escape"===e.key;ka({id:r,store:B,unselect:t,nodeRef:F})}else b&&d&&Object.prototype.hasOwnProperty.call(ja,e.key)&&(B.setState({ariaLiveMessage:"Moved selected node ".concat(e.key.replace("Arrow","").toLowerCase(),". New position, x: ").concat(~~a,", y: ").concat(~~l)}),Y({x:ja[e.key].x,y:ja[e.key].y,isShiftPressed:e.shiftKey}))}:void 0,tabIndex:S?0:void 0,role:S?"button":void 0,"aria-describedby":M?void 0:"".concat(Ri,"-").concat(z),"aria-label":L},e.createElement(Ho,{value:r},e.createElement(t,{id:r,data:i,type:o,xPos:a,yPos:l,selected:d,isConnectable:x,sourcePosition:E,targetPosition:C,dragging:Q,dragHandle:T,zIndex:O})))};return n.displayName="NodeWrapper",(0,e.memo)(n)};const Oa=e=>{const t=e.getNodes().filter(e=>e.selected);return s(s({},Zo(t,e.nodeOrigin)),{},{transformString:"translate(".concat(e.transform[0],"px,").concat(e.transform[1],"px) scale(").concat(e.transform[2],")"),userSelectionActive:e.userSelectionActive})};var Ia=(0,e.memo)(function(t){let{onSelectionContextMenu:n,noPanClassName:r,disableKeyboardA11y:o}=t;const i=Jr(),{width:a,height:s,x:l,y:c,transformString:u,userSelectionActive:d}=Xr(Oa,V),h=Na(),f=(0,e.useRef)(null);if((0,e.useEffect)(()=>{var e;o||(null===(e=f.current)||void 0===e||e.focus({preventScroll:!0}))},[o]),Ca({nodeRef:f}),d||!a||!s)return null;const p=n?e=>{const t=i.getState().getNodes().filter(e=>e.selected);n(e,t)}:void 0;return e.createElement("div",{className:D(["react-flow__nodesselection","react-flow__container",r]),style:{transform:u}},e.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:o?void 0:-1,onKeyDown:o?void 0:e=>{Object.prototype.hasOwnProperty.call(ja,e.key)&&h({x:ja[e.key].x,y:ja[e.key].y,isShiftPressed:e.shiftKey})},style:{width:a,height:s,top:c,left:l}}))});const Pa=e=>e.nodesSelectionActive,Aa=t=>{let{children:n,onPaneClick:r,onPaneMouseEnter:o,onPaneMouseMove:i,onPaneMouseLeave:a,onPaneContextMenu:s,onPaneScroll:l,deleteKeyCode:c,onMove:u,onMoveStart:d,onMoveEnd:h,selectionKeyCode:f,selectionOnDrag:p,selectionMode:v,onSelectionStart:m,onSelectionEnd:g,multiSelectionKeyCode:y,panActivationKeyCode:w,zoomActivationKeyCode:b,elementsSelectable:_,zoomOnScroll:x,zoomOnPinch:S,panOnScroll:k,panOnScrollSpeed:E,panOnScrollMode:C,zoomOnDoubleClick:N,panOnDrag:j,defaultViewport:T,translateExtent:O,minZoom:I,maxZoom:P,preventScrolling:A,onSelectionContextMenu:R,noWheelClassName:D,noPanClassName:M,disableKeyboardA11y:L}=t;const z=Xr(Pa),U=Ui(f),B=Ui(w),F=B||j,K=B||k,q=U||p&&!0!==F;return(t=>{let{deleteKeyCode:n,multiSelectionKeyCode:r}=t;const o=Jr(),{deleteElements:i}=Zi(),a=Ui(n,Qi),s=Ui(r);(0,e.useEffect)(()=>{if(a){const{edges:e,getNodes:t}=o.getState(),n=t().filter(e=>e.selected),r=e.filter(e=>e.selected);i({nodes:n,edges:r}),o.setState({nodesSelectionActive:!1})}},[a]),(0,e.useEffect)(()=>{o.setState({multiSelectionActive:s})},[s])})({deleteKeyCode:c,multiSelectionKeyCode:y}),e.createElement(aa,{onMove:u,onMoveStart:d,onMoveEnd:h,onPaneContextMenu:s,elementsSelectable:_,zoomOnScroll:x,zoomOnPinch:S,panOnScroll:K,panOnScrollSpeed:E,panOnScrollMode:C,zoomOnDoubleClick:N,panOnDrag:!U&&F,defaultViewport:T,translateExtent:O,minZoom:I,maxZoom:P,zoomActivationKeyCode:b,preventScrolling:A,noWheelClassName:D,noPanClassName:M},e.createElement(ma,{onSelectionStart:m,onSelectionEnd:g,onPaneClick:r,onPaneMouseEnter:o,onPaneMouseMove:i,onPaneMouseLeave:a,onPaneContextMenu:s,onPaneScroll:l,panOnDrag:F,isSelecting:!!q,selectionMode:v},n,z&&e.createElement(Ia,{onSelectionContextMenu:R,noPanClassName:M,disableKeyboardA11y:L})))};Aa.displayName="FlowRenderer";var Ra=(0,e.memo)(Aa);function Da(e){const t={input:Ta(e.input||yi),default:Ta(e.default||mi),output:Ta(e.output||bi),group:Ta(e.group||_i)},n=Object.keys(e).filter(e=>!["input","default","output","group"].includes(e)).reduce((t,n)=>(t[n]=Ta(e[n]||mi),t),{});return s(s({},t),n)}const Ma=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),La=t=>{const{nodesDraggable:n,nodesConnectable:r,nodesFocusable:o,elementsSelectable:i,updateNodeDimensions:a,onError:s}=Xr(Ma,V),l=(c=t.onlyRenderVisibleElements,Xr((0,e.useCallback)(e=>c?Qo(e.nodeInternals,{x:0,y:0,width:e.width,height:e.height},e.transform,!0):e.getNodes(),[c])));var c;const u=(0,e.useRef)(),d=(0,e.useMemo)(()=>{if("undefined"===typeof ResizeObserver)return null;const e=new ResizeObserver(e=>{const t=e.map(e=>({id:e.target.getAttribute("data-id"),nodeElement:e.target,forceUpdate:!0}));a(t)});return u.current=e,e},[]);return(0,e.useEffect)(()=>()=>{var e;null===u||void 0===u||null===(e=u.current)||void 0===e||e.disconnect()},[]),e.createElement("div",{className:"react-flow__nodes",style:ea},l.map(a=>{var l,c,u,h,f,p,v,m;let g=a.type||"default";t.nodeTypes[g]||(null===s||void 0===s||s("003",Ur(g)),g="default");const y=t.nodeTypes[g]||t.nodeTypes.default,w=!!(a.draggable||n&&"undefined"===typeof a.draggable),b=!!(a.selectable||i&&"undefined"===typeof a.selectable),_=!!(a.connectable||r&&"undefined"===typeof a.connectable),x=!!(a.focusable||o&&"undefined"===typeof a.focusable),S=t.nodeExtent?ro(a.positionAbsolute,t.nodeExtent):a.positionAbsolute,k=null!==(l=null===S||void 0===S?void 0:S.x)&&void 0!==l?l:0,E=null!==(c=null===S||void 0===S?void 0:S.y)&&void 0!==c?c:0,C=(e=>{let{x:t,y:n,width:r,height:o,origin:i}=e;return r&&o?i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:t,y:n}:{x:t-r*i[0],y:n-o*i[1]}:{x:t,y:n}})({x:k,y:E,width:null!==(u=a.width)&&void 0!==u?u:0,height:null!==(h=a.height)&&void 0!==h?h:0,origin:t.nodeOrigin});return e.createElement(y,{key:a.id,id:a.id,className:a.className,style:a.style,type:g,data:a.data,sourcePosition:a.sourcePosition||Oo.Bottom,targetPosition:a.targetPosition||Oo.Top,hidden:a.hidden,xPos:k,yPos:E,xPosOrigin:C.x,yPosOrigin:C.y,selectNodesOnDrag:t.selectNodesOnDrag,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,selected:!!a.selected,isDraggable:w,isSelectable:b,isConnectable:_,isFocusable:x,resizeObserver:d,dragHandle:a.dragHandle,zIndex:null!==(f=null===(p=a[po])||void 0===p?void 0:p.z)&&void 0!==f?f:0,isParent:!(null===(v=a[po])||void 0===v||!v.isParent),noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,initialized:!!a.width&&!!a.height,rfId:t.rfId,disableKeyboardA11y:t.disableKeyboardA11y,ariaLabel:a.ariaLabel,hasHandleBounds:!(null===(m=a[po])||void 0===m||!m.handleBounds)})}))};La.displayName="NodeRenderer";var za=(0,e.memo)(La);const Ua=(e,t,n)=>n===Oo.Left?e-t:n===Oo.Right?e+t:e,Ba=(e,t,n)=>n===Oo.Top?e-t:n===Oo.Bottom?e+t:e,Fa="react-flow__edgeupdater",Ka=t=>{let{position:n,centerX:r,centerY:o,radius:i=10,onMouseDown:a,onMouseEnter:s,onMouseOut:l,type:c}=t;return e.createElement("circle",{onMouseDown:a,onMouseEnter:s,onMouseOut:l,className:D([Fa,"".concat(Fa,"-").concat(c)]),cx:Ua(r,i,n),cy:Ba(o,i,n),r:i,stroke:"transparent",fill:"transparent"})},qa=()=>!0;var Va=t=>{const n=n=>{let{id:r,className:o,type:i,data:a,onClick:s,onEdgeDoubleClick:l,selected:c,animated:u,label:d,labelStyle:h,labelShowBg:f,labelBgStyle:p,labelBgPadding:v,labelBgBorderRadius:m,style:g,source:y,target:w,sourceX:b,sourceY:_,targetX:x,targetY:S,sourcePosition:k,targetPosition:E,elementsSelectable:C,hidden:N,sourceHandleId:j,targetHandleId:T,onContextMenu:O,onMouseEnter:I,onMouseMove:P,onMouseLeave:A,reconnectRadius:R,onReconnect:M,onReconnectStart:L,onReconnectEnd:z,markerEnd:U,markerStart:B,rfId:F,ariaLabel:K,isFocusable:q,isReconnectable:V,pathOptions:W,interactionWidth:H,disableKeyboardA11y:Y}=n;const G=(0,e.useRef)(null),[X,J]=(0,e.useState)(!1),[$,Z]=(0,e.useState)(!1),Q=Jr(),ee=(0,e.useMemo)(()=>"url('#".concat(Go(B,F),"')"),[B,F]),te=(0,e.useMemo)(()=>"url('#".concat(Go(U,F),"')"),[U,F]);if(N)return null;const ne=xo(r,Q.getState,l),re=xo(r,Q.getState,O),oe=xo(r,Q.getState,I),ie=xo(r,Q.getState,P),ae=xo(r,Q.getState,A),se=(e,t)=>{if(0!==e.button)return;const{edges:n,isValidConnection:o}=Q.getState(),i=t?w:y,a=(t?T:j)||null,s=t?"target":"source",l=o||qa,c=t,u=n.find(e=>e.id===r);Z(!0),null===L||void 0===L||L(e,u,s);ui({event:e,handleId:a,nodeId:i,onConnect:e=>null===M||void 0===M?void 0:M(u,e),isTarget:c,getState:Q.getState,setState:Q.setState,isValidConnection:l,edgeUpdaterType:s,onReconnectEnd:e=>{Z(!1),null===z||void 0===z||z(e,u,s)}})},le=()=>J(!0),ce=()=>J(!1),ue=!C&&!s;return e.createElement("g",{className:D(["react-flow__edge","react-flow__edge-".concat(i),o,{selected:c,animated:u,inactive:ue,updating:X}]),onClick:e=>{const{edges:t,addSelectedEdges:n,unselectNodesAndEdges:o,multiSelectionActive:i}=Q.getState(),a=t.find(e=>e.id===r);if(a){var l;if(C)if(Q.setState({nodesSelectionActive:!1}),a.selected&&i)o({nodes:[],edges:[a]}),null===(l=G.current)||void 0===l||l.blur();else n([r]);s&&s(e,a)}},onDoubleClick:ne,onContextMenu:re,onMouseEnter:oe,onMouseMove:ie,onMouseLeave:ae,onKeyDown:q?e=>{if(!Y&&vo.includes(e.key)&&C){const{unselectNodesAndEdges:n,addSelectedEdges:o,edges:i}=Q.getState();var t;if("Escape"===e.key)null===(t=G.current)||void 0===t||t.blur(),n({edges:[i.find(e=>e.id===r)]});else o([r])}}:void 0,tabIndex:q?0:void 0,role:q?"button":"img","data-testid":"rf__edge-".concat(r),"aria-label":null===K?void 0:K||"Edge from ".concat(y," to ").concat(w),"aria-describedby":q?"".concat(Di,"-").concat(F):void 0,ref:G},!$&&e.createElement(t,{id:r,source:y,target:w,selected:c,animated:u,label:d,labelStyle:h,labelShowBg:f,labelBgStyle:p,labelBgPadding:v,labelBgBorderRadius:m,data:a,style:g,sourceX:b,sourceY:_,targetX:x,targetY:S,sourcePosition:k,targetPosition:E,sourceHandleId:j,targetHandleId:T,markerStart:ee,markerEnd:te,pathOptions:W,interactionWidth:H}),V&&e.createElement(e.Fragment,null,("source"===V||!0===V)&&e.createElement(Ka,{position:k,centerX:b,centerY:_,radius:R,onMouseDown:e=>se(e,!0),onMouseEnter:le,onMouseOut:ce,type:"source"}),("target"===V||!0===V)&&e.createElement(Ka,{position:E,centerX:x,centerY:S,radius:R,onMouseDown:e=>se(e,!1),onMouseEnter:le,onMouseOut:ce,type:"target"})))};return n.displayName="EdgeWrapper",(0,e.memo)(n)};function Wa(e){const t={default:Va(e.default||Vo),straight:Va(e.bezier||Bo),step:Va(e.step||Uo),smoothstep:Va(e.step||zo),simplebezier:Va(e.simplebezier||Ao)},n=Object.keys(e).filter(e=>!["default","bezier"].includes(e)).reduce((t,n)=>(t[n]=Va(e[n]||Vo),t),{});return s(s({},t),n)}function Ha(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=((null===n||void 0===n?void 0:n.x)||0)+t.x,o=((null===n||void 0===n?void 0:n.y)||0)+t.y,i=(null===n||void 0===n?void 0:n.width)||t.width,a=(null===n||void 0===n?void 0:n.height)||t.height;switch(e){case Oo.Top:return{x:r+i/2,y:o};case Oo.Right:return{x:r+i,y:o+a/2};case Oo.Bottom:return{x:r+i/2,y:o+a};case Oo.Left:return{x:r,y:o+a/2}}}function Ya(e,t){return e?1!==e.length&&t?t&&e.find(e=>e.id===t)||null:e[0]:null}function Ga(e){var t,n,r,o,i;const a=(null===e||void 0===e||null===(t=e[po])||void 0===t?void 0:t.handleBounds)||null,s=a&&(null===e||void 0===e?void 0:e.width)&&(null===e||void 0===e?void 0:e.height)&&"undefined"!==typeof(null===e||void 0===e||null===(n=e.positionAbsolute)||void 0===n?void 0:n.x)&&"undefined"!==typeof(null===e||void 0===e||null===(r=e.positionAbsolute)||void 0===r?void 0:r.y);return[{x:(null===e||void 0===e||null===(o=e.positionAbsolute)||void 0===o?void 0:o.x)||0,y:(null===e||void 0===e||null===(i=e.positionAbsolute)||void 0===i?void 0:i.y)||0,width:(null===e||void 0===e?void 0:e.width)||0,height:(null===e||void 0===e?void 0:e.height)||0},a,!!s]}const Xa=[{level:0,isMaxLevel:!0,edges:[]}];function Ja(t,n,r){const o=Xr((0,e.useCallback)(e=>t?e.edges.filter(t=>{const r=n.get(t.source),o=n.get(t.target);return(null===r||void 0===r?void 0:r.width)&&(null===r||void 0===r?void 0:r.height)&&(null===o||void 0===o?void 0:o.width)&&(null===o||void 0===o?void 0:o.height)&&function(e){let{sourcePos:t,targetPos:n,sourceWidth:r,sourceHeight:o,targetWidth:i,targetHeight:a,width:s,height:l,transform:c}=e;const u={x:Math.min(t.x,n.x),y:Math.min(t.y,n.y),x2:Math.max(t.x+r,n.x+i),y2:Math.max(t.y+o,n.y+a)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const d=lo({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:s/c[2],height:l/c[2]}),h=Math.max(0,Math.min(d.x2,u.x2)-Math.max(d.x,u.x)),f=Math.max(0,Math.min(d.y2,u.y2)-Math.max(d.y,u.y));return Math.ceil(h*f)>0}({sourcePos:r.positionAbsolute||{x:0,y:0},targetPos:o.positionAbsolute||{x:0,y:0},sourceWidth:r.width,sourceHeight:r.height,targetWidth:o.width,targetHeight:o.height,width:e.width,height:e.height,transform:e.transform})}):e.edges,[t,n]));return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=-1;const o=e.reduce((e,o)=>{const i=fo(o.zIndex);let a=i?o.zIndex:0;if(n){var s,l;const e=t.get(o.target),n=t.get(o.source),r=o.selected||(null===e||void 0===e?void 0:e.selected)||(null===n||void 0===n?void 0:n.selected),c=Math.max((null===n||void 0===n||null===(s=n[po])||void 0===s?void 0:s.z)||0,(null===e||void 0===e||null===(l=e[po])||void 0===l?void 0:l.z)||0,1e3);a=(i?o.zIndex:0)+(r?c:0)}return e[a]?e[a].push(o):e[a]=[o],r=a>r?a:r,e},{}),i=Object.entries(o).map(e=>{let[t,n]=e;const o=+t;return{edges:n,level:o,isMaxLevel:o===r}});return 0===i.length?Xa:i}(o,n,r)}const $a={[To.Arrow]:t=>{let{color:n="none",strokeWidth:r=1}=t;return e.createElement("polyline",{style:{stroke:n,strokeWidth:r},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"})},[To.ArrowClosed]:t=>{let{color:n="none",strokeWidth:r=1}=t;return e.createElement("polyline",{style:{stroke:n,fill:n,strokeWidth:r},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})}};const Za=t=>{let{id:n,type:r,color:o,width:i=12.5,height:a=12.5,markerUnits:s="strokeWidth",strokeWidth:l,orient:c="auto-start-reverse"}=t;const u=function(t){const n=Jr();return(0,e.useMemo)(()=>{var e,r;return Object.prototype.hasOwnProperty.call($a,t)?$a[t]:(null===(e=(r=n.getState()).onError)||void 0===e||e.call(r,"009",qr(t)),null)},[t])}(r);return u?e.createElement("marker",{className:"react-flow__arrowhead",id:n,markerWidth:"".concat(i),markerHeight:"".concat(a),viewBox:"-10 -10 20 20",markerUnits:s,orient:c,refX:"0",refY:"0"},e.createElement(u,{color:o,strokeWidth:l})):null},Qa=t=>{let{defaultColor:n,rfId:r}=t;const o=Xr((0,e.useCallback)((e=>{let{defaultColor:t,rfId:n}=e;return e=>{const r=[];return e.edges.reduce((e,o)=>([o.markerStart,o.markerEnd].forEach(o=>{if(o&&"object"===typeof o){const i=Go(o,n);r.includes(i)||(e.push(s({id:i,color:o.color||t},o)),r.push(i))}}),e),[]).sort((e,t)=>e.id.localeCompare(t.id))}})({defaultColor:n,rfId:r}),[n,r]),(e,t)=>!(e.length!==t.length||e.some((e,n)=>e.id!==t[n].id)));return e.createElement("defs",null,o.map(t=>e.createElement(Za,{id:t.id,key:t.id,type:t.type,color:t.color,width:t.width,height:t.height,markerUnits:t.markerUnits,strokeWidth:t.strokeWidth,orient:t.orient})))};Qa.displayName="MarkerDefinitions";var es=(0,e.memo)(Qa);const ts=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),ns=t=>{let{defaultMarkerColor:n,onlyRenderVisibleElements:r,elevateEdgesOnSelect:o,rfId:i,edgeTypes:a,noPanClassName:s,onEdgeContextMenu:l,onEdgeMouseEnter:c,onEdgeMouseMove:u,onEdgeMouseLeave:d,onEdgeClick:h,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:v,onReconnectEnd:m,reconnectRadius:g,children:y,disableKeyboardA11y:w}=t;const{edgesFocusable:b,edgesUpdatable:_,elementsSelectable:x,width:S,height:k,connectionMode:E,nodeInternals:C,onError:N}=Xr(ts,V),j=Ja(r,C,o);return S?e.createElement(e.Fragment,null,j.map(t=>{let{level:r,edges:o,isMaxLevel:y}=t;return e.createElement("svg",{key:r,style:{zIndex:r},width:S,height:k,className:"react-flow__edges react-flow__container"},y&&e.createElement(es,{defaultColor:n,rfId:i}),e.createElement("g",null,o.map(t=>{var n,r;const[o,y,S]=Ga(C.get(t.source)),[k,j,T]=Ga(C.get(t.target));if(!S||!T)return null;let O=t.type||"default";a[O]||(null===N||void 0===N||N("011",Hr(O)),O="default");const I=a[O]||a.default,P=E===Eo.Strict?j.target:(null!==(n=j.target)&&void 0!==n?n:[]).concat(null!==(r=j.source)&&void 0!==r?r:[]),A=Ya(y.source,t.sourceHandle),R=Ya(P,t.targetHandle),M=(null===A||void 0===A?void 0:A.position)||Oo.Bottom,L=(null===R||void 0===R?void 0:R.position)||Oo.Top,z=!!(t.focusable||b&&"undefined"===typeof t.focusable),U=t.reconnectable||t.updatable,B="undefined"!==typeof p&&(U||_&&"undefined"===typeof U);if(!A||!R)return null===N||void 0===N||N("008",Vr(A,t)),null;const{sourceX:F,sourceY:K,targetX:q,targetY:V}=((e,t,n,r,o,i)=>{const a=Ha(n,e,t),s=Ha(i,r,o);return{sourceX:a.x,sourceY:a.y,targetX:s.x,targetY:s.y}})(o,A,M,k,R,L);return e.createElement(I,{key:t.id,id:t.id,className:D([t.className,s]),type:O,data:t.data,selected:!!t.selected,animated:!!t.animated,hidden:!!t.hidden,label:t.label,labelStyle:t.labelStyle,labelShowBg:t.labelShowBg,labelBgStyle:t.labelBgStyle,labelBgPadding:t.labelBgPadding,labelBgBorderRadius:t.labelBgBorderRadius,style:t.style,source:t.source,target:t.target,sourceHandleId:t.sourceHandle,targetHandleId:t.targetHandle,markerEnd:t.markerEnd,markerStart:t.markerStart,sourceX:F,sourceY:K,targetX:q,targetY:V,sourcePosition:M,targetPosition:L,elementsSelectable:x,onContextMenu:l,onMouseEnter:c,onMouseMove:u,onMouseLeave:d,onClick:h,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:v,onReconnectEnd:m,reconnectRadius:g,rfId:i,ariaLabel:t.ariaLabel,isFocusable:z,isReconnectable:B,pathOptions:"pathOptions"in t?t.pathOptions:void 0,interactionWidth:t.interactionWidth,disableKeyboardA11y:w})})))}),y):null};ns.displayName="EdgeRenderer";var rs=(0,e.memo)(ns);const os=e=>"translate(".concat(e.transform[0],"px,").concat(e.transform[1],"px) scale(").concat(e.transform[2],")");function is(t){let{children:n}=t;const r=Xr(os);return e.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:r}},n)}const as={[Oo.Left]:Oo.Right,[Oo.Right]:Oo.Left,[Oo.Top]:Oo.Bottom,[Oo.Bottom]:Oo.Top},ss=t=>{var n,r,o,i,a,l,c;let{nodeId:u,handleType:d,style:h,type:f=jo.Bezier,CustomComponent:p,connectionStatus:v}=t;const{fromNode:m,handleId:g,toX:y,toY:w,connectionMode:b}=Xr((0,e.useCallback)(e=>({fromNode:e.nodeInternals.get(u),handleId:e.connectionHandleId,toX:(e.connectionPosition.x-e.transform[0])/e.transform[2],toY:(e.connectionPosition.y-e.transform[1])/e.transform[2],connectionMode:e.connectionMode}),[u]),V),_=null===m||void 0===m||null===(n=m[po])||void 0===n?void 0:n.handleBounds;let x=null===_||void 0===_?void 0:_[d];if(b===Eo.Loose&&(x=x||(null===_||void 0===_?void 0:_["source"===d?"target":"source"])),!m||!x)return null;const S=g?x.find(e=>e.id===g):x[0],k=S?S.x+S.width/2:(null!==(r=m.width)&&void 0!==r?r:0)/2,E=S?S.y+S.height/2:null!==(o=m.height)&&void 0!==o?o:0,C=(null!==(i=null===(a=m.positionAbsolute)||void 0===a?void 0:a.x)&&void 0!==i?i:0)+k,N=(null!==(l=null===(c=m.positionAbsolute)||void 0===c?void 0:c.y)&&void 0!==l?l:0)+E,j=null===S||void 0===S?void 0:S.position,T=j?as[j]:null;if(!j||!T)return null;if(p)return e.createElement(p,{connectionLineType:f,connectionLineStyle:h,fromNode:m,fromHandle:S,fromX:C,fromY:N,toX:y,toY:w,fromPosition:j,toPosition:T,connectionStatus:v});let O="";const I={sourceX:C,sourceY:N,sourcePosition:j,targetX:y,targetY:w,targetPosition:T};return f===jo.Bezier?[O]=qo(I):f===jo.Step?[O]=Lo(s(s({},I),{},{borderRadius:0})):f===jo.SmoothStep?[O]=Lo(I):f===jo.SimpleBezier?[O]=Po(I):O="M".concat(C,",").concat(N," ").concat(y,",").concat(w),e.createElement("path",{d:O,fill:"none",className:"react-flow__connection-path",style:h})};ss.displayName="ConnectionLine";const ls=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function cs(t){let{containerStyle:n,style:r,type:o,component:i}=t;const{nodeId:a,handleType:s,nodesConnectable:l,width:c,height:u,connectionStatus:d}=Xr(ls,V);return!!(a&&s&&c&&l)?e.createElement("svg",{style:n,width:c,height:u,className:"react-flow__edges react-flow__connectionline react-flow__container"},e.createElement("g",{className:D(["react-flow__connection",d])},e.createElement(ss,{nodeId:a,handleType:s,style:r,type:o,CustomComponent:i,connectionStatus:d}))):null}function us(t,n){(0,e.useRef)(null),Jr();return(0,e.useMemo)(()=>n(t),[t])}const ds=t=>{let{nodeTypes:n,edgeTypes:r,onMove:o,onMoveStart:i,onMoveEnd:a,onInit:s,onNodeClick:l,onEdgeClick:c,onNodeDoubleClick:u,onEdgeDoubleClick:d,onNodeMouseEnter:h,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:v,onSelectionContextMenu:m,onSelectionStart:g,onSelectionEnd:y,connectionLineType:w,connectionLineStyle:b,connectionLineComponent:_,connectionLineContainerStyle:x,selectionKeyCode:S,selectionOnDrag:k,selectionMode:E,multiSelectionKeyCode:C,panActivationKeyCode:N,zoomActivationKeyCode:j,deleteKeyCode:T,onlyRenderVisibleElements:O,elementsSelectable:I,selectNodesOnDrag:P,defaultViewport:A,translateExtent:R,minZoom:D,maxZoom:M,preventScrolling:L,defaultMarkerColor:z,zoomOnScroll:U,zoomOnPinch:B,panOnScroll:F,panOnScrollSpeed:K,panOnScrollMode:q,zoomOnDoubleClick:V,panOnDrag:W,onPaneClick:H,onPaneMouseEnter:Y,onPaneMouseMove:G,onPaneMouseLeave:X,onPaneScroll:J,onPaneContextMenu:$,onEdgeContextMenu:Z,onEdgeMouseEnter:Q,onEdgeMouseMove:ee,onEdgeMouseLeave:te,onReconnect:ne,onReconnectStart:re,onReconnectEnd:oe,reconnectRadius:ie,noDragClassName:ae,noWheelClassName:se,noPanClassName:le,elevateEdgesOnSelect:ce,disableKeyboardA11y:ue,nodeOrigin:de,nodeExtent:he,rfId:fe}=t;const pe=us(n,Da),ve=us(r,Wa);return function(t){const n=Zi(),r=(0,e.useRef)(!1);(0,e.useEffect)(()=>{!r.current&&n.viewportInitialized&&t&&(setTimeout(()=>t(n),1),r.current=!0)},[t,n.viewportInitialized])}(s),e.createElement(Ra,{onPaneClick:H,onPaneMouseEnter:Y,onPaneMouseMove:G,onPaneMouseLeave:X,onPaneContextMenu:$,onPaneScroll:J,deleteKeyCode:T,selectionKeyCode:S,selectionOnDrag:k,selectionMode:E,onSelectionStart:g,onSelectionEnd:y,multiSelectionKeyCode:C,panActivationKeyCode:N,zoomActivationKeyCode:j,elementsSelectable:I,onMove:o,onMoveStart:i,onMoveEnd:a,zoomOnScroll:U,zoomOnPinch:B,zoomOnDoubleClick:V,panOnScroll:F,panOnScrollSpeed:K,panOnScrollMode:q,panOnDrag:W,defaultViewport:A,translateExtent:R,minZoom:D,maxZoom:M,onSelectionContextMenu:m,preventScrolling:L,noDragClassName:ae,noWheelClassName:se,noPanClassName:le,disableKeyboardA11y:ue},e.createElement(is,null,e.createElement(rs,{edgeTypes:ve,onEdgeClick:c,onEdgeDoubleClick:d,onlyRenderVisibleElements:O,onEdgeContextMenu:Z,onEdgeMouseEnter:Q,onEdgeMouseMove:ee,onEdgeMouseLeave:te,onReconnect:ne,onReconnectStart:re,onReconnectEnd:oe,reconnectRadius:ie,defaultMarkerColor:z,noPanClassName:le,elevateEdgesOnSelect:!!ce,disableKeyboardA11y:ue,rfId:fe},e.createElement(cs,{style:b,type:w,component:_,containerStyle:x})),e.createElement("div",{className:"react-flow__edgelabel-renderer"}),e.createElement(za,{nodeTypes:pe,onNodeClick:l,onNodeDoubleClick:u,onNodeMouseEnter:h,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:v,selectNodesOnDrag:P,onlyRenderVisibleElements:O,noPanClassName:le,noDragClassName:ae,disableKeyboardA11y:ue,nodeOrigin:de,nodeExtent:he,rfId:fe})))};ds.displayName="GraphView";var hs=(0,e.memo)(ds);const fs=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],ps={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:fs,nodeExtent:fs,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Eo.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:mo,isValidConnection:void 0},vs=()=>{return e=(e,t)=>s(s({},ps),{},{setNodes:n=>{const{nodeInternals:r,nodeOrigin:o,elevateNodesOnSelect:i}=t();e({nodeInternals:Vi(n,r,o,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map(e=>s(s({},r),e))})},setDefaultNodesAndEdges:(n,r)=>{const o="undefined"!==typeof n,i="undefined"!==typeof r,a=o?Vi(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:a,edges:i?r:[],hasDefaultNodes:o,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:o,fitViewOnInit:i,fitViewOnInitDone:a,fitViewOnInitOptions:l,domNode:c,nodeOrigin:u}=t(),d=null===c||void 0===c?void 0:c.querySelector(".react-flow__viewport");if(!d)return;const h=window.getComputedStyle(d),{m22:f}=new window.DOMMatrixReadOnly(h.transform),p=n.reduce((e,t)=>{const n=o.get(t.id);if(null!==n&&void 0!==n&&n.hidden)o.set(n.id,s(s({},n),{},{[po]:s(s({},n[po]),{},{handleBounds:void 0})}));else if(n){const r=to(t.nodeElement);r.width&&r.height&&(n.width!==r.width||n.height!==r.height||t.forceUpdate)&&(o.set(n.id,s(s({},n),{},{[po]:s(s({},n[po]),{},{handleBounds:{source:xa(".source",t.nodeElement,f,u),target:xa(".target",t.nodeElement,f,u)}})},r)),e.push({id:n.id,type:"dimensions",dimensions:r}))}return e},[]);qi(o,u);const v=a||i&&!a&&Wi(t,s({initial:!0},l));e({nodeInternals:new Map(o),fitViewOnInitDone:v}),(null===p||void 0===p?void 0:p.length)>0&&(null===r||void 0===r||r(p))},updateNodePositions:function(e){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{triggerNodeChanges:o}=t(),i=e.map(e=>{const t={id:e.id,type:"position",dragging:r};return n&&(t.positionAbsolute=e.positionAbsolute,t.position=e.position),t});o(i)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:o,hasDefaultNodes:i,nodeOrigin:a,getNodes:s,elevateNodesOnSelect:l}=t();if(null!==n&&void 0!==n&&n.length){if(i){const t=Vi(da(n,s()),o,a,l);e({nodeInternals:t})}null===r||void 0===r||r(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:o,getNodes:i}=t();let a,s=null;r?a=n.map(e=>ha(e,!0)):(a=fa(i(),n),s=fa(o,[])),Gi({changedNodes:a,changedEdges:s,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:o,getNodes:i}=t();let a,s=null;r?a=n.map(e=>ha(e,!0)):(a=fa(o,n),s=fa(i(),[])),Gi({changedNodes:s,changedEdges:a,get:t,set:e})},unselectNodesAndEdges:function(){let{nodes:n,edges:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{edges:o,getNodes:i}=t(),a=r||o;Gi({changedNodes:(n||i()).map(e=>(e.selected=!1,ha(e.id,!1))),changedEdges:a.map(e=>ha(e.id,!1)),get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:o}=t();null===r||void 0===r||r.scaleExtent([n,o]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:o}=t();null===r||void 0===r||r.scaleExtent([o,n]),e({maxZoom:n})},setTranslateExtent:n=>{var r;null===(r=t().d3Zoom)||void 0===r||r.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=t();Gi({changedNodes:r().filter(e=>e.selected).map(e=>ha(e.id,!1)),changedEdges:n.filter(e=>e.selected).map(e=>ha(e.id,!1)),get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach(e=>{e.positionAbsolute=ro(e.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:e=>{const{transform:n,width:r,height:o,d3Zoom:i,d3Selection:a,translateExtent:s}=t();if(!i||!a||!e.x&&!e.y)return!1;const l=gr.translate(n[0]+e.x,n[1]+e.y).scale(n[2]),c=[[0,0],[r,o]],u=null===i||void 0===i?void 0:i.constrain()(l,c,s);return i.transform(a,u),n[0]!==u.x||n[1]!==u.y||n[2]!==u.k},cancelConnection:()=>e({connectionNodeId:ps.connectionNodeId,connectionHandleId:ps.connectionHandleId,connectionHandleType:ps.connectionHandleType,connectionStatus:ps.connectionStatus,connectionStartHandle:ps.connectionStartHandle,connectionEndHandle:ps.connectionEndHandle}),reset:()=>e(s({},ps))}),t=Object.is,e?q(e,t):q;var e,t},ms=t=>{let{children:n}=t;const r=(0,e.useRef)(null);return r.current||(r.current=vs()),e.createElement(zr,{value:r.current},n)};ms.displayName="ReactFlowProvider";const gs=t=>{let{children:n}=t;return(0,e.useContext)(Lr)?e.createElement(e.Fragment,null,n):e.createElement(ms,null,n)};gs.displayName="ReactFlowWrapper";const ys={input:yi,default:mi,output:bi,group:_i},ws={default:Vo,straight:Bo,step:Uo,smoothstep:zo,simplebezier:Ao},bs=[0,0],_s=[15,15],xs={x:0,y:0,zoom:1},Ss={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},ks=(0,e.forwardRef)((t,n)=>{let{nodes:r,edges:o,defaultNodes:i,defaultEdges:a,className:l,nodeTypes:c=ys,edgeTypes:u=ws,onNodeClick:d,onEdgeClick:h,onInit:f,onMove:p,onMoveStart:v,onMoveEnd:m,onConnect:g,onConnectStart:y,onConnectEnd:w,onClickConnectStart:b,onClickConnectEnd:_,onNodeMouseEnter:x,onNodeMouseMove:S,onNodeMouseLeave:k,onNodeContextMenu:E,onNodeDoubleClick:C,onNodeDragStart:N,onNodeDrag:j,onNodeDragStop:T,onNodesDelete:O,onEdgesDelete:I,onSelectionChange:P,onSelectionDragStart:A,onSelectionDrag:M,onSelectionDragStop:L,onSelectionContextMenu:z,onSelectionStart:U,onSelectionEnd:B,connectionMode:F=Eo.Strict,connectionLineType:K=jo.Bezier,connectionLineStyle:q,connectionLineComponent:V,connectionLineContainerStyle:W,deleteKeyCode:H="Backspace",selectionKeyCode:Y="Shift",selectionOnDrag:G=!1,selectionMode:X=No.Full,panActivationKeyCode:J="Space",multiSelectionKeyCode:$=(bo()?"Meta":"Control"),zoomActivationKeyCode:Z=(bo()?"Meta":"Control"),snapToGrid:Q=!1,snapGrid:ee=_s,onlyRenderVisibleElements:te=!1,selectNodesOnDrag:ne=!0,nodesDraggable:re,nodesConnectable:oe,nodesFocusable:ie,nodeOrigin:ae=bs,edgesFocusable:se,edgesUpdatable:le,elementsSelectable:ce,defaultViewport:ue=xs,minZoom:de=.5,maxZoom:he=2,translateExtent:fe=fs,preventScrolling:pe=!0,nodeExtent:ve,defaultMarkerColor:me="#b1b1b7",zoomOnScroll:ge=!0,zoomOnPinch:ye=!0,panOnScroll:we=!1,panOnScrollSpeed:be=.5,panOnScrollMode:_e=Co.Free,zoomOnDoubleClick:xe=!0,panOnDrag:Se=!0,onPaneClick:ke,onPaneMouseEnter:Ee,onPaneMouseMove:Ce,onPaneMouseLeave:Ne,onPaneScroll:je,onPaneContextMenu:Te,children:Oe,onEdgeContextMenu:Ie,onEdgeDoubleClick:Pe,onEdgeMouseEnter:Ae,onEdgeMouseMove:Re,onEdgeMouseLeave:De,onEdgeUpdate:Me,onEdgeUpdateStart:Le,onEdgeUpdateEnd:ze,onReconnect:Ue,onReconnectStart:Be,onReconnectEnd:Fe,reconnectRadius:Ke=10,edgeUpdaterRadius:qe=10,onNodesChange:Ve,onEdgesChange:We,noDragClassName:He="nodrag",noWheelClassName:Ye="nowheel",noPanClassName:Ge="nopan",fitView:Xe=!1,fitViewOptions:Je,connectOnClick:$e=!0,attributionPosition:Ze,proOptions:Qe,defaultEdgeOptions:et,elevateNodesOnSelect:tt=!0,elevateEdgesOnSelect:nt=!1,disableKeyboardA11y:rt=!1,autoPanOnConnect:ot=!0,autoPanOnNodeDrag:it=!0,connectionRadius:at=20,isValidConnection:st,onError:lt,style:ct,id:ut,nodeDragThreshold:dt}=t,ht=R(t,Mr);const ft=ut||"1";return e.createElement("div",s(s({},ht),{},{style:s(s({},ct),Ss),ref:n,className:D(["react-flow",l]),"data-testid":"rf__wrapper",id:ut}),e.createElement(gs,null,e.createElement(hs,{onInit:f,onMove:p,onMoveStart:v,onMoveEnd:m,onNodeClick:d,onEdgeClick:h,onNodeMouseEnter:x,onNodeMouseMove:S,onNodeMouseLeave:k,onNodeContextMenu:E,onNodeDoubleClick:C,nodeTypes:c,edgeTypes:u,connectionLineType:K,connectionLineStyle:q,connectionLineComponent:V,connectionLineContainerStyle:W,selectionKeyCode:Y,selectionOnDrag:G,selectionMode:X,deleteKeyCode:H,multiSelectionKeyCode:$,panActivationKeyCode:J,zoomActivationKeyCode:Z,onlyRenderVisibleElements:te,selectNodesOnDrag:ne,defaultViewport:ue,translateExtent:fe,minZoom:de,maxZoom:he,preventScrolling:pe,zoomOnScroll:ge,zoomOnPinch:ye,zoomOnDoubleClick:xe,panOnScroll:we,panOnScrollSpeed:be,panOnScrollMode:_e,panOnDrag:Se,onPaneClick:ke,onPaneMouseEnter:Ee,onPaneMouseMove:Ce,onPaneMouseLeave:Ne,onPaneScroll:je,onPaneContextMenu:Te,onSelectionContextMenu:z,onSelectionStart:U,onSelectionEnd:B,onEdgeContextMenu:Ie,onEdgeDoubleClick:Pe,onEdgeMouseEnter:Ae,onEdgeMouseMove:Re,onEdgeMouseLeave:De,onReconnect:null!==Ue&&void 0!==Ue?Ue:Me,onReconnectStart:null!==Be&&void 0!==Be?Be:Le,onReconnectEnd:null!==Fe&&void 0!==Fe?Fe:ze,reconnectRadius:null!==Ke&&void 0!==Ke?Ke:qe,defaultMarkerColor:me,noDragClassName:He,noWheelClassName:Ye,noPanClassName:Ge,elevateEdgesOnSelect:nt,rfId:ft,disableKeyboardA11y:rt,nodeOrigin:ae,nodeExtent:ve}),e.createElement(Ii,{nodes:r,edges:o,defaultNodes:i,defaultEdges:a,onConnect:g,onConnectStart:y,onConnectEnd:w,onClickConnectStart:b,onClickConnectEnd:_,nodesDraggable:re,nodesConnectable:oe,nodesFocusable:ie,edgesFocusable:se,edgesUpdatable:le,elementsSelectable:ce,elevateNodesOnSelect:tt,minZoom:de,maxZoom:he,nodeExtent:ve,onNodesChange:Ve,onEdgesChange:We,snapToGrid:Q,snapGrid:ee,connectionMode:F,translateExtent:fe,connectOnClick:$e,defaultEdgeOptions:et,fitView:Xe,fitViewOptions:Je,onNodesDelete:O,onEdgesDelete:I,onNodeDragStart:N,onNodeDrag:j,onNodeDragStop:T,onSelectionDrag:M,onSelectionDragStart:A,onSelectionDragStop:L,noPanClassName:Ge,nodeOrigin:ae,rfId:ft,autoPanOnConnect:ot,autoPanOnNodeDrag:it,onError:lt,connectionRadius:at,isValidConnection:st,nodeDragThreshold:dt}),e.createElement(Ni,{onSelectionChange:P}),Oe,e.createElement(Qr,{proOptions:Qe,position:Ze}),e.createElement(zi,{rfId:ft,disableKeyboardA11y:rt})))});ks.displayName="ReactFlow";function Es(t){return n=>{const[r,o]=(0,e.useState)(n),i=(0,e.useCallback)(e=>o(n=>t(e,n)),[]);return[r,o,i]}}const Cs=Es(da),Ns=Es(function(e,t){return ua(e,t)});var js;function Ts(t){let{color:n,dimensions:r,lineWidth:o}=t;return e.createElement("path",{stroke:n,strokeWidth:o,d:"M".concat(r[0]/2," 0 V").concat(r[1]," M0 ").concat(r[1]/2," H").concat(r[0])})}function Os(t){let{color:n,radius:r}=t;return e.createElement("circle",{cx:r,cy:r,r:r,fill:n})}!function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"}(js||(js={}));const Is={[js.Dots]:"#91919a",[js.Lines]:"#eee",[js.Cross]:"#e2e2e2"},Ps={[js.Dots]:1,[js.Lines]:1,[js.Cross]:6},As=e=>({transform:e.transform,patternId:"pattern-".concat(e.rfId)});function Rs(t){let{id:n,variant:r=js.Dots,gap:o=20,size:i,lineWidth:a=1,offset:l=2,color:c,style:u,className:d}=t;const h=(0,e.useRef)(null),{transform:f,patternId:p}=Xr(As,V),v=c||Is[r],m=i||Ps[r],g=r===js.Dots,y=r===js.Cross,w=Array.isArray(o)?o:[o,o],b=[w[0]*f[2]||1,w[1]*f[2]||1],_=m*f[2],x=y?[_,_]:b,S=g?[_/l,_/l]:[x[0]/l,x[1]/l];return e.createElement("svg",{className:D(["react-flow__background",d]),style:s(s({},u),{},{position:"absolute",width:"100%",height:"100%",top:0,left:0}),ref:h,"data-testid":"rf__background"},e.createElement("pattern",{id:p+n,x:f[0]%b[0],y:f[1]%b[1],width:b[0],height:b[1],patternUnits:"userSpaceOnUse",patternTransform:"translate(-".concat(S[0],",-").concat(S[1],")")},g?e.createElement(Os,{color:v,radius:_/l}):e.createElement(Ts,{dimensions:x,color:v,lineWidth:a})),e.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#".concat(p+n,")")}))}Rs.displayName="Background";var Ds=(0,e.memo)(Rs);const Ms=["children","className"];function Ls(){return e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},e.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function zs(){return e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},e.createElement("path",{d:"M0 0h32v4.2H0z"}))}function Us(){return e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},e.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function Bs(){return e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},e.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function Fs(){return e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},e.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const Ks=t=>{let{children:n,className:r}=t,o=R(t,Ms);return e.createElement("button",s({type:"button",className:D(["react-flow__controls-button",r])},o),n)};Ks.displayName="ControlButton";const qs=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),Vs=t=>{let{style:n,showZoom:r=!0,showFitView:o=!0,showInteractive:i=!0,fitViewOptions:a,onZoomIn:s,onZoomOut:l,onFitView:c,onInteractiveChange:u,className:d,children:h,position:f="bottom-left"}=t;const p=Jr(),[v,m]=(0,e.useState)(!1),{isInteractive:g,minZoomReached:y,maxZoomReached:w}=Xr(qs,V),{zoomIn:b,zoomOut:_,fitView:x}=Zi();if((0,e.useEffect)(()=>{m(!0)},[]),!v)return null;return e.createElement(Zr,{className:D(["react-flow__controls",d]),position:f,style:n,"data-testid":"rf__controls"},r&&e.createElement(e.Fragment,null,e.createElement(Ks,{onClick:()=>{b(),null===s||void 0===s||s()},className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:w},e.createElement(Ls,null)),e.createElement(Ks,{onClick:()=>{_(),null===l||void 0===l||l()},className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:y},e.createElement(zs,null))),o&&e.createElement(Ks,{className:"react-flow__controls-fitview",onClick:()=>{x(a),null===c||void 0===c||c()},title:"fit view","aria-label":"fit view"},e.createElement(Us,null)),i&&e.createElement(Ks,{className:"react-flow__controls-interactive",onClick:()=>{p.setState({nodesDraggable:!g,nodesConnectable:!g,elementsSelectable:!g}),null===u||void 0===u||u(!g)},title:"toggle interactivity","aria-label":"toggle interactivity"},g?e.createElement(Fs,null):e.createElement(Bs,null)),h)};Vs.displayName="Controls";var Ws=(0,e.memo)(Vs);const Hs={outcome:["opportunity"],opportunity:["opportunity","solution"],solution:["solution","test"],test:[],journey:["opportunity"]},Ys={outcome:"Outcome",opportunity:"Opportunity",subOpportunity:"Sub-Opportunity",solution:"Solution",subSolution:"Sub-Solution",test:"Test",journey:"Journey stage"},Gs={outcome:"New Outcome",opportunity:"New Opportunity",solution:"New Solution",test:"New Test"},Xs=[{value:"idea",label:"Idea"},{value:"in_progress",label:"In Progress"},{value:"validated",label:"Validated"},{value:"killed",label:"Killed"}],Js=[{value:"idea",label:"Idea"},{value:"draft",label:"Draft"},{value:"designed",label:"Designed experiment"}],$s=e=>{if(!e)return"draft";const t=String(e).toLowerCase().trim();return"idea"===t||"draft"===t||"designed"===t?t:"planned"===t||"blocked"===t||"draft"===t?"draft":"running"===t||"active"===t||"testing"===t||"live"===t||"done"===t||"completed"===t||"done_pass"===t||"done_iterate"===t||"done_kill"===t?"designed":"draft"},Zs=e=>{const t=$s(e),n=Js.find(e=>e.value===t);return n?n.label:"Draft"},Qs=[{value:"ongoing",label:"Ongoing"},{value:"pass",label:"Pass \u2014 hypothesis supported"},{value:"iterate",label:"Iterate \u2014 refine and retest"},{value:"kill",label:"Kill \u2014 hypothesis disproven"}],el=e=>{if(null==e||""===e)return null;const t=String(e).toLowerCase().trim();return"ongoing"===t||"pass"===t||"iterate"===t||"kill"===t?t:null},tl=function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return"Ongoing";const t=el(e);if(!t||"ongoing"===t)return"Ongoing";const n=Qs.find(e=>e.value===t);return n?n.label.split(" \u2014 ")[0]:t},nl=(e,t)=>"".concat(e,":").concat(t),rl=e=>{if(!e)return null;const t=e.indexOf(":");if(t<=0||t===e.length-1)return null;return{type:e.slice(0,t),id:e.slice(t+1)}},ol={brand:{900:"#0b3d39",600:"#0f766e",100:"#d9f2ec"},type:{outcome:{accent:"#3f8f7a",tint:"rgba(63, 143, 122, 0.14)"},opportunity:{accent:"#c9822e",tint:"rgba(201, 130, 46, 0.12)"},solution:{accent:"#4d6fb3",tint:"rgba(77, 111, 179, 0.08)"},test:{accent:"#7c6ad6",tint:"rgba(124, 106, 214, 0.08)"},journey:{accent:"#64748b",tint:"rgba(248, 250, 252, 0.95)"}},neutral:{text:"#1f2937",muted:"#6b7280",border:"rgba(15, 23, 42, 0.08)",bg:"#ffffff"},node:{radius:12,shadow:"0 1px 4px rgba(15, 23, 42, 0.06)",shadowHover:"0 4px 12px rgba(15, 23, 42, 0.1)",shadowSelected:"0 0 0 1px rgba(15, 118, 110, 0.4), 0 8px 18px rgba(15, 23, 42, 0.1)"},edge:{base:{stroke:"rgba(100, 116, 139, 0.45)",width:1.2},active:{width:2.4}},canvas:{bg:"#ffffff",gridDot:"rgba(148, 163, 184, 0.25)"},panel:{bg:"#fbfbfc",border:"rgba(15, 23, 42, 0.08)"},status:{idea:"#94a3b8",in_progress:"#c0822e",validated:"#3f8f7a",killed:"#94a3b8",planned:"#94a3b8",running:"#0f766e",blocked:"#c0822e",live:"#0f766e",idea:"#94a3b8",draft:"#64748b",designed:"#0f766e",done_pass:"#059669",done_iterate:"#64748b",done_kill:"#dc2626"}};var il=n(579);const al={low:"confidence-low",medium:"confidence-medium",high:"confidence-high"};const sl=function(e){let{confidence:t,showExplanation:n=!1}=e;if(!t)return null;const r=al[t.level]||"confidence-low",o=function(e){var t;const n=null===e||void 0===e?void 0:e.explain;if(!n)return"".concat((null!==(t=null===e||void 0===e?void 0:e.score)&&void 0!==t?t:0).toFixed(0),"% confidence");const r=[];if(0===n.doneTests)r.push("No decided tests yet.");else{const e=[];n.pass>0&&e.push("".concat(n.pass," passed")),n.iterate>0&&e.push("".concat(n.iterate," iterate")),n.kill>0&&e.push("".concat(n.kill," killed")),r.push("Based on: ".concat(e.join(", "),".")),n.kill>0&&r.push("Killed tests reduce confidence.")}return r.push("Score: ".concat(n.score.toFixed(0),"% \u2192 ").concat(n.level,".")),r.join(" ")}(t),i=t.explain;return(0,il.jsxs)("div",{className:"confidence-badge ".concat(r),title:o,children:[(0,il.jsx)("span",{className:"confidence-badge-level",children:t.level.toUpperCase()}),n&&i&&i.doneTests>0&&(0,il.jsxs)("span",{className:"confidence-badge-detail",children:[i.pass,"P / ",i.iterate,"I / ",i.kill,"K"]})]})};const ll=function(e){let{score:t,className:n=""}=e;if(null==t||""===t)return null;const r=Math.min(100,Math.max(0,Number(t))),o=r>=70?"high":r>=40?"medium":"low";return(0,il.jsxs)("span",{className:"confidence-score-pill confidence-score-pill-".concat(o," ").concat(n),title:"Confidence score (0\u2013100)",children:[r,"%"]})};const cl=function(t){let{nodeKey:n,nodeType:r,currentScore:o,onSave:i,onClose:a,anchorRef:s}=t;const[l,c]=(0,e.useState)(null!=o?Number(o):50),[u,d]=(0,e.useState)(null!=o?String(o):"50"),h=(0,e.useRef)(null);return(0,e.useEffect)(()=>{const e=null!=o?Number(o):50;c(e),d(String(e))},[o,n]),(0,e.useEffect)(()=>{const e=e=>{!h.current||h.current.contains(e.target)||null!==s&&void 0!==s&&s.current&&s.current.contains(e.target)||a()},t=e=>{"Escape"===e.key&&a()};return document.addEventListener("mousedown",e),document.addEventListener("keydown",t),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",t)}},[a,s]),(0,il.jsxs)("div",{className:"confidence-score-popover",ref:h,children:[(0,il.jsx)("div",{className:"confidence-score-popover-title",children:"Confidence (0\u2013100)"}),(0,il.jsx)("div",{className:"confidence-score-popover-slider-row",children:(0,il.jsx)("input",{type:"range",min:0,max:100,value:l,onChange:e=>{const t=parseInt(e.target.value,10);c(t),d(String(t))},className:"confidence-score-popover-slider"})}),(0,il.jsxs)("div",{className:"confidence-score-popover-input-row",children:[(0,il.jsx)("input",{type:"text",inputMode:"numeric",value:u,onChange:e=>{const t=e.target.value.replace(/\D/g,"").slice(0,3);d(t);const n=""===t?0:Math.min(100,Math.max(0,parseInt(t,10)));c(isNaN(n)?0:n)},onBlur:()=>d(String(Math.min(100,Math.max(0,l)))),className:"confidence-score-popover-input"}),(0,il.jsx)("span",{className:"confidence-score-popover-suffix",children:"%"})]}),(0,il.jsxs)("div",{className:"confidence-score-popover-actions",children:[(0,il.jsx)("button",{type:"button",className:"confidence-score-popover-clear",onClick:()=>{i(null),a()},children:"Clear"}),(0,il.jsx)("button",{type:"button",className:"confidence-score-popover-save",onClick:()=>{i(l),a()},children:"Save"})]})]})},ul=(0,e.createContext)(null),dl={viewMode:"tree",treeStructure:"classic",selectedKey:null,collapsed:{},layoutUnlocked:!1,focusKey:null,nodeOverrides:{},renamingKey:null,evidenceByTest:{},todosById:{},todoIdsByTest:{}},hl=e=>{const t={};Object.values(e).forEach(e=>{const n=e.experiment_id;n&&(t[n]||(t[n]=[]),t[n].push(e))});const n={};return Object.entries(t).forEach(e=>{let[t,r]=e;n[t]=r.sort((e,t)=>{var n,r;const o=null!==(n=e.sort_order)&&void 0!==n?n:0,i=null!==(r=t.sort_order)&&void 0!==r?r:0;return o!==i?o-i:new Date(e.created_at).getTime()-new Date(t.created_at).getTime()}).map(e=>e.id)}),n},fl=(e,t)=>{switch(t.type){case"SET_VIEW_MODE":return s(s({},e),{},{viewMode:t.payload});case"SET_TREE_STRUCTURE":return s(s({},e),{},{treeStructure:t.payload});case"SET_SELECTED":return s(s({},e),{},{selectedKey:t.payload,focusKey:t.payload});case"CLEAR_SELECTED":return s(s({},e),{},{selectedKey:null});case"TOGGLE_COLLAPSE":{const n=s({},e.collapsed);return n[t.payload]=!n[t.payload],s(s({},e),{},{collapsed:n})}case"SET_COLLAPSE_MAP":return s(s({},e),{},{collapsed:t.payload});case"SET_LAYOUT_UNLOCKED":return s(s({},e),{},{layoutUnlocked:t.payload});case"SET_FOCUS_KEY":return s(s({},e),{},{focusKey:t.payload});case"SET_NODE_OVERRIDE":{const{key:n,changes:r}=t.payload;return s(s({},e),{},{nodeOverrides:s(s({},e.nodeOverrides),{},{[n]:s(s({},e.nodeOverrides[n]||{}),r)})})}case"SET_RENAMING_KEY":return s(s({},e),{},{renamingKey:t.payload});case"SET_EVIDENCE":{const{testId:n,items:r}=t.payload;return s(s({},e),{},{evidenceByTest:s(s({},e.evidenceByTest),{},{[n]:r})})}case"CLEAR_OVERRIDES":return s(s({},e),{},{nodeOverrides:{}});case"SET_TODOS":{const n={};return(t.payload||[]).forEach(e=>{n[e.id]=e}),s(s({},e),{},{todosById:n,todoIdsByTest:hl(n)})}case"UPSERT_TODO":{const n=t.payload;if(null===n||void 0===n||!n.id)return e;const r=e.todosById[n.id],o=(null===r||void 0===r?void 0:r.experiment_id)||null,i=n.experiment_id||o,a=s(s({},e.todosById),{},{[n.id]:s(s({},r||{}),n)}),l=s({},e.todoIdsByTest);return new Set([o,i].filter(Boolean)).forEach(e=>{const t=Object.values(a).filter(t=>t.experiment_id===e);l[e]=t.sort((e,t)=>{var n,r;const o=null!==(n=e.sort_order)&&void 0!==n?n:0,i=null!==(r=t.sort_order)&&void 0!==r?r:0;return o!==i?o-i:new Date(e.created_at).getTime()-new Date(t.created_at).getTime()}).map(e=>e.id)}),s(s({},e),{},{todosById:a,todoIdsByTest:l})}case"REMOVE_TODO":{const n=t.payload,r=e.todosById[n];if(!r)return e;const o=s({},e.todosById);delete o[n];const i=s({},e.todoIdsByTest);if(r.experiment_id){const e=Object.values(o).filter(e=>e.experiment_id===r.experiment_id);i[r.experiment_id]=e.sort((e,t)=>{var n,r;const o=null!==(n=e.sort_order)&&void 0!==n?n:0,i=null!==(r=t.sort_order)&&void 0!==r?r:0;return o!==i?o-i:new Date(e.created_at).getTime()-new Date(t.created_at).getTime()}).map(e=>e.id)}return s(s({},e),{},{todosById:o,todoIdsByTest:i})}case"SET_TODO_ORDER":{const{testId:n,orderedIds:r}=t.payload||{};return n?s(s({},e),{},{todoIdsByTest:s(s({},e.todoIdsByTest),{},{[n]:r||[]})}):e}default:return e}},pl=t=>{let{children:n}=t;const[r,o]=(0,e.useReducer)(fl,dl),i=(0,e.useMemo)(()=>({setViewMode:e=>o({type:"SET_VIEW_MODE",payload:e}),setTreeStructure:e=>o({type:"SET_TREE_STRUCTURE",payload:e}),setSelectedKey:e=>o({type:"SET_SELECTED",payload:e}),clearSelection:()=>o({type:"CLEAR_SELECTED"}),toggleCollapse:e=>o({type:"TOGGLE_COLLAPSE",payload:e}),setCollapseMap:e=>o({type:"SET_COLLAPSE_MAP",payload:e}),setLayoutUnlocked:e=>o({type:"SET_LAYOUT_UNLOCKED",payload:e}),setFocusKey:e=>o({type:"SET_FOCUS_KEY",payload:e}),setNodeOverride:(e,t)=>o({type:"SET_NODE_OVERRIDE",payload:{key:e,changes:t}}),setRenamingKey:e=>o({type:"SET_RENAMING_KEY",payload:e}),setEvidence:(e,t)=>o({type:"SET_EVIDENCE",payload:{testId:e,items:t}}),clearOverrides:()=>o({type:"CLEAR_OVERRIDES"}),setTodos:e=>o({type:"SET_TODOS",payload:e}),upsertTodo:e=>o({type:"UPSERT_TODO",payload:e}),removeTodo:e=>o({type:"REMOVE_TODO",payload:e}),setTodoOrder:(e,t)=>o({type:"SET_TODO_ORDER",payload:{testId:e,orderedIds:t}})}),[]),a=(0,e.useMemo)(()=>({state:r,actions:i}),[r,i]);return(0,il.jsx)(ul.Provider,{value:a,children:n})},vl=()=>{const t=(0,e.useContext)(ul);if(!t)throw new Error("useOstStore must be used within OstStoreProvider");return t},ml=[{key:"customer_interview",label:"Customer Interview",defaultTitle:"Customer Interview",successCriteria:{pass:"\u22655 interviews confirm the pain is urgent and frequent.",iterate:"Mixed signal on urgency; refine segment and retry.",kill:"Interviews show low urgency or no real pain."},timeboxDays:5,checklist:["What is the current workaround?","How often does this problem occur?","Would you pay to solve it?"]},{key:"cold_outreach",label:"Cold Outreach",defaultTitle:"Cold Outreach Test",successCriteria:{pass:"\u226510% reply rate with \u22653 positive problem confirmations.",iterate:"Reply rate 5\u201310% or low intent; refine message.",kill:"Reply rate <5% and no confirmations."},timeboxDays:7,checklist:["Open rate","Reply rate","Positive confirmation count"]},{key:"landing_page_smoke",label:"Landing Page Smoke Test",defaultTitle:"Landing Page Smoke Test",successCriteria:{pass:"\u22655% conversion to waitlist with \u226550 visits.",iterate:"2\u20135% conversion; iterate copy and CTA.",kill:"<2% conversion after 50+ visits."},timeboxDays:7,checklist:["Unique visitors","Conversion rate","CTA clicks"]},{key:"pricing_test",label:"Pricing Test",defaultTitle:"Pricing Test",successCriteria:{pass:"\u22653 users accept target price point.",iterate:"Interest but price too high; test alternative.",kill:"No one accepts target price."},timeboxDays:5,checklist:["Price point tested","Acceptance count","Objections"]},{key:"prototype_usability",label:"Prototype Usability Test",defaultTitle:"Prototype Usability Test",successCriteria:{pass:"\u226570% task success without guidance.",iterate:"50\u201370% success; refine UX and retry.",kill:"<50% task success."},timeboxDays:7,checklist:["Task success rate","Top confusion points","Time to complete"]},{key:"concierge_mvp",label:"Concierge MVP",defaultTitle:"Concierge MVP",successCriteria:{pass:"\u22653 users complete workflow manually with satisfaction.",iterate:"Users complete but friction high; simplify.",kill:"Users drop off before completing."},timeboxDays:10,checklist:["Completion rate","Satisfaction signal","Manual effort"]}],gl=e=>ml.find(t=>t.key===e);function yl(e){let{user:t,size:n=24,isOwner:r=!1,showPresence:o=!1,isActive:i=!1}=e;const a=(e=>{var t;const n=(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e||null===(t=e.profile)||void 0===t?void 0:t.name)||(null===e||void 0===e?void 0:e.email)||"";if(!n)return"?";const r=n.split(" ").filter(Boolean);return 1===r.length?r[0].slice(0,2).toUpperCase():"".concat(r[0][0]).concat(r[r.length-1][0]).toUpperCase()})(t),s=(e=>{var t;return(null===e||void 0===e?void 0:e.avatar_url)||(null===e||void 0===e?void 0:e.avatarUrl)||(null===e||void 0===e||null===(t=e.profile)||void 0===t?void 0:t.avatar)||(null===e||void 0===e?void 0:e.avatar)||null})(t),l=(null===t||void 0===t?void 0:t.name)||(null===t||void 0===t?void 0:t.email)||"User";return(0,il.jsxs)("div",{className:"avatar ".concat(r?"is-owner":""),style:{width:n,height:n},title:l,"aria-label":l,children:[s?(0,il.jsx)("img",{src:s,alt:l}):(0,il.jsx)("span",{className:"avatar-initials",style:{fontSize:Math.max(9,.42*n)},children:a}),o&&(0,il.jsx)("span",{className:"avatar-presence ".concat(i?"active":"")})]})}function wl(e){let{users:t=[],max:n=3,size:r=20,showPresence:o=!1,activeIds:i=new Set,ownerId:a=null}=e;const s=t.filter(Boolean).slice(0,n),l=t.length-s.length;return(0,il.jsxs)("div",{className:"avatar-group",children:[s.map(e=>(0,il.jsx)(yl,{user:e,size:r,isOwner:a&&e.id===a,showPresence:o,isActive:i.has(e.id)},e.id||e.email)),l>0&&(0,il.jsxs)("div",{className:"avatar avatar-extra",style:{width:r,height:r},children:["+",l]})]})}const bl=yl,_l=e=>e.transform[2],xl=["opportunity","solution"];const Sl=function(t){let{data:n}=t;const r=Xr(_l),{state:o,actions:i}=vl(),a=(0,e.useRef)(null),s=(0,e.useRef)(null),[l,c]=(0,e.useState)(null),[u,d]=(0,e.useState)(!1),h=o.selectedKey===n.nodeKey,f=o.renamingKey===n.nodeKey,p=Hs[n.type]||[];(0,e.useEffect)(()=>{f&&a.current&&(a.current.focus(),a.current.select())},[f]);const v=async e=>{var t;e.trim()&&(null===(t=n.onRename)||void 0===t||t.call(n,n.nodeKey,e.trim()),i.setRenamingKey(null))},m=()=>{var e;window.confirm("Delete this node and its children?")&&(null===(e=n.onDelete)||void 0===e||e.call(n,n.nodeKey))},g=r<.7?"compact":r<1?"medium":"expanded",y=ol.type[n.type]||{},w=(()=>{if("test"!==n.type)return null;const e={interview:"Interview",cold_outreach:"Cold Outreach",pricing:"Pricing",prototype_usability:"Prototype Usability",custom:"Custom"};if(n.testType&&e[n.testType])return e[n.testType];const t=gl(n.testTemplate);if(t)return t.label;if(n.title){const e=n.title.trim().toLowerCase(),t=ml.find(t=>t.label.toLowerCase()===e||t.defaultTitle.toLowerCase()===e);if(t)return t.label}return"Custom"})(),b=$s(n.testStatus||n.status),_="number"===typeof n.todoTotal&&n.todoTotal>0&&(n.todoDone||0)<n.todoTotal||"draft"===b,x=_?"ongoing":el(n.resultDecision)||"ongoing",S=null!=n.confidenceScore?Number(n.confidenceScore):null,k=null==S?null:S>=70?"high":S>=40?"medium":"low",E={background:y.tint||"#fff",borderColor:h?"var(--brand-600)":"transparent",boxShadow:h?ol.node.shadowSelected:ol.node.shadow,"--node-accent":y.accent||"#64748b"},C=n.contributorUsers||[],N="opportunity"===n.type||"solution"===n.type||"test"===n.type,j=xl.includes(n.type);return(0,il.jsxs)("div",{ref:s,className:"tree-node tree-node-".concat(n.type," tree-node-").concat(g," ").concat(h?"selected":""," ").concat(n.isDimmed?"dimmed":""," ").concat(n.isSubOpportunity?"tree-node-sub-opportunity":""," ").concat(n.isSubSolution?"tree-node-sub-solution":""," ").concat(k?"tree-node-confidence-".concat(k):""," ").concat("solution"===n.type&&n.hasPassExperiment?"tree-node-solution-has-pass":""," ").concat("solution"===n.type&&n.allExperimentsKill?"tree-node-solution-all-kill":""),style:E,onClick:e=>{var t;e.stopPropagation(),null===(t=n.onSelect)||void 0===t||t.call(n,n.nodeKey)},onContextMenu:e=>{e.preventDefault(),e.stopPropagation(),c({x:e.clientX,y:e.clientY})},children:[(0,il.jsx)(pi,{type:"target",position:Oo.Left,className:"tree-node-handle"}),(0,il.jsx)(pi,{type:"source",position:Oo.Right,className:"tree-node-handle"}),(0,il.jsxs)("div",{className:"tree-node-header",children:["solution"===n.type&&n.hasPassExperiment&&(0,il.jsx)("span",{className:"tree-node-momentum-dot tree-node-momentum-dot-pass",title:"Has passed experiment"}),(0,il.jsx)("span",{className:"tree-node-icon",style:{color:y.accent},children:n.icon}),(0,il.jsxs)("div",{className:"tree-node-title-wrap",children:["outcome"===n.type&&!f&&(0,il.jsx)("div",{className:"tree-node-outcome-label",children:"\ud83c\udfaf Outcome"}),f?(0,il.jsx)("input",{ref:a,className:"tree-node-input",defaultValue:n.title,onBlur:e=>v(e.target.value),onKeyDown:e=>{"Enter"===e.key&&v(e.currentTarget.value),"Escape"===e.key&&i.setRenamingKey(null)}}):(0,il.jsx)("div",{className:"tree-node-title",title:n.title,children:n.title})]}),N&&(0,il.jsxs)("div",{className:"tree-node-avatars",children:[n.ownerUser&&(0,il.jsx)(bl,{user:n.ownerUser,size:20,isOwner:!0}),C.length>0&&(0,il.jsx)(wl,{users:C,size:18,max:3})]}),n.isCollapsed&&n.childrenCount>0&&(0,il.jsx)("span",{className:"tree-node-count-pill",children:n.childrenCount})]}),n.description&&"compact"!==g&&(0,il.jsx)("div",{className:"outcome"===n.type?"tree-node-subtitle":"tree-node-description",title:n.description,children:n.description}),"compact"!==g&&(0,il.jsxs)("div",{className:"tree-node-badges",children:[("opportunity"===n.type||"solution"===n.type)&&null!=n.confidence&&(0,il.jsx)(sl,{confidence:n.confidence,showExplanation:!0}),("opportunity"===n.type||"solution"===n.type)&&null!=n.confidenceScore&&""!==n.confidenceScore&&(0,il.jsx)(ll,{score:n.confidenceScore}),"test"===n.type&&(0,il.jsxs)(il.Fragment,{children:[(0,il.jsx)("span",{className:"tree-node-pill tree-node-pill-type",children:w}),(0,il.jsx)("span",{className:"tree-node-pill tree-node-pill-status status-".concat(b),children:Zs(n.testStatus||n.status)}),(0,il.jsx)("span",{className:"tree-node-pill tree-node-pill-decision decision-".concat(x),children:tl(n.resultDecision,_)}),"number"===typeof n.todoTotal&&n.todoTotal>0&&(0,il.jsx)("span",{className:"tree-node-pill tree-node-pill-todos",children:"".concat(n.todoDone||0,"/").concat(n.todoTotal)})]}),"test"!==n.type&&n.status&&(0,il.jsx)("span",{className:"tree-node-badge status-".concat(n.status),children:n.status}),"expanded"===g&&n.owner&&(0,il.jsx)("span",{className:"tree-node-badge owner",children:n.ownerLabel}),n.isCollapsed&&n.childrenCount>0&&(0,il.jsx)("span",{className:"tree-node-badge count",children:n.childrenCount})]}),(0,il.jsxs)("div",{className:"tree-node-actions",children:[(0,il.jsx)("button",{className:"tree-node-action subtle",onClick:e=>{e.stopPropagation(),m()},type:"button","aria-label":"Delete node",children:(0,il.jsx)(I,{})}),n.hasChildren&&(0,il.jsx)("button",{className:"tree-node-action",onClick:e=>{var t;e.stopPropagation(),null===(t=n.onToggleCollapse)||void 0===t||t.call(n,n.nodeKey)},type:"button",children:n.isCollapsed?"\u25b8":"\u25be"}),p.length>0&&(0,il.jsxs)("div",{className:"tree-node-add",children:[(0,il.jsx)("button",{className:"tree-node-action",onClick:e=>{var t;e.stopPropagation(),null===(t=n.onToggleAdd)||void 0===t||t.call(n,n.nodeKey)},type:"button",children:"+"}),n.isAddOpen&&(0,il.jsx)("div",{className:"tree-node-add-menu",children:p.map(e=>(0,il.jsxs)("button",{type:"button",onClick:t=>{var r;t.stopPropagation(),null===(r=n.onAddChild)||void 0===r||r.call(n,n.nodeKey,e)},children:["Add ",Ys[e]]},e))})]})]}),u&&j&&(0,il.jsx)(cl,{nodeKey:n.nodeKey,nodeType:n.type,currentScore:n.confidenceScore,onSave:e=>{var t;null===(t=n.onUpdateConfidence)||void 0===t||t.call(n,n.nodeKey,e),d(!1)},onClose:()=>d(!1),anchorRef:s}),l&&(0,Pr.createPortal)((0,il.jsxs)(il.Fragment,{children:[(0,il.jsx)("div",{role:"presentation",className:"tree-node-context-menu-backdrop",onClick:()=>c(null),onContextMenu:e=>{e.preventDefault(),c(null)}}),(0,il.jsxs)("div",{className:"tree-node-context-menu",style:{left:l.x,top:l.y},children:[j&&(0,il.jsx)("button",{type:"button",onClick:()=>{c(null),d(!0)},children:"Set confidence\u2026"}),n.isSubSolution&&(0,il.jsx)("button",{type:"button",onClick:()=>{var e;c(null),null===(e=n.onPromoteSubSolution)||void 0===e||e.call(n,n.nodeKey)},children:"Promote to solution"}),(0,il.jsx)("button",{type:"button",onClick:()=>{c(null),m()},children:"Delete"})]})]}),document.body)]})};const kl=function(e){return(0,il.jsx)(Sl,s(s({},e),{},{data:s(s({},e.data),{},{icon:(0,il.jsx)(v,{})})}))};const El=function(e){return(0,il.jsx)(Sl,s(s({},e),{},{data:s(s({},e.data),{},{icon:(0,il.jsx)(E,{})})}))};const Cl=function(e){return(0,il.jsx)(Sl,s(s({},e),{},{data:s(s({},e.data),{},{icon:(0,il.jsx)(A,{})})}))};const Nl=function(e){return(0,il.jsx)(Sl,s(s({},e),{},{data:s(s({},e.data),{},{icon:(0,il.jsx)(k,{})})}))};const jl=function(e){let{data:t}=e;return(0,il.jsx)("div",{className:"tree-node tree-node-overflow ".concat(t.isDimmed?"dimmed":""),onClick:e=>{var n;e.stopPropagation(),null===(n=t.onOpenOverflow)||void 0===n||n.call(t,t)},children:(0,il.jsx)("div",{className:"tree-node-overflow-pill",children:t.title})})};const Tl=function(e){var t,n;let{data:r}=e;const{state:o,actions:i}=vl(),a=o.selectedKey===r.nodeKey,s=null===(t=o.collapsed)||void 0===t?void 0:t[r.nodeKey],l=r.node||{},c=null!==(n=l.count)&&void 0!==n?n:0,u=!0===l.isUnassigned;return(0,il.jsxs)("div",{className:"tree-node tree-node-journey ".concat(a?"selected":""," ").concat(u?"journey-unassigned":""),style:{borderColor:u?"rgba(234, 179, 8, 0.4)":"rgba(148, 163, 184, 0.2)",borderWidth:1,borderStyle:"solid"},onClick:e=>{var t;e.stopPropagation(),null===(t=r.onSelect)||void 0===t||t.call(r,r.nodeKey)},children:[(0,il.jsx)(pi,{type:"target",position:Oo.Left,className:"tree-node-handle"}),(0,il.jsx)(pi,{type:"source",position:Oo.Right,className:"tree-node-handle"}),(0,il.jsxs)("div",{className:"tree-node-journey-inner",children:[(0,il.jsx)("button",{type:"button",className:"tree-node-journey-collapse",onClick:e=>{e.stopPropagation(),i.toggleCollapse(r.nodeKey)},"aria-label":s?"Expand":"Collapse",children:(0,il.jsx)("span",{className:"tree-node-journey-chevron",children:s?"\u25b6":"\u25bc"})}),(0,il.jsx)("span",{className:"tree-node-journey-icon",style:{color:"var(--journey-accent, #64748b)"},children:(0,il.jsx)(j,{})}),(0,il.jsx)("span",{className:"tree-node-journey-title",title:u?"Assign a journey stage to move these opportunities":void 0,children:l.title}),(0,il.jsx)("span",{className:"tree-node-journey-count",children:c}),r.onAddChild&&(0,il.jsx)("button",{type:"button",className:"tree-node-journey-add",onClick:e=>{e.stopPropagation(),r.onAddChild(r.nodeKey,"opportunity")},"aria-label":"Add opportunity",title:"Add opportunity",children:"+"})]})]})},Ol=[{id:"awareness",label:"Awareness",sortOrder:1},{id:"education",label:"Education",sortOrder:2},{id:"acquisition",label:"Acquisition",sortOrder:3},{id:"product",label:"Product",sortOrder:4},{id:"onboarding",label:"Onboarding",sortOrder:5},{id:"usage",label:"Usage",sortOrder:6},{id:"support",label:"Support",sortOrder:7},{id:"loyalty",label:"Loyalty",sortOrder:8}],Il=(Object.fromEntries(Ol.map(e=>[e.id,e.label])),"__unassigned__");const Pl=e=>Array.isArray(e)?e:[],Al=function(e,t,n,r,o){var i,a,s,l,c,u,d,h,f,p,v,m,g,y,w,b,_,x,S,k,E,C,N,j,T,O,I,P,A,R,D,M,L,z,U,B,F,K;let q=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const V=nl(e,t.id),W=(null===o||void 0===o?void 0:o[V])||{};return{key:V,id:t.id,type:e,parentKey:n,order:"number"===typeof t.order?t.order:null!==(i=null!==(a=t.sortIndex)&&void 0!==a?a:t.sort_index)&&void 0!==i?i:r,title:null!==(s=null!==(l=W.title)&&void 0!==l?l:t.title)&&void 0!==s?s:Gs[e],description:null!==(c=null!==(u=W.description)&&void 0!==u?u:t.description)&&void 0!==c?c:"",status:null!==(d=null!==(h=W.status)&&void 0!==h?h:t.status)&&void 0!==d?d:null,owner:null!==(f=null!==(p=W.owner)&&void 0!==p?p:t.owner)&&void 0!==f?f:null,contributorIds:null!==(v=null!==(m=null!==(g=null!==(y=W.contributorIds)&&void 0!==y?y:t.contributorIds)&&void 0!==g?g:t.contributor_ids)&&void 0!==m?m:t.contributors)&&void 0!==v?v:[],evidence:null!==(w=null!==(b=W.evidence)&&void 0!==b?b:t.evidence)&&void 0!==w?w:"",result:null!==(_=null!==(x=W.result)&&void 0!==x?x:t.result)&&void 0!==_?_:"",testTemplate:null!==(S=null!==(k=W.testTemplate)&&void 0!==k?k:t.testTemplate)&&void 0!==S?S:null,testType:null!==(E=null!==(C=null!==(N=W.testType)&&void 0!==N?N:t.testType)&&void 0!==C?C:t.type)&&void 0!==E?E:null,testStatus:null!==(j=null!==(T=W.testStatus)&&void 0!==T?T:t.testStatus)&&void 0!==j?j:null,resultDecision:null!==(O=null!==(I=W.resultDecision)&&void 0!==I?I:t.resultDecision)&&void 0!==O?O:null,todoDone:null!==(P=null!==(A=W.todoDone)&&void 0!==A?A:t.todoDone)&&void 0!==P?P:null,todoTotal:null!==(R=null!==(D=W.todoTotal)&&void 0!==D?D:t.todoTotal)&&void 0!==R?R:null,journeyStage:null!==(M=null!==(L=t.journeyStage)&&void 0!==L?L:t.journey_stage)&&void 0!==M?M:null,confidenceScore:null!==(z=null!==(U=null!==(B=W.confidenceScore)&&void 0!==B?B:t.confidenceScore)&&void 0!==U?U:t.confidence_score)&&void 0!==z?z:null,isSubOpportunity:null!==(F=q.isSubOpportunity)&&void 0!==F&&F,isSubSolution:null!==(K=q.isSubSolution)&&void 0!==K&&K,raw:t}};function Rl(e,t,n,r){const o=Al("solution",e,t,n,r,{isSubSolution:arguments.length>4&&void 0!==arguments[4]&&arguments[4]}),i=Pl(e.subSolutions),a=Pl(e.tests),s=[...i.map((e,t)=>Rl(e,o.key,t,r,!0)),...a.map((e,t)=>{const n=Al("test",e,o.key,i.length+t,r);return n.children=[],n})];return o.children=s.sort((e,t)=>{var n,r;return(null!==(n=e.order)&&void 0!==n?n:0)-(null!==(r=t.order)&&void 0!==r?r:0)}),o}function Dl(e,t,n,r){const o=Al("opportunity",e,t,n,r,{isSubOpportunity:arguments.length>4&&void 0!==arguments[4]&&arguments[4]}),i=Pl(e.subOpportunities),a=Pl(e.solutions),s=[...i.map((e,t)=>Dl(e,o.key,t,r,!0)),...a.map((e,t)=>Rl(e,o.key,i.length+t,r,!1))];return o.children=s.sort((e,t)=>{var n,r;return(null!==(n=e.order)&&void 0!==n?n:0)-(null!==(r=t.order)&&void 0!==r?r:0)}),o}const Ml=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={},r=Al("outcome",e,null,0,t);n[r.key]=r;const o=Pl(e.opportunities);r.children=o.map((e,n)=>Dl(e,r.key,n,t,!1));const i=e=>{e&&e.key&&(n[e.key]=e),(e.children||[]).forEach(i)};return i(r),{root:r,nodesByKey:n}},Ll=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={},r=Al("outcome",e,null,0,t);n[r.key]=r;const o=Pl(e.opportunities),i=new Map;o.forEach(e=>{var t,n;const r=null!==(t=null!==(n=e.journeyStage)&&void 0!==n?n:e.journey_stage)&&void 0!==t?t:Il;i.has(r)||i.set(r,[]),i.get(r).push(e)});const a=[...Ol.map(e=>e.id),Il],s=[...i.keys()].sort((e,t)=>a.indexOf(e)-a.indexOf(t));r.children=s.map((n,o)=>{var a,s;const l=i.get(n),c="journey:".concat(e.id,":").concat(n);return{key:c,id:n,type:"journey",parentKey:r.key,order:o,title:n===Il?"Unassigned":null!==(a=null===(s=Ol.find(e=>e.id===n))||void 0===s?void 0:s.label)&&void 0!==a?a:n,isUnassigned:n===Il,count:l.length,children:l.map((e,n)=>Dl(e,c,n,t,!1))}});const l=e=>{e&&e.key&&(n[e.key]=e),(e.children||[]).forEach(l)};return l(r),{root:r,nodesByKey:n}},zl=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{treeStructure:r="classic"}=n,o=[],i={},a="journey"===r?Ll:Ml;return Pl(e).forEach(e=>{const n=a(e,t);o.push(n.root),Object.assign(i,n.nodesByKey)}),{roots:o,nodesByKey:i}};function Ul(e,t,n,r,o){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if("solution"===t&&e.id===n)return{type:t,node:e,parent:i||o,opportunity:o,root:r};for(const a of Pl(e.subSolutions)){const i=Ul(a,t,n,r,o,e);if(i)return i}for(const a of Pl(e.tests))if("test"===t&&a.id===n)return{type:t,node:a,parent:e,opportunity:o,root:r};return null}function Bl(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if("opportunity"===t&&e.id===n)return{type:t,node:e,parent:o||r,opportunity:e,root:r};for(const i of Pl(e.subOpportunities)){const o=Bl(i,t,n,r,e);if(o)return o}for(const i of Pl(e.solutions)){const o=Ul(i,t,n,r,e);if(o)return o}return null}const Fl=(e,t)=>{if(!t)return null;const[n,r]=t.split(":");if(!n||!r)return null;for(const o of e){if("outcome"===n&&o.id===r)return{type:n,node:o};for(const e of Pl(o.opportunities)){const t=Bl(e,n,r,o);if(t)return t}}return null};var Kl=n(3577),ql=n.n(Kl);const Vl={outcome:{width:320,height:120},journey:{width:96,height:32},opportunity:{width:248,height:80},solution:{width:228,height:74},test:{width:208,height:70},overflow:{width:140,height:48}};const Wl=function(t){var n;let{parentType:r,hiddenChildren:o,onClose:i,onSelect:a,onAddChild:s}=t;const[l,c]=(0,e.useState)(""),u=r?null===(n=Hs[r])||void 0===n?void 0:n[0]:null,d=(0,e.useMemo)(()=>l?o.filter(e=>{var t;return null===(t=e.title)||void 0===t?void 0:t.toLowerCase().includes(l.toLowerCase())}):o,[o,l]);return(0,il.jsx)("div",{className:"overflow-modal-backdrop",onClick:i,children:(0,il.jsxs)("div",{className:"overflow-modal",onClick:e=>e.stopPropagation(),children:[(0,il.jsxs)("div",{className:"overflow-modal-header",children:[(0,il.jsxs)("div",{children:["Hidden items (",o.length,")"]}),(0,il.jsxs)("div",{className:"overflow-modal-actions",children:[u&&(0,il.jsxs)("button",{type:"button",onClick:()=>null===s||void 0===s?void 0:s(u),children:["Add ",Ys[u]]}),(0,il.jsx)("button",{type:"button",onClick:i,children:"Close"})]})]}),(0,il.jsx)("input",{className:"overflow-search",placeholder:"Search hidden items",value:l,onChange:e=>c(e.target.value)}),(0,il.jsx)("div",{className:"overflow-list",children:d.map(e=>(0,il.jsxs)("button",{type:"button",className:"overflow-item",onClick:()=>{null===a||void 0===a||a({type:e.type,id:e.id}),i()},children:[(0,il.jsx)("span",{className:"overflow-item-type",children:Ys[e.type]}),(0,il.jsx)("span",{className:"overflow-item-title",children:e.title})]},e.key))})]})})},Hl={outcome:kl,opportunity:El,solution:Cl,test:Nl,overflow:jl,journey:Tl},Yl={default:{stroke:ol.edge.base.stroke,strokeWidth:1.2},draft:{stroke:"rgba(100, 116, 139, 0.32)",strokeWidth:1.1},planned:{stroke:ol.status.planned,strokeWidth:1.1,strokeDasharray:"4 6"},live:{stroke:ol.status.live,strokeWidth:1.4,strokeDasharray:"6 8"},done_pass:{stroke:ol.status.done_pass,strokeWidth:1.5},done_iterate:{stroke:ol.status.done_iterate,strokeWidth:1.3},done_kill:{stroke:ol.status.done_kill,strokeWidth:1.5}};const Gl={live:function(e){let{id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,sourcePosition:a,targetPosition:s,style:l,markerEnd:c}=e;const[u]=Lo({sourceX:n,sourceY:r,targetX:o,targetY:i,sourcePosition:a,targetPosition:s});return(0,il.jsx)(_o,{id:t,path:u,style:l,markerEnd:c,className:"edge-live-path"})}};const Xl=function(t){let{outcomes:n,treeStructure:r="classic",onUpdate:o,users:i,confidenceMap:a,onAddOutcome:l}=t;const{state:{collapsed:c,selectedKey:u,layoutUnlocked:d,focusKey:h,nodeOverrides:f},actions:{setSelectedKey:p,toggleCollapse:v,clearSelection:m,setFocusKey:g}}=vl(),[y,w,b]=Cs([]),[_,x,S]=Ns([]),[k,E]=(0,e.useState)(null),[C,N]=(0,e.useState)(null),[j,T]=(0,e.useState)(0),[O,I]=(0,e.useState)(!1),[P,A]=(0,e.useState)(null),R=(0,e.useMemo)(()=>{const e=new Map;return(i||[]).forEach(t=>{e.set(t.id,t)}),e},[i]),D=(0,e.useMemo)(()=>{const e={};return(i||[]).forEach(t=>{e[t.id]=t.name||t.email||t.id}),e},[i]),M=(0,e.useMemo)(()=>zl(n,f,{treeStructure:r}),[n,f,r]),L=(0,e.useMemo)(()=>new Set(Object.keys(c).filter(e=>c[e])),[c]),z=h,U=(0,e.useMemo)(()=>((e,t)=>{if(!t||!e[t])return{nodes:new Set,edges:new Set};const n=new Set,r=new Set,o=t=>{t&&(n.add(t.key),t.parentKey&&(r.add("".concat(t.parentKey,"->").concat(t.key)),o(e[t.parentKey])))},i=t=>{t&&(n.add(t.key),(t.children||[]).forEach(n=>{r.add("".concat(t.key,"->").concat(n.key)),i(e[n.key])}))},a=e[t];return o(a),i(a),{nodes:n,edges:r}})(M.nodesByKey,z),[M.nodesByKey,z]),{nodes:B,edges:F,overflowNodes:K}=(0,e.useMemo)(()=>function(e,t){var n;const r=[],o=[],i=[],a=null!==(n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).maxChildren)&&void 0!==n?n:8,s=e=>{if(r.push(e),null!==t&&void 0!==t&&t.has(e.key))return;const n=[...e.children||[]].sort((e,t)=>("number"===typeof e.order?e.order:0)-("number"===typeof t.order?t.order:0)),l=n.slice(0,a),c=n.slice(a);if(l.forEach(t=>{o.push({id:"".concat(e.key,"->").concat(t.key),source:e.key,target:t.key}),s(t)}),c.length>0){const t="".concat(e.key,":overflow");i.push({key:t,id:t,type:"overflow",parentKey:e.key,title:"+".concat(c.length," more"),hiddenChildren:c}),o.push({id:"".concat(e.key,"->").concat(t),source:e.key,target:t})}};return(e||[]).forEach(e=>s(e)),{nodes:r,edges:o,overflowNodes:i}}(M.roots,L,{maxChildren:8}),[M.roots,L]),q=(0,e.useMemo)(()=>{const e=B.map(e=>{var t,n,r;return{id:e.key,type:e.type,data:s(s({nodeKey:e.key,node:e,type:e.type,title:e.title,status:e.status,ownerLabel:e.owner?D[e.owner]||e.owner:"",ownerId:e.owner||null,ownerUser:e.owner?R.get(e.owner):null,contributorUsers:(e.contributorIds||e.contributors||[]).map(e=>R.get(e)).filter(Boolean),description:e.description,confidence:null===a||void 0===a?void 0:a[e.key],testTemplate:e.testTemplate||null,testType:e.testType||null,testStatus:e.testStatus||null,resultDecision:e.resultDecision||null,todoDone:null!==(t=e.todoDone)&&void 0!==t?t:null,todoTotal:null!==(n=e.todoTotal)&&void 0!==n?n:null,isCollapsed:L.has(e.key),hasChildren:(e.children||[]).length>0,isDimmed:!!z&&!U.nodes.has(e.key),isHovered:!1,isSubOpportunity:!0===e.isSubOpportunity,isSubSolution:!0===e.isSubSolution,confidenceScore:null!==(r=e.confidenceScore)&&void 0!==r?r:null},"solution"===e.type?(()=>{const t=function(e){const t=[],n=e=>{(e.children||[]).forEach(e=>{if("test"===e.type){const n=el(e.resultDecision);n&&t.push(n)}else"solution"===e.type&&n(e)})};return n(e),t}(e);return{hasPassExperiment:t.some(e=>"pass"===e),allExperimentsKill:t.length>0&&t.every(e=>"kill"===e)}})():{}),{},{onSelect:p,onToggleCollapse:v,onToggleAdd:e=>E(t=>t===e?null:e),onAddChild:(e,t)=>{L.has(e)&&v(e),E(null),null===o||void 0===o||o("add-child",{parentKey:e,childType:t})},onRename:(e,t)=>null===o||void 0===o?void 0:o("rename",{nodeKey:e,title:t}),onDelete:e=>null===o||void 0===o?void 0:o("delete-node",{nodeKey:e}),onUpdateConfidence:(e,t)=>null===o||void 0===o?void 0:o("set-confidence",{nodeKey:e,score:t}),onPromoteSubSolution:e=>null===o||void 0===o?void 0:o("promote-sub-solution",{nodeKey:e}),isAddOpen:k===e.key,childrenCount:(e.children||[]).length}),position:{x:0,y:0},sourcePosition:"right",targetPosition:"left"}}),t=K.map(e=>({id:e.key,type:"overflow",data:{title:e.title,hiddenChildren:e.hiddenChildren,isDimmed:!!z&&!U.nodes.has(e.parentKey),onOpenOverflow:()=>{var t;return N({parentKey:e.parentKey,parentType:null===(t=M.nodesByKey[e.parentKey])||void 0===t?void 0:t.type,hiddenChildren:e.hiddenChildren})}},position:{x:0,y:0},sourcePosition:"right",targetPosition:"left"}));return[...e,...t]},[B,K,L,z,U,p,v,k,o,M,D,a,R]),V=(0,e.useMemo)(()=>F.map(e=>{var t,n;const r=null===(t=M.nodesByKey[e.source])||void 0===t?void 0:t.type,o=(e=>{if(!e||"test"!==e.type)return"default";const t=$s(e.testStatus||e.status),n=(e.resultDecision||"").toLowerCase(),r="number"===typeof e.todoTotal&&e.todoTotal>0&&(e.todoDone||0)<e.todoTotal;if("designed"===t&&!r&&("pass"===n||"iterate"===n||"kill"===n)){if("pass"===n)return"done_pass";if("iterate"===n)return"done_iterate";if("kill"===n)return"done_kill"}return"designed"===t?"live":"planned"})(M.nodesByKey[e.target]),i=r?null===(n=ol.type[r])||void 0===n?void 0:n.accent:null,a=!!z&&U.edges.has(e.id),l=Yl[o]||Yl.default,c=a&&i||l.stroke,u=a?Math.max(l.strokeWidth||1,ol.edge.active.width):l.strokeWidth||ol.edge.base.width;return{id:e.id,source:e.source,target:e.target,type:"live"===o?"live":"smoothstep",animated:!1,style:s(s({},l),{},{stroke:c,strokeWidth:u}),className:["edge-state-".concat(o),z&&!a?"edge-dimmed":"",a?"edge-active":""].filter(Boolean).join(" ")}}),[F,z,U.edges,M.nodesByKey]),W=(0,e.useMemo)(()=>function(e,t){var n,r,o,i;let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const l=a.direction||"LR",c=new(ql().graphlib.Graph);return c.setDefaultEdgeLabel(()=>({})),c.setGraph({rankdir:l,ranksep:null!==(n=a.rankSep)&&void 0!==n?n:88,nodesep:null!==(r=a.nodeSep)&&void 0!==r?r:30,marginx:null!==(o=a.marginX)&&void 0!==o?o:24,marginy:null!==(i=a.marginY)&&void 0!==i?i:24}),e.forEach(e=>{var t,n,r;const o=(null===(t=e.data)||void 0===t?void 0:t.type)||e.type,i=Vl[o]||Vl.solution,a=(null===(n=e.data)||void 0===n?void 0:n.isSubOpportunity)||(null===(r=e.data)||void 0===r?void 0:r.isSubSolution),s=a?Math.round(.92*i.width):i.width,l=a?Math.round(.88*i.height):i.height;c.setNode(e.id,{width:s,height:l})}),t.forEach(e=>{c.setEdge(e.source,e.target)}),ql().layout(c),e.map(e=>{var t,n,r;const o=(null===(t=e.data)||void 0===t?void 0:t.type)||e.type,i=Vl[o]||Vl.solution,a=(null===(n=e.data)||void 0===n?void 0:n.isSubOpportunity)||(null===(r=e.data)||void 0===r?void 0:r.isSubSolution),l=a?Math.round(.92*i.width):i.width,u=a?Math.round(.88*i.height):i.height,d=c.node(e.id);return s(s({},e),{},{position:{x:d.x-l/2,y:d.y-u/2}})})}(q,V),[q,V,j]);return(0,e.useEffect)(()=>{x(V)},[V,x]),(0,e.useEffect)(()=>{w(W)},[W,w]),(0,e.useEffect)(()=>{if(O||0===W.length||!P)return;const e=window.requestAnimationFrame(()=>{P.fitView({padding:.2,duration:200}),I(!0)});return()=>window.cancelAnimationFrame(e)},[P,O,W.length]),(0,e.useEffect)(()=>{if(!u||!P)return;const e=y.find(e=>e.id===u),t=(null===e||void 0===e?void 0:e.positionAbsolute)||(null===e||void 0===e?void 0:e.position);t&&P.setCenter(t.x,t.y,{zoom:1.1,duration:300})},[u,y,P]),(0,e.useEffect)(()=>{const e=()=>{T(e=>e+1)},t=()=>window.requestAnimationFrame(e);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),n&&0!==n.length?(0,il.jsxs)("div",{className:"tree-canvas-card",children:[(0,il.jsxs)("div",{className:"tree-canvas-body",children:[(0,il.jsxs)(ks,{nodes:y,edges:_,onNodesChange:b,onEdgesChange:S,onInit:A,nodeTypes:Hl,edgeTypes:Gl,nodesDraggable:d,nodesConnectable:!1,elementsSelectable:!0,deleteKeyCode:null,onPaneClick:()=>{k&&E(null),m(),g(null)},style:{background:ol.canvas.bg},children:[(0,il.jsx)(Ds,{gap:20,size:1,color:ol.canvas.gridDot}),(0,il.jsx)(Ws,{showInteractive:!1,position:"bottom-right"})]}),(0,il.jsx)("button",{className:"tree-center-btn",type:"button",onClick:()=>null===P||void 0===P?void 0:P.fitView({padding:.2,duration:200}),children:"Center"})]}),C&&(0,il.jsx)(Wl,{parentKey:C.parentKey,parentType:C.parentType,hiddenChildren:C.hiddenChildren,onClose:()=>N(null),onSelect:e=>p(nl(e.type,e.id)),onAddChild:e=>null===o||void 0===o?void 0:o("add-child",{parentKey:C.parentKey,childType:e})})]}):(0,il.jsxs)("div",{className:"tree-empty-state",children:[(0,il.jsx)("div",{className:"tree-empty-title",children:"This Decision Space has no Outcomes yet"}),(0,il.jsx)("div",{className:"tree-empty-subtitle",children:"Outcomes are the root goals of this tree."}),(0,il.jsx)("button",{type:"button",onClick:l,className:"tree-empty-cta",children:"Add first Outcome"})]})};const Jl=function(e){let{outcomes:t,treeStructure:n="classic",onUpdate:r,users:o,confidenceMap:i,onAddOutcome:a}=e;return(0,il.jsx)("div",{className:"tree-mode-view",children:(0,il.jsx)(Xl,{outcomes:t,treeStructure:n,onUpdate:r,users:o,confidenceMap:i,onAddOutcome:a})})};function $l(e){var t,n;let{node:r,depth:o,collapsed:i,selectedKey:a,renamingKey:s,onSelect:l,onToggleCollapse:c,onRename:u,onAddChild:d,onSetRenaming:h,confidenceMap:f}=e;const p=i[r.key],v=a===r.key,m=s===r.key,g=(null===(t=Hs[r.type])||void 0===t?void 0:t.length)>0,y=(null===(n=r.children)||void 0===n?void 0:n.length)>0,b=e=>{const t=e.trim();t&&(u(r.key,t),h(null))};return(0,il.jsxs)("div",{className:"list-node list-node-".concat(r.type),children:[(0,il.jsxs)("div",{className:"list-node-row ".concat(v?"selected":""),style:{paddingLeft:"".concat(18*o,"px")},onClick:()=>l(r.key),children:[y?(0,il.jsx)("button",{className:"list-node-toggle",type:"button",onClick:e=>{e.stopPropagation(),c(r.key)},children:p?(0,il.jsx)(_,{}):(0,il.jsx)(w,{})}):(0,il.jsx)("span",{className:"list-node-toggle spacer"}),m?(0,il.jsx)("input",{className:"list-node-input",defaultValue:r.title,autoFocus:!0,onBlur:e=>b(e.target.value),onKeyDown:e=>{"Enter"===e.key&&b(e.currentTarget.value),"Escape"===e.key&&h(null)}}):(0,il.jsx)("span",{className:"list-node-title",children:r.title}),("opportunity"===r.type||"solution"===r.type)&&(null===f||void 0===f?void 0:f[r.key])&&(0,il.jsx)(sl,{confidence:f[r.key],showExplanation:!0}),g&&(0,il.jsxs)("button",{className:"list-node-action",type:"button",onClick:e=>{var t;e.stopPropagation(),t=Hs[r.type][0],i[r.key]&&c(r.key),d(r.key,t)},children:[(0,il.jsx)(N,{}),Ys[Hs[r.type][0]]]}),(0,il.jsx)("button",{className:"list-node-action secondary",type:"button",onClick:e=>{e.stopPropagation(),h(r.key)},children:"Rename"})]}),!p&&y&&(0,il.jsx)("div",{className:"list-node-children",children:r.children.map(e=>(0,il.jsx)($l,{node:e,depth:o+1,collapsed:i,selectedKey:a,renamingKey:s,onSelect:l,onToggleCollapse:c,onRename:u,onAddChild:d,onSetRenaming:h,confidenceMap:f},e.key))})]})}const Zl=function(t){let{outcomes:n,onUpdate:r,confidenceMap:o,onAddOutcome:i}=t;const{state:{collapsed:a,selectedKey:s,nodeOverrides:l,renamingKey:c},actions:{setSelectedKey:u,toggleCollapse:d,setRenamingKey:h}}=vl(),f=(0,e.useMemo)(()=>n&&0!==n.length?zl(n,l):null,[n,l]);return(0,il.jsx)("div",{className:"list-mode-view",children:f?(0,il.jsx)("div",{className:"list-tree",children:f.roots.map(e=>(0,il.jsx)($l,{node:e,depth:0,collapsed:a,selectedKey:s,renamingKey:c,onSelect:u,onToggleCollapse:d,onRename:(e,t)=>null===r||void 0===r?void 0:r("rename",{nodeKey:e,title:t}),onAddChild:(e,t)=>{null===r||void 0===r||r("add-child",{parentKey:e,childType:t})},onSetRenaming:h,confidenceMap:o},e.key))}):(0,il.jsxs)("div",{className:"empty-state compact",children:[(0,il.jsx)("p",{children:"This Decision Space has no Outcomes yet."}),(0,il.jsx)("button",{type:"button",className:"tree-empty-cta",onClick:i,children:"Add first Outcome"})]})})},Ql=(e,t,n)=>Math.min(n,Math.max(t,e)),ec=e=>{if(null==e||""===e)return null;const t=String(e).toLowerCase().trim();return"pass"===t||"iterate"===t||"kill"===t?t:null},tc=(e,t)=>t&&t.kill>0&&0===t.pass||t&&t.kill>=2?"low":e>=70?"high":e>=40?"medium":"low",nc=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.filter(e=>{if(!ec(e.resultDecision||e.result_decision))return!1;return!("number"===typeof e.todoTotal&&e.todoTotal>0&&(e.todoDone||0)<e.todoTotal)});let r=0,o=0,i=0,a=0;n.forEach(e=>{const n=ec(e.resultDecision||e.result_decision);"pass"===n&&(r+=1),"iterate"===n&&(o+=1),"kill"===n&&(i+=1);const s=(e=>"pass"===e?1:"iterate"===e?.3:"kill"===e?-1:0)(n),l=(e=>{if(!e||0===e.length)return.6;const t=e.map(e=>"high"===e.quality?1.2:"medium"===e.quality?1:.8);return t.reduce((e,t)=>e+t,0)/t.length})(t[e.id]),c=(e=>{if(!e)return.7;const t=(Date.now()-new Date(e).getTime())/864e5;return t<=14?1:t<=45?.85:.7})(e.updatedAt||e.updated_at||e.createdAt||e.created_at);a+=s*l*c});const s=n.length;let l=Ql(50+50*(0===s?0:a/s),0,100);l=Ql(l+Ql(3*(s-1),0,12),0,100);const c={score:l,doneTests:s,pass:r,iterate:o,kill:i},u=tc(l,c);return c.level=u,{score:l,level:u,explain:c}},rc=e=>Array.isArray(e)?e:[];function oc(e,t,n,r,o,i){rc(e).forEach(e=>{const a=function(e,t){return rc(e.tests).map(e=>{const n=t["test:".concat(e.id)];return n?s(s({},e),n):e})}(e,i);n.push(...a),r.push(...a);const l=nc(a,o);t["solution:".concat(e.id)]=l,oc(e.subSolutions,t,n,r,o,i)})}function ic(e,t,n,r,o){rc(e).forEach(e=>{const i=[];oc(e.solutions,t,i,n,r,o);const a=nc(i,r);t["opportunity:".concat(e.id)]=a,ic(e.subOpportunities,t,n,r,o)})}const ac=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r={};return e.forEach(e=>{const o=[];ic(e.opportunities,r,o,t,n);const i=nc(o,t);r["outcome:".concat(e.id)]=i}),r};const sc=function(t){let{outcomes:n,outcomesCount:r,workspaceName:o,decisionSpaceName:i,onUpdate:a,onAddOutcome:s,users:l}=t;const[c,u]=(0,e.useState)(!1),{state:{viewMode:d,treeStructure:h,layoutUnlocked:f,nodeOverrides:p,selectedKey:v,evidenceByTest:m},actions:{setTreeStructure:g,setLayoutUnlocked:y,setCollapseMap:w,clearOverrides:b,setRenamingKey:_,setFocusKey:x,setSelectedKey:k}}=vl();(0,e.useEffect)(()=>{b()},[n,b]),(0,e.useEffect)(()=>{const e=e=>{const t=e.target;if(!("INPUT"===(null===t||void 0===t?void 0:t.tagName)||"TEXTAREA"===(null===t||void 0===t?void 0:t.tagName)||null!==t&&void 0!==t&&t.isContentEditable)&&v){if("Enter"===e.key&&(e.preventDefault(),_(v)),"Tab"===e.key){var n;e.preventDefault();const t=rl(v),r=t?null===(n=Hs[t.type])||void 0===n?void 0:n[0]:null;r&&(null===a||void 0===a||a("add-child",{parentKey:v,childType:r}))}"Escape"===e.key&&x(null)}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[a,v,x,_]);const E=(0,e.useMemo)(()=>{if(!n||0===n.length)return[];const e=zl(n,p,{treeStructure:h}),t=[];return(e.roots||[]).forEach(e=>{const n=(e,r)=>{t.push({node:e,depth:r}),(e.children||[]).forEach(e=>n(e,r+1))};n(e,1)}),t},[n,p,h]),C=e=>{const t={};E.forEach(n=>{let{node:r,depth:o}=n;(r.children||[]).length>0&&(t[r.key]=o>=e)}),w(t)},N=(0,e.useMemo)(()=>n&&0!==n.length?ac(n,m,p):{},[n,m,p]),j="list"===d,T=(0,il.jsx)("div",{className:"tree-view-content",children:(0,il.jsx)("div",{className:"tree-container",onClick:()=>k(null),children:"tree"===d?(0,il.jsx)(Jl,{outcomes:n,treeStructure:h,onUpdate:a,users:l,confidenceMap:N,onAddOutcome:s}):(0,il.jsx)(Zl,{outcomes:n,onUpdate:a,confidenceMap:N,onAddOutcome:s})})});return(0,il.jsx)("div",{className:"tree-view ".concat(j?"tree-view-list":"tree-view-canvas"),children:j?(0,il.jsxs)(il.Fragment,{children:[(0,il.jsxs)("div",{className:"context-bar",children:[(0,il.jsxs)("span",{children:["Workspace \xb7 ",o||"\u2014"]}),(0,il.jsx)("span",{children:"\xb7"}),(0,il.jsxs)("span",{children:["Decision Space \xb7 ",i||"\u2014"]}),(0,il.jsx)("span",{children:"\xb7"}),(0,il.jsxs)("span",{children:[r||0," Outcomes"]})]}),T]}):(0,il.jsxs)("div",{className:"canvas-root",children:[(0,il.jsxs)("div",{className:"context-bar",children:[(0,il.jsxs)("span",{children:["Workspace \xb7 ",o||"\u2014"]}),(0,il.jsx)("span",{children:"\xb7"}),(0,il.jsxs)("span",{children:["Decision Space \xb7 ",i||"\u2014"]}),(0,il.jsx)("span",{children:"\xb7"}),(0,il.jsxs)("span",{children:[r||0," Outcomes"]})]}),(0,il.jsx)("div",{className:"tree-toolbar",children:"tree"===d&&(0,il.jsxs)(il.Fragment,{children:[(0,il.jsxs)("div",{className:"tree-toolbar-structure",role:"group","aria-label":"Tree structure",children:[(0,il.jsx)("span",{className:"tree-toolbar-label",children:"Structure:"}),(0,il.jsx)("button",{type:"button",className:"tree-toolbar-btn tree-toolbar-structure-btn ".concat("classic"===h?"active":""),onClick:()=>g("classic"),children:"Classic"}),(0,il.jsx)("button",{type:"button",className:"tree-toolbar-btn tree-toolbar-structure-btn ".concat("journey"===h?"active":""),onClick:()=>g("journey"),children:"Journey"})]}),(0,il.jsx)("button",{className:"tree-toolbar-btn",type:"button",onClick:()=>{const e={};E.forEach(t=>{let{node:n}=t;(n.children||[]).length>0&&(e[n.key]=!0)}),w(e)},children:"Collapse all"}),(0,il.jsx)("button",{className:"tree-toolbar-btn",type:"button",onClick:()=>{const e={};E.forEach(t=>{let{node:n}=t;e[n.key]=!1}),w(e)},children:"Expand all"}),(0,il.jsxs)("div",{className:"tree-toolbar-expand",children:[(0,il.jsx)("button",{className:"tree-toolbar-btn",type:"button",onClick:()=>C(2),children:"Expand to level"}),(0,il.jsx)("div",{className:"tree-toolbar-expand-options",children:[1,2,3,4].map(e=>(0,il.jsxs)("button",{type:"button",onClick:()=>C(e),children:["Level ",e]},e))})]}),(0,il.jsxs)("div",{className:"tree-toolbar-menu",children:[(0,il.jsx)("button",{className:"tree-toolbar-btn icon",type:"button",onClick:()=>u(e=>!e),children:(0,il.jsx)(S,{})}),c&&(0,il.jsx)("div",{className:"tree-toolbar-menu-card",children:(0,il.jsx)("button",{type:"button",onClick:()=>{y(!f),u(!1)},children:f?"Lock layout":"Unlock layout"})})]})]})}),T]})})},lc=(0,e.forwardRef)(function(e,t){let{onCreate:n,label:r="+ Outcome",disabled:o=!1}=e;return(0,il.jsxs)("button",{ref:t,type:"button",onClick:e=>{e.preventDefault(),null===n||void 0===n||n()},className:"add-outcome-btn",disabled:o,title:o?"Create or select a Decision Space first":void 0,"data-onboarding":"add-outcome",children:[(0,il.jsx)(N,{})," ",r]})}),cc="treeflow:onboarding_completed",uc=[{headline:"Start with a clear Outcome",body:"An Outcome defines the strategic result you want to achieve. Everything else connects to this.",cta:"Create Outcome"},{headline:"Break it into Opportunities",body:"Opportunities describe user problems or growth levers. Think: Where is the friction? Where is the upside?",cta:"Add Opportunity"},{headline:"Propose a Solution",body:"Solutions are bets. They should be testable. Don't overthink \u2014 you can refine later.",cta:"Add Solution"},{headline:"Test with Experiments",body:"Experiments validate or invalidate your ideas. TreeFlow connects strategy to evidence.",cta:"Add Experiment"}];function dc(e){try{e?localStorage.setItem(cc,"true"):localStorage.removeItem(cc)}catch(t){}}function hc(e){if(function(){try{return"true"===localStorage.getItem(cc)}catch(e){return!1}}())return!1;return 0===(Array.isArray(e)?e.length:0)}const fc=function(t){let{isOpen:n,onClose:r,outcomes:o=[],treeStructure:i="classic",onCreateOutcome:a,onUpdate:s,addOutcomeButtonRef:l}=t;const[c,u]=(0,e.useState)(1),[d,h]=(0,e.useState)(!1),[f,p]=(0,e.useState)(!1),[v,m]=(0,e.useState)(null),g=(0,e.useRef)(null),y=Array.isArray(o)?o.length:0,w=function(e){const t=null===e||void 0===e?void 0:e[0],n=null===t||void 0===t?void 0:t.opportunities;return Array.isArray(n)?n.length:0}(o),b=function(e){const t=null===e||void 0===e?void 0:e[0],n=null===t||void 0===t?void 0:t.opportunities,r=Array.isArray(n)?n[0]:null,o=null===r||void 0===r?void 0:r.solutions;return Array.isArray(o)?o.length:0}(o),_=function(e){const t=null===e||void 0===e?void 0:e[0],n=null===t||void 0===t?void 0:t.opportunities,r=Array.isArray(n)?n[0]:null,o=null===r||void 0===r?void 0:r.solutions,i=Array.isArray(o)?o[0]:null,a=null===i||void 0===i?void 0:i.tests;return Array.isArray(a)?a.length:0}(o);(0,e.useEffect)(()=>{n&&(y>=1&&1===c&&u(2),w>=1&&2===c&&(u(3),"journey"===i&&h(!0)),b>=1&&3===c&&u(4),_>=1&&4===c&&p(!0))},[n,y,w,b,_,c,i]),(0,e.useEffect)(()=>{if(!n||1!==c||null===l||void 0===l||!l.current)return void m(null);const e=l.current;let t=0;const r=()=>{t&&cancelAnimationFrame(t),t=requestAnimationFrame(()=>{t=0,m(e.getBoundingClientRect())})};r();const o=new ResizeObserver(r);return o.observe(e),window.addEventListener("scroll",r,!0),()=>{t&&cancelAnimationFrame(t),o.disconnect(),window.removeEventListener("scroll",r,!0)}},[n,c,l]);const x=()=>{dc(!0),null===r||void 0===r||r()};if(!n)return null;const S=uc[c-1];return f?(0,Pr.createPortal)((0,il.jsx)("div",{className:"onboarding-flow onboarding-flow-success",ref:g,children:(0,il.jsxs)("div",{className:"onboarding-flow-success-inner",children:[(0,il.jsx)("p",{className:"onboarding-flow-success-text",children:"You're ready. Now refine, test, and build momentum."}),(0,il.jsx)("button",{type:"button",className:"onboarding-flow-btn onboarding-flow-btn-primary",onClick:x,children:"Explore TreeFlow"})]})}),document.body):(0,Pr.createPortal)((0,il.jsxs)(il.Fragment,{children:[1===c&&v&&(0,il.jsx)("div",{className:"onboarding-flow-spotlight",style:{top:v.top-6,left:v.left-6,width:v.width+12,height:v.height+12}}),(0,il.jsxs)("div",{className:"onboarding-flow-panel",ref:g,style:1===c&&v?{position:"fixed",top:v.bottom+12,left:v.left,right:"auto",maxWidth:360}:{},children:[(0,il.jsxs)("div",{className:"onboarding-flow-progress",children:["Step ",c," of ",4]}),(0,il.jsx)("h3",{className:"onboarding-flow-headline",children:S.headline}),(0,il.jsx)("p",{className:"onboarding-flow-body",children:S.body}),d&&3===c&&(0,il.jsx)("p",{className:"onboarding-flow-tip",children:"Journey stages help you think across the full customer lifecycle. You can switch between Classic and Journey anytime."}),(0,il.jsxs)("div",{className:"onboarding-flow-actions",children:[(0,il.jsx)("button",{type:"button",className:"onboarding-flow-btn onboarding-flow-btn-primary",onClick:()=>{if(1!==c){if(2===c){const e="journey"===i?function(e){const t=null===e||void 0===e?void 0:e[0];return null!==t&&void 0!==t&&t.id?"journey:".concat(t.id,":").concat(Il):null}(o):function(e){const t=null===e||void 0===e?void 0:e[0];return t?nl("outcome",t.id):null}(o);return void(e&&(null===s||void 0===s||s("add-child",{parentKey:e,childType:"opportunity",initialTitle:"Low engagement in first week"})))}if(3===c){const e=function(e){const t=null===e||void 0===e?void 0:e[0],n=null===t||void 0===t?void 0:t.opportunities,r=Array.isArray(n)?n[0]:null;return r?nl("opportunity",r.id):null}(o);return void(e&&(null===s||void 0===s||s("add-child",{parentKey:e,childType:"solution",initialTitle:"In-app 7-day habit checklist"})))}if(4===c){const e=function(e){const t=null===e||void 0===e?void 0:e[0],n=null===t||void 0===t?void 0:t.opportunities,r=Array.isArray(n)?n[0]:null,o=null===r||void 0===r?void 0:r.solutions,i=Array.isArray(o)?o[0]:null;return i?nl("solution",i.id):null}(o);e&&(null===s||void 0===s||s("add-child",{parentKey:e,childType:"test",initialTitle:"A/B test: checklist vs control on activation"}))}}else null===a||void 0===a||a("Increase weekly active usage by 20%")},children:S.cta}),(0,il.jsxs)("div",{className:"onboarding-flow-actions-secondary",children:[c>1&&(0,il.jsx)("button",{type:"button",className:"onboarding-flow-btn onboarding-flow-btn-ghost",onClick:()=>{c>1&&u(c-1)},children:"Back"}),(0,il.jsx)("button",{type:"button",className:"onboarding-flow-btn onboarding-flow-btn-ghost",onClick:()=>{dc(!0),null===r||void 0===r||r()},children:"Skip"}),(0,il.jsx)("button",{type:"button",className:"onboarding-flow-btn onboarding-flow-btn-ghost",onClick:r,"aria-label":"Close",children:"Close"})]})]})]})]}),document.body)},pc=2e3;function vc(t){let{message:n,variant:r="success",onDismiss:o}=t;return(0,e.useEffect)(()=>{const e=setTimeout(o,4e3);return()=>clearTimeout(e)},[o]),(0,il.jsx)("div",{className:"feedback-toast feedback-toast-".concat(r),role:"status",children:n})}const mc=function(t){let{context:n={},onSendFeedback:r,isOpen:o,onOpenChange:i}=t;const[a,l]=(0,e.useState)(""),[c,u]=(0,e.useState)(!0),[d,h]=(0,e.useState)(!1),[f,p]=(0,e.useState)(null),[v,m]=(0,e.useState)(!1),g=(0,e.useRef)(null),y=(0,e.useRef)(null),w=void 0!==o,b=w?o:v,_=w?i||(()=>{}):m,x=function(e){p({message:e,variant:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"})},S=()=>{_(!1),l("")};return(0,e.useEffect)(()=>{const e=e=>{"Escape"===e.key&&S()};if(b)return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[b]),(0,il.jsxs)(il.Fragment,{children:[(0,il.jsx)("button",{type:"button",className:"feedback-widget-pill",onClick:()=>_(!0),"aria-label":"Send feedback",children:"Feedback"}),b&&(0,il.jsx)("div",{ref:y,className:"feedback-widget-backdrop",onClick:e=>{e.target===y.current&&S()},"aria-hidden":!0,children:(0,il.jsxs)("div",{ref:g,className:"feedback-widget-panel",role:"dialog","aria-labelledby":"feedback-title",onClick:e=>e.stopPropagation(),children:[(0,il.jsx)("h2",{id:"feedback-title",className:"feedback-widget-title",children:"Send Feedback"}),(0,il.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const t=null===a||void 0===a?void 0:a.trim();if(t){h(!0);try{await r(s({message:t,includeContext:!!c},c?n:{})),x("Thanks. We read every message.","success"),S()}catch(o){const e=(null===o||void 0===o?void 0:o.message)||"Could not send feedback. Please try again.";x(e,"error")}finally{h(!1)}}},children:[(0,il.jsx)("textarea",{className:"feedback-widget-textarea",value:a,onChange:e=>l(e.target.value.slice(0,pc)),placeholder:"What\u2019s on your mind?",rows:4,required:!0,maxLength:pc,disabled:d}),(0,il.jsxs)("div",{className:"feedback-widget-meta",children:[(0,il.jsxs)("label",{className:"feedback-widget-checkbox",children:[(0,il.jsx)("input",{type:"checkbox",checked:c,onChange:e=>u(e.target.checked),disabled:d}),(0,il.jsx)("span",{children:"Include page context"})]}),(0,il.jsxs)("span",{className:"feedback-widget-counter",children:[a.length," / ",pc]})]}),(0,il.jsxs)("div",{className:"feedback-widget-actions",children:[(0,il.jsx)("button",{type:"button",className:"feedback-widget-btn secondary",onClick:S,disabled:d,children:"Cancel"}),(0,il.jsx)("button",{type:"submit",className:"feedback-widget-btn primary",disabled:d||!a.trim(),children:d?"Sending\u2026":"Send"})]})]})]})}),f&&(0,il.jsx)(vc,{message:f.message,variant:f.variant,onDismiss:()=>p(null)})]})};function gc(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function yc(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{l(r.next(e))}catch(t){i(t)}}function s(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;class wc extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",n=arguments.length>2?arguments[2]:void 0;super(e),this.name=t,this.context=n}}class bc extends wc{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class _c extends wc{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class xc extends wc{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Sc;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(Sc||(Sc={}));class kc{constructor(e){let{headers:t={},customFetch:n,region:r=Sc.Any}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=t,this.region=r,this.fetch=(e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)})(n)}setAuth(e){this.headers.Authorization="Bearer ".concat(e)}invoke(e){return yc(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){var r;let o,i;try{const{headers:a,method:s,body:l,signal:c,timeout:u}=n;let d={},{region:h}=n;h||(h=t.region);const f=new URL("".concat(t.url,"/").concat(e));let p;h&&"any"!==h&&(d["x-region"]=h,f.searchParams.set("forceFunctionRegion",h)),l&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?"undefined"!==typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",p=l):"string"===typeof l?(d["Content-Type"]="text/plain",p=l):"undefined"!==typeof FormData&&l instanceof FormData?p=l:(d["Content-Type"]="application/json",p=JSON.stringify(l)):p=!l||"string"===typeof l||"undefined"!==typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer||"undefined"!==typeof FormData&&l instanceof FormData?l:JSON.stringify(l);let v=c;u&&(i=new AbortController,o=setTimeout(()=>i.abort(),u),c?(v=i.signal,c.addEventListener("abort",()=>i.abort())):v=i.signal);const m=yield t.fetch(f.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},d),t.headers),a),body:p,signal:v}).catch(e=>{throw new bc(e)}),g=m.headers.get("x-relay-error");if(g&&"true"===g)throw new _c(m);if(!m.ok)throw new xc(m);let y,w=(null!==(r=m.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return y="application/json"===w?yield m.json():"application/octet-stream"===w||"application/pdf"===w?yield m.blob():"text/event-stream"===w?m:"multipart/form-data"===w?yield m.formData():yield m.text(),{data:y,error:null,response:m}}catch(a){return{data:null,error:a,response:a instanceof xc||a instanceof _c?a.context:void 0}}finally{o&&clearTimeout(o)}}()})}}var Ec=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},Cc=class{constructor(e){var t,n;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(n=e.isMaybeSingle)&&void 0!==n&&n,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var n=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{let t=null,r=null,o=null,i=e.status,a=e.statusText;if(e.ok){var s,l;if("HEAD"!==n.method){var c;const t=await e.text();""===t||(r="text/csv"===n.headers.get("Accept")||n.headers.get("Accept")&&(null===(c=n.headers.get("Accept"))||void 0===c?void 0:c.includes("application/vnd.pgrst.plan+text"))?t:JSON.parse(t))}const u=null===(s=n.headers.get("Prefer"))||void 0===s?void 0:s.match(/count=(exact|planned|estimated)/),d=null===(l=e.headers.get("content-range"))||void 0===l?void 0:l.split("/");u&&d&&d.length>1&&(o=parseInt(d[1])),n.isMaybeSingle&&"GET"===n.method&&Array.isArray(r)&&(r.length>1?(t={code:"PGRST116",details:"Results contain ".concat(r.length," rows, application/vnd.pgrst.object+json requires 1 row"),hint:null,message:"JSON object requested, multiple (or no) rows returned"},r=null,o=null,i=406,a="Not Acceptable"):r=1===r.length?r[0]:null)}else{var u;const o=await e.text();try{t=JSON.parse(o),Array.isArray(t)&&404===e.status&&(r=[],t=null,i=200,a="OK")}catch(d){404===e.status&&""===o?(i=204,a="No Content"):t={message:o}}if(t&&n.isMaybeSingle&&(null===t||void 0===t||null===(u=t.details)||void 0===u?void 0:u.includes("0 rows"))&&(t=null,i=200,a="OK"),t&&n.shouldThrowOnError)throw new Ec(t)}return{error:t,data:r,count:o,status:i,statusText:a}});return this.shouldThrowOnError||(r=r.catch(e=>{var t;let n="";const r=null===e||void 0===e?void 0:e.cause;if(r){var o,i,a,s;const t=null!==(o=null===r||void 0===r?void 0:r.message)&&void 0!==o?o:"",l=null!==(i=null===r||void 0===r?void 0:r.code)&&void 0!==i?i:"";n="".concat(null!==(a=null===e||void 0===e?void 0:e.name)&&void 0!==a?a:"FetchError",": ").concat(null===e||void 0===e?void 0:e.message),n+="\n\nCaused by: ".concat(null!==(s=null===r||void 0===r?void 0:r.name)&&void 0!==s?s:"Error",": ").concat(t),l&&(n+=" (".concat(l,")")),(null===r||void 0===r?void 0:r.stack)&&(n+="\n".concat(r.stack))}else{var l;n=null!==(l=null===e||void 0===e?void 0:e.stack)&&void 0!==l?l:""}return{error:{message:"".concat(null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"FetchError",": ").concat(null===e||void 0===e?void 0:e.message),details:n,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}returns(){return this}overrideTypes(){return this}},Nc=class extends Cc{select(e){let t=!1;const n=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(e){let{ascending:t=!0,nullsFirst:n,foreignTable:r,referencedTable:o=r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=o?"".concat(o,".order"):"order",a=this.url.searchParams.get(i);return this.url.searchParams.set(i,"".concat(a?"".concat(a,","):"").concat(e,".").concat(t?"asc":"desc").concat(void 0===n?"":n?".nullsfirst":".nullslast")),this}limit(e){let{foreignTable:t,referencedTable:n=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r="undefined"===typeof n?"limit":"".concat(n,".limit");return this.url.searchParams.set(r,"".concat(e)),this}range(e,t){let{foreignTable:n,referencedTable:r=n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o="undefined"===typeof r?"offset":"".concat(r,".offset"),i="undefined"===typeof r?"limit":"".concat(r,".limit");return this.url.searchParams.set(o,"".concat(e)),this.url.searchParams.set(i,"".concat(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain(){let{analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:r=!1,wal:o=!1,format:i="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var a;const s=[e?"analyze":null,t?"verbose":null,n?"settings":null,r?"buffers":null,o?"wal":null].filter(Boolean).join("|"),l=null!==(a=this.headers.get("Accept"))&&void 0!==a?a:"application/json";return this.headers.set("Accept","application/vnd.pgrst.plan+".concat(i,'; for="').concat(l,'"; options=').concat(s,";")),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer","max-affected=".concat(e)),this}};const jc=new RegExp("[,()]");var Tc=class extends Nc{eq(e,t){return this.url.searchParams.append(e,"eq.".concat(t)),this}neq(e,t){return this.url.searchParams.append(e,"neq.".concat(t)),this}gt(e,t){return this.url.searchParams.append(e,"gt.".concat(t)),this}gte(e,t){return this.url.searchParams.append(e,"gte.".concat(t)),this}lt(e,t){return this.url.searchParams.append(e,"lt.".concat(t)),this}lte(e,t){return this.url.searchParams.append(e,"lte.".concat(t)),this}like(e,t){return this.url.searchParams.append(e,"like.".concat(t)),this}likeAllOf(e,t){return this.url.searchParams.append(e,"like(all).{".concat(t.join(","),"}")),this}likeAnyOf(e,t){return this.url.searchParams.append(e,"like(any).{".concat(t.join(","),"}")),this}ilike(e,t){return this.url.searchParams.append(e,"ilike.".concat(t)),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,"ilike(all).{".concat(t.join(","),"}")),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,"ilike(any).{".concat(t.join(","),"}")),this}regexMatch(e,t){return this.url.searchParams.append(e,"match.".concat(t)),this}regexIMatch(e,t){return this.url.searchParams.append(e,"imatch.".concat(t)),this}is(e,t){return this.url.searchParams.append(e,"is.".concat(t)),this}isDistinct(e,t){return this.url.searchParams.append(e,"isdistinct.".concat(t)),this}in(e,t){const n=Array.from(new Set(t)).map(e=>"string"===typeof e&&jc.test(e)?'"'.concat(e,'"'):"".concat(e)).join(",");return this.url.searchParams.append(e,"in.(".concat(n,")")),this}notIn(e,t){const n=Array.from(new Set(t)).map(e=>"string"===typeof e&&jc.test(e)?'"'.concat(e,'"'):"".concat(e)).join(",");return this.url.searchParams.append(e,"not.in.(".concat(n,")")),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cs.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cs.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cs.".concat(JSON.stringify(t))),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cd.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cd.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cd.".concat(JSON.stringify(t))),this}rangeGt(e,t){return this.url.searchParams.append(e,"sr.".concat(t)),this}rangeGte(e,t){return this.url.searchParams.append(e,"nxl.".concat(t)),this}rangeLt(e,t){return this.url.searchParams.append(e,"sl.".concat(t)),this}rangeLte(e,t){return this.url.searchParams.append(e,"nxr.".concat(t)),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,"adj.".concat(t)),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(e,"ov.".concat(t)):this.url.searchParams.append(e,"ov.{".concat(t.join(","),"}")),this}textSearch(e,t){let{config:n,type:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o="";"plain"===r?o="pl":"phrase"===r?o="ph":"websearch"===r&&(o="w");const i=void 0===n?"":"(".concat(n,")");return this.url.searchParams.append(e,"".concat(o,"fts").concat(i,".").concat(t)),this}match(e){return Object.entries(e).forEach(e=>{let[t,n]=e;this.url.searchParams.append(t,"eq.".concat(n))}),this}not(e,t,n){return this.url.searchParams.append(e,"not.".concat(t,".").concat(n)),this}or(e){let{foreignTable:t,referencedTable:n=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=n?"".concat(n,".or"):"or";return this.url.searchParams.append(r,"(".concat(e,")")),this}filter(e,t,n){return this.url.searchParams.append(e,"".concat(t,".").concat(n)),this}},Oc=class{constructor(e,t){let{headers:n={},schema:r,fetch:o}=t;this.url=e,this.headers=new Headers(n),this.schema=r,this.fetch=o}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:n=!1,count:r}=null!==t&&void 0!==t?t:{},o=n?"HEAD":"GET";let i=!1;const a=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!i?"":('"'===e&&(i=!i),e)).join(""),{url:s,headers:l}=this.cloneRequestState();return s.searchParams.set("select",a),r&&l.append("Prefer","count=".concat(r)),new Tc({method:o,url:s,headers:l,schema:this.schema,fetch:this.fetch})}insert(e){let{count:t,defaultToNull:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r;const{url:o,headers:i}=this.cloneRequestState();if(t&&i.append("Prefer","count=".concat(t)),n||i.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));o.searchParams.set("columns",e.join(","))}}return new Tc({method:"POST",url:o,headers:i,schema:this.schema,body:e,fetch:null!==(r=this.fetch)&&void 0!==r?r:fetch})}upsert(e){let{onConflict:t,ignoreDuplicates:n=!1,count:r,defaultToNull:o=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var i;const{url:a,headers:s}=this.cloneRequestState();if(s.append("Prefer","resolution=".concat(n?"ignore":"merge","-duplicates")),void 0!==t&&a.searchParams.set("on_conflict",t),r&&s.append("Prefer","count=".concat(r)),o||s.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));a.searchParams.set("columns",e.join(","))}}return new Tc({method:"POST",url:a,headers:s,schema:this.schema,body:e,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}update(e){let{count:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;const{url:r,headers:o}=this.cloneRequestState();return t&&o.append("Prefer","count=".concat(t)),new Tc({method:"PATCH",url:r,headers:o,schema:this.schema,body:e,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch})}delete(){let{count:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;const{url:n,headers:r}=this.cloneRequestState();return e&&r.append("Prefer","count=".concat(e)),new Tc({method:"DELETE",url:n,headers:r,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch})}},Ic=class e{constructor(e){let{headers:t={},schema:n,fetch:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=new Headers(t),this.schemaName=n,this.fetch=r}from(e){if(!e||"string"!==typeof e||""===e.trim())throw new Error("Invalid relation name: relation must be a non-empty string.");return new Oc(new URL("".concat(this.url,"/").concat(e)),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:n=!1,get:r=!1,count:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var i;let a;const s=new URL("".concat(this.url,"/rpc/").concat(e));let l;const c=e=>null!==e&&"object"===typeof e&&(!Array.isArray(e)||e.some(c)),u=n&&Object.values(t).some(c);u?(a="POST",l=t):n||r?(a=n?"HEAD":"GET",Object.entries(t).filter(e=>{let[t,n]=e;return void 0!==n}).map(e=>{let[t,n]=e;return[t,Array.isArray(n)?"{".concat(n.join(","),"}"):"".concat(n)]}).forEach(e=>{let[t,n]=e;s.searchParams.append(t,n)})):(a="POST",l=t);const d=new Headers(this.headers);return u?d.set("Prefer",o?"count=".concat(o,",return=minimal"):"return=minimal"):o&&d.set("Prefer","count=".concat(o)),new Tc({method:a,url:s,headers:d,schema:this.schemaName,body:l,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}};const Pc=class{constructor(){}static detectEnvironment(){var e;if("undefined"!==typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!==typeof globalThis&&"undefined"!==typeof globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!==typeof n.g&&"undefined"!==typeof n.g.WebSocket)return{type:"native",constructor:n.g.WebSocket};if("undefined"!==typeof globalThis&&"undefined"!==typeof globalThis.WebSocketPair&&"undefined"===typeof globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!==typeof globalThis&&globalThis.EdgeRuntime||"undefined"!==typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const e=t.versions;if(e&&e.node){const t=e.node,n=parseInt(t.replace(/^v/,"").split(".")[0]);return n>=22?"undefined"!==typeof globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:"Node.js ".concat(n," detected but native WebSocket not found."),workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:"Node.js ".concat(n," detected without native WebSocket support."),workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+="\n\nSuggested solution: ".concat(e.workaround)),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}},Ac="realtime-js/".concat("2.90.1"),Rc="1.0.0",Dc=Rc,Mc=1e4;var Lc,zc,Uc,Bc,Fc,Kc;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(Lc||(Lc={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(zc||(zc={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(Uc||(Uc={})),function(e){e.websocket="websocket"}(Bc||(Bc={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(Fc||(Fc={}));class qc{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=null!==e&&void 0!==e?e:[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&"string"===typeof e.payload.event)return t(this._binaryEncodeUserBroadcastPush(e));let n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer(null===(t=e.payload)||void 0===t?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,n;const r=null!==(n=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==n?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,r)}_encodeJsonUserBroadcastPush(e){var t,n;const r=null!==(n=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==n?n:{},o=(new TextEncoder).encode(JSON.stringify(r)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,t,n){var r,o;const i=e.topic,a=null!==(r=e.ref)&&void 0!==r?r:"",s=null!==(o=e.join_ref)&&void 0!==o?o:"",l=e.payload.event,c=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},u=0===Object.keys(c).length?"":JSON.stringify(c);if(s.length>255)throw new Error("joinRef length ".concat(s.length," exceeds maximum of 255"));if(a.length>255)throw new Error("ref length ".concat(a.length," exceeds maximum of 255"));if(i.length>255)throw new Error("topic length ".concat(i.length," exceeds maximum of 255"));if(l.length>255)throw new Error("userEvent length ".concat(l.length," exceeds maximum of 255"));if(u.length>255)throw new Error("metadata length ".concat(u.length," exceeds maximum of 255"));const d=this.USER_BROADCAST_PUSH_META_LENGTH+s.length+a.length+i.length+l.length+u.length,h=new ArrayBuffer(this.HEADER_LENGTH+d);let f=new DataView(h),p=0;f.setUint8(p++,this.KINDS.userBroadcastPush),f.setUint8(p++,s.length),f.setUint8(p++,a.length),f.setUint8(p++,i.length),f.setUint8(p++,l.length),f.setUint8(p++,u.length),f.setUint8(p++,t),Array.from(s,e=>f.setUint8(p++,e.charCodeAt(0))),Array.from(a,e=>f.setUint8(p++,e.charCodeAt(0))),Array.from(i,e=>f.setUint8(p++,e.charCodeAt(0))),Array.from(l,e=>f.setUint8(p++,e.charCodeAt(0))),Array.from(u,e=>f.setUint8(p++,e.charCodeAt(0)));var v=new Uint8Array(h.byteLength+n.byteLength);return v.set(new Uint8Array(h),0),v.set(new Uint8Array(n),h.byteLength),v.buffer}decode(e,t){if(this._isArrayBuffer(e)){return t(this._binaryDecode(e))}if("string"===typeof e){const n=JSON.parse(e),[r,o,i,a,s]=n;return t({join_ref:r,ref:o,topic:i,event:a,payload:s})}return t({})}_binaryDecode(e){const t=new DataView(e),n=t.getUint8(0),r=new TextDecoder;if(n===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,t,r)}_decodeUserBroadcast(e,t,n){const r=t.getUint8(1),o=t.getUint8(2),i=t.getUint8(3),a=t.getUint8(4);let s=this.HEADER_LENGTH+4;const l=n.decode(e.slice(s,s+r));s+=r;const c=n.decode(e.slice(s,s+o));s+=o;const u=n.decode(e.slice(s,s+i));s+=i;const d=e.slice(s,e.byteLength),h=a===this.JSON_ENCODING?JSON.parse(n.decode(d)):d,f={type:this.BROADCAST_EVENT,event:c,payload:h};return i>0&&(f.meta=JSON.parse(u)),{join_ref:null,ref:null,topic:l,event:this.BROADCAST_EVENT,payload:f}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||"ArrayBuffer"===(null===(t=null===e||void 0===e?void 0:e.constructor)||void 0===t?void 0:t.name)}_pick(e,t){return e&&"object"===typeof e?Object.fromEntries(Object.entries(e).filter(e=>{let[n]=e;return t.includes(n)})):{}}}class Vc{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(Kc||(Kc={}));const Wc=function(e,t){var n;const r=null!==(n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==n?n:[];return t?Object.keys(t).reduce((n,o)=>(n[o]=Hc(o,e,t,r),n),{}):{}},Hc=(e,t,n,r)=>{const o=t.find(t=>t.name===e),i=null===o||void 0===o?void 0:o.type,a=n[e];return i&&!r.includes(i)?Yc(i,a):Gc(a)},Yc=(e,t)=>{if("_"===e.charAt(0)){const n=e.slice(1,e.length);return Zc(t,n)}switch(e){case Kc.bool:return Xc(t);case Kc.float4:case Kc.float8:case Kc.int2:case Kc.int4:case Kc.int8:case Kc.numeric:case Kc.oid:return Jc(t);case Kc.json:case Kc.jsonb:return $c(t);case Kc.timestamp:return Qc(t);case Kc.abstime:case Kc.date:case Kc.daterange:case Kc.int4range:case Kc.int8range:case Kc.money:case Kc.reltime:case Kc.text:case Kc.time:case Kc.timestamptz:case Kc.timetz:case Kc.tsrange:case Kc.tstzrange:default:return Gc(t)}},Gc=e=>e,Xc=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Jc=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},$c=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(t){return e}return e},Zc=(e,t)=>{if("string"!==typeof e)return e;const n=e.length-1,r=e[n];if("{"===e[0]&&"}"===r){let r;const i=e.slice(1,n);try{r=JSON.parse("["+i+"]")}catch(o){r=i?i.split(","):[]}return r.map(e=>Yc(t,e))}return e},Qc=e=>"string"===typeof e?e.replace(" ","T"):e,eu=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),""===t.pathname||"/"===t.pathname?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class tu{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Mc;this.channel=e,this.event=t,this.payload=n,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t(null===(n=this.receivedResp)||void 0===n?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:n}=e;this.recHooks.filter(e=>e.status===t).forEach(e=>e.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var nu,ru,ou,iu;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(nu||(nu={}));class au{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},e=>{const{onJoin:t,onLeave:n,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=au.syncState(this.state,e,t,n),this.pendingDiffs.forEach(e=>{this.state=au.syncDiff(this.state,e,t,n)}),this.pendingDiffs=[],r()}),this.channel._on(n.diff,{},e=>{const{onJoin:t,onLeave:n,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=au.syncDiff(this.state,e,t,n),r())}),this.onJoin((e,t,n)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:n})}),this.onLeave((e,t,n)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:n})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,r){const o=this.cloneDeep(e),i=this.transformState(t),a={},s={};return this.map(o,(e,t)=>{i[e]||(s[e]=t)}),this.map(i,(e,t)=>{const n=o[e];if(n){const r=t.map(e=>e.presence_ref),o=n.map(e=>e.presence_ref),i=t.filter(e=>o.indexOf(e.presence_ref)<0),l=n.filter(e=>r.indexOf(e.presence_ref)<0);i.length>0&&(a[e]=i),l.length>0&&(s[e]=l)}else a[e]=t}),this.syncDiff(o,{joins:a,leaves:s},n,r)}static syncDiff(e,t,n,r){const{joins:o,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),r||(r=()=>{}),this.map(o,(t,r)=>{var o;const i=null!==(o=e[t])&&void 0!==o?o:[];if(e[t]=this.cloneDeep(r),i.length>0){const n=e[t].map(e=>e.presence_ref),r=i.filter(e=>n.indexOf(e.presence_ref)<0);e[t].unshift(...r)}n(t,i,r)}),this.map(i,(t,n)=>{let o=e[t];if(!o)return;const i=n.map(e=>e.presence_ref);o=o.filter(e=>i.indexOf(e.presence_ref)<0),e[t]=o,r(t,o,n),0===o.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const r=e[n];return t[n]="metas"in r?r.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(ru||(ru={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(ou||(ou={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(iu||(iu={}));class su{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},n=arguments.length>2?arguments[2]:void 0;var r,o;if(this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=zc.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new tu(this,Uc.join,this.params,this.timeout),this.rejoinTimer=new Vc(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=zc.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel","close ".concat(this.topic," ").concat(this._joinRef())),this.state=zc.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=zc.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel","timeout ".concat(this.topic),this.joinPush.timeout),this.state=zc.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=zc.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Uc.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new au(this),this.broadcastEndpointURL=eu(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null===(o=null===(r=this.params.config)||void 0===r?void 0:r.broadcast)||void 0===o?void 0:o.replay))throw"tried to use replay on public channel '".concat(this.topic,"'. It must be a private channel.")}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;var n,r,o;if(this.socket.isConnected()||this.socket.connect(),this.state==zc.closed){const{config:{broadcast:i,presence:a,private:s}}=this.params,l=null!==(r=null===(n=this.bindings.postgres_changes)||void 0===n?void 0:n.map(e=>e.filter))&&void 0!==r?r:[],c=!!this.bindings[ou.PRESENCE]&&this.bindings[ou.PRESENCE].length>0||!0===(null===(o=this.params.config.presence)||void 0===o?void 0:o.enabled),u={},d={broadcast:i,presence:Object.assign(Object.assign({},a),{enabled:c}),postgres_changes:l,private:s};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(t=>null===e||void 0===e?void 0:e(iu.CHANNEL_ERROR,t)),this._onClose(()=>null===e||void 0===e?void 0:e(iu.CLOSED)),this.updateJoinPayload(Object.assign({config:d},u)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async t=>{let{postgres_changes:n}=t;var r;if(this.socket._isManualToken()||this.socket.setAuth(),void 0!==n){const t=this.bindings.postgres_changes,o=null!==(r=null===t||void 0===t?void 0:t.length)&&void 0!==r?r:0,i=[];for(let r=0;r<o;r++){const o=t[r],{filter:{event:a,schema:s,table:l,filter:c}}=o,u=n&&n[r];if(!(u&&u.event===a&&su.isFilterValueEqual(u.schema,s)&&su.isFilterValueEqual(u.table,l)&&su.isFilterValueEqual(u.filter,c)))return this.unsubscribe(),this.state=zc.errored,void(null===e||void 0===e||e(iu.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));i.push(Object.assign(Object.assign({},o),{id:u.id}))}return this.bindings.postgres_changes=i,void(e&&e(iu.SUBSCRIBED))}null===e||void 0===e||e(iu.SUBSCRIBED)}).receive("error",t=>{this.state=zc.errored,null===e||void 0===e||e(iu.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null===e||void 0===e||e(iu.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this.state===zc.joined&&e===ou.PRESENCE&&(this.socket.log("channel","resubscribe to ".concat(this.topic," due to change in presence callbacks on joined channel")),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,n)}async httpSend(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var r;if(void 0===t||null===t)return Promise.reject("Payload is required for httpSend()");const o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization="Bearer ".concat(this.socket.accessTokenValue));const i={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},a=await this._fetchWithTimeout(this.broadcastEndpointURL,i,null!==(r=n.timeout)&&void 0!==r?r:this.timeout);if(202===a.status)return{success:!0};let s=a.statusText;try{const e=await a.json();s=e.error||e.message||s}catch(l){}return Promise.reject(new Error(s))}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,r;if(this._canPush()||"broadcast"!==e.type)return new Promise(n=>{var r,o,i;const a=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(i=null===(o=null===(r=this.params)||void 0===r?void 0:r.config)||void 0===o?void 0:o.broadcast)||void 0===i?void 0:i.ack)||n("ok"),a.receive("ok",()=>n("ok")),a.receive("error",()=>n("error")),a.receive("timeout",()=>n("timed out"))});{console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:a}=e,s={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(s.Authorization="Bearer ".concat(this.socket.accessTokenValue));const l={method:"POST",headers:s,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,l,null!==(n=t.timeout)&&void 0!==n?n:this.timeout);return await(null===(r=e.body)||void 0===r?void 0:r.cancel()),e.ok?"ok":"error"}catch(o){return"AbortError"===o.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=zc.leaving;const t=()=>{this.socket.log("channel","leave ".concat(this.topic)),this._trigger(Uc.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(r=>{n=new tu(this,Uc.leave,{},e),n.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{null===n||void 0===n||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=zc.closed,this.bindings={}}async _fetchWithTimeout(e,t,n){const r=new AbortController,o=setTimeout(()=>r.abort(),n),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(o),i}_push(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw"tried to push '".concat(e,"' to '").concat(this.topic,"' before joining. Use channel.subscribe() before pushing events");let r=new tu(this,e,t,n);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel","discarded push due to buffer overflow: ".concat(e.event),e.payload))}}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var r,o;const i=e.toLocaleLowerCase(),{close:a,error:s,leave:l,join:c}=Uc;if(n&&[a,s,l,c].indexOf(i)>=0&&n!==this._joinRef())return;let u=this._onMessage(i,t,n);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?null===(r=this.bindings.postgres_changes)||void 0===r||r.filter(e=>{var t,n,r;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(r=null===(n=e.filter)||void 0===n?void 0:n.event)||void 0===r?void 0:r.toLocaleLowerCase())===i}).map(e=>e.callback(u,n)):null===(o=this.bindings[i])||void 0===o||o.filter(e=>{var n,r,o,a,s,l,c,u;if(["broadcast","presence","postgres_changes"].includes(i)){if("id"in e){const i=e.id,l=null===(n=e.filter)||void 0===n?void 0:n.event;return i&&(null===(r=t.ids)||void 0===r?void 0:r.includes(i))&&("*"===l||(null===l||void 0===l?void 0:l.toLocaleLowerCase())===(null===(o=t.data)||void 0===o?void 0:o.type.toLocaleLowerCase()))&&(!(null===(a=e.filter)||void 0===a?void 0:a.table)||e.filter.table===(null===(s=t.data)||void 0===s?void 0:s.table))}{const n=null===(c=null===(l=null===e||void 0===e?void 0:e.filter)||void 0===l?void 0:l.event)||void 0===c?void 0:c.toLocaleLowerCase();return"*"===n||n===(null===(u=null===t||void 0===t?void 0:t.event)||void 0===u?void 0:u.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===i}).map(e=>{if("object"===typeof u&&"ids"in u){const e=u.data,{schema:t,table:n,commit_timestamp:r,type:o,errors:i}=e,a={schema:t,table:n,commit_timestamp:r,eventType:o,new:{},old:{},errors:i};u=Object.assign(Object.assign({},a),this._getPayloadRecords(e))}e.callback(u,n)})}_isClosed(){return this.state===zc.closed}_isJoined(){return this.state===zc.joined}_isJoining(){return this.state===zc.joining}_isLeaving(){return this.state===zc.leaving}_replyEventName(e){return"chan_reply_".concat(e)}_on(e,t,n){const r=e.toLocaleLowerCase(),o={type:r,filter:t,callback:n};return this.bindings[r]?this.bindings[r].push(o):this.bindings[r]=[o],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(e=>{var r;return!((null===(r=e.type)||void 0===r?void 0:r.toLocaleLowerCase())===n&&su.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}static isFilterValueEqual(e,t){return(null!==e&&void 0!==e?e:void 0)===(null!==t&&void 0!==t?t:void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Uc.close,{},e)}_onError(e){this._on(Uc.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=zc.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=Wc(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=Wc(e.columns,e.old_record)),t}}const lu=()=>{},cu=25e3,uu=10,du=100,hu=[1e3,2e3,5e3,1e4];class fu{constructor(e,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Mc,this.transport=null,this.heartbeatIntervalMs=cu,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=lu,this.ref=0,this.reconnectTimer=null,this.vsn=Dc,this.logger=lu,this.conn=null,this.sendBuffer=[],this.serializer=new qc,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)},!(null===(n=null===t||void 0===t?void 0:t.params)||void 0===n?void 0:n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint="".concat(e,"/").concat(Bc.websocket),this.httpEndpoint=eu(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null===t||void 0===t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Pc.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;if(t.includes("Node.js"))throw new Error("".concat(t,"\n\n")+'To use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })');throw new Error("WebSocket not available: ".concat(t))}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},"function"===typeof this.conn.close&&(e?this.conn.close(e,null!==t&&void 0!==t?t:""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Lc.connecting:return Fc.Connecting;case Lc.open:return Fc.Open;case Lc.closing:return Fc.Closing;default:return Fc.Closed}}isConnected(){return this.connectionState()===Fc.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};const n="realtime:".concat(e),r=this.getChannels().find(e=>e.topic===n);if(r)return r;{const n=new su("realtime:".concat(e),t,this);return this.channels.push(n),n}}push(e){const{topic:t,event:n,payload:r,ref:o}=e,i=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push","".concat(t," ").concat(n," (").concat(o,")"),r),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}return this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},du)}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}else try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",'leaving duplicate topic "'.concat(e,'"')),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event&&e.ref&&e.ref===this.pendingHeartbeatRef){const t=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error",t)}catch(s){this.log("error","error in heartbeat callback",s)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:t,event:n,payload:r,ref:o}=e,i=o?"(".concat(o,")"):"",a=r.status||"";this.log("receive","".concat(a," ").concat(t," ").concat(n," ").concat(i).trim(),r),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(n,r,o)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Lc.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Lc.open||this.conn.readyState===Lc.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport","connected to ".concat(this.endpointURL()));(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(e=>{this.log("error","error waiting for auth on connect",e),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker","starting worker for from ".concat(this.workerUrl)):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this._terminateWorker()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport","".concat(e)),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Uc.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const n=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return"".concat(e).concat(n).concat(r)}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=!1;if(t)e=t,n=!0;else if(this.accessToken)try{e=await this.accessToken()}catch(r){this.log("error","Error fetching access token from callback",r),e=this.accessTokenValue}else e=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(t=>{const n={access_token:e,version:Ac};e&&t.updateJoinPayload(n),t.joinedOnce&&t._isJoined()&&t._push(Uc.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"general";this._isManualToken()||this.setAuth().catch(t=>{this.log("error","Error setting auth in ".concat(e),t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(t)}catch(r){this.log("error","error in ".concat(e," callback"),r)}})}catch(n){this.log("error","error triggering ".concat(e," callbacks"),n)}}_setupReconnectionTimer(){this.reconnectTimer=new Vc(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},uu)},this.reconnectAfterMs)}_initializeOptions(e){var t,n,r,o,i,a,s,l,c,u,d,h;switch(this.transport=null!==(t=null===e||void 0===e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(n=null===e||void 0===e?void 0:e.timeout)&&void 0!==n?n:Mc,this.heartbeatIntervalMs=null!==(r=null===e||void 0===e?void 0:e.heartbeatIntervalMs)&&void 0!==r?r:cu,this.worker=null!==(o=null===e||void 0===e?void 0:e.worker)&&void 0!==o&&o,this.accessToken=null!==(i=null===e||void 0===e?void 0:e.accessToken)&&void 0!==i?i:null,this.heartbeatCallback=null!==(a=null===e||void 0===e?void 0:e.heartbeatCallback)&&void 0!==a?a:lu,this.vsn=null!==(s=null===e||void 0===e?void 0:e.vsn)&&void 0!==s?s:Dc,(null===e||void 0===e?void 0:e.params)&&(this.params=e.params),(null===e||void 0===e?void 0:e.logger)&&(this.logger=e.logger),((null===e||void 0===e?void 0:e.logLevel)||(null===e||void 0===e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(l=null===e||void 0===e?void 0:e.reconnectAfterMs)&&void 0!==l?l:e=>hu[e-1]||1e4,this.vsn){case Rc:this.encode=null!==(c=null===e||void 0===e?void 0:e.encode)&&void 0!==c?c:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(u=null===e||void 0===e?void 0:e.decode)&&void 0!==u?u:(e,t)=>t(JSON.parse(e));break;case"2.0.0":this.encode=null!==(d=null===e||void 0===e?void 0:e.encode)&&void 0!==d?d:this.serializer.encode.bind(this.serializer),this.decode=null!==(h=null===e||void 0===e?void 0:e.decode)&&void 0!==h?h:this.serializer.decode.bind(this.serializer);break;default:throw new Error("Unsupported serializer version: ".concat(this.vsn))}if(this.worker){if("undefined"!==typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null===e||void 0===e?void 0:e.workerUrl}}}var pu=class extends Error{constructor(e,t){var n;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown="CommitStateUnknownException"===t.icebergType||[500,502,504].includes(t.status)&&!0===(null===(n=t.icebergType)||void 0===n?void 0:n.includes("CommitState"))}isNotFound(){return 404===this.status}isConflict(){return 409===this.status}isAuthenticationTimeout(){return 419===this.status}};function vu(e){var t;const n=null!==(t=e.fetchImpl)&&void 0!==t?t:globalThis.fetch;return{async request(t){let{method:r,path:o,query:i,body:a,headers:l}=t;const c=function(e,t,n){const r=new URL(t,e);if(n)for(const[o,i]of Object.entries(n))void 0!==i&&r.searchParams.set(o,i);return r.toString()}(e.baseUrl,o,i),u=await async function(e){return e&&"none"!==e.type?"bearer"===e.type?{Authorization:"Bearer ".concat(e.token)}:"header"===e.type?{[e.name]:e.value}:"custom"===e.type?await e.getHeaders():{}:{}}(e.auth),d=await n(c,{method:r,headers:s(s(s({},a?{"Content-Type":"application/json"}:{}),u),l),body:a?JSON.stringify(a):void 0}),h=await d.text(),f=(d.headers.get("content-type")||"").includes("application/json"),p=f&&h?JSON.parse(h):h;if(!d.ok){var v;const e=f?p:void 0,t=null===e||void 0===e?void 0:e.error;throw new pu(null!==(v=null===t||void 0===t?void 0:t.message)&&void 0!==v?v:"Request failed with status ".concat(d.status),{status:d.status,icebergType:null===t||void 0===t?void 0:t.type,icebergCode:null===t||void 0===t?void 0:t.code,details:e})}return{status:d.status,headers:d.headers,data:p}}}}function mu(e){return e.join("\x1f")}var gu=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:mu(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:"".concat(this.prefix,"/namespaces"),query:t})).data.namespaces.map(e=>({namespace:e}))}async createNamespace(e,t){const n={namespace:e.namespace,properties:null===t||void 0===t?void 0:t.properties};return(await this.client.request({method:"POST",path:"".concat(this.prefix,"/namespaces"),body:n})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:"".concat(this.prefix,"/namespaces/").concat(mu(e.namespace))})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:"".concat(this.prefix,"/namespaces/").concat(mu(e.namespace))})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:"".concat(this.prefix,"/namespaces/").concat(mu(e.namespace))}),!0}catch(t){if(t instanceof pu&&404===t.status)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(n){if(n instanceof pu&&409===n.status)return;throw n}}};function yu(e){return e.join("\x1f")}var wu=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;this.client=e,this.prefix=t,this.accessDelegation=n}async listTables(e){return(await this.client.request({method:"GET",path:"".concat(this.prefix,"/namespaces/").concat(yu(e.namespace),"/tables")})).data.identifiers}async createTable(e,t){const n={};this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation);return(await this.client.request({method:"POST",path:"".concat(this.prefix,"/namespaces/").concat(yu(e.namespace),"/tables"),body:t,headers:n})).data.metadata}async updateTable(e,t){const n=await this.client.request({method:"POST",path:"".concat(this.prefix,"/namespaces/").concat(yu(e.namespace),"/tables/").concat(e.name),body:t});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(e,t){var n;await this.client.request({method:"DELETE",path:"".concat(this.prefix,"/namespaces/").concat(yu(e.namespace),"/tables/").concat(e.name),query:{purgeRequested:String(null!==(n=null===t||void 0===t?void 0:t.purge)&&void 0!==n&&n)}})}async loadTable(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);return(await this.client.request({method:"GET",path:"".concat(this.prefix,"/namespaces/").concat(yu(e.namespace),"/tables/").concat(e.name),headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:"".concat(this.prefix,"/namespaces/").concat(yu(e.namespace),"/tables/").concat(e.name),headers:t}),!0}catch(n){if(n instanceof pu&&404===n.status)return!1;throw n}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(n){if(n instanceof pu&&409===n.status)return await this.loadTable({namespace:e.namespace,name:t.name});throw n}}},bu=class{constructor(e){var t;let n="v1";e.catalogName&&(n+="/".concat(e.catalogName));const r=e.baseUrl.endsWith("/")?e.baseUrl:"".concat(e.baseUrl,"/");this.client=vu({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=null===(t=e.accessDelegation)||void 0===t?void 0:t.join(","),this.namespaceOps=new gu(this.client,n),this.tableOps=new wu(this.client,n,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}};var _u=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function xu(e){return"object"===typeof e&&null!==e&&"__isStorageError"in e}var Su=class extends _u{constructor(e,t,n){super(e),this.name="StorageApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},ku=class extends _u{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const Eu=e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)},Cu=e=>{if(Array.isArray(e))return e.map(e=>Cu(e));if("function"===typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(e=>{let[n,r]=e;const o=n.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[o]=Cu(r)}),t};function Nu(e){return(Nu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ju(e){var t=function(e,t){if("object"!=Nu(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Nu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Nu(t)?t:t+""}function Tu(e,t,n){return(t=ju(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ou(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Iu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ou(Object(n),!0).forEach(function(t){Tu(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ou(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const Pu=e=>{var t;return e.msg||e.message||e.error_description||("string"===typeof e.error?e.error:null===(t=e.error)||void 0===t?void 0:t.message)||JSON.stringify(e)},Au=async(e,t,n)=>{e instanceof await Response&&!(null===n||void 0===n?void 0:n.noResolveJson)?e.json().then(n=>{const r=e.status||500,o=(null===n||void 0===n?void 0:n.statusCode)||r+"";t(new Su(Pu(n),r,o))}).catch(e=>{t(new ku(Pu(e),e))}):t(new ku(Pu(e),e))},Ru=(e,t,n,r)=>{const o={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"!==e&&r?((e=>{if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)})(r)?(o.headers=Iu({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),o.body=JSON.stringify(r)):o.body=r,(null===t||void 0===t?void 0:t.duplex)&&(o.duplex=t.duplex),Iu(Iu({},o),n)):o};async function Du(e,t,n,r,o,i){return new Promise((a,s)=>{e(n,Ru(t,r,o,i)).then(e=>{if(!e.ok)throw e;return(null===r||void 0===r?void 0:r.noResolveJson)?e:e.json()}).then(e=>a(e)).catch(e=>Au(e,s,r))})}async function Mu(e,t,n,r){return Du(e,"GET",t,n,r)}async function Lu(e,t,n,r,o){return Du(e,"POST",t,r,o,n)}async function zu(e,t,n,r,o){return Du(e,"PUT",t,r,o,n)}async function Uu(e,t,n,r,o){return Du(e,"DELETE",t,r,o,n)}var Bu=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){try{return{data:(await this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(xu(e))return{data:null,error:e};throw e}}};let Fu;Fu=Symbol.toStringTag;var Ku=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Fu]="BlobDownloadBuilder",this.promise=null}asStream(){return new Bu(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){try{return{data:await(await this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(xu(e))return{data:null,error:e};throw e}}};const qu={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Vu={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Wu=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=n,this.fetch=Eu(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,n,r){var o=this;try{let i;const a=Iu(Iu({},Vu),r);let s=Iu(Iu({},o.headers),"POST"===e&&{"x-upsert":String(a.upsert)});const l=a.metadata;"undefined"!==typeof Blob&&n instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",o.encodeMetadata(l)),i.append("",n)):"undefined"!==typeof FormData&&n instanceof FormData?(i=n,i.has("cacheControl")||i.append("cacheControl",a.cacheControl),l&&!i.has("metadata")&&i.append("metadata",o.encodeMetadata(l))):(i=n,s["cache-control"]="max-age=".concat(a.cacheControl),s["content-type"]=a.contentType,l&&(s["x-metadata"]=o.toBase64(o.encodeMetadata(l))),("undefined"!==typeof ReadableStream&&i instanceof ReadableStream||i&&"object"===typeof i&&"pipe"in i&&"function"===typeof i.pipe)&&!a.duplex&&(a.duplex="half")),(null===r||void 0===r?void 0:r.headers)&&(s=Iu(Iu({},s),r.headers));const c=o._removeEmptyFolders(t),u=o._getFinalPath(c),d=await("PUT"==e?zu:Lu)(o.fetch,"".concat(o.url,"/object/").concat(u),i,Iu({headers:s},(null===a||void 0===a?void 0:a.duplex)?{duplex:a.duplex}:{}));return{data:{path:c,id:d.Id,fullPath:d.Key},error:null}}catch(i){if(o.shouldThrowOnError)throw i;if(xu(i))return{data:null,error:i};throw i}}async upload(e,t,n){return this.uploadOrUpdate("POST",e,t,n)}async uploadToSignedUrl(e,t,n,r){var o=this;const i=o._removeEmptyFolders(e),a=o._getFinalPath(i),s=new URL(o.url+"/object/upload/sign/".concat(a));s.searchParams.set("token",t);try{let e;const t=Iu({upsert:Vu.upsert},r),a=Iu(Iu({},o.headers),{"x-upsert":String(t.upsert)});return"undefined"!==typeof Blob&&n instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",n)):"undefined"!==typeof FormData&&n instanceof FormData?(e=n,e.append("cacheControl",t.cacheControl)):(e=n,a["cache-control"]="max-age=".concat(t.cacheControl),a["content-type"]=t.contentType),{data:{path:i,fullPath:(await zu(o.fetch,s.toString(),e,{headers:a})).Key},error:null}}catch(l){if(o.shouldThrowOnError)throw l;if(xu(l))return{data:null,error:l};throw l}}async createSignedUploadUrl(e,t){var n=this;try{let r=n._getFinalPath(e);const o=Iu({},n.headers);(null===t||void 0===t?void 0:t.upsert)&&(o["x-upsert"]="true");const i=await Lu(n.fetch,"".concat(n.url,"/object/upload/sign/").concat(r),{},{headers:o}),a=new URL(n.url+i.url),s=a.searchParams.get("token");if(!s)throw new _u("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:s},error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(xu(r))return{data:null,error:r};throw r}}async update(e,t,n){return this.uploadOrUpdate("PUT",e,t,n)}async move(e,t,n){var r=this;try{return{data:await Lu(r.fetch,"".concat(r.url,"/object/move"),{bucketId:r.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===n||void 0===n?void 0:n.destinationBucket},{headers:r.headers}),error:null}}catch(o){if(r.shouldThrowOnError)throw o;if(xu(o))return{data:null,error:o};throw o}}async copy(e,t,n){var r=this;try{return{data:{path:(await Lu(r.fetch,"".concat(r.url,"/object/copy"),{bucketId:r.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===n||void 0===n?void 0:n.destinationBucket},{headers:r.headers})).Key},error:null}}catch(o){if(r.shouldThrowOnError)throw o;if(xu(o))return{data:null,error:o};throw o}}async createSignedUrl(e,t,n){var r=this;try{let o=r._getFinalPath(e),i=await Lu(r.fetch,"".concat(r.url,"/object/sign/").concat(o),Iu({expiresIn:t},(null===n||void 0===n?void 0:n.transform)?{transform:n.transform}:{}),{headers:r.headers});const a=(null===n||void 0===n?void 0:n.download)?"&download=".concat(!0===n.download?"":n.download):"";return i={signedUrl:encodeURI("".concat(r.url).concat(i.signedURL).concat(a))},{data:i,error:null}}catch(o){if(r.shouldThrowOnError)throw o;if(xu(o))return{data:null,error:o};throw o}}async createSignedUrls(e,t,n){var r=this;try{const o=await Lu(r.fetch,"".concat(r.url,"/object/sign/").concat(r.bucketId),{expiresIn:t,paths:e},{headers:r.headers}),i=(null===n||void 0===n?void 0:n.download)?"&download=".concat(!0===n.download?"":n.download):"";return{data:o.map(e=>Iu(Iu({},e),{},{signedUrl:e.signedURL?encodeURI("".concat(r.url).concat(e.signedURL).concat(i)):null})),error:null}}catch(o){if(r.shouldThrowOnError)throw o;if(xu(o))return{data:null,error:o};throw o}}download(e,t){const n="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{}),o=r?"?".concat(r):"",i=this._getFinalPath(e);return new Ku(()=>Mu(this.fetch,"".concat(this.url,"/").concat(n,"/").concat(i).concat(o),{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}async info(e){var t=this;const n=t._getFinalPath(e);try{return{data:Cu(await Mu(t.fetch,"".concat(t.url,"/object/info/").concat(n),{headers:t.headers})),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(xu(r))return{data:null,error:r};throw r}}async exists(e){var t=this;const n=t._getFinalPath(e);try{return await async function(e,t,n,r){return Du(e,"HEAD",t,Iu(Iu({},n),{},{noResolveJson:!0}),r)}(t.fetch,"".concat(t.url,"/object/").concat(n),{headers:t.headers}),{data:!0,error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(xu(r)&&r instanceof ku){const e=r.originalError;if([400,404].includes(null===e||void 0===e?void 0:e.status))return{data:!1,error:r}}throw r}}getPublicUrl(e,t){const n=this._getFinalPath(e),r=[],o=(null===t||void 0===t?void 0:t.download)?"download=".concat(!0===t.download?"":t.download):"";""!==o&&r.push(o);const i="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image":"object",a=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{});""!==a&&r.push(a);let s=r.join("&");return""!==s&&(s="?".concat(s)),{data:{publicUrl:encodeURI("".concat(this.url,"/").concat(i,"/public/").concat(n).concat(s))}}}async remove(e){var t=this;try{return{data:await Uu(t.fetch,"".concat(t.url,"/object/").concat(t.bucketId),{prefixes:e},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(xu(n))return{data:null,error:n};throw n}}async list(e,t,n){var r=this;try{const o=Iu(Iu(Iu({},qu),t),{},{prefix:e||""});return{data:await Lu(r.fetch,"".concat(r.url,"/object/list/").concat(r.bucketId),o,{headers:r.headers},n),error:null}}catch(o){if(r.shouldThrowOnError)throw o;if(xu(o))return{data:null,error:o};throw o}}async listV2(e,t){var n=this;try{const r=Iu({},e);return{data:await Lu(n.fetch,"".concat(n.url,"/object/list-v2/").concat(n.bucketId),r,{headers:n.headers},t),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(xu(r))return{data:null,error:r};throw r}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!==typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return"".concat(this.bucketId,"/").concat(e.replace(/^\/+/,""))}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push("width=".concat(e.width)),e.height&&t.push("height=".concat(e.height)),e.resize&&t.push("resize=".concat(e.resize)),e.format&&t.push("format=".concat(e.format)),e.quality&&t.push("quality=".concat(e.quality)),t.join("&")}};const Hu="2.90.1",Yu={"X-Client-Info":"storage-js/".concat(Hu)};var Gu=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;this.shouldThrowOnError=!1;const o=new URL(e);(null===r||void 0===r?void 0:r.useNewHostname)&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href.replace(/\/$/,""),this.headers=Iu(Iu({},Yu),t),this.fetch=Eu(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const n=t.listBucketOptionsToQueryString(e);return{data:await Mu(t.fetch,"".concat(t.url,"/bucket").concat(n),{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(xu(n))return{data:null,error:n};throw n}}async getBucket(e){var t=this;try{return{data:await Mu(t.fetch,"".concat(t.url,"/bucket/").concat(e),{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(xu(n))return{data:null,error:n};throw n}}async createBucket(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};var n=this;try{return{data:await Lu(n.fetch,"".concat(n.url,"/bucket"),{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:n.headers}),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(xu(r))return{data:null,error:r};throw r}}async updateBucket(e,t){var n=this;try{return{data:await zu(n.fetch,"".concat(n.url,"/bucket/").concat(e),{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:n.headers}),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(xu(r))return{data:null,error:r};throw r}}async emptyBucket(e){var t=this;try{return{data:await Lu(t.fetch,"".concat(t.url,"/bucket/").concat(e,"/empty"),{},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(xu(n))return{data:null,error:n};throw n}}async deleteBucket(e){var t=this;try{return{data:await Uu(t.fetch,"".concat(t.url,"/bucket/").concat(e),{},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(xu(n))return{data:null,error:n};throw n}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},Xu=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Iu(Iu({},Yu),t),this.fetch=Eu(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Lu(t.fetch,"".concat(t.url,"/bucket"),{name:e},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(xu(n))return{data:null,error:n};throw n}}async listBuckets(e){var t=this;try{const n=new URLSearchParams;void 0!==(null===e||void 0===e?void 0:e.limit)&&n.set("limit",e.limit.toString()),void 0!==(null===e||void 0===e?void 0:e.offset)&&n.set("offset",e.offset.toString()),(null===e||void 0===e?void 0:e.sortColumn)&&n.set("sortColumn",e.sortColumn),(null===e||void 0===e?void 0:e.sortOrder)&&n.set("sortOrder",e.sortOrder),(null===e||void 0===e?void 0:e.search)&&n.set("search",e.search);const r=n.toString(),o=r?"".concat(t.url,"/bucket?").concat(r):"".concat(t.url,"/bucket");return{data:await Mu(t.fetch,o,{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(xu(n))return{data:null,error:n};throw n}}async deleteBucket(e){var t=this;try{return{data:await Uu(t.fetch,"".concat(t.url,"/bucket/").concat(e),{},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(xu(n))return{data:null,error:n};throw n}}from(e){var t=this;if(!(e=>!(!e||"string"!==typeof e)&&!(0===e.length||e.length>100)&&e.trim()===e&&!e.includes("/")&&!e.includes("\\")&&/^[\w!.\*'() &$@=;:+,?-]+$/.test(e))(e))throw new _u("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const n=new bu({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),r=this.shouldThrowOnError;return new Proxy(n,{get(e,t){const n=e[t];return"function"!==typeof n?n:async function(){try{for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return{data:await n.apply(e,o),error:null}}catch(a){if(r)throw a;return{data:null,error:a}}}}})}};const Ju={"X-Client-Info":"storage-js/".concat(Hu),"Content-Type":"application/json"};var $u=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Zu(e){return"object"===typeof e&&null!==e&&"__isStorageVectorsError"in e}var Qu=class extends $u{constructor(e,t,n){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},ed=class extends $u{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const td=e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)},nd=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),rd=(e,t,n,r)=>{const o={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"!==e&&r?((e=>{if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)})(r)?(o.headers=Iu({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),o.body=JSON.stringify(r)):o.body=r,Iu(Iu({},o),n)):o};async function od(e,t,n,r,o,i){return new Promise((a,s)=>{e(n,rd(t,r,o,i)).then(e=>{if(!e.ok)throw e;if(null===r||void 0===r?void 0:r.noResolveJson)return e;const t=e.headers.get("content-type");return t&&t.includes("application/json")?e.json():{}}).then(e=>a(e)).catch(e=>(async(e,t,n)=>{if(e&&"object"===typeof e&&"status"in e&&"ok"in e&&"number"===typeof e.status&&!(null===n||void 0===n?void 0:n.noResolveJson)){const n=e.status||500,r=e;if("function"===typeof r.json)r.json().then(e=>{const r=(null===e||void 0===e?void 0:e.statusCode)||(null===e||void 0===e?void 0:e.code)||n+"";t(new Qu(nd(e),n,r))}).catch(()=>{const e=n+"";t(new Qu(r.statusText||"HTTP ".concat(n," error"),n,e))});else{const e=n+"";t(new Qu(r.statusText||"HTTP ".concat(n," error"),n,e))}}else t(new ed(nd(e),e))})(e,s,r))})}async function id(e,t,n,r,o){return od(e,"POST",t,r,o,n)}var ad=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Iu(Iu({},Ju),t),this.fetch=td(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await id(t.fetch,"".concat(t.url,"/CreateIndex"),e,{headers:t.headers})||{},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Zu(n))return{data:null,error:n};throw n}}async getIndex(e,t){var n=this;try{return{data:await id(n.fetch,"".concat(n.url,"/GetIndex"),{vectorBucketName:e,indexName:t},{headers:n.headers}),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(Zu(r))return{data:null,error:r};throw r}}async listIndexes(e){var t=this;try{return{data:await id(t.fetch,"".concat(t.url,"/ListIndexes"),e,{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Zu(n))return{data:null,error:n};throw n}}async deleteIndex(e,t){var n=this;try{return{data:await id(n.fetch,"".concat(n.url,"/DeleteIndex"),{vectorBucketName:e,indexName:t},{headers:n.headers})||{},error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(Zu(r))return{data:null,error:r};throw r}}},sd=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Iu(Iu({},Ju),t),this.fetch=td(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await id(t.fetch,"".concat(t.url,"/PutVectors"),e,{headers:t.headers})||{},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Zu(n))return{data:null,error:n};throw n}}async getVectors(e){var t=this;try{return{data:await id(t.fetch,"".concat(t.url,"/GetVectors"),e,{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Zu(n))return{data:null,error:n};throw n}}async listVectors(e){var t=this;try{if(void 0!==e.segmentCount){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(void 0!==e.segmentIndex&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error("segmentIndex must be between 0 and ".concat(e.segmentCount-1))}return{data:await id(t.fetch,"".concat(t.url,"/ListVectors"),e,{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Zu(n))return{data:null,error:n};throw n}}async queryVectors(e){var t=this;try{return{data:await id(t.fetch,"".concat(t.url,"/QueryVectors"),e,{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Zu(n))return{data:null,error:n};throw n}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await id(t.fetch,"".concat(t.url,"/DeleteVectors"),e,{headers:t.headers})||{},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Zu(n))return{data:null,error:n};throw n}}},ld=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Iu(Iu({},Ju),t),this.fetch=td(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await id(t.fetch,"".concat(t.url,"/CreateVectorBucket"),{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Zu(n))return{data:null,error:n};throw n}}async getBucket(e){var t=this;try{return{data:await id(t.fetch,"".concat(t.url,"/GetVectorBucket"),{vectorBucketName:e},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Zu(n))return{data:null,error:n};throw n}}async listBuckets(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t=this;try{return{data:await id(t.fetch,"".concat(t.url,"/ListVectorBuckets"),e,{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Zu(n))return{data:null,error:n};throw n}}async deleteBucket(e){var t=this;try{return{data:await id(t.fetch,"".concat(t.url,"/DeleteVectorBucket"),{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Zu(n))return{data:null,error:n};throw n}}},cd=class extends ld{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t.headers||{},t.fetch)}from(e){return new ud(this.url,this.headers,e,this.fetch)}async createBucket(e){return(()=>super.createBucket)().call(this,e)}async getBucket(e){return(()=>super.getBucket)().call(this,e)}async listBuckets(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(()=>super.listBuckets)().call(this,e)}async deleteBucket(e){return(()=>super.deleteBucket)().call(this,e)}},ud=class extends ad{constructor(e,t,n,r){super(e,t,r),this.vectorBucketName=n}async createIndex(e){return(()=>super.createIndex)().call(this,Iu(Iu({},e),{},{vectorBucketName:this.vectorBucketName}))}async listIndexes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(()=>super.listIndexes)().call(this,Iu(Iu({},e),{},{vectorBucketName:this.vectorBucketName}))}async getIndex(e){return(()=>super.getIndex)().call(this,this.vectorBucketName,e)}async deleteIndex(e){return(()=>super.deleteIndex)().call(this,this.vectorBucketName,e)}index(e){return new dd(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},dd=class extends sd{constructor(e,t,n,r,o){super(e,t,o),this.vectorBucketName=n,this.indexName=r}async putVectors(e){var t=this;return(()=>super.putVectors)().call(t,Iu(Iu({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(e){var t=this;return(()=>super.getVectors)().call(t,Iu(Iu({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t=this;return(()=>super.listVectors)().call(t,Iu(Iu({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(e){var t=this;return(()=>super.queryVectors)().call(t,Iu(Iu({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(e){var t=this;return(()=>super.deleteVectors)().call(t,Iu(Iu({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},hd=class extends Gu{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0)}from(e){return new Wu(this.url,this.headers,e,this.fetch)}get vectors(){return new cd(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Xu(this.url+"/iceberg",this.headers,this.fetch)}};const fd="2.90.1",pd=3e4,vd=9e4,md={"X-Client-Info":"gotrue-js/".concat(fd)},gd="X-Supabase-Api-Version",yd={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},wd=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class bd extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function _d(e){return"object"===typeof e&&null!==e&&"__isAuthError"in e}class xd extends bd{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}class Sd extends bd{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class kd extends bd{constructor(e,t,n,r){super(e,n,r),this.name=t,this.status=n}}class Ed extends kd{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Cd extends kd{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Nd extends kd{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class jd extends kd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Td extends kd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Od extends kd{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Id extends kd{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Pd(e){return _d(e)&&"AuthRetryableFetchError"===e.name}class Ad extends kd{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class Rd extends kd{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Dd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Md=" \t\n\r=".split(""),Ld=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Md.length;t+=1)e[Md[t].charCodeAt(0)]=-2;for(let t=0;t<Dd.length;t+=1)e[Dd[t].charCodeAt(0)]=t;return e})();function zd(e,t,n){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;n(Dd[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;n(Dd[e]),t.queuedBits-=6}}function Ud(e,t,n){const r=Ld[e];if(!(r>-1)){if(-2===r)return;throw new Error('Invalid Base64-URL character "'.concat(String.fromCharCode(e),'"'))}for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function Bd(e){const t=[],n=e=>{t.push(String.fromCodePoint(e))},r={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},i=e=>{!function(e,t,n){if(0===t.utf8seq){if(e<=127)return void n(e);for(let n=1;n<6;n+=1)if(0===(e>>7-n&1)){t.utf8seq=n;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&n(t.codepoint)}}(e,r,n)};for(let a=0;a<e.length;a+=1)Ud(e.charCodeAt(a),o,i);return t.join("")}function Fd(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error("Unrecognized Unicode codepoint: ".concat(e.toString(16)))}t(e)}function Kd(e,t){for(let n=0;n<e.length;n+=1){let r=e.charCodeAt(n);if(r>55295&&r<=56319){const t=1024*(r-55296)&65535;r=65536+(e.charCodeAt(n+1)-56320&65535|t),n+=1}Fd(r,t)}}function qd(e){const t=[],n={queue:0,queuedBits:0},r=e=>{t.push(e)};for(let o=0;o<e.length;o+=1)Ud(e.charCodeAt(o),n,r);return new Uint8Array(t)}function Vd(e){const t=[],n={queue:0,queuedBits:0},r=e=>{t.push(e)};return e.forEach(e=>zd(e,n,r)),zd(null,n,r),t.join("")}const Wd=()=>"undefined"!==typeof window&&"undefined"!==typeof document,Hd={tested:!1,writable:!1},Yd=()=>{if(!Wd())return!1;try{if("object"!==typeof globalThis.localStorage)return!1}catch(t){return!1}if(Hd.tested)return Hd.writable;const e="lswt-".concat(Math.random()).concat(Math.random());try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Hd.tested=!0,Hd.writable=!0}catch(t){Hd.tested=!0,Hd.writable=!1}return Hd.writable};const Gd=e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)},Xd=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},Jd=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch(r){return n}},$d=async(e,t)=>{await e.removeItem(t)};class Zd{constructor(){this.promise=new Zd.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function Qd(e){const t=e.split(".");if(3!==t.length)throw new Rd("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!wd.test(t[n]))throw new Rd("JWT not in base64url format");return{header:JSON.parse(Bd(t[0])),payload:JSON.parse(Bd(t[1])),signature:qd(t[2]),raw:{header:t[0],payload:t[1]}}}function eh(e){return("0"+e.toString(16)).substr(-2)}async function th(e){if(!("undefined"!==typeof crypto&&"undefined"!==typeof crypto.subtle&&"undefined"!==typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(n);return Array.from(r).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function nh(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=function(){const e=new Uint32Array(56);if("undefined"===typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let n="";for(let r=0;r<56;r++)n+=e.charAt(Math.floor(Math.random()*t));return n}return crypto.getRandomValues(e),Array.from(e,eh).join("")}();let o=r;n&&(o+="/PASSWORD_RECOVERY"),await Xd(e,"".concat(t,"-code-verifier"),o);const i=await th(r);return[i,r===i?"plain":"s256"]}Zd.promiseConstructor=Promise;const rh=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const oh=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ih(e){if(!oh.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ah(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"===typeof t){const e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "'.concat(t,'" property of the session object is not supported. Please use getUser() instead.'))},set:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))},deleteProperty:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))}})}function sh(e){return JSON.parse(JSON.stringify(e))}const lh=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ch=[502,503,504];async function uh(e){var t,n;if(!("object"===typeof(n=e)&&null!==n&&"status"in n&&"ok"in n&&"json"in n&&"function"===typeof n.json))throw new Id(lh(e),0);if(ch.includes(e.status))throw new Id(lh(e),e.status);let r,o;try{r=await e.json()}catch(a){throw new Sd(lh(a),a)}const i=function(e){const t=e.headers.get(gd);if(!t)return null;if(!t.match(rh))return null;try{return new Date("".concat(t,"T00:00:00.0Z"))}catch(a){return null}}(e);if(i&&i.getTime()>=yd.timestamp&&"object"===typeof r&&r&&"string"===typeof r.code?o=r.code:"object"===typeof r&&r&&"string"===typeof r.error_code&&(o=r.error_code),o){if("weak_password"===o)throw new Ad(lh(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===o)throw new Ed}else if("object"===typeof r&&r&&"object"===typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0))throw new Ad(lh(r),e.status,r.weak_password.reasons);throw new xd(lh(r),e.status||500,o)}async function dh(e,t,n,r){var o;const i=Object.assign({},null===r||void 0===r?void 0:r.headers);i[gd]||(i[gd]=yd.name),(null===r||void 0===r?void 0:r.jwt)&&(i.Authorization="Bearer ".concat(r.jwt));const a=null!==(o=null===r||void 0===r?void 0:r.query)&&void 0!==o?o:{};(null===r||void 0===r?void 0:r.redirectTo)&&(a.redirect_to=r.redirectTo);const s=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await async function(e,t,n,r,o,i){const a=((e,t,n,r)=>{const o={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),o.body=JSON.stringify(r),Object.assign(Object.assign({},o),n))})(t,r,o,i);let s;try{s=await e(n,Object.assign({},a))}catch(l){throw console.error(l),new Id(lh(l),0)}s.ok||await uh(s);if(null===r||void 0===r?void 0:r.noResolveJson)return s;try{return await s.json()}catch(l){await uh(l)}}(e,t,n+s,{headers:i,noResolveJson:null===r||void 0===r?void 0:r.noResolveJson},{},null===r||void 0===r?void 0:r.body);return(null===r||void 0===r?void 0:r.xform)?null===r||void 0===r?void 0:r.xform(l):{data:Object.assign({},l),error:null}}function hh(e){var t;let n=null;var r;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)));return{data:{session:n,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function fh(e){const t=hh(e);return!t.error&&e.weak_password&&"object"===typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"===typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function ph(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function vh(e){return{data:e,error:null}}function mh(e){const{action_link:t,email_otp:n,hashed_token:r,redirect_to:o,verification_type:i}=e,a=gc(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:n,hashed_token:r,redirect_to:o,verification_type:i},user:Object.assign({},a)},error:null}}function gh(e){return e}const yh=["global","local","others"];class wh{constructor(e){let{url:t="",headers:n={},fetch:r}=e;this.url=t,this.headers=n,this.fetch=Gd(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yh[0];if(yh.indexOf(t)<0)throw new Error("@supabase/auth-js: Parameter scope must be one of ".concat(yh.join(", ")));try{return await dh(this.fetch,"POST","".concat(this.url,"/logout?scope=").concat(t),{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(_d(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await dh(this.fetch,"POST","".concat(this.url,"/invite"),{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:ph})}catch(n){if(_d(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=gc(e,["options"]),r=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(r.new_email=null===n||void 0===n?void 0:n.newEmail,delete r.newEmail),await dh(this.fetch,"POST","".concat(this.url,"/admin/generate_link"),{body:r,headers:this.headers,xform:mh,redirectTo:null===t||void 0===t?void 0:t.redirectTo})}catch(t){if(_d(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await dh(this.fetch,"POST","".concat(this.url,"/admin/users"),{body:e,headers:this.headers,xform:ph})}catch(t){if(_d(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,r,o,i,a,s;try{const l={nextPage:null,lastPage:0,total:0},c=await dh(this.fetch,"GET","".concat(this.url,"/admin/users"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(n=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",per_page:null!==(o=null===(r=null===e||void 0===e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==o?o:""},xform:gh});if(c.error)throw c.error;const u=await c.json(),d=null!==(i=c.headers.get("x-total-count"))&&void 0!==i?i:0,h=null!==(s=null===(a=c.headers.get("link"))||void 0===a?void 0:a.split(","))&&void 0!==s?s:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),n=JSON.parse(e.split(";")[1].split("=")[1]);l["".concat(n,"Page")]=t}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(l){if(_d(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){ih(e);try{return await dh(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,xform:ph})}catch(t){if(_d(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){ih(e);try{return await dh(this.fetch,"PUT","".concat(this.url,"/admin/users/").concat(e),{body:t,headers:this.headers,xform:ph})}catch(n){if(_d(n))return{data:{user:null},error:n};throw n}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];ih(e);try{return await dh(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,body:{should_soft_delete:t},xform:ph})}catch(n){if(_d(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){ih(e.userId);try{const{data:t,error:n}=await dh(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e.userId,"/factors"),{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:n}}catch(t){if(_d(t))return{data:null,error:t};throw t}}async _deleteFactor(e){ih(e.userId),ih(e.id);try{return{data:await dh(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e.userId,"/factors/").concat(e.id),{headers:this.headers}),error:null}}catch(t){if(_d(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,n,r,o,i,a,s;try{const l={nextPage:null,lastPage:0,total:0},c=await dh(this.fetch,"GET","".concat(this.url,"/admin/oauth/clients"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(n=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",per_page:null!==(o=null===(r=null===e||void 0===e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==o?o:""},xform:gh});if(c.error)throw c.error;const u=await c.json(),d=null!==(i=c.headers.get("x-total-count"))&&void 0!==i?i:0,h=null!==(s=null===(a=c.headers.get("link"))||void 0===a?void 0:a.split(","))&&void 0!==s?s:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),n=JSON.parse(e.split(";")[1].split("=")[1]);l["".concat(n,"Page")]=t}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(l){if(_d(l))return{data:{clients:[]},error:l};throw l}}async _createOAuthClient(e){try{return await dh(this.fetch,"POST","".concat(this.url,"/admin/oauth/clients"),{body:e,headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(_d(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await dh(this.fetch,"GET","".concat(this.url,"/admin/oauth/clients/").concat(e),{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(_d(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await dh(this.fetch,"PUT","".concat(this.url,"/admin/oauth/clients/").concat(e),{body:t,headers:this.headers,xform:e=>({data:e,error:null})})}catch(n){if(_d(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await dh(this.fetch,"DELETE","".concat(this.url,"/admin/oauth/clients/").concat(e),{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(_d(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await dh(this.fetch,"POST","".concat(this.url,"/admin/oauth/clients/").concat(e,"/regenerate_secret"),{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(_d(t))return{data:null,error:t};throw t}}}function bh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}const _h=!!(globalThis&&Yd()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class xh extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Sh extends xh{}async function kh(e,t,n){_h&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),_h&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async r=>{if(!r){if(0===t)throw _h&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Sh('Acquiring an exclusive Navigator LockManager lock "'.concat(e,'" immediately failed'));if(_h)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}_h&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,r.name);try{return await n()}finally{_h&&console.log("@supabase/gotrue-js: navigatorLock: released",e,r.name)}}))}function Eh(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error('@supabase/auth-js: Address "'.concat(e,'" is invalid.'));return e.toLowerCase()}function Ch(e){const t=(new TextEncoder).encode(e);return"0x"+Array.from(t,e=>e.toString(16).padStart(2,"0")).join("")}class Nh extends Error{constructor(e){let{message:t,code:n,cause:r,name:o}=e;var i;super(t,{cause:r}),this.__isWebAuthnError=!0,this.name=null!==(i=null!==o&&void 0!==o?o:r instanceof Error?r.name:void 0)&&void 0!==i?i:"Unknown Error",this.code=n}}class jh extends Nh{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function Th(e){let{error:t,options:n}=e;var r,o,i;const{publicKey:a}=n;if(!a)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(n.signal instanceof AbortSignal)return new Nh({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if("ConstraintError"===t.name){if(!0===(null===(r=a.authenticatorSelection)||void 0===r?void 0:r.requireResidentKey))return new Nh({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if("conditional"===n.mediation&&"required"===(null===(o=a.authenticatorSelection)||void 0===o?void 0:o.userVerification))return new Nh({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if("required"===(null===(i=a.authenticatorSelection)||void 0===i?void 0:i.userVerification))return new Nh({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if("InvalidStateError"===t.name)return new Nh({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if("NotAllowedError"===t.name)return new Nh({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if("NotSupportedError"===t.name){return 0===a.pubKeyCredParams.filter(e=>"public-key"===e.type).length?new Nh({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Nh({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t})}if("SecurityError"===t.name){const e=window.location.hostname;if(!Mh(e))return new Nh({message:"".concat(window.location.hostname," is an invalid domain"),code:"ERROR_INVALID_DOMAIN",cause:t});if(a.rp.id!==e)return new Nh({message:'The RP ID "'.concat(a.rp.id,'" is invalid for this domain'),code:"ERROR_INVALID_RP_ID",cause:t})}else if("TypeError"===t.name){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new Nh({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if("UnknownError"===t.name)return new Nh({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Nh({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function Oh(e){let{error:t,options:n}=e;const{publicKey:r}=n;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(n.signal instanceof AbortSignal)return new Nh({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if("NotAllowedError"===t.name)return new Nh({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if("SecurityError"===t.name){const e=window.location.hostname;if(!Mh(e))return new Nh({message:"".concat(window.location.hostname," is an invalid domain"),code:"ERROR_INVALID_DOMAIN",cause:t});if(r.rpId!==e)return new Nh({message:'The RP ID "'.concat(r.rpId,'" is invalid for this domain'),code:"ERROR_INVALID_RP_ID",cause:t})}else if("UnknownError"===t.name)return new Nh({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Nh({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}const Ih=new class{createNewAbortSignal(){if(this.controller){const e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}};function Ph(e){if(!e)throw new Error("Credential creation options are required");if("undefined"!==typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"===typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:n,excludeCredentials:r}=e,o=gc(e,["challenge","user","excludeCredentials"]),i=qd(t).buffer,a=Object.assign(Object.assign({},n),{id:qd(n.id).buffer}),s=Object.assign(Object.assign({},o),{challenge:i,user:a});if(r&&r.length>0){s.excludeCredentials=new Array(r.length);for(let e=0;e<r.length;e++){const t=r[e];s.excludeCredentials[e]=Object.assign(Object.assign({},t),{id:qd(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return s}function Ah(e){if(!e)throw new Error("Credential request options are required");if("undefined"!==typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"===typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:n}=e,r=gc(e,["challenge","allowCredentials"]),o=qd(t).buffer,i=Object.assign(Object.assign({},r),{challenge:o});if(n&&n.length>0){i.allowCredentials=new Array(n.length);for(let e=0;e<n.length;e++){const t=n[e];i.allowCredentials[e]=Object.assign(Object.assign({},t),{id:qd(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return i}function Rh(e){var t;if("toJSON"in e&&"function"===typeof e.toJSON)return e.toJSON();const n=e;return{id:e.id,rawId:e.id,response:{attestationObject:Vd(new Uint8Array(e.response.attestationObject)),clientDataJSON:Vd(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:null!==(t=n.authenticatorAttachment)&&void 0!==t?t:void 0}}function Dh(e){var t;if("toJSON"in e&&"function"===typeof e.toJSON)return e.toJSON();const n=e,r=e.getClientExtensionResults(),o=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Vd(new Uint8Array(o.authenticatorData)),clientDataJSON:Vd(new Uint8Array(o.clientDataJSON)),signature:Vd(new Uint8Array(o.signature)),userHandle:o.userHandle?Vd(new Uint8Array(o.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:null!==(t=n.authenticatorAttachment)&&void 0!==t?t:void 0}}function Mh(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function Lh(){var e,t;return!!(Wd()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&"function"===typeof(null===(e=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===e?void 0:e.create)&&"function"===typeof(null===(t=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===t?void 0:t.get))}const zh={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Uh={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Bh(){const e=e=>null!==e&&"object"===typeof e&&!Array.isArray(e),t=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),n={};for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];for(const a of o)if(a)for(const r in a){const o=a[r];if(void 0!==o)if(Array.isArray(o))n[r]=o;else if(t(o))n[r]=o;else if(e(o)){const t=n[r];e(t)?n[r]=Bh(t,o):n[r]=Bh(o)}else n[r]=o}return n}class Fh{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge(e,t){let{factorId:n,webauthn:r,friendlyName:o,signal:i}=e;try{const{data:e,error:a}=await this.client.mfa.challenge({factorId:n,webauthn:r});if(!e)return{data:null,error:a};const s=null!==i&&void 0!==i?i:Ih.createNewAbortSignal();if("create"===e.webauthn.type){const{user:t}=e.webauthn.credential_options.publicKey;t.name||(t.name="".concat(t.id,":").concat(o)),t.displayName||(t.displayName=t.name)}switch(e.webauthn.type){case"create":{const r=function(e,t){return Bh(zh,e,t||{})}(e.webauthn.credential_options.publicKey,null===t||void 0===t?void 0:t.create),{data:o,error:i}=await async function(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new jh("Browser returned unexpected credential type",t)}:{data:null,error:new jh("Empty credential response",t)}}catch(t){return{data:null,error:Th({error:t,options:e})}}}({publicKey:r,signal:s});return o?{data:{factorId:n,challengeId:e.id,webauthn:{type:e.webauthn.type,credential_response:o}},error:null}:{data:null,error:i}}case"request":{const r=function(e,t){return Bh(Uh,e,t||{})}(e.webauthn.credential_options.publicKey,null===t||void 0===t?void 0:t.request),{data:o,error:i}=await async function(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new jh("Browser returned unexpected credential type",t)}:{data:null,error:new jh("Empty credential response",t)}}catch(t){return{data:null,error:Oh({error:t,options:e})}}}(Object.assign(Object.assign({},e.webauthn.credential_options),{publicKey:r,signal:s}));return o?{data:{factorId:n,challengeId:e.id,webauthn:{type:e.webauthn.type,credential_response:o}},error:null}:{data:null,error:i}}}}catch(a){return _d(a)?{data:null,error:a}:{data:null,error:new Sd("Unexpected error in challenge",a)}}}async _verify(e){let{challengeId:t,factorId:n,webauthn:r}=e;return this.client.mfa.verify({factorId:n,challengeId:t,webauthn:r})}async _authenticate(e,t){let{factorId:n,webauthn:{rpId:r=("undefined"!==typeof window?window.location.hostname:void 0),rpOrigins:o=("undefined"!==typeof window?[window.location.origin]:void 0),signal:i}={}}=e;if(!r)return{data:null,error:new bd("rpId is required for WebAuthn authentication")};try{if(!Lh())return{data:null,error:new Sd("Browser does not support WebAuthn",null)};const{data:e,error:a}=await this.challenge({factorId:n,webauthn:{rpId:r,rpOrigins:o},signal:i},{request:t});if(!e)return{data:null,error:a};const{webauthn:s}=e;return this._verify({factorId:n,challengeId:e.challengeId,webauthn:{type:s.type,rpId:r,rpOrigins:o,credential_response:s.credential_response}})}catch(a){return _d(a)?{data:null,error:a}:{data:null,error:new Sd("Unexpected error in authenticate",a)}}}async _register(e,t){let{friendlyName:n,webauthn:{rpId:r=("undefined"!==typeof window?window.location.hostname:void 0),rpOrigins:o=("undefined"!==typeof window?[window.location.origin]:void 0),signal:i}={}}=e;if(!r)return{data:null,error:new bd("rpId is required for WebAuthn registration")};try{if(!Lh())return{data:null,error:new Sd("Browser does not support WebAuthn",null)};const{data:e,error:a}=await this._enroll({friendlyName:n});if(!e)return await this.client.mfa.listFactors().then(e=>{var t;return null===(t=e.data)||void 0===t?void 0:t.all.find(e=>"webauthn"===e.factor_type&&e.friendly_name===n&&"unverified"!==e.status)}).then(e=>e?this.client.mfa.unenroll({factorId:null===e||void 0===e?void 0:e.id}):void 0),{data:null,error:a};const{data:s,error:l}=await this._challenge({factorId:e.id,friendlyName:e.friendly_name,webauthn:{rpId:r,rpOrigins:o},signal:i},{create:t});return s?this._verify({factorId:e.id,challengeId:s.challengeId,webauthn:{rpId:r,rpOrigins:o,type:s.webauthn.type,credential_response:s.webauthn.credential_response}}):{data:null,error:l}}catch(a){return _d(a)?{data:null,error:a}:{data:null,error:new Sd("Unexpected error in register",a)}}}}!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!==typeof self&&(self.globalThis=self)}}();const Kh={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:md,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function qh(e,t,n){return await n()}const Vh={};class Wh{get jwks(){var e,t;return null!==(t=null===(e=Vh[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){Vh[this.storageKey]=Object.assign(Object.assign({},Vh[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=Vh[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Vh[this.storageKey]=Object.assign(Object.assign({},Vh[this.storageKey]),{cachedAt:e})}constructor(e){var t,n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const o=Object.assign(Object.assign({},Kh),e);if(this.storageKey=o.storageKey,this.instanceID=null!==(t=Wh.nextInstanceID[this.storageKey])&&void 0!==t?t:0,Wh.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!o.debug,"function"===typeof o.debug&&(this.logger=o.debug),this.instanceID>0&&Wd()){const e="".concat(this._logPrefix()," Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");console.warn(e),this.logDebugMessages&&console.trace(e)}if(this.persistSession=o.persistSession,this.autoRefreshToken=o.autoRefreshToken,this.admin=new wh({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=Gd(o.fetch),this.lock=o.lock||qh,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,this.throwOnError=o.throwOnError,this.lockAcquireTimeout=o.lockAcquireTimeout,o.lock?this.lock=o.lock:this.persistSession&&Wd()&&(null===(n=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===n?void 0:n.locks)?this.lock=kh:this.lock=qh,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Fh(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:Yd()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=bh(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=bh(this.memoryStorage)),Wd()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}null===(r=this.broadcastChannel)||void 0===r||r.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return"GoTrueClient@"+"".concat(this.storageKey,":").concat(this.instanceID," (").concat(fd,") ").concat((new Date).toISOString())}_debug(){if(this.logDebugMessages){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger(this._logPrefix(),...t)}return this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t={},n="none";if(Wd()&&(t=function(e){const t={},n=new URL(e);if(n.hash&&"#"===n.hash[0])try{new URLSearchParams(n.hash.substring(1)).forEach((e,n)=>{t[n]=e})}catch(r){}return n.searchParams.forEach((e,n)=>{t[n]=e}),t}(window.location.href),this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce")),Wd()&&this.detectSessionInUrl&&"none"!==n){const{data:r,error:o}=await this._getSessionFromURL(t,n);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),function(e){return _d(e)&&"AuthImplicitGrantRedirectError"===e.name}(o)){const t=null===(e=o.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:o}}return{error:o}}const{session:i,redirectType:a}=r;return this._debug("#_initialize()","detected session in URL",i,"redirect type",a),await this._saveSession(i),setTimeout(async()=>{"recovery"===a?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return _d(t)?this._returnResult({error:t}):this._returnResult({error:new Sd("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,r;try{const o=await dh(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{data:null!==(n=null===(t=null===e||void 0===e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==n?n:{},gotrue_meta_security:{captcha_token:null===(r=null===e||void 0===e?void 0:e.options)||void 0===r?void 0:r.captchaToken}},xform:hh}),{data:i,error:a}=o;if(a||!i)return this._returnResult({data:{user:null,session:null},error:a});const s=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",s)),this._returnResult({data:{user:l,session:s},error:null})}catch(o){if(_d(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signUp(e){var t,n,r;try{let o;if("email"in e){const{email:n,password:r,options:i}=e;let a=null,s=null;"pkce"===this.flowType&&([a,s]=await nh(this.storage,this.storageKey)),o=await dh(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,redirectTo:null===i||void 0===i?void 0:i.emailRedirectTo,body:{email:n,password:r,data:null!==(t=null===i||void 0===i?void 0:i.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken},code_challenge:a,code_challenge_method:s},xform:hh})}else{if(!("phone"in e))throw new Nd("You must provide either an email or phone number and a password");{const{phone:t,password:i,options:a}=e;o=await dh(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{phone:t,password:i,data:null!==(n=null===a||void 0===a?void 0:a.data)&&void 0!==n?n:{},channel:null!==(r=null===a||void 0===a?void 0:a.channel)&&void 0!==r?r:"sms",gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},xform:hh})}}const{data:i,error:a}=o;if(a||!i)return await $d(this.storage,"".concat(this.storageKey,"-code-verifier")),this._returnResult({data:{user:null,session:null},error:a});const s=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",s)),this._returnResult({data:{user:l,session:s},error:null})}catch(o){if(await $d(this.storage,"".concat(this.storageKey,"-code-verifier")),_d(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithPassword(e){try{let t;if("email"in e){const{email:n,password:r,options:o}=e;t=await dh(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{email:n,password:r,gotrue_meta_security:{captcha_token:null===o||void 0===o?void 0:o.captchaToken}},xform:fh})}else{if(!("phone"in e))throw new Nd("You must provide either an email or phone number and a password");{const{phone:n,password:r,options:o}=e;t=await dh(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{phone:n,password:r,gotrue_meta_security:{captcha_token:null===o||void 0===o?void 0:o.captchaToken}},xform:fh})}}const{data:n,error:r}=t;if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!n||!n.session||!n.user){const e=new Cd;return this._returnResult({data:{user:null,session:null},error:e})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:r})}catch(t){if(_d(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,n,r,o;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:null===(o=e.options)||void 0===o?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error('@supabase/auth-js: Unsupported chain "'.concat(t,'"'))}}async signInWithEthereum(e){var t,n,r,o,i,a,s,l,c,u,d;let h,f;if("message"in e)h=e.message,f=e.signature;else{const{chain:u,wallet:d,statement:p,options:v}=e;let m;if(Wd())if("object"===typeof d)m=d;else{const e=window;if(!("ethereum"in e)||"object"!==typeof e.ethereum||!("request"in e.ethereum)||"function"!==typeof e.ethereum.request)throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.");m=e.ethereum}else{if("object"!==typeof d||!(null===v||void 0===v?void 0:v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");m=d}const g=new URL(null!==(t=null===v||void 0===v?void 0:v.url)&&void 0!==t?t:window.location.href),y=await m.request({method:"eth_requestAccounts"}).then(e=>e).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!y||0===y.length)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const w=Eh(y[0]);let b=null===(n=null===v||void 0===v?void 0:v.signInWithEthereum)||void 0===n?void 0:n.chainId;if(!b){b=function(e){return parseInt(e,16)}(await m.request({method:"eth_chainId"}))}h=function(e){var t;const{chainId:n,domain:r,expirationTime:o,issuedAt:i=new Date,nonce:a,notBefore:s,requestId:l,resources:c,scheme:u,uri:d,version:h}=e;if(!Number.isInteger(n))throw new Error('@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: '.concat(n));if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error('@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: '.concat(a));if(!d)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==h)throw new Error("@supabase/auth-js: Invalid SIWE message field \"version\". Version must be '1'. Provided value: ".concat(h));if(null===(t=e.statement)||void 0===t?void 0:t.includes("\n"))throw new Error("@supabase/auth-js: Invalid SIWE message field \"statement\". Statement must not include '\\n'. Provided value: ".concat(e.statement));const f=Eh(e.address),p=u?"".concat(u,"://").concat(r):r,v=e.statement?"".concat(e.statement,"\n"):"",m="".concat(p," wants you to sign in with your Ethereum account:\n").concat(f,"\n\n").concat(v);let g="URI: ".concat(d,"\nVersion: ").concat(h,"\nChain ID: ").concat(n).concat(a?"\nNonce: ".concat(a):"","\nIssued At: ").concat(i.toISOString());if(o&&(g+="\nExpiration Time: ".concat(o.toISOString())),s&&(g+="\nNot Before: ".concat(s.toISOString())),l&&(g+="\nRequest ID: ".concat(l)),c){let e="\nResources:";for(const t of c){if(!t||"string"!==typeof t)throw new Error('@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: '.concat(t));e+="\n- ".concat(t)}g+=e}return"".concat(m,"\n").concat(g)}({domain:g.host,address:w,statement:p,uri:g.href,version:"1",chainId:b,nonce:null===(r=null===v||void 0===v?void 0:v.signInWithEthereum)||void 0===r?void 0:r.nonce,issuedAt:null!==(i=null===(o=null===v||void 0===v?void 0:v.signInWithEthereum)||void 0===o?void 0:o.issuedAt)&&void 0!==i?i:new Date,expirationTime:null===(a=null===v||void 0===v?void 0:v.signInWithEthereum)||void 0===a?void 0:a.expirationTime,notBefore:null===(s=null===v||void 0===v?void 0:v.signInWithEthereum)||void 0===s?void 0:s.notBefore,requestId:null===(l=null===v||void 0===v?void 0:v.signInWithEthereum)||void 0===l?void 0:l.requestId,resources:null===(c=null===v||void 0===v?void 0:v.signInWithEthereum)||void 0===c?void 0:c.resources}),f=await m.request({method:"personal_sign",params:[Ch(h),w]})}try{const{data:t,error:n}=await dh(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"ethereum",message:h,signature:f},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(d=e.options)||void 0===d?void 0:d.captchaToken}}:null),xform:hh});if(n)throw n;if(!t||!t.session||!t.user){const e=new Cd;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:n})}catch(p){if(_d(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async signInWithSolana(e){var t,n,r,o,i,a,s,l,c,u,d,h;let f,p;if("message"in e)f=e.message,p=e.signature;else{const{chain:d,wallet:h,statement:v,options:m}=e;let g;if(Wd())if("object"===typeof h)g=h;else{const e=window;if(!("solana"in e)||"object"!==typeof e.solana||!("signIn"in e.solana&&"function"===typeof e.solana.signIn||"signMessage"in e.solana&&"function"===typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");g=e.solana}else{if("object"!==typeof h||!(null===m||void 0===m?void 0:m.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");g=h}const y=new URL(null!==(t=null===m||void 0===m?void 0:m.url)&&void 0!==t?t:window.location.href);if("signIn"in g&&g.signIn){const e=await g.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null===m||void 0===m?void 0:m.signInWithSolana),{version:"1",domain:y.host,uri:y.href}),v?{statement:v}:null));let t;if(Array.isArray(e)&&e[0]&&"object"===typeof e[0])t=e[0];else{if(!(e&&"object"===typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"===typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");f="string"===typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),p=t.signature}else{if(!("signMessage"in g)||"function"!==typeof g.signMessage||!("publicKey"in g)||"object"!==typeof g||!g.publicKey||!("toBase58"in g.publicKey)||"function"!==typeof g.publicKey.toBase58)throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");f=["".concat(y.host," wants you to sign in with your Solana account:"),g.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1","URI: ".concat(y.href),"Issued At: ".concat(null!==(r=null===(n=null===m||void 0===m?void 0:m.signInWithSolana)||void 0===n?void 0:n.issuedAt)&&void 0!==r?r:(new Date).toISOString()),...(null===(o=null===m||void 0===m?void 0:m.signInWithSolana)||void 0===o?void 0:o.notBefore)?["Not Before: ".concat(m.signInWithSolana.notBefore)]:[],...(null===(i=null===m||void 0===m?void 0:m.signInWithSolana)||void 0===i?void 0:i.expirationTime)?["Expiration Time: ".concat(m.signInWithSolana.expirationTime)]:[],...(null===(a=null===m||void 0===m?void 0:m.signInWithSolana)||void 0===a?void 0:a.chainId)?["Chain ID: ".concat(m.signInWithSolana.chainId)]:[],...(null===(s=null===m||void 0===m?void 0:m.signInWithSolana)||void 0===s?void 0:s.nonce)?["Nonce: ".concat(m.signInWithSolana.nonce)]:[],...(null===(l=null===m||void 0===m?void 0:m.signInWithSolana)||void 0===l?void 0:l.requestId)?["Request ID: ".concat(m.signInWithSolana.requestId)]:[],...(null===(u=null===(c=null===m||void 0===m?void 0:m.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===u?void 0:u.length)?["Resources",...m.signInWithSolana.resources.map(e=>"- ".concat(e))]:[]].join("\n");const e=await g.signMessage((new TextEncoder).encode(f),"utf8");if(!e||!(e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=e}}try{const{data:t,error:n}=await dh(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"solana",message:f,signature:Vd(p)},(null===(d=e.options)||void 0===d?void 0:d.captchaToken)?{gotrue_meta_security:{captcha_token:null===(h=e.options)||void 0===h?void 0:h.captchaToken}}:null),xform:hh});if(n)throw n;if(!t||!t.session||!t.user){const e=new Cd;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:n})}catch(v){if(_d(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async _exchangeCodeForSession(e){const t=await Jd(this.storage,"".concat(this.storageKey,"-code-verifier")),[n,r]=(null!==t&&void 0!==t?t:"").split("/");try{if(!n&&"pkce"===this.flowType)throw new Od;const{data:t,error:o}=await dh(this.fetch,"POST","".concat(this.url,"/token?grant_type=pkce"),{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:hh});if(await $d(this.storage,"".concat(this.storageKey,"-code-verifier")),o)throw o;if(!t||!t.session||!t.user){const e=new Cd;return this._returnResult({data:{user:null,session:null,redirectType:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign(Object.assign({},t),{redirectType:null!==r&&void 0!==r?r:null}),error:o})}catch(o){if(await $d(this.storage,"".concat(this.storageKey,"-code-verifier")),_d(o))return this._returnResult({data:{user:null,session:null,redirectType:null},error:o});throw o}}async signInWithIdToken(e){try{const{options:t,provider:n,token:r,access_token:o,nonce:i}=e,a=await dh(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,body:{provider:n,id_token:r,access_token:o,nonce:i,gotrue_meta_security:{captcha_token:null===t||void 0===t?void 0:t.captchaToken}},xform:hh}),{data:s,error:l}=a;if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!s||!s.session||!s.user){const e=new Cd;return this._returnResult({data:{user:null,session:null},error:e})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:s,error:l})}catch(t){if(_d(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,n,r,o,i;try{if("email"in e){const{email:r,options:o}=e;let i=null,a=null;"pkce"===this.flowType&&([i,a]=await nh(this.storage,this.storageKey));const{error:s}=await dh(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{email:r,data:null!==(t=null===o||void 0===o?void 0:o.data)&&void 0!==t?t:{},create_user:null===(n=null===o||void 0===o?void 0:o.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null===o||void 0===o?void 0:o.captchaToken},code_challenge:i,code_challenge_method:a},redirectTo:null===o||void 0===o?void 0:o.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:s})}if("phone"in e){const{phone:t,options:n}=e,{data:a,error:s}=await dh(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{phone:t,data:null!==(r=null===n||void 0===n?void 0:n.data)&&void 0!==r?r:{},create_user:null===(o=null===n||void 0===n?void 0:n.shouldCreateUser)||void 0===o||o,gotrue_meta_security:{captcha_token:null===n||void 0===n?void 0:n.captchaToken},channel:null!==(i=null===n||void 0===n?void 0:n.channel)&&void 0!==i?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:null===a||void 0===a?void 0:a.message_id},error:s})}throw new Nd("You must provide either an email or phone number.")}catch(a){if(await $d(this.storage,"".concat(this.storageKey,"-code-verifier")),_d(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async verifyOtp(e){var t,n;try{let r,o;"options"in e&&(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo,o=null===(n=e.options)||void 0===n?void 0:n.captchaToken);const{data:i,error:a}=await dh(this.fetch,"POST","".concat(this.url,"/verify"),{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:r,xform:hh});if(a)throw a;if(!i){throw new Error("An error occurred on token verification.")}const s=i.session,l=i.user;return(null===s||void 0===s?void 0:s.access_token)&&(await this._saveSession(s),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",s)),this._returnResult({data:{user:l,session:s},error:null})}catch(r){if(_d(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithSSO(e){var t,n,r,o,i;try{let a=null,s=null;"pkce"===this.flowType&&([a,s]=await nh(this.storage,this.storageKey));const l=await dh(this.fetch,"POST","".concat(this.url,"/sso"),{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==n?n:void 0}),(null===(r=null===e||void 0===e?void 0:e.options)||void 0===r?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:s}),headers:this.headers,xform:vh});return(null===(o=l.data)||void 0===o?void 0:o.url)&&Wd()&&!(null===(i=e.options)||void 0===i?void 0:i.skipBrowserRedirect)&&window.location.assign(l.data.url),this._returnResult(l)}catch(a){if(await $d(this.storage,"".concat(this.storageKey,"-code-verifier")),_d(a))return this._returnResult({data:null,error:a});throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new Ed;const{error:r}=await dh(this.fetch,"GET","".concat(this.url,"/reauthenticate"),{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:r})})}catch(e){if(_d(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t="".concat(this.url,"/resend");if("email"in e){const{email:n,type:r,options:o}=e,{error:i}=await dh(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:r,gotrue_meta_security:{captcha_token:null===o||void 0===o?void 0:o.captchaToken}},redirectTo:null===o||void 0===o?void 0:o.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}if("phone"in e){const{phone:n,type:r,options:o}=e,{data:i,error:a}=await dh(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:r,gotrue_meta_security:{captcha_token:null===o||void 0===o?void 0:o.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:null===i||void 0===i?void 0:i.message_id},error:a})}throw new Nd("You must provide either an email or phone number and a type")}catch(t){if(_d(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch(e){}})()),n}return await this.lock("lock:".concat(this.storageKey),e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await Jd(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=!!e.expires_at&&1e3*e.expires_at-Date.now()<vd;if(this._debug("#__loadSession()","session has".concat(n?"":" not"," expired"),"expires_at",e.expires_at),!n){if(this.userStorage){const t=await Jd(this.userStorage,this.storageKey+"-user");(null===t||void 0===t?void 0:t.user)?e.user=t.user:e.user=ah()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const t={value:this.suppressGetSessionWarning};e.user=function(e,t){return new Proxy(e,{get:(e,n,r)=>{if("__isInsecureUserWarningProxy"===n)return!0;if("symbol"===typeof n){const t=n.toString();if("Symbol(Symbol.toPrimitive)"===t||"Symbol(Symbol.toStringTag)"===t||"Symbol(util.inspect.custom)"===t||"Symbol(nodejs.util.inspect.custom)"===t)return Reflect.get(e,n,r)}return t.value||"string"!==typeof n||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(e,n,r)}})}(e.user,t),t.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:r,error:o}=await this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{session:null},error:o}):this._returnResult({data:{session:r},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await dh(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:e,xform:ph}):await this._useSession(async e=>{var t,n,r;const{data:o,error:i}=e;if(i)throw i;return(null===(t=o.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await dh(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:null!==(r=null===(n=o.session)||void 0===n?void 0:n.access_token)&&void 0!==r?r:void 0,xform:ph}):{data:{user:null},error:new Ed}})}catch(t){if(_d(t))return function(e){return _d(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await $d(this.storage,"".concat(this.storageKey,"-code-verifier"))),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession(async n=>{const{data:r,error:o}=n;if(o)throw o;if(!r.session)throw new Ed;const i=r.session;let a=null,s=null;"pkce"===this.flowType&&null!=e.email&&([a,s]=await nh(this.storage,this.storageKey));const{data:l,error:c}=await dh(this.fetch,"PUT","".concat(this.url,"/user"),{headers:this.headers,redirectTo:null===t||void 0===t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:s}),jwt:i.access_token,xform:ph});if(c)throw c;return i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(n){if(await $d(this.storage,"".concat(this.storageKey,"-code-verifier")),_d(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ed;const t=Date.now()/1e3;let n=t,r=!0,o=null;const{payload:i}=Qd(e.access_token);if(i.exp&&(n=i.exp,r=n<=t),r){const{data:t,error:n}=await this._callRefreshToken(e.refresh_token);if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!t)return{data:{user:null,session:null},error:null};o=t}else{const{data:r,error:i}=await this._getUser(e.access_token);if(i)throw i;o={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return this._returnResult({data:{user:o.user,session:o},error:null})}catch(t){if(_d(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:r,error:o}=t;if(o)throw o;e=null!==(n=r.session)&&void 0!==n?n:void 0}if(!(null===e||void 0===e?void 0:e.refresh_token))throw new Ed;const{data:r,error:o}=await this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{user:null,session:null},error:o}):r?this._returnResult({data:{user:r.user,session:r},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(_d(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!Wd())throw new jd("No browser detected.");if(e.error||e.error_description||e.error_code)throw new jd(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new Td("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new jd("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Td("No code detected.");const{data:t,error:n}=await this._exchangeCodeForSession(e.code);if(n)throw n;const r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:r,access_token:o,refresh_token:i,expires_in:a,expires_at:s,token_type:l}=e;if(!o||!a||!i||!l)throw new jd("No session defined in URL");const c=Math.round(Date.now()/1e3),u=parseInt(a);let d=c+u;s&&(d=parseInt(s));const h=d-c;1e3*h<=pd&&console.warn("@supabase/gotrue-js: Session as retrieved from URL expires in ".concat(h,"s, should have been closer to ").concat(u,"s"));const f=d-u;c-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,d,c):c-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",f,d,c);const{data:p,error:v}=await this._getUser(o);if(v)throw v;const m={provider_token:n,provider_refresh_token:r,access_token:o,expires_in:u,expires_at:d,refresh_token:i,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:m,redirectType:e.type},error:null})}catch(n){if(_d(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(e){return"function"===typeof this.detectSessionInUrl?this.detectSessionInUrl(new URL(window.location.href),e):Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Jd(this.storage,"".concat(this.storageKey,"-code-verifier"));return!(!e.code||!t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession(async t=>{var n;const{data:r,error:o}=t;if(o)return this._returnResult({error:o});const i=null===(n=r.session)||void 0===n?void 0:n.access_token;if(i){const{error:t}=await this.admin.signOut(i,e);if(t&&(!function(e){return _d(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return this._returnResult({error:t})}return"others"!==e&&(await this._removeSession(),await $d(this.storage,"".concat(this.storageKey,"-code-verifier"))),this._returnResult({error:null})})}onAuthStateChange(e){const t=Symbol("auth-callback"),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>{await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,r;try{const{data:{session:r},error:o}=t;if(o)throw o;await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(o){await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,r=null;"pkce"===this.flowType&&([n,r]=await nh(this.storage,this.storageKey,!0));try{return await dh(this.fetch,"POST","".concat(this.url,"/recover"),{body:{email:e,code_challenge:n,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(o){if(await $d(this.storage,"".concat(this.storageKey,"-code-verifier")),_d(o))return this._returnResult({data:null,error:o});throw o}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null})}catch(t){if(_d(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:n,error:r}=await this._useSession(async t=>{var n,r,o,i,a;const{data:s,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider("".concat(this.url,"/user/identities/authorize"),e.provider,{redirectTo:null===(n=e.options)||void 0===n?void 0:n.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(o=e.options)||void 0===o?void 0:o.queryParams,skipBrowserRedirect:!0});return await dh(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(a=null===(i=s.session)||void 0===i?void 0:i.access_token)&&void 0!==a?a:void 0})});if(r)throw r;return Wd()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null===n||void 0===n?void 0:n.url),this._returnResult({data:{provider:e.provider,url:null===n||void 0===n?void 0:n.url},error:null})}catch(n){if(_d(n))return this._returnResult({data:{provider:e.provider,url:null},error:n});throw n}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var n;try{const{error:r,data:{session:o}}=t;if(r)throw r;const{options:i,provider:a,token:s,access_token:l,nonce:c}=e,u=await dh(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,jwt:null!==(n=null===o||void 0===o?void 0:o.access_token)&&void 0!==n?n:void 0,body:{provider:a,id_token:s,access_token:l,nonce:c,link_identity:!0,gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}},xform:hh}),{data:d,error:h}=u;return h?this._returnResult({data:{user:null,session:null},error:h}):d&&d.session&&d.user?(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("USER_UPDATED",d.session)),this._returnResult({data:d,error:h})):this._returnResult({data:{user:null,session:null},error:new Cd})}catch(r){if(await $d(this.storage,"".concat(this.storageKey,"-code-verifier")),_d(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,r;const{data:o,error:i}=t;if(i)throw i;return await dh(this.fetch,"DELETE","".concat(this.url,"/user/identities/").concat(e.identity_id),{headers:this.headers,jwt:null!==(r=null===(n=o.session)||void 0===n?void 0:n.access_token)&&void 0!==r?r:void 0})})}catch(t){if(_d(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t="#_refreshAccessToken(".concat(e.substring(0,5),"...)");this._debug(t,"begin");try{const o=Date.now();return await(n=async n=>(n>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await dh(this.fetch,"POST","".concat(this.url,"/token?grant_type=refresh_token"),{body:{refresh_token:e},headers:this.headers,xform:hh})),r=(e,t)=>{const n=200*Math.pow(2,e);return t&&Pd(t)&&Date.now()+n-o<pd},new Promise((e,t)=>{(async()=>{for(let i=0;i<1/0;i++)try{const t=await n(i);if(!r(i,null,t))return void e(t)}catch(o){if(!r(i,o))return void t(o)}})()}))}catch(o){if(this._debug(t,"error",o),_d(o))return this._returnResult({data:{session:null,user:null},error:o});throw o}finally{this._debug(t,"end")}var n,r}_isValidSession(e){return"object"===typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider("".concat(this.url,"/authorize"),e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),Wd()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const o=await Jd(this.storage,this.storageKey);if(o&&this.userStorage){let t=await Jd(this.userStorage,this.storageKey+"-user");this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:o.user},await Xd(this.userStorage,this.storageKey+"-user",t)),o.user=null!==(e=null===t||void 0===t?void 0:t.user)&&void 0!==e?e:ah()}else if(o&&!o.user&&!o.user){const e=await Jd(this.storage,this.storageKey+"-user");e&&(null===e||void 0===e?void 0:e.user)?(o.user=e.user,await $d(this.storage,this.storageKey+"-user"),await Xd(this.storage,this.storageKey,o)):o.user=ah()}if(this._debug(n,"session from storage",o),!this._isValidSession(o))return this._debug(n,"session is not valid"),void(null!==o&&await this._removeSession());const i=1e3*(null!==(t=o.expires_at)&&void 0!==t?t:1/0)-Date.now()<vd;if(this._debug(n,"session has".concat(i?"":" not"," expired with margin of ").concat(vd,"s")),i){if(this.autoRefreshToken&&o.refresh_token){const{error:e}=await this._callRefreshToken(o.refresh_token);e&&(console.error(e),Pd(e)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(o.user&&!0===o.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(o.access_token);!t&&(null===e||void 0===e?void 0:e.user)?(o.user=e.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(r){console.error("Error getting user data:",r),this._debug(n,"error getting user data, skipping SIGNED_IN notification",r)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){return this._debug(n,"error",o),void console.error(o)}finally{this._debug(n,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new Ed;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r="#_callRefreshToken(".concat(e.substring(0,5),"...)");this._debug(r,"begin");try{this.refreshingDeferred=new Zd;const{data:t,error:n}=await this._refreshAccessToken(e);if(n)throw n;if(!t.session)throw new Ed;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const r={data:t.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(o){if(this._debug(r,"error",o),_d(o)){const e={data:null,error:o};return Pd(o)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(n=this.refreshingDeferred)||void 0===n||n.reject(o),o}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r="#_notifyAllSubscribers(".concat(e,")");this._debug(r,"begin",t,"broadcast = ".concat(n));try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],o=Array.from(this.stateChangeEmitters.values()).map(async n=>{try{await n.callback(e,t)}catch(o){r.push(o)}});if(await Promise.all(o),r.length>0){for(let e=0;e<r.length;e+=1)console.error(r[e]);throw r[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await $d(this.storage,"".concat(this.storageKey,"-code-verifier"));const t=Object.assign({},e),n=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!n&&t.user&&await Xd(this.userStorage,this.storageKey+"-user",{user:t.user});const e=Object.assign({},t);delete e.user;const r=sh(e);await Xd(this.storage,this.storageKey,r)}else{const e=sh(t);await Xd(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await $d(this.storage,this.storageKey),await $d(this.storage,this.storageKey+"-code-verifier"),await $d(this.storage,this.storageKey+"-user"),this.userStorage&&await $d(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Wd()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),pd);this.autoRefreshTicker=e,e&&"object"===typeof e&&"function"===typeof e.unref?e.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&"object"===typeof t&&"function"===typeof t.unref?t.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:n}}=e;if(!n||!n.refresh_token||!n.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const r=Math.floor((1e3*n.expires_at-t)/pd);this._debug("#_autoRefreshTokenTick()","access token expires in ".concat(r," ticks, a tick lasts ").concat(pd,"ms, refresh threshold is ").concat(3," ticks")),r<=3&&await this._callRefreshToken(n.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(!(e.isAcquireTimeout||e instanceof xh))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Wd()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t="#_onVisibilityChanged(".concat(e,")");this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const r=["provider=".concat(encodeURIComponent(t))];if((null===n||void 0===n?void 0:n.redirectTo)&&r.push("redirect_to=".concat(encodeURIComponent(n.redirectTo))),(null===n||void 0===n?void 0:n.scopes)&&r.push("scopes=".concat(encodeURIComponent(n.scopes))),"pkce"===this.flowType){const[e,t]=await nh(this.storage,this.storageKey),n=new URLSearchParams({code_challenge:"".concat(encodeURIComponent(e)),code_challenge_method:"".concat(encodeURIComponent(t))});r.push(n.toString())}if(null===n||void 0===n?void 0:n.queryParams){const e=new URLSearchParams(n.queryParams);r.push(e.toString())}return(null===n||void 0===n?void 0:n.skipBrowserRedirect)&&r.push("skip_http_redirect=".concat(n.skipBrowserRedirect)),"".concat(e,"?").concat(r.join("&"))}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:r,error:o}=t;return o?this._returnResult({data:null,error:o}):await dh(this.fetch,"DELETE","".concat(this.url,"/factors/").concat(e.factorId),{headers:this.headers,jwt:null===(n=null===r||void 0===r?void 0:r.session)||void 0===n?void 0:n.access_token})})}catch(t){if(_d(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,r;const{data:o,error:i}=t;if(i)return this._returnResult({data:null,error:i});const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:"totp"===e.factorType?{issuer:e.issuer}:{}),{data:s,error:l}=await dh(this.fetch,"POST","".concat(this.url,"/factors"),{body:a,headers:this.headers,jwt:null===(n=null===o||void 0===o?void 0:o.session)||void 0===n?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):("totp"===e.factorType&&"totp"===s.type&&(null===(r=null===s||void 0===s?void 0:s.totp)||void 0===r?void 0:r.qr_code)&&(s.totp.qr_code="data:image/svg+xml;utf-8,".concat(s.totp.qr_code)),this._returnResult({data:s,error:null}))})}catch(t){if(_d(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var n;const{data:r,error:o}=t;if(o)return this._returnResult({data:null,error:o});const i=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:"create"===e.webauthn.type?Rh(e.webauthn.credential_response):Dh(e.webauthn.credential_response)})}:{code:e.code}),{data:a,error:s}=await dh(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/verify"),{body:i,headers:this.headers,jwt:null===(n=null===r||void 0===r?void 0:r.session)||void 0===n?void 0:n.access_token});return s?this._returnResult({data:null,error:s}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),this._returnResult({data:a,error:s}))})}catch(t){if(_d(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var n;const{data:r,error:o}=t;if(o)return this._returnResult({data:null,error:o});const i=await dh(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/challenge"),{body:e,headers:this.headers,jwt:null===(n=null===r||void 0===r?void 0:r.session)||void 0===n?void 0:n.access_token});if(i.error)return i;const{data:a}=i;if("webauthn"!==a.type)return{data:a,error:null};switch(a.webauthn.type){case"create":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:Ph(a.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:Ah(a.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(_d(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const r={all:[],phone:[],totp:[],webauthn:[]};for(const o of null!==(e=null===t||void 0===t?void 0:t.factors)&&void 0!==e?e:[])r.all.push(o),"verified"===o.status&&r[o.factor_type].push(o);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:n},error:r}=await this.getSession();if(r)return this._returnResult({data:null,error:r});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Qd(n.access_token);let i=null;o.aal&&(i=o.aal);let a=i;(null!==(t=null===(e=n.user.factors)||void 0===e?void 0:e.filter(e=>"verified"===e.status))&&void 0!==t?t:[]).length>0&&(a="aal2");return{data:{currentLevel:i,nextLevel:a,currentAuthenticationMethods:o.amr||[]},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:n},error:r}=t;return r?this._returnResult({data:null,error:r}):n?await dh(this.fetch,"GET","".concat(this.url,"/oauth/authorizations/").concat(e),{headers:this.headers,jwt:n.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new Ed})})}catch(t){if(_d(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:r},error:o}=n;if(o)return this._returnResult({data:null,error:o});if(!r)return this._returnResult({data:null,error:new Ed});const i=await dh(this.fetch,"POST","".concat(this.url,"/oauth/authorizations/").concat(e,"/consent"),{headers:this.headers,jwt:r.access_token,body:{action:"approve"},xform:e=>({data:e,error:null})});return i.data&&i.data.redirect_url&&Wd()&&!(null===t||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(n){if(_d(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:r},error:o}=n;if(o)return this._returnResult({data:null,error:o});if(!r)return this._returnResult({data:null,error:new Ed});const i=await dh(this.fetch,"POST","".concat(this.url,"/oauth/authorizations/").concat(e,"/consent"),{headers:this.headers,jwt:r.access_token,body:{action:"deny"},xform:e=>({data:e,error:null})});return i.data&&i.data.redirect_url&&Wd()&&!(null===t||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(n){if(_d(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;return n?this._returnResult({data:null,error:n}):t?await dh(this.fetch,"GET","".concat(this.url,"/user/oauth/grants"),{headers:this.headers,jwt:t.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new Ed})})}catch(e){if(_d(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:n},error:r}=t;return r?this._returnResult({data:null,error:r}):n?(await dh(this.fetch,"DELETE","".concat(this.url,"/user/oauth/grants"),{headers:this.headers,jwt:n.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Ed})})}catch(t){if(_d(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e){let t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[]}).keys.find(t=>t.kid===e);if(t)return t;const n=Date.now();if(t=this.jwks.keys.find(t=>t.kid===e),t&&this.jwks_cached_at+6e5>n)return t;const{data:r,error:o}=await dh(this.fetch,"GET","".concat(this.url,"/.well-known/jwks.json"),{headers:this.headers});if(o)throw o;return r.keys&&0!==r.keys.length?(this.jwks=r,this.jwks_cached_at=n,t=r.keys.find(t=>t.kid===e),t||null):null}async getClaims(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let n=e;if(!n){const{data:e,error:t}=await this.getSession();if(t||!e.session)return this._returnResult({data:null,error:t});n=e.session.access_token}const{header:r,payload:o,signature:i,raw:{header:a,payload:s}}=Qd(n);(null===t||void 0===t?void 0:t.allowExpired)||function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(o.exp);const l=r.alg&&!r.alg.startsWith("HS")&&r.kid&&"crypto"in globalThis&&"subtle"in globalThis.crypto?await this.fetchJwk(r.kid,(null===t||void 0===t?void 0:t.keys)?{keys:t.keys}:null===t||void 0===t?void 0:t.jwks):null;if(!l){const{error:e}=await this.getUser(n);if(e)throw e;return{data:{claims:o,header:r,signature:i},error:null}}const c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(r.alg),u=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!await crypto.subtle.verify(c,u,i,function(e){const t=[];return Kd(e,e=>t.push(e)),new Uint8Array(t)}("".concat(a,".").concat(s))))throw new Rd("Invalid JWT signature");return{data:{claims:o,header:r,signature:i},error:null}}catch(n){if(_d(n))return this._returnResult({data:null,error:n});throw n}}}Wh.nextInstanceID={};const Hh=Wh;let Yh="";Yh="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const Gh={headers:{"X-Client-Info":"supabase-js-".concat(Yh,"/").concat("2.90.1")}},Xh={schema:"public"},Jh={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},$h={};function Zh(e){return(Zh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qh(e){var t=function(e,t){if("object"!=Zh(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Zh(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Zh(t)?t:t+""}function ef(e,t,n){return(t=Qh(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function nf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tf(Object(n),!0).forEach(function(t){ef(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tf(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const rf=(e,t,n)=>{const r=(e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)})(n),o=Headers;return async(n,i)=>{var a;const s=null!==(a=await t())&&void 0!==a?a:e;let l=new o(null===i||void 0===i?void 0:i.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization","Bearer ".concat(s)),r(n,nf(nf({},i),{},{headers:l}))}};var of=class extends Hh{constructor(e){super(e)}},af=class{constructor(e,t,n){var r,o;this.supabaseUrl=e,this.supabaseKey=t;const i=function(e){const t=null===e||void 0===e?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL((n=t).endsWith("/")?n:n+"/")}catch(r){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}var n}(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const a="sb-".concat(i.hostname.split(".")[0],"-auth-token"),s=function(e,t){var n,r;const{db:o,auth:i,realtime:a,global:s}=e,{db:l,auth:c,realtime:u,global:d}=t,h={db:nf(nf({},l),o),auth:nf(nf({},c),i),realtime:nf(nf({},u),a),storage:{},global:nf(nf(nf({},d),s),{},{headers:nf(nf({},null!==(n=null===d||void 0===d?void 0:d.headers)&&void 0!==n?n:{}),null!==(r=null===s||void 0===s?void 0:s.headers)&&void 0!==r?r:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}(null!==n&&void 0!==n?n:{},{db:Xh,realtime:$h,auth:nf(nf({},Jh),{},{storageKey:a}),global:Gh});var l;(this.storageKey=null!==(r=s.auth.storageKey)&&void 0!==r?r:"",this.headers=null!==(o=s.global.headers)&&void 0!==o?o:{},s.accessToken)?(this.accessToken=s.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error("@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.".concat(String(t)," is not possible"))}})):this.auth=this._initSupabaseAuthClient(null!==(l=s.auth)&&void 0!==l?l:{},this.headers,s.global.fetch);this.fetch=rf(t,this._getAccessToken.bind(this),s.global.fetch),this.realtime=this._initRealtimeClient(nf({headers:this.headers,accessToken:this._getAccessToken.bind(this)},s.realtime)),this.accessToken&&this.accessToken().then(e=>this.realtime.setAuth(e)).catch(e=>console.warn("Failed to set initial Realtime auth token:",e)),this.rest=new Ic(new URL("rest/v1",i).href,{headers:this.headers,schema:s.db.schema,fetch:this.fetch}),this.storage=new hd(this.storageUrl.href,this.headers,this.fetch,null===n||void 0===n?void 0:n.storage),s.accessToken||this._listenForAuthEvents()}get functions(){return new kc(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{head:!1,get:!1,count:void 0};return this.rest.rpc(e,t,n)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t,n=this;if(n.accessToken)return await n.accessToken();const{data:r}=await n.auth.getSession();return null!==(e=null===(t=r.session)||void 0===t?void 0:t.access_token)&&void 0!==e?e:n.supabaseKey}_initSupabaseAuthClient(e,t,n){let{autoRefreshToken:r,persistSession:o,detectSessionInUrl:i,storage:a,userStorage:s,storageKey:l,flowType:c,lock:u,debug:d,throwOnError:h}=e;const f={Authorization:"Bearer ".concat(this.supabaseKey),apikey:"".concat(this.supabaseKey)};return new of({url:this.authUrl.href,headers:nf(nf({},f),t),storageKey:l,autoRefreshToken:r,persistSession:o,detectSessionInUrl:i,storage:a,userStorage:s,flowType:c,lock:u,debug:d,throwOnError:h,fetch:n,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new fu(this.realtimeUrl.href,nf(nf({},e),{},{params:nf(nf({},{apikey:this.supabaseKey}),null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)})}_handleTokenChanged(e,t,n){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===n?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):(this.changedAccessToken=n,this.realtime.setAuth(n))}};function sf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://api.maxbeitler.com",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlhdCI6MTc2Nzk1NjM2OCwiZXhwIjo0OTIzNzE2MzY4LCJpc3MiOiJzdXBhYmFzZSJ9.rKZNRrRnXo4OypIDdonMnWkteCfaFPSz1oTwLNLd5M0"}[e]?{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://api.maxbeitler.com",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlhdCI6MTc2Nzk1NjM2OCwiZXhwIjo0OTIzNzE2MzY4LCJpc3MiOiJzdXBhYmFzZSJ9.rKZNRrRnXo4OypIDdonMnWkteCfaFPSz1oTwLNLd5M0"}[e]:"undefined"!==typeof window&&window.__ENV__&&window.__ENV__[e]?window.__ENV__[e]:"undefined"!==typeof window&&window.env&&window.env[e]?window.env[e]:"undefined"!==typeof window&&window[e]?window[e]:t}(function(){if("undefined"!==typeof window)return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(void 0===t||null===t)return!1;const n=t.match(/^v(\d+)\./);return!!n&&parseInt(n[1],10)<=18})()&&console.warn("\u26a0\ufe0f  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const lf=sf("REACT_APP_SUPABASE_URL"),cf=sf("REACT_APP_SUPABASE_ANON_KEY");if(!lf||!cf){const e="\n\u274c Missing Supabase configuration!\n\nEnvironment variables not found:\n".concat(lf?"":"  - REACT_APP_SUPABASE_URL is missing\n").concat(cf?"":"  - REACT_APP_SUPABASE_ANON_KEY is missing\n","\nFor development:\n  Create client/.env file with:\n    REACT_APP_SUPABASE_URL=your_supabase_url\n    REACT_APP_SUPABASE_ANON_KEY=your_anon_key\n\nFor production build:\n  Option 1: Rebuild with environment variables set\n  Option 2: Inject config via window.__ENV__ before app loads:\n    <script>\n      window.__ENV__ = {\n        REACT_APP_SUPABASE_URL: 'your_supabase_url',\n        REACT_APP_SUPABASE_ANON_KEY: 'your_anon_key'\n      };\n    <\/script>\n");throw console.error(e),new Error("Missing Supabase environment variables. Check console for details.")}console.log("\u2705 Supabase URL configured:",lf),lf.includes("http://")&&!lf.includes("localhost")&&console.warn("\u26a0\ufe0f Supabase URL is using HTTP instead of HTTPS:",lf),/\d+\.\d+\.\d+\.\d+/.test(lf)&&console.error("\u274c Supabase URL contains an IP address! It should use a domain name:",lf);const uf="undefined"!==typeof window?function(){const e="undefined"!==typeof window&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent);let t=null,n=!1;try{if("undefined"!==typeof window&&window.localStorage){const e="__safari_test__";window.localStorage.setItem(e,"test");const r=window.localStorage.getItem(e);window.localStorage.removeItem(e),"test"===r&&(t=window.localStorage,n=!0)}}catch(a){console.warn("\u26a0\ufe0f localStorage test failed, will use fallback:",a.message)}const r={};let o=!1,i=null;if(!n&&"undefined"!==typeof window&&window.sessionStorage)try{const e="__session_test__";window.sessionStorage.setItem(e,"test");const t=window.sessionStorage.getItem(e);window.sessionStorage.removeItem(e),"test"===t&&(i=window.sessionStorage,o=!0,console.log("\u2705 Using sessionStorage as fallback for Safari"))}catch(a){console.warn("\u26a0\ufe0f sessionStorage also not available")}return{getItem:e=>{try{return n&&t?t.getItem(e):o&&sessionStorage?sessionStorage.getItem(e):r[e]||null}catch(a){if(console.warn("Storage getItem error:",a),o&&i)try{return i.getItem(e)}catch(s){}return r[e]||null}},setItem:(s,l)=>{try{if(n&&t)return void t.setItem(s,l);if(o&&i)return i.setItem(s,l),void(e&&console.log("\ud83c\udf10 Safari: Using sessionStorage for auth token (session-only)"));r[s]=l,e&&console.warn("\u26a0\ufe0f Safari: Using in-memory storage (will be lost on page reload)")}catch(a){if(console.warn("Storage setItem error:",a),o&&i)try{return void i.setItem(s,l)}catch(c){}r[s]=l}},removeItem:e=>{try{if(n&&t)return void t.removeItem(e);if(o&&i)return void i.removeItem(e);delete r[e]}catch(a){if(console.warn("Storage removeItem error:",a),o&&i)try{return void i.removeItem(e)}catch(s){}delete r[e]}}}}():null,df="undefined"!==typeof window&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent);df&&console.log("\ud83c\udf10 Safari detected - using compatible storage adapter");const hf=12e4,ff=((e,t,n)=>new af(e,t,n))(lf,cf,{auth:s({persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!1,storage:uf||("undefined"!==typeof window?window.localStorage:null),flowType:"password",storageKey:"supabase.auth.token",debug:df},df&&{persistSession:!0}),db:{schema:"public"},global:{headers:{"x-client-info":"treeflow@1.0.0",Connection:"keep-alive"},fetch:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new AbortController,r=Date.now(),o=setTimeout(()=>{console.warn("Request timeout after ".concat(120,"s: ").concat(e)),n.abort()},hf);return fetch(e,s(s({},t),{},{signal:n.signal,keepalive:!1,cache:"no-store"})).catch(t=>{if("AbortError"===t.name)throw new Error("Request to ".concat(e," timed out after ").concat(120," seconds. Please check your connection."));throw t}).finally(()=>{const t=Date.now()-r;t>5e3&&console.warn("Slow request (".concat(t,"ms): ").concat(e)),clearTimeout(o)})}},realtime:{params:{eventsPerSecond:10}}});async function pf(e){const{data:t,error:n}=await ff.from("profiles").select("role").eq("id",e).single();return!(n||!t)&&"admin"===t.role}function vf(e){if(!e||0===e.length)return[];const t=new Map;e.forEach(e=>{t.set(e.id,s(s({},e),{},{subSolutions:[]}))});const n=[];e.forEach(e=>{var r;const o=t.get(e.id),i=null!==(r=e.parent_solution_id)&&void 0!==r?r:e.parentSolutionId;if(i){const e=t.get(i);e?e.subSolutions.push(o):n.push(o)}else n.push(o)});const r=(e,t)=>{var n,r,o,i;return(null!==(n=null!==(r=e.sort_index)&&void 0!==r?r:e.sortIndex)&&void 0!==n?n:0)-(null!==(o=null!==(i=t.sort_index)&&void 0!==i?i:t.sortIndex)&&void 0!==o?o:0)};return n.sort(r),n.forEach(e=>e.subSolutions.sort(r)),n}const mf=!1;let gf=null;function yf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"An error occurred";throw console.error("Supabase error:",e),new Error(e.message||t)}async function wf(){const{data:{user:e}}=await ff.auth.getUser();if(!e)throw new Error("Not authenticated");return e.id}const bf={nestSolutions:vf,listExperimentTodos:async e=>{const{data:t,error:n}=await ff.from("experiment_todos").select("*").eq("experiment_id",e).order("sort_order",{ascending:!0}).order("created_at",{ascending:!0});return n&&yf(n,"Failed to fetch todos"),t||[]},createExperimentTodo:async function(e,t){var n,r;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i={experiment_id:e,title:t,sort_order:null!==(n=o.sortOrder)&&void 0!==n?n:0,due_date:null!==(r=o.dueDate)&&void 0!==r?r:null},{data:a,error:s}=await ff.from("experiment_todos").insert(i).select().single();return s&&yf(s,"Failed to create todo"),a},toggleExperimentTodo:async(e,t)=>{const{data:n,error:r}=await ff.from("experiment_todos").update({is_done:t}).eq("id",e).select().single();return r&&yf(r,"Failed to update todo"),n},updateExperimentTodo:async(e,t)=>{const n={title:t.title,due_date:t.dueDate,sort_order:t.sortOrder,assignee_id:t.assigneeId};Object.keys(n).forEach(e=>void 0===n[e]&&delete n[e]);const{data:r,error:o}=await ff.from("experiment_todos").update(n).eq("id",e).select().single();return o&&yf(o,"Failed to update todo"),r},deleteExperimentTodo:async e=>{const{error:t}=await ff.from("experiment_todos").delete().eq("id",e);t&&yf(t,"Failed to delete todo")},listWorkspaceTodos:async e=>{const{data:t,error:n}=await ff.from("experiment_todos_with_context").select("*").eq("workspace_id",e).order("sort_order",{ascending:!0}).order("created_at",{ascending:!0});return n&&yf(n,"Failed to fetch workspace todos"),t||[]},getDecisionHealthMetrics:async e=>{const{data:t,error:n}=await ff.rpc("get_decision_health_metrics",{target_workspace_id:e});return n&&yf(n,"Failed to fetch decision health metrics"),(null===t||void 0===t?void 0:t[0])||null},getAtRiskOpportunities:async e=>{const{data:t,error:n}=await ff.rpc("get_at_risk_opportunities",{target_workspace_id:e});return n&&yf(n,"Failed to fetch at-risk opportunities"),t||[]},listDecisionSpaces:async e=>{const{data:t,error:n}=await ff.from("decision_spaces").select("*").eq("workspace_id",e).order("created_at",{ascending:!0});if(n){const e=n.message||"";if("42P01"===n.code||e.includes("does not exist")||e.includes("schema cache")||e.includes("Could not find the table"))return console.warn("Decision spaces table missing; returning empty list."),[];yf(n,"Failed to fetch decision spaces")}return t||[]},createDecisionSpace:async(e,t)=>{var n,r;const{data:o,error:i}=await ff.rpc("create_decision_space",{p_workspace_id:e,p_name:null!==(n=t.name)&&void 0!==n?n:"Default",p_description:null!==(r=t.description)&&void 0!==r?r:null});return i&&yf(i,"Failed to create decision space"),o},listWorkspaces:async()=>{const{data:e,error:t}=await ff.from("workspaces").select("*").order("created_at",{ascending:!0});return t&&yf(t,"Failed to fetch workspaces"),e||[]},createMyDefaultWorkspace:async()=>{const{data:e,error:t}=await ff.rpc("create_my_default_workspace");if(t)throw console.warn("create_my_default_workspace failed:",t),t;return e},createWorkspace:async e=>{const t=await wf(),{data:n,error:r}=await ff.from("workspaces").insert({name:e.name,type:e.type,owner_id:t}).select().single();return r&&yf(r,"Failed to create workspace"),await ff.from("workspace_members").insert({workspace_id:n.id,user_id:t,email:e.ownerEmail||null,role:"owner",status:"active"}),n},listWorkspaceMembers:async e=>{const{data:t,error:n}=await ff.from("workspace_members").select("*").eq("workspace_id",e).order("created_at",{ascending:!0});if(n&&yf(n,"Failed to fetch workspace members"),null===t||void 0===t||!t.length)return[];const r=[...new Set(t.map(e=>e.user_id).filter(Boolean))];let o={};if(r.length>0){const{data:e}=await ff.from("profiles").select("id, name, email").in("id",r);e&&e.forEach(e=>{o[e.id]=e})}return t.map(e=>s(s({},e),{},{profile:o[e.user_id]||{id:e.user_id,name:null,email:e.email}}))},listWorkspaceInvites:async e=>{const{data:t,error:n}=await ff.from("workspace_invites").select("*").eq("workspace_id",e).order("created_at",{ascending:!1});return n&&yf(n,"Failed to fetch invites"),t||[]},addMemberByEmail:async(e,t)=>{var n;const r=t.trim().toLowerCase();if(!r)throw new Error("Email required");const{data:o,error:i}=await ff.from("profiles").select("id, email").eq("email",r).limit(1);i&&yf(i,"Failed to lookup user");const a=(null===o||void 0===o||null===(n=o[0])||void 0===n?void 0:n.id)||null,s=a?"active":"pending",{data:l,error:c}=await ff.from("workspace_members").upsert({workspace_id:e,user_id:a,email:r,role:"member",status:s},{onConflict:"workspace_id,email"}).select().single();return c&&yf(c,"Failed to add member"),{member:l,status:s}},removeWorkspaceMember:async e=>{const{error:t}=await ff.from("workspace_members").delete().eq("id",e);t&&yf(t,"Failed to remove member")},claimPendingMemberships:async()=>{const{data:{user:e}}=await ff.auth.getUser();if(null===e||void 0===e||!e.email)return[];const t=e.email.toLowerCase(),{data:n,error:r}=await ff.from("workspace_members").update({user_id:e.id,status:"active"}).eq("email",t).eq("status","pending").is("user_id",null).select();return r&&yf(r,"Failed to claim memberships"),n||[]},acceptWorkspaceInvite:async e=>{var t,n;const{data:{user:r}}=await ff.auth.getUser();if(!r)throw new Error("Not authenticated");const{data:o,error:i}=await ff.from("workspace_invites").select("*").eq("token",e).single();if(!i&&o||yf(i,"Invalid invite"),o.accepted_at)throw new Error("Invite already accepted");if(new Date(o.expires_at).getTime()<Date.now())throw new Error("Invite expired");if((null===(t=r.email)||void 0===t?void 0:t.toLowerCase())!==(null===(n=o.invited_email)||void 0===n?void 0:n.toLowerCase()))throw new Error("Invite email mismatch");return await ff.from("workspace_invites").update({accepted_at:(new Date).toISOString()}).eq("id",o.id),await ff.from("workspace_members").update({user_id:r.id,status:"active"}).eq("workspace_id",o.workspace_id).eq("invited_email",o.invited_email),o.workspace_id},getOutcomes:async()=>{try{const e=[{name:"experiments+sprints",select:"\n        *,\n        opportunities (\n          *,\n          solutions (\n            *,\n            experiments (\n              *,\n              kpis (*)\n            ),\n            sprints (\n              id,\n              title,\n              status,\n              start_date,\n              end_date,\n              tasks (\n                id,\n                status\n              )\n            )\n          )\n        )\n      "},{name:"experiments",select:"\n        *,\n        opportunities (\n          *,\n          solutions (\n            *,\n            experiments (\n              *,\n              kpis (*)\n            )\n          )\n        )\n      "},{name:"tests+sprints",select:"\n        *,\n        opportunities (\n          *,\n          solutions (\n            *,\n            tests (\n              *,\n              kpis (*)\n            ),\n            sprints (\n              id,\n              title,\n              status,\n              start_date,\n              end_date,\n              tasks (\n                id,\n                status\n              )\n            )\n          )\n        )\n      "},{name:"tests",select:"\n        *,\n        opportunities (\n          *,\n          solutions (\n            *,\n            tests (\n              *,\n              kpis (*)\n            )\n          )\n        )\n      "},{name:"minimal",select:"\n        *,\n        opportunities (\n          *,\n          solutions (*)\n        )\n      "}];let t=null,n=null;for(const r of e){const e=await ff.from("outcomes").select(r.select).order("created_at",{ascending:!1});if(!e.error){t=e.data,n=null;break}n=e.error;const o=e.error.message||"";if(!o.includes("Could not find a relationship")&&!o.includes("does not exist")&&"42P01"!==e.error.code){if("PGRST301"===e.error.code||o.includes("permission")||o.includes("policy"))return console.warn("RLS policy error - returning empty array"),[];break}console.warn("getOutcomes fallback (".concat(r.name,"):"),o)}return n&&(console.error("Error fetching outcomes:",n),yf(n,"Failed to fetch outcomes")),(t||[]).map(e=>{const t=function(e){if(!e||0===e.length)return[];const t=new Map;e.forEach(e=>{t.set(e.id,s(s({},e),{},{subOpportunities:[]}))});const n=[];e.forEach(e=>{var r;const o=t.get(e.id),i=null!==(r=e.parent_opportunity_id)&&void 0!==r?r:e.parentOpportunityId;if(i){const e=t.get(i);e?e.subOpportunities.push(o):n.push(o)}else n.push(o)});const r=(e,t)=>{var n,r,o,i;return(null!==(n=null!==(r=e.sort_index)&&void 0!==r?r:e.sortIndex)&&void 0!==n?n:0)-(null!==(o=null!==(i=t.sort_index)&&void 0!==i?i:t.sortIndex)&&void 0!==o?o:0)};return n.sort(r),n.forEach(e=>e.subOpportunities.sort(r)),n}((e.opportunities||[]).map(e=>{var t,n,r,o;const i=(e.solutions||[]).map(e=>{var t,n,r;return s(s({},e),{},{parentSolutionId:null!==(t=e.parent_solution_id)&&void 0!==t?t:null,confidenceScore:null!==(n=e.confidence_score)&&void 0!==n?n:null,sortIndex:null!==(r=e.sort_index)&&void 0!==r?r:0,startDate:e.start_date,endDate:e.end_date,workspaceId:e.workspace_id,tests:(e.experiments||e.tests||[]).map(e=>s(s({},e),{},{startDate:e.start_date,endDate:e.end_date,testTemplate:e.test_template,testType:e.type,testStatus:e.test_status,successCriteria:e.success_criteria,resultDecision:e.result_decision,resultSummary:e.result_summary,timebox:{start:e.timebox_start,end:e.timebox_end},hypothesisId:e.hypothesis_id,opportunityId:e.opportunity_id,workspaceId:e.workspace_id,kpis:e.kpis||[]})),campaigns:(e.sprints||e.campaigns||[]).map(e=>s(s({},e),{},{startDate:e.start_date,endDate:e.end_date,tasks:(e.tasks||[]).map(e=>s(s({},e),{},{dueDate:e.due_date}))}))||[]})});return s(s({},e),{},{parentOpportunityId:null!==(t=e.parent_opportunity_id)&&void 0!==t?t:null,journeyStage:null!==(n=e.journey_stage)&&void 0!==n?n:null,sortIndex:null!==(r=e.sort_index)&&void 0!==r?r:0,confidenceScore:null!==(o=e.confidence_score)&&void 0!==o?o:null,startDate:e.start_date,endDate:e.end_date,workspaceId:e.workspace_id,solutions:vf(i)})}));return s(s({},e),{},{startDate:e.start_date,endDate:e.end_date,teamId:e.team_id,workspaceId:e.workspace_id,decisionSpaceId:e.decision_space_id,opportunities:t})})}catch(e){return console.error("Exception in getOutcomes:",e),[]}},createOutcome:async e=>{try{const t=await wf();console.log("Creating outcome with data:",s(s({},e),{},{owner:e.owner||t}));const{data:n,error:r}=await ff.from("outcomes").insert({title:e.title,description:e.description,owner:e.owner||t,team_id:e.teamId||null,workspace_id:e.workspaceId||null,decision_space_id:e.decisionSpaceId||null,visibility:e.visibility||"team",start_date:e.startDate||null,end_date:e.endDate||null}).select().single();return r&&(console.error("Error creating outcome:",r),console.error("Error details:",{code:r.code,message:r.message,details:r.details,hint:r.hint}),yf(r,"Failed to create outcome")),s(s({},n),{},{opportunities:[],startDate:n.start_date,endDate:n.end_date,teamId:n.team_id,workspaceId:n.workspace_id,decisionSpaceId:n.decision_space_id})}catch(t){throw console.error("Exception in createOutcome:",t),t}},updateOutcome:async(e,t)=>{var n,r,o;const i={title:t.title,description:null!==(n=t.description)&&void 0!==n?n:null,status:t.status,owner:t.owner,visibility:t.visibility,start_date:null!==(r=t.startDate)&&void 0!==r?r:null,end_date:null!==(o=t.endDate)&&void 0!==o?o:null};var a,l,c;Object.prototype.hasOwnProperty.call(t,"teamId")&&(i.team_id=null!==(a=t.teamId)&&void 0!==a?a:null);Object.prototype.hasOwnProperty.call(t,"workspaceId")&&(i.workspace_id=null!==(l=t.workspaceId)&&void 0!==l?l:null);Object.prototype.hasOwnProperty.call(t,"decisionSpaceId")&&(i.decision_space_id=null!==(c=t.decisionSpaceId)&&void 0!==c?c:null);Object.keys(i).forEach(e=>void 0===i[e]&&delete i[e]);let u=await ff.from("outcomes").update(i).eq("id",e).select().single();if(u.error){const t=u.error.message||"";if("PGRST204"===u.error.code&&t.includes("Could not find the 'status' column")&&Object.prototype.hasOwnProperty.call(i,"status")){const t=s({},i);delete t.status,u=await ff.from("outcomes").update(t).eq("id",e).select().single()}}u.error&&(console.error("Error updating outcome:",u.error),console.error("Update data:",i),yf(u.error,"Failed to update outcome"));const d=u.data;return s(s({},d),{},{startDate:d.start_date,endDate:d.end_date,teamId:d.team_id,workspaceId:d.workspace_id,decisionSpaceId:d.decision_space_id})},deleteOutcome:async e=>{const{error:t}=await ff.from("outcomes").delete().eq("id",e);t&&yf(t,"Failed to delete outcome")},createOpportunity:async(e,t)=>{try{var n,r,o,i,a,l,c;const p=await wf();console.log("Creating opportunity:",{outcomeId:e,data:t,userId:p});const{data:v,error:m}=await ff.from("outcomes").select("id").eq("id",e).single();if(m||!v)throw console.error("Outcome not found or not accessible:",m),new Error("Outcome not found or you don't have access to it. Error: ".concat((null===m||void 0===m?void 0:m.message)||"Unknown error"));const{data:g,error:y}=await ff.from("opportunities").insert({title:t.title,description:t.description,outcome_id:e,owner:t.owner||p,workspace_id:t.workspaceId||null,start_date:t.startDate||null,end_date:t.endDate||null,parent_opportunity_id:null!==(n=t.parentOpportunityId)&&void 0!==n?n:null,journey_stage:null!==(r=t.journeyStage)&&void 0!==r?r:null,sort_index:null!==(o=t.sortIndex)&&void 0!==o?o:0}).select().single();if(y){var u,d,h,f;if(console.error("Error creating opportunity:",y),console.error("Error details:",{code:y.code,message:y.message,details:y.details,hint:y.hint,userId:p,outcomeId:e}),"42501"===y.code||null!==(u=y.message)&&void 0!==u&&u.includes("permission")||null!==(d=y.message)&&void 0!==d&&d.includes("policy"))throw new Error("Permission denied: You may not have permission to create opportunities. Please check your RLS policies.");if("23503"===y.code||null!==(h=y.message)&&void 0!==h&&h.includes("foreign key"))throw new Error("Invalid outcome: The outcome you are trying to add an opportunity to does not exist or is not accessible.");if("23505"===y.code||null!==(f=y.message)&&void 0!==f&&f.includes("unique"))throw new Error("Duplicate entry: An opportunity with this name already exists.");yf(y,"Failed to create opportunity")}if(!g)throw new Error("Opportunity was not created, but no error was returned.");return s(s({},g),{},{solutions:[],subOpportunities:[],startDate:g.start_date,endDate:g.end_date,workspaceId:g.workspace_id,parentOpportunityId:null!==(i=g.parent_opportunity_id)&&void 0!==i?i:null,journeyStage:null!==(a=g.journey_stage)&&void 0!==a?a:null,sortIndex:null!==(l=g.sort_index)&&void 0!==l?l:0,confidenceScore:null!==(c=g.confidence_score)&&void 0!==c?c:null})}catch(p){if(console.error("Exception in createOpportunity:",p),p.message&&(p.message.includes("Permission denied")||p.message.includes("Invalid outcome")||p.message.includes("Duplicate entry")))throw p;throw p}},updateOpportunity:async(e,t)=>{var n,r,o,i,a,l;const c={title:t.title,description:t.description,status:t.status,owner:t.owner,start_date:null!==(n=t.startDate)&&void 0!==n?n:null,end_date:null!==(r=t.endDate)&&void 0!==r?r:null};var u,d,h,f,p;Object.prototype.hasOwnProperty.call(t,"workspaceId")&&(c.workspace_id=null!==(u=t.workspaceId)&&void 0!==u?u:null);Object.prototype.hasOwnProperty.call(t,"parentOpportunityId")&&(c.parent_opportunity_id=null!==(d=t.parentOpportunityId)&&void 0!==d?d:null);Object.prototype.hasOwnProperty.call(t,"journeyStage")&&(c.journey_stage=null!==(h=t.journeyStage)&&void 0!==h?h:null);Object.prototype.hasOwnProperty.call(t,"sortIndex")&&(c.sort_index=null!==(f=t.sortIndex)&&void 0!==f?f:0);Object.prototype.hasOwnProperty.call(t,"confidenceScore")&&(c.confidence_score=null!==(p=t.confidenceScore)&&void 0!==p?p:null);Object.keys(c).forEach(e=>void 0===c[e]&&delete c[e]);const{data:v,error:m}=await ff.from("opportunities").update(c).eq("id",e).select().single();return m&&yf(m,"Failed to update opportunity"),s(s({},v),{},{startDate:v.start_date,endDate:v.end_date,workspaceId:v.workspace_id,parentOpportunityId:null!==(o=v.parent_opportunity_id)&&void 0!==o?o:null,journeyStage:null!==(i=v.journey_stage)&&void 0!==i?i:null,sortIndex:null!==(a=v.sort_index)&&void 0!==a?a:0,confidenceScore:null!==(l=v.confidence_score)&&void 0!==l?l:null})},deleteOpportunity:async e=>{const{error:t}=await ff.from("opportunities").delete().eq("id",e);t&&yf(t,"Failed to delete opportunity")},createSolution:async(e,t)=>{var n,r,o;const i=await wf(),a={title:t.title,description:t.description,opportunity_id:e,owner:t.owner||i,workspace_id:t.workspaceId||null,start_date:t.startDate||null,end_date:t.endDate||null};null!=t.parentSolutionId&&(a.parent_solution_id=t.parentSolutionId),void 0!==t.sortIndex&&(a.sort_index=t.sortIndex);const{data:l,error:c}=await ff.from("solutions").insert(a).select().single();return c&&yf(c,"Failed to create solution"),s(s({},l),{},{tests:[],subSolutions:[],startDate:l.start_date,endDate:l.end_date,workspaceId:l.workspace_id,parentSolutionId:null!==(n=l.parent_solution_id)&&void 0!==n?n:null,confidenceScore:null!==(r=l.confidence_score)&&void 0!==r?r:null,sortIndex:null!==(o=l.sort_index)&&void 0!==o?o:0})},updateSolution:async(e,t)=>{var n,r,o,i,a;const l={title:t.title,description:t.description,status:t.status,owner:t.owner,start_date:null!==(n=t.startDate)&&void 0!==n?n:null,end_date:null!==(r=t.endDate)&&void 0!==r?r:null};var c,u,d,h;Object.prototype.hasOwnProperty.call(t,"workspaceId")&&(l.workspace_id=null!==(c=t.workspaceId)&&void 0!==c?c:null);Object.prototype.hasOwnProperty.call(t,"parentSolutionId")&&(l.parent_solution_id=null!==(u=t.parentSolutionId)&&void 0!==u?u:null);Object.prototype.hasOwnProperty.call(t,"confidenceScore")&&(l.confidence_score=null!==(d=t.confidenceScore)&&void 0!==d?d:null);Object.prototype.hasOwnProperty.call(t,"sortIndex")&&(l.sort_index=null!==(h=t.sortIndex)&&void 0!==h?h:0);Object.keys(l).forEach(e=>void 0===l[e]&&delete l[e]);const{data:f,error:p}=await ff.from("solutions").update(l).eq("id",e).select().single();return p&&yf(p,"Failed to update solution"),s(s({},f),{},{startDate:f.start_date,endDate:f.end_date,workspaceId:f.workspace_id,parentSolutionId:null!==(o=f.parent_solution_id)&&void 0!==o?o:null,confidenceScore:null!==(i=f.confidence_score)&&void 0!==i?i:null,sortIndex:null!==(a=f.sort_index)&&void 0!==a?a:0})},deleteSolution:async e=>{const{error:t}=await ff.from("solutions").delete().eq("id",e);t&&yf(t,"Failed to delete solution")},createTest:async(e,t)=>{var n,r;const o=await wf(),i={title:t.title,description:t.description,solution_id:e,owner:t.owner||o,status:t.status||"draft",test_template:t.testTemplate||null,type:t.testType||"custom",hypothesis_id:t.hypothesisId||null,test_status:t.testStatus||"draft",success_criteria:t.successCriteria||null,result_decision:t.resultDecision||null,result_summary:t.resultSummary||null,timebox_start:(null===(n=t.timebox)||void 0===n?void 0:n.start)||null,timebox_end:(null===(r=t.timebox)||void 0===r?void 0:r.end)||null,workspace_id:t.workspaceId||null,start_date:t.startDate||null,end_date:t.endDate||null},{data:a,error:l}=await ff.from("tests").insert(i).select().single();if(!l)return s(s({},a),{},{kpis:[],startDate:a.start_date,endDate:a.end_date,testType:a.type,hypothesisId:a.hypothesis_id,workspaceId:a.workspace_id});const c=l.message||"";"42P01"===l.code||c.includes("does not exist")||c.includes("relation")||c.includes("schema cache")||c.includes("Could not find the table")||yf(l,"Failed to create test");const{data:u,error:d}=await ff.from("experiments").insert({solution_id:e,type:t.testType||"custom",title:t.title,hypothesis:t.description||null,hypothesis_id:t.hypothesisId||null,status:t.status||"planned",target_n:50,created_by:o,owner:t.owner||o}).select().single();return d&&yf(d,"Failed to create test"),s(s({},u),{},{kpis:[],startDate:u.start_date,endDate:u.end_date,testType:u.type,hypothesisId:u.hypothesis_id,workspaceId:u.workspace_id})},updateTest:async(e,t)=>{var n,r,o,i,a,l,c,u,d,h,f,p,v;const m=t.testStatus||t.status;let g=null;g=t.resultDecision&&["pass","iterate","kill"].includes(String(t.resultDecision).toLowerCase())?"evaluated":"designed"===m||"running"===m?"running":"idea"===m||"draft"===m||"planned"===m||"blocked"===m?"planned":"done"===m||"completed"===m||"evaluated"===m||"archived"===m?"archived"===m?"archived":"evaluated":"planned";const y={title:null!==(n=t.title)&&void 0!==n?n:null,hypothesis:null!==(r=t.description)&&void 0!==r?r:null,status:g,owner:null!==(o=t.owner)&&void 0!==o?o:null,type:null!==(i=t.testType)&&void 0!==i?i:"custom",hypothesis_id:null!==(a=t.hypothesisId)&&void 0!==a?a:null,test_template:null!==(l=t.testTemplate)&&void 0!==l?l:null,test_status:null!==(c=t.testStatus)&&void 0!==c?c:null,success_criteria:null!==(u=t.successCriteria)&&void 0!==u?u:null,result_decision:null!==(d=t.resultDecision)&&void 0!==d?d:null,result_summary:null!==(h=t.resultSummary)&&void 0!==h?h:null};var w,b,_,x;Object.prototype.hasOwnProperty.call(t,"timebox")&&(y.timebox_start=null!==(w=null===(b=t.timebox)||void 0===b?void 0:b.start)&&void 0!==w?w:null,y.timebox_end=null!==(_=null===(x=t.timebox)||void 0===x?void 0:x.end)&&void 0!==_?_:null);let S=await ff.from("experiments").update(y).eq("id",e).select().single();if(S.error){var k,E;const n=S.error.message||"";"42P01"===S.error.code||n.includes("does not exist")||n.includes("relation")||n.includes("schema cache")||n.includes("Could not find the table")||yf(S.error,"Failed to update test");const r={title:t.title,description:t.description,owner:t.owner,status:t.status,evidence:t.evidence,result:t.result,type:t.testType,hypothesis_id:t.hypothesisId,test_template:t.testTemplate,test_status:t.testStatus,success_criteria:t.successCriteria,result_decision:t.resultDecision,result_summary:t.resultSummary,start_date:null!==(k=t.startDate)&&void 0!==k?k:null,end_date:null!==(E=t.endDate)&&void 0!==E?E:null};var C,N,j,T,O;if(Object.prototype.hasOwnProperty.call(t,"timebox"))r.timebox_start=null!==(C=null===(N=t.timebox)||void 0===N?void 0:N.start)&&void 0!==C?C:null,r.timebox_end=null!==(j=null===(T=t.timebox)||void 0===T?void 0:T.end)&&void 0!==j?j:null;if(Object.prototype.hasOwnProperty.call(t,"workspaceId"))r.workspace_id=null!==(O=t.workspaceId)&&void 0!==O?O:null;Object.keys(r).forEach(e=>void 0===r[e]&&delete r[e]),S=await ff.from("tests").update(r).eq("id",e).select().single(),S.error&&yf(S.error,"Failed to update test")}const I=S.data;return s(s({},I),{},{testStatus:null!==(f=I.test_status)&&void 0!==f?f:I.testStatus,resultDecision:null!==(p=null!==(v=I.result_decision)&&void 0!==v?v:I.resultDecision)&&void 0!==p?p:null,startDate:I.start_date,endDate:I.end_date,workspaceId:I.workspace_id})},listEvidence:async e=>{var t;const{data:n,error:r}=await ff.from("evidence_items").select("*").eq("node_id",e).order("created_at",{ascending:!1});if(r){if("42P01"===r.code||r.message&&(r.message.includes("does not exist")||r.message.includes("relation")))return console.warn("Evidence table may not exist; run migration 032_create_evidence_items.sql"),[];console.error("[Evidence] listEvidence failed:",e,r.code,r.message),yf(r,"Failed to fetch evidence")}const o=n||[];return"undefined"!==typeof process&&"development"===(null===(t={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://api.maxbeitler.com",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlhdCI6MTc2Nzk1NjM2OCwiZXhwIjo0OTIzNzE2MzY4LCJpc3MiOiJzdXBhYmFzZSJ9.rKZNRrRnXo4OypIDdonMnWkteCfaFPSz1oTwLNLd5M0"})||void 0===t?void 0:t.NODE_ENV)&&o.length>0&&console.log("[Evidence] listEvidence",e,"\u2192",o.length,"items"),o},createEvidence:async(e,t)=>{var n,r;const o=await wf();let i=null!==(n=t.workspaceId)&&void 0!==n?n:null;if(!i){let t=null;const{data:n}=await ff.from("experiments").select("solution_id").eq("id",e).single();if(null!==n&&void 0!==n&&n.solution_id&&(t=n.solution_id),!t){const{data:n}=await ff.from("tests").select("solution_id").eq("id",e).single();null!==n&&void 0!==n&&n.solution_id&&(t=n.solution_id)}if(t){const{data:e}=await ff.from("solutions").select("workspace_id, opportunity_id").eq("id",t).single();if(null!==e&&void 0!==e&&e.workspace_id)i=e.workspace_id;else if(null!==e&&void 0!==e&&e.opportunity_id){const{data:t}=await ff.from("opportunities").select("outcome_id").eq("id",e.opportunity_id).single();if(null!==t&&void 0!==t&&t.outcome_id){const{data:e}=await ff.from("outcomes").select("workspace_id").eq("id",t.outcome_id).single();null!==e&&void 0!==e&&e.workspace_id&&(i=e.workspace_id)}}}}const a={node_id:e,board_id:t.boardId||null,workspace_id:i,type:t.type,content:t.content||"",quality:t.quality||"medium",source:t.source||"customer",created_by:o},{data:s,error:l}=await ff.from("evidence_items").insert(a).select().single();if(l){if(console.error("[Evidence] createEvidence failed:",e,l.code,l.message,a),"42P01"===l.code||l.message&&l.message.includes("does not exist"))throw new Error("Evidence storage is not set up. Please run database migrations (see docs or migration 032_create_evidence_items.sql).");if("42501"===l.code||l.message&&l.message.toLowerCase().includes("policy"))throw new Error("Evidence could not be saved (permission or workspace). Ensure you are in a workspace and run migration 033 to backfill evidence workspace_id.");yf(l,"Failed to create evidence")}return s&&"undefined"!==typeof process&&"development"===(null===(r={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://api.maxbeitler.com",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlhdCI6MTc2Nzk1NjM2OCwiZXhwIjo0OTIzNzE2MzY4LCJpc3MiOiJzdXBhYmFzZSJ9.rKZNRrRnXo4OypIDdonMnWkteCfaFPSz1oTwLNLd5M0"})||void 0===r?void 0:r.NODE_ENV)&&console.log("[Evidence] createEvidence ok:",e,"\u2192 id",null===s||void 0===s?void 0:s.id),s},updateEvidence:async(e,t)=>{const{data:n,error:r}=await ff.from("evidence_items").update({type:t.type,content:t.content,quality:t.quality,source:t.source}).eq("id",e).select().single();return r&&yf(r,"Failed to update evidence"),n},deleteEvidence:async e=>{const{error:t}=await ff.from("evidence_items").delete().eq("id",e);t&&yf(t,"Failed to delete evidence")},deleteTest:async e=>{const{error:t}=await ff.from("tests").delete().eq("id",e);t&&yf(t,"Failed to delete test")},createKPI:async(e,t)=>{const{data:n,error:r}=await ff.from("kpis").insert(s(s({},t),{},{experiment_id:e})).select().single();return r&&yf(r,"Failed to create KPI"),n},updateKPI:async(e,t)=>{const{data:n,error:r}=await ff.from("kpis").update(t).eq("id",e).select().single();return r&&yf(r,"Failed to update KPI"),n},deleteKPI:async e=>{const{error:t}=await ff.from("kpis").delete().eq("id",e);t&&yf(t,"Failed to delete KPI")},getCampaigns:async e=>{const{data:t,error:n}=await ff.from("sprints").select("\n        *,\n        tasks (*)\n      ").eq("solution_id",e).order("created_at",{ascending:!1});return n&&yf(n,"Failed to fetch sprints"),(t||[]).map(e=>s(s({},e),{},{startDate:e.start_date,endDate:e.end_date,tasks:(e.tasks||[]).map(e=>s(s({},e),{},{dueDate:e.due_date}))}))},createCampaign:async(e,t)=>{const{data:n,error:r}=await ff.from("sprints").insert({solution_id:e,title:t.title,description:t.description||null,start_date:t.startDate||null,end_date:t.endDate||null,status:t.status||"planned"}).select().single();if(r){var o;if(console.error("Error creating sprint:",r),console.error("Error details:",{code:r.code,message:r.message,details:r.details,hint:r.hint}),"42P01"===r.code||null!==(o=r.message)&&void 0!==o&&o.includes("does not exist"))throw new Error("Sprints table does not exist. Please run the database migration (020_rename_campaigns_to_sprints.sql) in Supabase Studio.");yf(r,"Failed to create sprint")}return s(s({},n),{},{startDate:n.start_date,endDate:n.end_date,tasks:[]})},updateCampaign:async(e,t)=>{const n={title:t.title,description:t.description,start_date:t.startDate||null,end_date:t.endDate||null,status:t.status};Object.keys(n).forEach(e=>void 0===n[e]&&delete n[e]);const{data:r,error:o}=await ff.from("sprints").update(n).eq("id",e).select().single();return o&&yf(o,"Failed to update sprint"),s(s({},r),{},{startDate:r.start_date,endDate:r.end_date})},deleteCampaign:async e=>{const{error:t}=await ff.from("sprints").delete().eq("id",e);t&&yf(t,"Failed to delete sprint")},createTask:async(e,t)=>{const n=await wf(),{data:r,error:o}=await ff.from("tasks").insert({sprint_id:e,title:t.title,notes:t.notes||null,status:t.status||"todo",priority:t.priority||null,due_date:t.dueDate||null,assignee_id:t.assigneeId||n}).select().single();return o&&yf(o,"Failed to create task"),s(s({},r),{},{dueDate:r.due_date})},updateTask:async(e,t)=>{const n={title:t.title,notes:t.notes,status:t.status,priority:t.priority,due_date:t.dueDate||null,assignee_id:t.assigneeId};Object.keys(n).forEach(e=>void 0===n[e]&&delete n[e]);const{data:r,error:o}=await ff.from("tasks").update(n).eq("id",e).select().single();return o&&yf(o,"Failed to update task"),s(s({},r),{},{dueDate:r.due_date})},deleteTask:async e=>{const{error:t}=await ff.from("tasks").delete().eq("id",e);t&&yf(t,"Failed to delete task")},register:async e=>{try{var t;const{data:o,error:i}=await ff.auth.signUp({email:e.email,password:e.password,options:{data:{name:e.name,invite_code:(null===(t=e.inviteCode)||void 0===t?void 0:t.trim())||""},emailRedirectTo:window.location.origin}});if(i){var n,r;if(console.error("Registration error:",i),null!==(n=i.message)&&void 0!==n&&n.includes("aborted")||null!==(r=i.message)&&void 0!==r&&r.includes("signal")||"AbortError"===i.name)throw new Error("Registration request was cancelled. Please check your connection and try again.");yf(i,i.message||"Failed to register")}if(null!==o&&void 0!==o&&o.user&&!o.session){await new Promise(e=>setTimeout(e,500));const{data:{session:e}}=await ff.auth.getSession();e&&(o.session=e)}return o}catch(i){var o;if(console.error("Registration exception:",i),null!==(o=i.message)&&void 0!==o&&o.includes("aborted")||"AbortError"===i.name)throw new Error("Registration request was cancelled. Please try again.");throw i}},login:async e=>{const t=Date.now();try{var n,r,o,i;console.log("Starting login for:",e.email);const m=Date.now(),g=ff.auth.signInWithPassword({email:e.email,password:e.password}),{data:y,error:w}=await g,b=Date.now()-m;if(console.log("Sign in completed in ".concat(b,"ms")),w){var a,l,c,u,d,h;if(console.error("Login error:",w),null!==(a=w.message)&&void 0!==a&&a.includes("Failed to fetch")||null!==(l=w.message)&&void 0!==l&&l.includes("ERR_NAME_NOT_RESOLVED")||null!==(c=w.message)&&void 0!==c&&c.includes("NetworkError"))throw new Error("Cannot connect to server. The domain api.maxbeitler.com may not be resolving. Please check your network connection and DNS settings.");if(null!==(u=w.message)&&void 0!==u&&u.includes("aborted")||null!==(d=w.message)&&void 0!==d&&d.includes("signal"))throw new Error("Connection was interrupted. Please check your network connection and try again.");if(null!==(h=w.message)&&void 0!==h&&h.includes("Invalid login credentials"))throw new Error("Invalid email or password. Please try again.");yf(w,w.message||"Failed to login")}if(!y||!y.session)throw new Error("No session created. Please check your credentials and try again.");const _=Date.now()-t;console.log("Login successful, session created (total: ".concat(_,"ms)"));const x=y.user||(null===(n=y.session)||void 0===n?void 0:n.user);if(!x){var f,p,v;const{data:{user:e},error:t}=await ff.auth.getUser();if(t||!e)throw new Error("Could not get user after login. Please try again.");return{user:{id:e.id,email:e.email,name:(null===(f=e.user_metadata)||void 0===f?void 0:f.name)||e.email,profile:{id:e.id,email:e.email,name:(null===(p=e.user_metadata)||void 0===p?void 0:p.name)||e.email,role:"user"}},token:null===(v=y.session)||void 0===v?void 0:v.access_token}}const S={id:x.id,email:x.email,name:(null===(r=x.user_metadata)||void 0===r?void 0:r.name)||x.email,profile:{id:x.id,email:x.email,name:(null===(o=x.user_metadata)||void 0===o?void 0:o.name)||x.email,role:"user"}};return async function(){try{const{data:{user:t},error:n}=await ff.auth.getUser();if(n||!t)return console.warn("No auth user:",n),null;const r=ff.from("profiles").select("*").eq("id",t.id).single(),o=new Promise((e,t)=>setTimeout(()=>t(new Error("Profile query timeout")),3e3)),{data:i,error:a}=await Promise.race([r,o]);var e;return a?(console.warn("Error fetching profile (non-fatal):",a),s(s({},t),{},{profile:{id:t.id,email:t.email,name:(null===(e=t.user_metadata)||void 0===e?void 0:e.name)||t.email,role:"user"}})):s(s({},t),{},{profile:i})}catch(n){console.error("Exception in getCurrentUserWithProfile:",n);try{const{data:{user:e}}=await ff.auth.getUser();var t;if(e)return s(s({},e),{},{profile:{id:e.id,email:e.email,name:(null===(t=e.user_metadata)||void 0===t?void 0:t.name)||e.email,role:"user"}})}catch(r){console.error("Fallback also failed:",r)}return null}}().then(e=>{e&&e.profile&&console.log("Profile loaded successfully")}).catch(e=>{console.warn("Could not load profile (non-fatal):",e)}),{user:S,token:null===(i=y.session)||void 0===i?void 0:i.access_token}}catch(w){var m,g,y;if(console.error("Login exception:",w),null!==(m=w.message)&&void 0!==m&&m.includes("aborted")||"AbortError"===w.name)throw new Error("Login request was cancelled. Please try again.");if(null!==(g=w.message)&&void 0!==g&&g.includes("timeout")||null!==(y=w.message)&&void 0!==y&&y.includes("timed out"))throw new Error("Connection to server is slow or unreachable. Please check your network and try again.");throw w}},logout:async()=>{const{error:e}=await ff.auth.signOut();e&&yf(e,"Failed to logout")},getCurrentUser:async()=>gf||(gf=(async()=>{try{var e,t;mf;const{data:{session:n},error:r}=await ff.auth.getSession();if(r)throw r;if(!n)return null;ff.auth.getUser().then(e=>{let{data:{user:t},error:n}=e}).catch(e=>{mf});return{id:n.user.id,email:n.user.email,name:(null===(e=n.user.user_metadata)||void 0===e?void 0:e.name)||n.user.email,profile:{id:n.user.id,email:n.user.email,name:(null===(t=n.user.user_metadata)||void 0===t?void 0:t.name)||n.user.email,role:"user"}}}catch(n){throw n}finally{gf=null}})(),gf),updateProfile:async e=>{const t=await wf(),{data:n,error:r}=await ff.from("profiles").update(e).eq("id",t).select().single();return r&&yf(r,"Failed to update profile"),n},changePassword:async e=>{const{error:t}=await ff.auth.updateUser({password:e.newPassword});t&&yf(t,"Failed to change password")},getUsers:async()=>{const{data:e,error:t}=await ff.from("profiles").select("*").order("name");return t&&yf(t,"Failed to fetch users"),e||[]},getAdminUsers:async()=>{if(!await pf(await wf()))throw new Error("Admin access required");return await(void 0).getUsers()},updateAdminUser:async(e,t)=>{if(!await pf(await wf()))throw new Error("Admin access required");const{data:n,error:r}=await ff.from("profiles").update(t).eq("id",e).select().single();return r&&yf(r,"Failed to update user"),n},deleteAdminUser:async e=>{if(!await pf(await wf()))throw new Error("Admin access required");const{error:t}=await ff.auth.admin.deleteUser(e);t&&yf(t,"Failed to delete user")},getTeams:async()=>{try{const{data:n,error:r}=await ff.from("teams").select("*").order("name");if(r){var e,t;if(console.error("Error fetching teams:",r),"PGRST301"===r.code||null!==(e=r.message)&&void 0!==e&&e.includes("permission")||null!==(t=r.message)&&void 0!==t&&t.includes("policy"))return console.warn("RLS policy error for teams - returning empty array"),[];yf(r,"Failed to fetch teams")}return n||[]}catch(n){return console.error("Exception in getTeams:",n),[]}},createTeam:async e=>{const t=await wf(),{data:n,error:r}=await ff.from("teams").insert(s(s({},e),{},{created_by:t})).select().single();return r&&yf(r,"Failed to create team"),await ff.from("team_memberships").insert({team_id:n.id,user_id:t,role:"lead"}),n},updateTeam:async(e,t)=>{const{data:n,error:r}=await ff.from("teams").update(t).eq("id",e).select().single();return r&&yf(r,"Failed to update team"),n},deleteTeam:async e=>{const{error:t}=await ff.from("teams").delete().eq("id",e);t&&yf(t,"Failed to delete team")},getTeamMembers:async e=>{const{data:t,error:n}=await ff.from("team_memberships").select("\n        *,\n        user:profiles(*)\n      ").eq("team_id",e);return n&&yf(n,"Failed to fetch team members"),t||[]},addTeamMember:async(e,t,n)=>{const{data:r,error:o}=await ff.from("profiles").select("id").eq("email",t).single();if(o||!r)throw new Error("User not found");const{data:i,error:a}=await ff.from("team_memberships").insert({team_id:e,user_id:r.id,role:n||"member"}).select().single();return a&&yf(a,"Failed to add team member"),i},updateTeamMember:async(e,t,n)=>{const{data:r,error:o}=await ff.from("team_memberships").update({role:n}).eq("team_id",e).eq("id",t).select().single();return o&&yf(o,"Failed to update team member"),r},removeTeamMember:async(e,t)=>{const{error:n}=await ff.from("team_memberships").delete().eq("team_id",e).eq("id",t);n&&yf(n,"Failed to remove team member")},addComment:async(e,t,n)=>{const r=await wf(),{data:o,error:i}=await ff.from("comments").insert({entity_id:e,entity_type:t,user_id:r,content:n.content}).select().single();return i&&yf(i,"Failed to add comment"),o},deleteComment:async e=>{const{error:t}=await ff.from("comments").delete().eq("id",e);t&&yf(t,"Failed to delete comment")},getKPITemplates:async e=>{let t=ff.from("kpi_templates").select("*");e&&(t=t.eq("category",e));const{data:n,error:r}=await t.order("name");return r&&yf(r,"Failed to fetch KPI templates"),n||[]},createKPITemplate:async e=>{const t=await wf();if(!await pf(t))throw new Error("Admin access required");const{data:n,error:r}=await ff.from("kpi_templates").insert(e).select().single();return r&&yf(r,"Failed to create KPI template"),n},updateKPITemplate:async(e,t)=>{const n=await wf();if(!await pf(n))throw new Error("Admin access required");const{data:r,error:o}=await ff.from("kpi_templates").update(t).eq("id",e).select().single();return o&&yf(o,"Failed to update KPI template"),r},deleteKPITemplate:async e=>{const t=await wf();if(!await pf(t))throw new Error("Admin access required");const{error:n}=await ff.from("kpi_templates").delete().eq("id",e);n&&yf(n,"Failed to delete KPI template")},getInterviewNotes:async()=>{const{data:e,error:t}=await ff.from("interview_notes").select("*").order("created_at",{ascending:!1});return t&&yf(t,"Failed to fetch interview notes"),e||[]},createInterviewNote:async e=>{const t=await wf(),{data:n,error:r}=await ff.from("interview_notes").insert(s(s({},e),{},{created_by:t})).select().single();return r&&yf(r,"Failed to create interview note"),n},updateInterviewNote:async(e,t)=>{const{data:n,error:r}=await ff.from("interview_notes").update(t).eq("id",e).select().single();return r&&yf(r,"Failed to update interview note"),n},deleteInterviewNote:async e=>{const{error:t}=await ff.from("interview_notes").delete().eq("id",e);t&&yf(t,"Failed to delete interview note")},addNoteLink:async(e,t)=>{const{data:n,error:r}=await ff.from("note_links").insert({note_id:e,entity_id:t.entityId,entity_type:t.entityType}).select().single();return r&&yf(r,"Failed to add note link"),n},deleteNoteLink:async(e,t)=>{const{error:n}=await ff.from("note_links").delete().eq("id",t).eq("note_id",e);n&&yf(n,"Failed to delete note link")},getDataSources:async()=>{const{data:e,error:t}=await ff.from("data_sources").select("*").order("created_at",{ascending:!1});return t&&yf(t,"Failed to fetch data sources"),e||[]},createDataSource:async e=>{const t=await wf(),{data:n,error:r}=await ff.from("data_sources").insert(s(s({},e),{},{created_by:t,team_id:e.teamId||null})).select().single();return r&&yf(r,"Failed to create data source"),n},updateDataSource:async(e,t)=>{const{data:n,error:r}=await ff.from("data_sources").update(s(s({},t),{},{team_id:t.teamId||null})).eq("id",e).select().single();return r&&yf(r,"Failed to update data source"),n},deleteDataSource:async e=>{const{error:t}=await ff.from("data_sources").delete().eq("id",e);t&&yf(t,"Failed to delete data source")},getDataPoints:async(e,t)=>{let n=ff.from("data_points").select("*");e&&(n=n.eq("data_source_id",e)),t&&(n=n.eq("test_id",t));const{data:r,error:o}=await n.order("date",{ascending:!1});return o&&yf(o,"Failed to fetch data points"),r||[]},createDataPoint:async e=>{const{data:t,error:n}=await ff.from("data_points").insert(s(s({},e),{},{data_source_id:e.dataSourceId,test_id:e.testId||null})).select().single();return n&&yf(n,"Failed to create data point"),t},updateDataPoint:async(e,t)=>{const{data:n,error:r}=await ff.from("data_points").update(s(s({},t),{},{test_id:t.testId||null})).eq("id",e).select().single();return r&&yf(r,"Failed to update data point"),n},deleteDataPoint:async e=>{const{error:t}=await ff.from("data_points").delete().eq("id",e);t&&yf(t,"Failed to delete data point")},linkDataPointToTest:async(e,t)=>{const{data:n,error:r}=await ff.from("data_points").update({test_id:t}).eq("id",e).select().single();return r&&yf(r,"Failed to link data point to test"),n},getIntegrationTypes:async()=>({microsoft_clarity:{name:"Microsoft Clarity",fields:[{name:"projectId",label:"Project ID",required:!0},{name:"accessToken",label:"Access Token",required:!0,type:"password"}]},linkedin:{name:"LinkedIn",fields:[{name:"accessToken",label:"Access Token",required:!0,type:"password"},{name:"organizationId",label:"Organization ID",required:!1},{name:"pageId",label:"Page ID",required:!1}]},instagram:{name:"Instagram",fields:[{name:"accessToken",label:"Access Token",required:!0,type:"password"},{name:"userId",label:"User ID",required:!0}]},calling:{name:"Calling Insights",fields:[{name:"platform",label:"Platform",required:!0,type:"select",options:["twilio","ringcentral","aircall","custom"]},{name:"accountSid",label:"Account SID",required:!1},{name:"authToken",label:"Auth Token",required:!1,type:"password"}]}}),testDataSource:async e=>{throw new Error("Not implemented - requires Edge Function")},fetchDataSource:async(e,t)=>{throw new Error("Not implemented - requires Edge Function")},createExperiment:async(e,t)=>{const n=await wf(),{data:r,error:o}=await ff.from("experiments").insert({solution_id:e,type:t.type||"custom",title:t.title,hypothesis:t.hypothesis||null,hypothesis_id:t.hypothesisId||null,target_n:t.targetN||50,status:t.status||"planned",created_by:n,owner:n}).select().single();if(o&&(console.error("Error creating experiment:",o),yf(o,"Failed to create experiment")),r&&"calling_campaign"===r.type){const e=[{key:"attractiveness",label:"Attractiveness",type:"enum",options:["attractive","less_attractive"],required:!0},{key:"urgency",label:"Urgency",type:"enum",options:["high","medium","low"],required:!1},{key:"willingness_to_pay",label:"Willingness to Pay",type:"enum",options:["yes","no","unclear"],required:!1}];for(const t of e){const{error:e}=await ff.from("experiment_signals").insert({experiment_id:r.id,key:t.key,label:t.label,type:t.type,options:t.options,required:t.required||!1});e&&console.error("Error creating signal ".concat(t.key,":"),e)}}return r},listHypotheses:async e=>{const{data:t,error:n}=await ff.from("hypotheses").select("*").eq("opportunity_id",e).order("created_at",{ascending:!0});return n&&yf(n,"Failed to fetch hypotheses"),t||[]},createHypothesis:async(e,t)=>{const{data:n,error:r}=await ff.from("hypotheses").insert({opportunity_id:e,statement:t}).select().single();return r&&yf(r,"Failed to create hypothesis"),n},updateHypothesis:async(e,t)=>{const n={statement:t.statement,status:t.status};Object.keys(n).forEach(e=>void 0===n[e]&&delete n[e]);const{data:r,error:o}=await ff.from("hypotheses").update(n).eq("id",e).select().single();return o&&yf(o,"Failed to update hypothesis"),r},deleteHypothesis:async e=>{const{error:t}=await ff.from("hypotheses").delete().eq("id",e);t&&yf(t,"Failed to delete hypothesis")},listExperiments:async e=>{const{data:t,error:n}=await ff.from("experiments").select("\n        *,\n        experiment_signals (*),\n        experiment_evidence (\n          id,\n          evidence_type,\n          contact_label,\n          notes,\n          duration_min,\n          created_at,\n          experiment_evidence_signal_values (\n            signal_id,\n            value_text,\n            experiment_signals!inner (key, label)\n          )\n        )\n      ").eq("solution_id",e).order("created_at",{ascending:!1});return n&&yf(n,"Failed to fetch experiments"),(t||[]).map(e=>s(s({},e),{},{signals:e.experiment_signals||[],evidence:(e.experiment_evidence||[]).map(e=>s(s({},e),{},{signalValues:e.experiment_evidence_signal_values||[]}))}))},getExperiment:async e=>{const{data:t,error:n}=await ff.from("experiments").select("\n        *,\n        experiment_signals (*),\n        experiment_evidence (\n          *,\n          experiment_evidence_signal_values (\n            *,\n            experiment_signals!inner (*)\n          )\n        )\n      ").eq("id",e).single();return n&&yf(n,"Failed to fetch experiment"),s(s({},t),{},{signals:t.experiment_signals||[],evidence:(t.experiment_evidence||[]).map(e=>s(s({},e),{},{signalValues:e.experiment_evidence_signal_values||[]}))})},createDefaultSignalsForCallingCampaign:async e=>{const t=[{key:"attractiveness",label:"Attractiveness",type:"enum",options:["attractive","less_attractive"],required:!0},{key:"urgency",label:"Urgency",type:"enum",options:["high","medium","low"],required:!1},{key:"willingness_to_pay",label:"Willingness to Pay",type:"enum",options:["yes","no","unclear"],required:!1}],n=[];for(const r of t){const{data:t,error:o}=await ff.from("experiment_signals").insert({experiment_id:e,key:r.key,label:r.label,type:r.type,options:r.options,required:r.required||!1}).select().single();o?console.error("Error creating signal ".concat(r.key,":"),o):n.push(t)}return n},listSignals:async e=>{const{data:t,error:n}=await ff.from("experiment_signals").select("*").eq("experiment_id",e).order("created_at",{ascending:!0});return n&&yf(n,"Failed to fetch signals"),t||[]},logCall:async(e,t,n)=>{const r=await wf(),{data:o,error:i}=await ff.from("experiment_evidence").insert({experiment_id:e,evidence_type:"call",contact_label:t.contactLabel||null,notes:t.notes||null,duration_min:t.durationMin||null,created_by:r}).select().single();if(i&&(console.error("Error creating evidence:",i),yf(i,"Failed to log call")),n&&Object.keys(n).length>0){const{data:t}=await ff.from("experiment_signals").select("id, key").eq("experiment_id",e),r={};(t||[]).forEach(e=>{r[e.key]=e.id});const i=[];for(const[e,a]of Object.entries(n))null!==a&&void 0!==a&&r[e]&&i.push({evidence_id:o.id,signal_id:r[e],value_text:String(a)});if(i.length>0){const{error:e}=await ff.from("experiment_evidence_signal_values").insert(i);e&&console.error("Error creating signal values:",e)}}const{data:a,error:l}=await ff.from("experiment_evidence").select("\n        *,\n        experiment_evidence_signal_values (\n          *,\n          experiment_signals!inner (*)\n        )\n      ").eq("id",o.id).single();return l?(console.error("Error fetching complete evidence:",l),o):s(s({},a),{},{signalValues:a.experiment_evidence_signal_values||[]})},listEvidence:async e=>{const{data:t,error:n}=await ff.from("experiment_evidence").select("\n        *,\n        experiment_evidence_signal_values (\n          *,\n          experiment_signals!inner (*)\n        )\n      ").eq("experiment_id",e).order("created_at",{ascending:!1});return n&&yf(n,"Failed to fetch evidence"),(t||[]).map(e=>s(s({},e),{},{signalValues:e.experiment_evidence_signal_values||[]}))},getAggregatedResults:async e=>{const{data:t,error:n}=await ff.from("experiment_evidence").select("\n        id,\n        experiment_evidence_signal_values (\n          value_text,\n          experiment_signals!inner (key, label, type, options)\n        )\n      ").eq("experiment_id",e);n&&yf(n,"Failed to fetch results");const r={};return(t||[]).forEach(e=>{(e.experiment_evidence_signal_values||[]).forEach(e=>{const t=e.experiment_signals;r[t.key]||(r[t.key]={key:t.key,label:t.label,type:t.type,options:t.options,counts:{},total:0});const n=e.value_text;r[t.key].counts[n]=(r[t.key].counts[n]||0)+1,r[t.key].total+=1})}),Object.values(r).forEach(e=>{e.percentages={},Object.entries(e.counts).forEach(t=>{let[n,r]=t;e.percentages[n]=e.total>0?Math.round(r/e.total*100):0})}),r},sendFeedback:async function(){var e;let{message:t,includeContext:n,workspaceName:r,decisionSpaceName:o,url:i,mode:a,selectedNodeId:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{data:{session:l}}=await ff.auth.getSession();if(null===l||void 0===l||!l.access_token)throw new Error("Not authenticated");const c="undefined"!==typeof window&&null!=(null===(e=window.__ENV__)||void 0===e?void 0:e.REACT_APP_API_URL)?window.__ENV__.REACT_APP_API_URL:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://api.maxbeitler.com",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlhdCI6MTc2Nzk1NjM2OCwiZXhwIjo0OTIzNzE2MzY4LCJpc3MiOiJzdXBhYmFzZSJ9.rKZNRrRnXo4OypIDdonMnWkteCfaFPSz1oTwLNLd5M0"}.REACT_APP_API_URL,u="string"===typeof c&&c.trim()&&/^https?:\/\//i.test(c.trim())?c.trim().replace(/\/$/,""):"http://localhost:3001/api";try{const e=await fetch("".concat(u,"/feedback"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(l.access_token)},body:JSON.stringify({message:(null===t||void 0===t?void 0:t.trim())||"",includeContext:!!n,workspaceName:r||void 0,decisionSpaceName:o||void 0,url:i||void 0,mode:a||void 0,selectedNodeId:s||void 0})});if(!e.ok){const t=await e.json().catch(()=>({})),n=(null===t||void 0===t?void 0:t.error)||(503===e.status?"Feedback service not configured. Add REACT_APP_SUPABASE_URL and REACT_APP_SUPABASE_ANON_KEY to server .env (same as client).":"Request failed: ".concat(e.status));throw new Error(n)}return e.json()}catch(d){if(d instanceof TypeError&&"Failed to fetch"===d.message)throw new Error("Cannot reach server. Is it running on "+u+"?");throw d}}};const _f=function(t){let{workspace:n,currentUserId:r,onClose:o}=t;const[i,a]=(0,e.useState)([]),[s,l]=(0,e.useState)(""),[c,u]=(0,e.useState)(!1),d=async()=>{if(n){u(!0);try{const[e]=await Promise.all([bf.listWorkspaceMembers(n.id)]);a(e||[])}catch(e){console.error("Failed to load members:",e)}finally{u(!1)}}};return(0,e.useEffect)(()=>{d()},[n]),n?(0,il.jsx)("div",{className:"workspace-modal-backdrop",onClick:o,children:(0,il.jsxs)("div",{className:"workspace-modal",onClick:e=>e.stopPropagation(),children:[(0,il.jsxs)("div",{className:"workspace-modal-header",children:[(0,il.jsxs)("div",{children:["Members \xb7 ",n.name]}),(0,il.jsx)("button",{type:"button",onClick:o,children:"Close"})]}),n.isOwner&&(0,il.jsxs)("div",{className:"workspace-invite-row",children:[(0,il.jsx)("input",{placeholder:"Invite by email",value:s,onChange:e=>l(e.target.value)}),(0,il.jsx)("button",{type:"button",onClick:async()=>{if(s&&n)try{await bf.addMemberByEmail(n.id,s),l(""),await d()}catch(e){alert(e.message||"Failed to invite member")}},children:"Add member"})]}),c?(0,il.jsx)("div",{className:"workspace-empty",children:"Loading members\u2026"}):(0,il.jsxs)(il.Fragment,{children:[(0,il.jsx)("div",{className:"workspace-section-title",children:"Active members"}),[...i].sort((e,t)=>"owner"===e.role&&"owner"!==t.role?-1:"owner"===t.role&&"owner"!==e.role?1:"active"===e.status&&"active"!==t.status?-1:"active"===t.status&&"active"!==e.status?1:(e.email||"").localeCompare(t.email||"")).map(e=>{var t,o;return(0,il.jsxs)("div",{className:"workspace-member-row",children:[(0,il.jsxs)("div",{children:[(null===(t=e.profile)||void 0===t?void 0:t.name)||(null===(o=e.profile)||void 0===o?void 0:o.email)||e.email,"pending"===e.status&&(0,il.jsx)("span",{className:"workspace-pending",children:"Pending \u2014 user will join after registering"})]}),(0,il.jsxs)("div",{className:"workspace-member-actions",children:[(0,il.jsx)("span",{className:"workspace-role",children:e.role}),n.isOwner&&e.user_id!==r&&(0,il.jsx)("button",{type:"button",onClick:()=>bf.removeWorkspaceMember(e.id).then(d),children:"Remove"})]})]},e.id)})]})]})}):null};const xf=function(t){let{onClose:n,onCreated:r,ownerEmail:o}=t;const[i,a]=(0,e.useState)(""),[s,l]=(0,e.useState)(!1);return(0,il.jsx)("div",{className:"workspace-modal-backdrop",onClick:n,children:(0,il.jsxs)("div",{className:"create-team-modal",onClick:e=>e.stopPropagation(),children:[(0,il.jsx)("div",{className:"create-team-header",children:"Create team workspace"}),(0,il.jsx)("input",{placeholder:"Product Team",value:i,onChange:e=>a(e.target.value)}),(0,il.jsxs)("div",{className:"create-team-actions",children:[(0,il.jsx)("button",{type:"button",className:"secondary",onClick:n,children:"Cancel"}),(0,il.jsx)("button",{type:"button",onClick:async()=>{if(!(i.trim().length<2)){l(!0);try{const e=await bf.createWorkspace({name:i.trim(),type:"team",ownerEmail:o});null===r||void 0===r||r(e)}catch(e){alert(e.message||"Failed to create team workspace")}finally{l(!1)}}},disabled:s||i.trim().length<2,children:s?"Creating\u2026":"Create team"})]})]})})};const Sf=function(t){let{onClose:n,onCreated:r,workspaceId:o}=t;const[i,a]=(0,e.useState)(""),[s,l]=(0,e.useState)(""),[c,u]=(0,e.useState)(!1);return(0,il.jsx)("div",{className:"workspace-modal-backdrop",onClick:n,children:(0,il.jsxs)("div",{className:"create-space-modal",onClick:e=>e.stopPropagation(),children:[(0,il.jsx)("div",{className:"create-space-header",children:"New Decision Space"}),(0,il.jsx)("input",{placeholder:"Growth",value:i,onChange:e=>a(e.target.value)}),(0,il.jsx)("textarea",{placeholder:"Short description (optional)",value:s,onChange:e=>l(e.target.value),rows:3}),(0,il.jsxs)("div",{className:"create-space-actions",children:[(0,il.jsx)("button",{type:"button",className:"secondary",onClick:n,children:"Cancel"}),(0,il.jsx)("button",{type:"button",onClick:async()=>{if(!(i.trim().length<2)){u(!0);try{const e=await bf.createDecisionSpace(o,{name:i.trim(),description:s.trim()});null===r||void 0===r||r(e)}catch(e){alert(e.message||"Failed to create decision space")}finally{u(!1)}}},disabled:c||i.trim().length<2,children:c?"Creating\u2026":"Create Decision Space"})]})]})})};const kf=function(e){let{isOpen:t,onClose:n,workspace:r,members:o=[],currentUserId:i,activeMap:a={},activeIds:s=new Set}=e;if(!r)return null;const l=[...o].sort((e,t)=>{var n,r,o,i;return"owner"===e.role&&"owner"!==t.role?-1:"owner"===t.role&&"owner"!==e.role?1:((null===(n=e.profile)||void 0===n?void 0:n.name)||(null===(r=e.profile)||void 0===r?void 0:r.email)||e.email||"").localeCompare((null===(o=t.profile)||void 0===o?void 0:o.name)||(null===(i=t.profile)||void 0===i?void 0:i.email)||t.email||"")}),c=r.name||"Workspace",u=r.description||"Team workspace";return(0,il.jsxs)("aside",{className:"team-drawer ".concat(t?"is-open":""),"aria-hidden":!t,children:[(0,il.jsxs)("div",{className:"team-drawer-header",children:[(0,il.jsxs)("div",{children:[(0,il.jsx)("div",{className:"team-drawer-title",children:c}),(0,il.jsx)("div",{className:"team-drawer-subtitle",children:u})]}),(0,il.jsx)("button",{type:"button",className:"team-drawer-close",onClick:n,children:"Close"})]}),(0,il.jsxs)("div",{className:"team-drawer-section",children:[(0,il.jsx)("div",{className:"team-drawer-section-title",children:"Members"}),(0,il.jsxs)("div",{className:"team-drawer-list",children:[l.map(e=>{const t=e.profile||{id:e.user_id,email:e.email},n="owner"===e.role?"Owner":"Editor",r=a[e.user_id]||"\u2014",o=e.user_id&&s.has(e.user_id);return(0,il.jsxs)("div",{className:"team-drawer-row",children:[(0,il.jsx)(bl,{user:t,size:28,isOwner:"owner"===e.role,showPresence:!0,isActive:Boolean(o)}),(0,il.jsxs)("div",{className:"team-drawer-info",children:[(0,il.jsxs)("div",{className:"team-drawer-name",children:[t.name||t.email||e.email||"Member",e.user_id===i&&(0,il.jsx)("span",{className:"team-drawer-you",children:"You"})]}),(0,il.jsxs)("div",{className:"team-drawer-meta",children:[(0,il.jsx)("span",{children:n}),(0,il.jsx)("span",{children:"\xb7"}),(0,il.jsxs)("span",{children:["Working on: ",r]})]})]})]},e.id)}),0===l.length&&(0,il.jsx)("div",{className:"team-drawer-empty",children:"No members yet."})]})]})]})};const Ef=function(e){let{message:t}=e;return(0,il.jsx)("div",{className:"todo-sidebar-empty",children:t})};const Cf=function(e){let{completed:t=0,total:n=0}=e;if(!n)return(0,il.jsx)("div",{className:"todo-progress-empty",children:"\u2014"});const r=Math.min(100,Math.round(t/n*100));return(0,il.jsx)("div",{className:"todo-progress-ring",style:{"--percent":r},children:(0,il.jsxs)("span",{children:[r,"%"]})})};const Nf=function(t){let{group:n,testMeta:r,users:o=[],onOpenTest:i,onToggleTodo:a,onAssignOwner:s,expanded:l=!1,onToggleExpand:c,toastMessageById:u={},isHighlighted:d=!1}=t;const[h,f]=(0,e.useState)(!1),p=n.todos||[],v=p.filter(e=>e.is_done).length,m=p.length,g=m>0&&v===m,y=(0,e.useMemo)(()=>null!==r&&void 0!==r&&r.description&&r.description.length<=90?r.description:"Validate this assumption before scaling.",[null===r||void 0===r?void 0:r.description]),w=(null===r||void 0===r?void 0:r.ownerUser)||null,b=l?p:p.slice(0,3),_=m-b.length,x={interview:"Interview",cold_outreach:"Cold Outreach",pricing:"Pricing",prototype_usability:"Prototype",custom:"Test"}[null===r||void 0===r?void 0:r.testType]||"Test",S=(null===r||void 0===r?void 0:r.breadcrumb)||"",k=n.experimentTitle||(null===r||void 0===r?void 0:r.title)||"Experiment";return(0,il.jsxs)("div",{className:"todo-test-card ".concat(d?"highlight":""),children:[(0,il.jsxs)("button",{type:"button",className:"todo-test-card-header",onClick:()=>null===i||void 0===i?void 0:i(n.experimentId),children:[(0,il.jsxs)("div",{className:"todo-test-card-title",children:[(0,il.jsx)("span",{children:k}),g&&(0,il.jsx)("span",{className:"todo-test-card-complete",children:"Completed \u2728"})]}),(0,il.jsxs)("div",{className:"todo-test-card-meta",children:[(0,il.jsx)("span",{className:"todo-test-card-badge",children:x}),S&&(0,il.jsx)("span",{className:"todo-test-card-breadcrumb",children:S})]}),(0,il.jsx)("div",{className:"todo-test-card-why",children:y})]}),(0,il.jsx)("div",{className:"todo-test-card-progress",children:(0,il.jsx)(Cf,{completed:v,total:m})}),(0,il.jsxs)("div",{className:"todo-test-card-owner",children:[w?(0,il.jsx)("button",{type:"button",className:"todo-owner-btn",onClick:()=>f(e=>!e),children:(0,il.jsx)(bl,{user:w,size:22,isOwner:!0})}):(0,il.jsxs)("button",{type:"button",className:"todo-owner-btn assign",onClick:()=>f(e=>!e),children:[(0,il.jsx)(N,{}),(0,il.jsx)("span",{children:"Assign"})]}),h&&(0,il.jsxs)("select",{className:"todo-assign-select",value:(null===w||void 0===w?void 0:w.id)||"",onChange:e=>{f(!1),null===s||void 0===s||s(n.experimentId,e.target.value||null)},children:[(0,il.jsx)("option",{value:"",children:"Unassigned"}),o.map(e=>(0,il.jsx)("option",{value:e.id,children:e.name||e.email},e.id))]})]}),(0,il.jsxs)("div",{className:"todo-test-card-list",children:[b.map(e=>(0,il.jsxs)("label",{className:"todo-test-item ".concat(e.is_done?"done":""),children:[(0,il.jsx)("input",{type:"checkbox",checked:e.is_done,onChange:()=>null===a||void 0===a?void 0:a(e),"aria-label":"Toggle ".concat(e.title)}),(0,il.jsx)("span",{className:"todo-test-item-title",children:e.title}),u[e.id]&&(0,il.jsx)("span",{className:"todo-test-item-toast",children:u[e.id]})]},e.id)),_>0&&(0,il.jsxs)("button",{type:"button",className:"todo-test-more",onClick:c,children:["+",_," more"]})]})]})};var jf=n(9507),Tf=n.n(jf);const Of=function(t){let{isOpen:n,todos:r=[],users:o=[],testMetaById:i={},highlightedIds:a=new Set,onOpenTest:l,onToggleTodo:c,onAssignOwner:u,onClose:d}=t;const[h,f]=(0,e.useState)({today:!1,upcoming:!1,completed:!0}),[p,v]=(0,e.useState)({}),[m,g]=(0,e.useState)({}),y=(0,e.useMemo)(()=>r.filter(e=>!e.is_done),[r]),_=(0,e.useMemo)(()=>r.filter(e=>e.is_done&&(e=>{if(!e)return!1;const t=Date.now()-864e5;return new Date(e).getTime()>=t})(e.updated_at)),[r]),x=(0,e.useMemo)(()=>{const e=[],t=[];y.forEach(n=>{(e=>{if(!e)return!1;const t=new Date,n=new Date(e),r=new Date(t.getFullYear(),t.getMonth(),t.getDate());return new Date(n.getFullYear(),n.getMonth(),n.getDate())<=r})(n.due_date)?e.push(n):t.push(n)});const n=e=>{const t=new Map;e.forEach(e=>{const n=e.experiment_id||"unknown";t.has(n)||t.set(n,{experimentId:e.experiment_id,experimentTitle:e.experiment_title,opportunityTitle:e.opportunity_title,todos:[]}),t.get(n).todos.push(e)});const n=Array.from(t.values());return n.forEach(e=>{e.todos.sort((e,t)=>{const n=e.due_date?new Date(e.due_date).getTime():1/0,r=t.due_date?new Date(t.due_date).getTime():1/0;return n!==r?n-r:new Date(t.updated_at).getTime()-new Date(e.updated_at).getTime()})}),n.sort((e,t)=>{const n=e.todos.some(e=>e.due_date);if(n!==t.todos.some(e=>e.due_date))return n?-1:1;const r=e.todos.reduce((e,t)=>t.due_date?Math.min(e,new Date(t.due_date).getTime()):e,1/0),o=t.todos.reduce((e,t)=>t.due_date?Math.min(e,new Date(t.due_date).getTime()):e,1/0);if(r!==o)return r-o;const i=Math.max(...e.todos.map(e=>new Date(e.updated_at).getTime()));return Math.max(...t.todos.map(e=>new Date(e.updated_at).getTime()))-i}),n};return{today:n(e),upcoming:n(t),completed:n(_)}},[y,_]),S=async e=>{const t=Tf()[Math.floor(Math.random()*Tf().length)];g(n=>s(s({},n),{},{[e.id]:t})),setTimeout(()=>{g(t=>{const n=s({},t);return delete n[e.id],n})},1600),await(null===c||void 0===c?void 0:c(e))},k=(e,t,n,r)=>(0,il.jsxs)("div",{className:"todo-sidebar-section",children:[(0,il.jsxs)("button",{type:"button",className:"todo-sidebar-section-header",onClick:()=>f(t=>s(s({},t),{},{[e]:!t[e]})),children:[(0,il.jsx)("span",{children:t}),(0,il.jsx)(w,{className:h[e]?"":"open"})]}),!h[e]&&(0,il.jsx)(il.Fragment,{children:r.length>0?r.map(e=>(0,il.jsx)(Nf,{group:e,testMeta:i[e.experimentId],users:o,expanded:Boolean(p[e.experimentId]),onToggleExpand:()=>v(t=>s(s({},t),{},{[e.experimentId]:!t[e.experimentId]})),onOpenTest:e=>null===l||void 0===l?void 0:l(e),onToggleTodo:S,onAssignOwner:u,toastMessageById:m,isHighlighted:a.has(e.experimentId)},e.experimentId)):(0,il.jsx)(Ef,{message:n})})]});return(0,il.jsxs)("aside",{className:"todo-sidebar ".concat(n?"is-open":""),children:[(0,il.jsxs)("div",{className:"todo-sidebar-header",children:[(0,il.jsxs)("div",{children:[(0,il.jsx)("div",{className:"todo-sidebar-title",children:"Todo"}),(0,il.jsx)("div",{className:"todo-sidebar-subtitle",children:"Your next small steps"})]}),(0,il.jsx)("button",{type:"button",className:"todo-sidebar-collapse",onClick:d,"aria-label":"Collapse todo sidebar",children:(0,il.jsx)(b,{})})]}),k("today","Today","No urgent steps today. That\u2019s okay.",x.today),k("upcoming","Upcoming","Nothing queued. Add a task from any test.",x.upcoming),k("completed","Completed today","No completions yet.",x.completed)]})};const If=function(t){let{onLogin:n}=t;const[r,o]=(0,e.useState)(!1),[i,a]=(0,e.useState)({name:"",email:"",password:"",confirmPassword:"",inviteCode:""}),[l,c]=(0,e.useState)(""),[u,d]=(0,e.useState)(!1),h=e=>{a(s(s({},i),{},{[e.target.name]:e.target.value}))};return(0,il.jsx)("div",{className:"login-container",children:(0,il.jsxs)("div",{className:"login-card",children:[(0,il.jsx)("h1",{children:"TreeFlow"}),(0,il.jsxs)("div",{className:"auth-tabs",children:[(0,il.jsx)("button",{className:r?"":"active",onClick:()=>o(!1),children:"Login"}),(0,il.jsx)("button",{className:r?"active":"",onClick:()=>o(!0),children:"Register"})]}),(0,il.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),c(""),d(!0);try{if(r){var t,o;if(i.password!==i.confirmPassword)return c("Passwords do not match"),void d(!1);if(i.password.length<6)return c("Password must be at least 6 characters"),void d(!1);if(null===(t=i.inviteCode)||void 0===t||!t.trim())return c("Invite code is required"),void d(!1);const e=await bf.register({name:i.name,email:i.email,password:i.password,inviteCode:(null===(o=i.inviteCode)||void 0===o?void 0:o.trim())||""});if(e.user){const t=(async()=>{await new Promise(e=>setTimeout(e,1e3));const e=await bf.getCurrentUser();if(e)return e;await new Promise(e=>setTimeout(e,1e3));return await bf.getCurrentUser()})(),r=new Promise((e,t)=>setTimeout(()=>t(new Error("Timeout")),5e3));try{const e=await Promise.race([t,r]);if(e){try{await bf.createMyDefaultWorkspace()}catch(l){console.warn("createMyDefaultWorkspace after signup:",l)}n(e)}else c("Registration successful, but profile not created. Please try logging in.")}catch(u){if(e.user){try{await bf.createMyDefaultWorkspace()}catch(l){console.warn("createMyDefaultWorkspace after signup:",l)}n(e.user)}else c("Registration successful, but could not load profile. Please try logging in.")}}else c("Registration failed. Please try again.")}else{const e=bf.login({email:i.email,password:i.password}),t=new Promise((e,t)=>setTimeout(()=>t(new Error("Login is taking longer than expected. Please wait or check your connection.")),12e4));try{const r=await Promise.race([e,t]);r&&r.user?n(r.user):(c("Login successful but could not load user data. Please refresh the page."),d(!1))}catch(u){var a,s;if(!(null!==(a=u.message)&&void 0!==a&&a.includes("timeout")||null!==(s=u.message)&&void 0!==s&&s.includes("too long")))throw u;c("Login is taking longer than expected. Please wait or check your connection.");try{const t=await e;if(t&&t.user)return void n(t.user)}catch(h){throw h}}}}catch(f){console.error("Authentication error:",f),c(f.message||"Authentication failed")}finally{d(!1)}},children:[r&&(0,il.jsx)("input",{type:"text",name:"name",placeholder:"Full Name",value:i.name,onChange:h,required:!0,className:"form-input"}),(0,il.jsx)("input",{type:"email",name:"email",placeholder:"Email",value:i.email,onChange:h,required:!0,className:"form-input"}),(0,il.jsx)("input",{type:"password",name:"password",placeholder:"Password",value:i.password,onChange:h,required:!0,className:"form-input",minLength:6}),r&&(0,il.jsx)("input",{type:"password",name:"confirmPassword",placeholder:"Confirm Password",value:i.confirmPassword,onChange:h,required:!0,className:"form-input",minLength:6}),r&&(0,il.jsx)("input",{type:"text",name:"inviteCode",placeholder:"Invite code",value:i.inviteCode,onChange:h,required:!0,className:"form-input",autoComplete:"off"}),l&&(0,il.jsx)("div",{className:"error-message",children:l}),(0,il.jsx)("button",{type:"submit",className:"btn-primary",disabled:u,children:u?(0,il.jsxs)("span",{children:[(0,il.jsx)("span",{className:"spinner"})," ",r?"Registering...":"Logging in..."]}):r?"Register":"Login"})]})]})})};const Pf=function(t){var n,r,o,i,a,l,c;let{user:u,onUpdate:d,onClose:h,workspace:f,workspaceRole:p}=t;const[v,m]=(0,e.useState)("identity"),[g,y]=(0,e.useState)({name:u.name||"",profile:{bio:(null===(n=u.profile)||void 0===n?void 0:n.bio)||"",avatar:(null===(r=u.profile)||void 0===r?void 0:r.avatar)||"",badge:(null===(o=u.profile)||void 0===o?void 0:o.badge)||"",preferences:{theme:(null===(i=u.profile)||void 0===i||null===(a=i.preferences)||void 0===a?void 0:a.theme)||"light",notifications:!1!==(null===(l=u.profile)||void 0===l||null===(c=l.preferences)||void 0===c?void 0:c.notifications)}}}),[w,b]=(0,e.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[_,x]=(0,e.useState)(""),[S,k]=(0,e.useState)(""),[E,N]=(0,e.useState)(!1),j=(0,e.useRef)(null),I=async e=>{e.preventDefault(),x(""),k(""),N(!0);try{const e=await bf.updateProfile(g);k("Saved \u2713"),d(e),setTimeout(()=>k(""),2e3)}catch(r){var t,n;x((null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.error)||"Failed to update profile")}finally{N(!1)}};return(0,il.jsx)("div",{className:"user-profile-overlay",onClick:h,children:(0,il.jsxs)("div",{className:"user-profile-modal",onClick:e=>e.stopPropagation(),children:[(0,il.jsxs)("div",{className:"user-profile-hero",children:[(0,il.jsxs)("button",{type:"button",className:"user-profile-avatar",onClick:()=>{var e;return null===(e=j.current)||void 0===e?void 0:e.focus()},children:[(0,il.jsx)(bl,{user:s(s({},u),{},{profile:g.profile}),size:72,isOwner:!0}),(0,il.jsx)("span",{className:"avatar-edit-hint",children:"Edit"})]}),(0,il.jsxs)("div",{className:"user-profile-hero-info",children:[(0,il.jsx)("div",{className:"user-profile-name",children:g.name||"Your name"}),(0,il.jsxs)("div",{className:"user-profile-role",children:[p||"Member"," \xb7 ",(null===f||void 0===f?void 0:f.name)||"Workspace"]}),(0,il.jsx)("div",{className:"user-profile-email",children:u.email})]}),(0,il.jsx)("button",{onClick:h,className:"btn-close",children:(0,il.jsx)(O,{})})]}),(0,il.jsxs)("div",{className:"user-profile-tabs",children:[(0,il.jsxs)("button",{className:"identity"===v?"active":"",onClick:()=>m("identity"),children:[(0,il.jsx)(P,{})," Identity"]}),(0,il.jsxs)("button",{className:"tab-muted ".concat("security"===v?"active":""),onClick:()=>m("security"),children:[(0,il.jsx)(C,{})," Security"]}),(0,il.jsxs)("button",{className:"preferences"===v?"active":"",onClick:()=>m("preferences"),children:[(0,il.jsx)(T,{})," Preferences"]})]}),(0,il.jsxs)("div",{className:"user-profile-content",children:[_&&(0,il.jsx)("div",{className:"error-message",children:_}),S&&(0,il.jsx)("div",{className:"success-message",children:S}),"identity"===v&&(0,il.jsxs)("form",{onSubmit:I,children:[(0,il.jsxs)("div",{className:"form-group",children:[(0,il.jsx)("label",{children:"Name"}),(0,il.jsx)("input",{type:"text",value:g.name,onChange:e=>y(s(s({},g),{},{name:e.target.value})),className:"form-input",required:!0})]}),(0,il.jsxs)("div",{className:"form-group",children:[(0,il.jsx)("label",{children:"Avatar URL"}),(0,il.jsx)("input",{ref:j,type:"url",value:g.profile.avatar,onChange:e=>y(s(s({},g),{},{profile:s(s({},g.profile),{},{avatar:e.target.value})})),className:"form-input",placeholder:"https://..."}),(0,il.jsx)("small",{children:"Paste an image URL for now. Uploading comes later."})]}),(0,il.jsxs)("div",{className:"form-group",children:[(0,il.jsx)("label",{children:"Bio"}),(0,il.jsx)("textarea",{value:g.profile.bio,onChange:e=>y(s(s({},g),{},{profile:s(s({},g.profile),{},{bio:e.target.value})})),className:"form-input",rows:"4",placeholder:"What do you work on here? A short line about you helps teammates."})]}),(0,il.jsxs)("div",{className:"form-group",children:[(0,il.jsx)("label",{children:"Badge (optional)"}),(0,il.jsx)("input",{type:"text",value:g.profile.badge,onChange:e=>y(s(s({},g),{},{profile:s(s({},g.profile),{},{badge:e.target.value})})),className:"form-input",placeholder:"e.g. Research, Growth, PM"})]}),(0,il.jsxs)("div",{className:"form-actions",children:[(0,il.jsx)("button",{type:"submit",className:"btn-primary",disabled:E,children:E?"Saving...":"Save Changes"}),S&&(0,il.jsx)("span",{className:"save-indicator",children:"Saved \u2713"})]})]}),"security"===v&&(0,il.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),x(""),k(""),w.newPassword===w.confirmPassword)if(w.newPassword.length<6)x("Password must be at least 6 characters");else{N(!0);try{await bf.changePassword({currentPassword:w.currentPassword,newPassword:w.newPassword}),k("Saved \u2713"),b({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>k(""),2e3)}catch(r){var t,n;x((null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.error)||"Failed to change password")}finally{N(!1)}}else x("New passwords do not match")},children:[(0,il.jsx)("div",{className:"security-note",children:"Keep your account secure. Password changes apply globally."}),(0,il.jsxs)("div",{className:"form-group",children:[(0,il.jsx)("label",{children:"Current Password"}),(0,il.jsx)("input",{type:"password",value:w.currentPassword,onChange:e=>b(s(s({},w),{},{currentPassword:e.target.value})),className:"form-input",required:!0})]}),(0,il.jsxs)("div",{className:"form-group",children:[(0,il.jsx)("label",{children:"New Password"}),(0,il.jsx)("input",{type:"password",value:w.newPassword,onChange:e=>b(s(s({},w),{},{newPassword:e.target.value})),className:"form-input",required:!0,minLength:6})]}),(0,il.jsxs)("div",{className:"form-group",children:[(0,il.jsx)("label",{children:"Confirm New Password"}),(0,il.jsx)("input",{type:"password",value:w.confirmPassword,onChange:e=>b(s(s({},w),{},{confirmPassword:e.target.value})),className:"form-input",required:!0,minLength:6})]}),(0,il.jsxs)("div",{className:"form-actions",children:[(0,il.jsx)("button",{type:"submit",className:"btn-primary",disabled:E,children:E?"Changing...":"Change Password"}),S&&(0,il.jsx)("span",{className:"save-indicator",children:"Saved \u2713"})]})]}),"preferences"===v&&(0,il.jsxs)("form",{onSubmit:I,children:[(0,il.jsxs)("div",{className:"form-group",children:[(0,il.jsx)("label",{children:"Theme"}),(0,il.jsxs)("select",{value:g.profile.preferences.theme,onChange:e=>y(s(s({},g),{},{profile:s(s({},g.profile),{},{preferences:s(s({},g.profile.preferences),{},{theme:e.target.value})})})),className:"form-input",children:[(0,il.jsx)("option",{value:"light",children:"Light"}),(0,il.jsx)("option",{value:"dark",children:"Dark"})]}),(0,il.jsx)("small",{children:"More preferences are coming soon."})]}),(0,il.jsxs)("div",{className:"form-actions",children:[(0,il.jsx)("button",{type:"submit",className:"btn-primary",disabled:E,children:E?"Saving...":"Save Preferences"}),S&&(0,il.jsx)("span",{className:"save-indicator",children:"Saved \u2713"})]})]})]})]})})};const Af=function(t){let{todos:n=[],draftValue:r,onDraftChange:o,onAdd:i,onToggle:a,onUpdateText:s,onUpdateDueDate:l,onMoveUp:c,onMoveDown:u,onDelete:d,editingTodoId:h,editingTodoTitle:f,onStartEdit:p,onEditChange:v,onCommitEdit:g,onCancelEdit:b,userById:_={}}=t;const S=n.length,k=(0,e.useMemo)(()=>n.filter(e=>e.is_done).length,[n]),E=0===S?0:Math.round(k/S*100),C=S>0&&k===S;return(0,il.jsxs)("div",{className:"todo-panel",children:[(0,il.jsx)("div",{className:"todo-panel-header",children:(0,il.jsxs)("div",{className:"todo-panel-title",children:[(0,il.jsx)("span",{children:"Do"}),(0,il.jsxs)("div",{className:"todo-panel-progress",children:[(0,il.jsxs)("span",{children:[k,"/",S," done"]}),(0,il.jsx)("div",{className:"todo-panel-progress-bar",children:(0,il.jsx)("span",{style:{width:"".concat(E,"%")}})})]})]})}),C&&(0,il.jsx)("div",{className:"todo-panel-celebrate",children:"Nice \u2014 you cleared this test\u2019s tasks \u2728"}),(0,il.jsxs)("div",{className:"todo-panel-composer",children:[(0,il.jsxs)("div",{className:"todo-panel-composer-input",children:[(0,il.jsx)(N,{}),(0,il.jsx)("input",{value:r,placeholder:"Add a to-do\u2026",maxLength:120,onChange:e=>null===o||void 0===o?void 0:o(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),null===i||void 0===i||i())}})]}),(0,il.jsxs)("button",{type:"button",className:"todo-panel-add",onClick:()=>null===i||void 0===i?void 0:i(),children:[(0,il.jsx)(N,{}),"Add"]})]}),0===n.length?(0,il.jsx)("div",{className:"todo-panel-empty",children:"No to-dos yet."}):(0,il.jsx)("div",{className:"todo-panel-list",children:n.map((e,t)=>{const r=_[e.assignee_id||e.assigneeId||e.owner_id||e.owner],o=(e=>{if(!e)return"none";const t=new Date,n=new Date(e);if(Number.isNaN(n.getTime()))return"none";const r=new Date(t.getFullYear(),t.getMonth(),t.getDate()),o=new Date(n.getFullYear(),n.getMonth(),n.getDate()),i=Math.round((o-r)/864e5);return i<0?"overdue":i<=3?"soon":"future"})(e.due_date),i=(e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleDateString(void 0,{month:"short",day:"numeric"})})(e.due_date);return(0,il.jsxs)("div",{className:"todo-pill-row ".concat(e.is_done?"done":""),children:[(0,il.jsxs)("label",{className:"todo-pill-check",children:[(0,il.jsx)("input",{type:"checkbox",checked:e.is_done,onChange:()=>null===a||void 0===a?void 0:a(e),"aria-label":"Toggle ".concat(e.title)}),(0,il.jsx)("span",{className:"todo-pill-checkmark",children:(0,il.jsx)(y,{})})]}),(0,il.jsxs)("div",{className:"todo-pill-content",children:[h===e.id?(0,il.jsx)("input",{className:"todo-pill-input",value:f,onChange:e=>null===v||void 0===v?void 0:v(e.target.value),onBlur:()=>null===g||void 0===g?void 0:g(e.id,f),onKeyDown:t=>{"Enter"===t.key&&(t.preventDefault(),null===g||void 0===g||g(e.id,f)),"Escape"===t.key&&(null===b||void 0===b||b())}}):(0,il.jsx)("button",{type:"button",className:"todo-pill-title ".concat(e.is_done?"done":""),onClick:()=>null===p||void 0===p?void 0:p(e),children:e.title}),r&&(0,il.jsx)("div",{className:"todo-pill-assignee",children:(0,il.jsx)(bl,{user:r,size:18})})]}),(0,il.jsxs)("div",{className:"todo-pill-meta",children:[(0,il.jsxs)("label",{className:"todo-date-pill ".concat(o),children:[(0,il.jsx)(m,{}),(0,il.jsx)("span",{children:i||"Add date"}),(0,il.jsx)("input",{type:"date",value:e.due_date||"",onChange:t=>null===l||void 0===l?void 0:l(e.id,t.target.value),"aria-label":"Set due date"})]}),(0,il.jsxs)("div",{className:"todo-row-actions",children:[(0,il.jsx)("button",{type:"button",onClick:()=>null===c||void 0===c?void 0:c(e.id),disabled:0===t,"aria-label":"Move up",children:(0,il.jsx)(x,{})}),(0,il.jsx)("button",{type:"button",onClick:()=>null===u||void 0===u?void 0:u(e.id),disabled:t===n.length-1,"aria-label":"Move down",children:(0,il.jsx)(w,{})}),(0,il.jsx)("button",{type:"button",onClick:()=>null===d||void 0===d?void 0:d(e.id),"aria-label":"Delete todo",children:(0,il.jsx)(I,{})})]})]})]},e.id)})})]})},Rf={title:"",description:"",status:"",owner:"",evidence:"",result:""};const Df=function(t){var n,r,o,i,a,l,c,u,d,h,f,p,v;let{outcomes:m,users:g,onUpdate:y,isDrawer:w=!1,treeStructure:b="classic"}=t;const{state:{selectedKey:_,nodeOverrides:x,todosById:S,todoIdsByTest:k,evidenceByTest:E},actions:{setNodeOverride:C,setEvidence:N,setSelectedKey:j,upsertTodo:T,removeTodo:O}}=vl(),I=(0,e.useMemo)(()=>Fl(m,_),[m,_]),P=_?x[_]:null,A=(0,e.useMemo)(()=>null!==I&&void 0!==I&&I.node?s(s({},I.node),P||{}):null,[null===I||void 0===I?void 0:I.node,P]),R=(0,e.useMemo)(()=>(e=>(e||[]).map(e=>({value:e.id,label:e.name||e.email})))(g),[g]),[D,M]=(0,e.useState)(Rf),[L,z]=(0,e.useState)({testTemplate:null,testType:"custom",testStatus:"draft",successCriteria:{pass:"",iterate:"",kill:""},resultDecision:null,hypothesisId:null,resultSummary:"",timebox:{start:"",end:""}}),[U,B]=(0,e.useState)([]),[F,K]=(0,e.useState)(!1),[q,V]=(0,e.useState)(""),[W,H]=(0,e.useState)(null),[Y,G]=(0,e.useState)(""),[X,J]=(0,e.useState)(!1),[$,Z]=(0,e.useState)("context"),[Q,ee]=(0,e.useState)(!1),te=(0,e.useMemo)(()=>{const e={};return(g||[]).forEach(t=>{e[t.id]=t}),e},[g]),[ne,re]=(0,e.useState)([]),[oe,ie]=(0,e.useState)(!1),[ae,se]=(0,e.useState)(""),[le,ce]=(0,e.useState)(null),[ue,de]=(0,e.useState)(""),[he,fe]=(0,e.useState)(null),[pe,ve]=(0,e.useState)(""),[me,ge]=(0,e.useState)(""),[ye,we]=(0,e.useState)(()=>{if("undefined"===typeof window)return 520;const e=window.sessionStorage.getItem("treeflow:sidebarWidth");return e?Number(e):520}),be=(0,e.useRef)(null),_e=(0,e.useRef)(null),xe=(0,e.useRef)(null),Se=(0,e.useRef)(null),ke=(0,e.useRef)(U);ke.current=U;const[Ee,Ce]=(0,e.useState)("saved"),Ne=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:L;return"test"===(null===I||void 0===I?void 0:I.type)?s(s({},e),t):s({},e)},je=e=>D.title===e.title&&D.description===e.description&&D.status===e.status&&D.owner===e.owner&&D.evidence===e.evidence&&D.result===e.result;(0,e.useEffect)(()=>{var e;if(!A)return void(je(Rf)||M(Rf));const t={title:A.title||"",description:A.description||"",status:A.status||"",owner:A.owner||"",evidence:A.evidence||"",result:A.result||""};je(t)||M(t);const n={testTemplate:A.testTemplate||null,testType:A.testType||A.type||"custom",testStatus:$s(A.testStatus||A.status||"draft"),successCriteria:A.successCriteria||{pass:"",iterate:"",kill:""},resultDecision:null!==(e=el(A.resultDecision))&&void 0!==e?e:null,hypothesisId:A.hypothesisId||null,resultSummary:A.resultSummary||"",timebox:A.timebox||{start:"",end:""}};(e=>{var t,n,r,o,i,a,s,l,c,u;return L.testTemplate===e.testTemplate&&L.testType===e.testType&&L.testStatus===e.testStatus&&L.resultDecision===e.resultDecision&&L.hypothesisId===e.hypothesisId&&L.resultSummary===e.resultSummary&&(null===(t=L.timebox)||void 0===t?void 0:t.start)===(null===(n=e.timebox)||void 0===n?void 0:n.start)&&(null===(r=L.timebox)||void 0===r?void 0:r.end)===(null===(o=e.timebox)||void 0===o?void 0:o.end)&&(null===(i=L.successCriteria)||void 0===i?void 0:i.pass)===(null===(a=e.successCriteria)||void 0===a?void 0:a.pass)&&(null===(s=L.successCriteria)||void 0===s?void 0:s.iterate)===(null===(l=e.successCriteria)||void 0===l?void 0:l.iterate)&&(null===(c=L.successCriteria)||void 0===c?void 0:c.kill)===(null===(u=e.successCriteria)||void 0===u?void 0:u.kill)})(n)||z(n),Ce("saved")},[A]),(0,e.useEffect)(()=>{var e;const t="test"===(null===I||void 0===I?void 0:I.type)?null===I||void 0===I||null===(e=I.node)||void 0===e?void 0:e.id:null;if(!t)return void B([]);const n=E[t];n&&n.length>0?B(n):B([]);(async()=>{K(!0);try{const e=await bf.listEvidence(t);B(e||[]),N(t,e||[])}catch(e){console.error("[Evidence] Load failed for test",t,e)}finally{K(!1)}})()},[null===I||void 0===I||null===(n=I.node)||void 0===n?void 0:n.id,null===I||void 0===I?void 0:I.type,N]);const Te="test"===(null===I||void 0===I?void 0:I.type)?null===I||void 0===I||null===(r=I.node)||void 0===r?void 0:r.id:null,Oe=(0,e.useMemo)(()=>{if(!Te)return[];const e=(null===k||void 0===k?void 0:k[Te])||[];return e.length>0?e.map(e=>null===S||void 0===S?void 0:S[e]).filter(Boolean):Object.values(S||{}).filter(e=>e.experiment_id===Te).sort((e,t)=>{var n,r;const o=null!==(n=e.sort_order)&&void 0!==n?n:0,i=null!==(r=t.sort_order)&&void 0!==r?r:0;return o!==i?o-i:new Date(e.created_at).getTime()-new Date(t.created_at).getTime()})},[Te,k,S]),Ie=(0,e.useMemo)(()=>Oe.length>0&&Oe.some(e=>!e.is_done),[Oe]),Pe="test"===(null===I||void 0===I?void 0:I.type)&&"draft"===$s(L.testStatus),Ae=Ie||Pe;(0,e.useEffect)(()=>{(async()=>{if(null!==I&&void 0!==I&&I.node&&"opportunity"===I.type){ie(!0);try{const e=await bf.listHypotheses(I.node.id);re(e||[])}catch(e){console.error("Failed to load hypotheses:",e)}finally{ie(!1)}}else re([])})()},[null===I||void 0===I||null===(o=I.node)||void 0===o?void 0:o.id,null===I||void 0===I?void 0:I.type]),(0,e.useEffect)(()=>{if("test"!==(null===I||void 0===I?void 0:I.type))return;(async()=>{try{var e;if(null===(e=I.opportunity)||void 0===e||!e.id)return;const t=await bf.listHypotheses(I.opportunity.id);re(t||[])}catch(t){console.error("Failed to load linked hypothesis:",t)}})()},[null===I||void 0===I?void 0:I.type,null===I||void 0===I||null===(i=I.opportunity)||void 0===i?void 0:i.id]),(0,e.useEffect)(()=>{if(!_||"test"!==(null===I||void 0===I?void 0:I.type))return;const e=Oe.length,t=Oe.filter(e=>e.is_done).length;C(_,{todoDone:t,todoTotal:e})},[Oe,null===I||void 0===I?void 0:I.type,_,C]),(0,e.useEffect)(()=>{"test"===(null===I||void 0===I?void 0:I.type)&&(Z("context"),ee(!1))},[null===I||void 0===I||null===(a=I.node)||void 0===a?void 0:a.id,null===I||void 0===I?void 0:I.type]),(0,e.useEffect)(()=>{const e=e=>{const t=Math.max(420,Math.min(720,window.innerWidth-e.clientX));we(t),window.sessionStorage.setItem("treeflow:sidebarWidth",String(t))},t=()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t)},n=n=>{0===n.button&&(n.preventDefault(),window.addEventListener("mousemove",e),window.addEventListener("mouseup",t))},r=document.getElementById("side-panel-resizer");if(r)return r.addEventListener("mousedown",n),()=>{r.removeEventListener("mousedown",n),t()}},[]),(0,e.useEffect)(()=>()=>{be.current&&clearTimeout(be.current),_e.current&&We(_e.current,{refresh:!1})},[]);const Re=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!==I&&void 0!==I&&I.node&&(be.current&&clearTimeout(be.current),_e.current=e,Ce("saving"),t.immediate?We(e,{refresh:!1}):be.current=setTimeout(()=>{We(e,{refresh:!1})},200))},De=()=>{Re(Ne(),{immediate:!0})},Me=e=>{var t,n,r;const o=(e=>{const t={interview:"customer_interview",cold_outreach:"cold_outreach",pricing:"pricing_test",prototype_usability:"prototype_usability"}[e];return t?gl(t):null})(e),i=Boolean(null===(t=L.successCriteria)||void 0===t?void 0:t.pass)||Boolean(null===(n=L.successCriteria)||void 0===n?void 0:n.iterate)||Boolean(null===(r=L.successCriteria)||void 0===r?void 0:r.kill),a=s(s({},L),{},{testType:e,testTemplate:"custom"===e?null:(null===o||void 0===o?void 0:o.key)||null,successCriteria:!i&&null!==o&&void 0!==o&&o.successCriteria?o.successCriteria:L.successCriteria});z(a),_&&C(_,{testType:e,testTemplate:a.testTemplate,successCriteria:a.successCriteria}),Re(Ne(D,a),{immediate:!0})},Le=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=s(s({},D),{},{[e]:t});M(r),_&&C(_,{[e]:t}),Re(Ne(r,L),n)},ze=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=s(s({},L),{},{[e]:t});z(r),_&&C(_,{[e]:t}),Re(Ne(D,r),n)},Ue=(e,t)=>{const n=s(s({},L.successCriteria),{},{[e]:t}),r=s(s({},L),{},{successCriteria:n});z(r),_&&C(_,{successCriteria:n}),Re(Ne(D,r))},Be=async(e,t)=>{const n=Oe.findIndex(t=>t.id===e);if(-1===n)return;const r="up"===t?n-1:n+1;if(r<0||r>=Oe.length)return;const o=Oe[n],i=Oe[r];try{T(s(s({},o),{},{sort_order:i.sort_order,updated_at:(new Date).toISOString()})),T(s(s({},i),{},{sort_order:o.sort_order,updated_at:(new Date).toISOString()})),await bf.updateExperimentTodo(o.id,{sortOrder:i.sort_order}),await bf.updateExperimentTodo(i.id,{sortOrder:o.sort_order})}catch(a){console.error("Failed to reorder todos:",a),T(o),T(i)}},Fe=async()=>{if(null!==I&&void 0!==I&&I.node&&"opportunity"===I.type)try{const e=await bf.listHypotheses(I.node.id);re(e||[])}catch(e){console.error("Failed to refresh hypotheses:",e)}},Ke=async()=>{if(null===I||void 0===I||!I.node||"opportunity"!==I.type)return;const e=ae.trim();if(e)try{await bf.createHypothesis(I.node.id,e.slice(0,240)),se(""),await Fe()}catch(t){console.error("Failed to create hypothesis:",t)}},qe=async(e,t)=>{try{await bf.updateHypothesis(e,t),await Fe()}catch(n){console.error("Failed to update hypothesis:",n)}},Ve=async(e,t)=>{const n=U.map(n=>n.id===e?s(s({},n),t):n);if(B(n),null!==I&&void 0!==I&&I.node&&N(I.node.id,n),!String(e).startsWith("temp-"))try{const r=await bf.updateEvidence(e,t);B(t=>t.map(t=>t.id===e?s(s({},t),r):t)),null!==I&&void 0!==I&&I.node&&N(I.node.id,n.map(t=>t.id===e?s(s({},t),r):t))}catch(r){console.error("Failed to update evidence:",r);const n=U.map(n=>n.id===e?s(s({},n),t):n);B(n),null!==I&&void 0!==I&&I.node&&N(I.node.id,n)}};(0,e.useEffect)(()=>()=>{xe.current&&clearTimeout(xe.current),xe.current=null;const e=Se.current;if(null!==e&&void 0!==e&&e.itemId&&(Se.current=null,!String(e.itemId).startsWith("temp-"))){const t=ke.current.find(t=>t.id===e.itemId);t&&bf.updateEvidence(e.itemId,s(s({},t),{},{content:t.content})).catch(e=>console.error("Flush evidence save failed:",e))}},[]);const We=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ne(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null!==I&&void 0!==I&&I.node)try{"outcome"===I.type?await bf.updateOutcome(I.node.id,e):"opportunity"===I.type?await bf.updateOpportunity(I.node.id,e):"solution"===I.type?await bf.updateSolution(I.node.id,e):"test"===I.type&&await bf.updateTest(I.node.id,e),_&&(null===y||void 0===y||y("patch-node",{nodeKey:_,changes:e})),t.refresh&&(null===y||void 0===y||y()),Ce("saved")}catch(n){console.error("Failed to update node:",n),Ce("error")}},He=Boolean(null===I||void 0===I?void 0:I.node),Ye=null!==I&&void 0!==I&&null!==(l=I.node)&&void 0!==l&&l.owner?te[I.node.owner]:null;return(0,il.jsxs)("aside",{className:"side-panel ".concat(w?"side-panel-drawer":""," ").concat(He?"is-open":""),style:{width:ye},children:[(0,il.jsx)("div",{id:"side-panel-resizer",className:"side-panel-resizer"}),!He&&(0,il.jsx)("div",{className:"side-panel-empty",children:"Select a node to edit details."}),He?(0,il.jsxs)(il.Fragment,{children:[(0,il.jsxs)("div",{className:"side-panel-header",children:[(0,il.jsx)("div",{className:"side-panel-title",children:Ys[I.type]||"Node"}),Ye&&(0,il.jsx)("div",{className:"side-panel-owner",children:(0,il.jsx)(bl,{user:Ye,size:24,isOwner:!0})})]}),"test"===I.type?(0,il.jsxs)("div",{className:"side-panel-test",children:[(0,il.jsxs)("div",{className:"side-panel-meta",children:[(0,il.jsxs)("div",{className:"side-panel-field",children:[(0,il.jsx)("label",{htmlFor:"side-title",children:"Title"}),(0,il.jsx)("input",{id:"side-title",value:D.title,onChange:e=>Le("title",e.target.value,{immediate:!0}),onBlur:De,onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),De())},placeholder:"Title"})]}),(0,il.jsxs)("div",{className:"side-panel-field side-panel-description",children:[(0,il.jsxs)("div",{className:"side-panel-field-header",children:[(0,il.jsx)("label",{htmlFor:"side-description",children:"Description"}),(0,il.jsx)("button",{type:"button",className:"side-panel-link",onClick:()=>ee(e=>!e),children:Q?"Collapse":"Expand"})]}),(0,il.jsx)("textarea",{id:"side-description",value:D.description,onChange:e=>Le("description",e.target.value),onBlur:De,placeholder:"Add a short description",rows:Q?4:2,className:Q?"":"is-collapsed"})]}),(0,il.jsxs)("div",{className:"side-panel-row two-col",children:[(0,il.jsxs)("div",{className:"side-panel-field",children:[(0,il.jsxs)("label",{htmlFor:"side-status",className:"side-panel-label-row",children:["Status","test"===I.type?L.testStatus&&(0,il.jsx)("span",{className:"status-chip",style:{background:ol.status[$s(L.testStatus)]||"#94a3b8"}}):D.status&&(0,il.jsx)("span",{className:"status-chip",style:{background:ol.status[D.status]||"#94a3b8"}})]}),"test"===I.type?(0,il.jsx)("select",{id:"side-status",value:$s(L.testStatus),onChange:e=>ze("testStatus",e.target.value,{immediate:!0}),"aria-label":"Test status",children:Js.map(e=>(0,il.jsx)("option",{value:e.value,children:e.label},e.value))}):(0,il.jsxs)("select",{id:"side-status",value:D.status||"",onChange:e=>Le("status",e.target.value,{immediate:!0}),children:[(0,il.jsx)("option",{value:"",children:"No status"}),Xs.map(e=>(0,il.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,il.jsxs)("div",{className:"side-panel-field",children:[(0,il.jsx)("label",{htmlFor:"side-owner",children:"Owner"}),(0,il.jsxs)("select",{id:"side-owner",value:D.owner||"",onChange:e=>Le("owner",e.target.value,{immediate:!0}),children:[(0,il.jsx)("option",{value:"",children:"Unassigned"}),R.map(e=>(0,il.jsx)("option",{value:e.value,children:e.label},e.value))]})]})]})]}),(0,il.jsxs)("div",{className:"phase-grid",children:[(0,il.jsx)("div",{className:"stepper-line","aria-hidden":"true"}),(0,il.jsx)("div",{className:"stepper-dot ".concat("context"===$?"active":"")}),(0,il.jsxs)("div",{className:"experiment-section phase-card phase-card-context",onFocusCapture:()=>Z("context"),onClick:()=>Z("context"),children:[(0,il.jsxs)("div",{className:"experiment-section-header",children:[(0,il.jsxs)("div",{children:[(0,il.jsx)("div",{className:"experiment-section-title",children:"Context"}),(0,il.jsx)("div",{className:"experiment-section-subtitle",children:"Define the hypothesis and success criteria."})]}),(0,il.jsx)("button",{type:"button",className:"experiment-section-toggle",onClick:()=>J(e=>!e),children:(0,il.jsx)("span",{children:X?"Collapse":"Expand"})})]}),X&&(0,il.jsxs)("div",{className:"experiment-section-content",children:[(0,il.jsxs)("div",{className:"side-panel-section",children:[(0,il.jsx)("div",{className:"side-panel-section-title",children:"Testing hypothesis"}),(0,il.jsx)("div",{className:"read-only-box",children:(null===(c=(ne||[]).find(e=>e.id===I.node.hypothesisId))||void 0===c?void 0:c.statement)||"No hypothesis linked."}),(null===(u=I.opportunity)||void 0===u?void 0:u.id)&&(0,il.jsx)("button",{type:"button",className:"hypothesis-link",onClick:()=>j(nl("opportunity",I.opportunity.id)),children:"View parent opportunity"})]}),(0,il.jsxs)("div",{className:"side-panel-section",children:[(0,il.jsx)("div",{className:"side-panel-section-title",children:"Test type"}),(0,il.jsxs)("select",{value:L.testType||"custom",onChange:e=>Me(e.target.value),children:[(0,il.jsx)("option",{value:"interview",children:"Interview"}),(0,il.jsx)("option",{value:"cold_outreach",children:"Cold Outreach"}),(0,il.jsx)("option",{value:"pricing",children:"Pricing"}),(0,il.jsx)("option",{value:"prototype_usability",children:"Prototype Usability"}),(0,il.jsx)("option",{value:"custom",children:"Custom"})]})]}),(0,il.jsxs)("div",{className:"side-panel-section",children:[(0,il.jsx)("div",{className:"side-panel-section-title",children:"Hypothesis"}),(0,il.jsxs)("select",{value:L.hypothesisId||"",onChange:e=>(e=>{const t=s(s({},L),{},{hypothesisId:e||null});z(t),_&&C(_,{hypothesisId:t.hypothesisId}),Re(Ne(D,t),{immediate:!0})})(e.target.value),children:[(0,il.jsx)("option",{value:"",children:"None"}),(ne||[]).map(e=>(0,il.jsx)("option",{value:e.id,children:e.statement},e.id))]})]}),(0,il.jsxs)("div",{className:"side-panel-section",children:[(0,il.jsx)("div",{className:"side-panel-section-title",children:"Success Criteria"}),(0,il.jsxs)("div",{className:"side-panel-field",children:[(0,il.jsx)("label",{htmlFor:"criteria-pass",children:"Pass"}),(0,il.jsx)("textarea",{id:"criteria-pass",value:(null===(d=L.successCriteria)||void 0===d?void 0:d.pass)||"",onChange:e=>Ue("pass",e.target.value),rows:2})]}),(0,il.jsxs)("div",{className:"side-panel-field",children:[(0,il.jsx)("label",{htmlFor:"criteria-iterate",children:"Iterate"}),(0,il.jsx)("textarea",{id:"criteria-iterate",value:(null===(h=L.successCriteria)||void 0===h?void 0:h.iterate)||"",onChange:e=>Ue("iterate",e.target.value),rows:2})]}),(0,il.jsxs)("div",{className:"side-panel-field",children:[(0,il.jsx)("label",{htmlFor:"criteria-kill",children:"Kill"}),(0,il.jsx)("textarea",{id:"criteria-kill",value:(null===(f=L.successCriteria)||void 0===f?void 0:f.kill)||"",onChange:e=>Ue("kill",e.target.value),rows:2})]})]})]})]}),(0,il.jsx)("div",{className:"stepper-dot ".concat("do"===$?"active":"")}),(0,il.jsx)("div",{className:"experiment-section experiment-section-primary phase-card phase-card-do",onFocusCapture:()=>Z("do"),onClick:()=>Z("do"),children:(0,il.jsx)(Af,{todos:Oe,draftValue:q,onDraftChange:V,onAdd:()=>{(async()=>{var e,t,n;if(null===I||void 0===I||!I.node||"test"!==I.type)return;const r=q.trim();if(!r)return;const o=Oe.reduce((e,t)=>Math.max(e,t.sort_order||0),0),i={experiment_title:I.node.title,solution_title:null===(e=I.parent)||void 0===e?void 0:e.title,opportunity_title:null===(t=I.opportunity)||void 0===t?void 0:t.title,outcome_title:null===(n=I.root)||void 0===n?void 0:n.title},a="temp-".concat(Date.now()),l=s({id:a,experiment_id:I.node.id,title:r.slice(0,120),is_done:!1,due_date:null,sort_order:o+1,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()},i);try{T(l);const e=await bf.createExperimentTodo(I.node.id,r.slice(0,120),{sortOrder:o+1});V(""),O(a),e&&T(s(s({},e),i))}catch(c){console.error("Failed to create todo:",c),O(a)}})()},onToggle:e=>{(async e=>{const t=(null===S||void 0===S?void 0:S[e.id])||e,n=s(s({},t),{},{is_done:!e.is_done,updated_at:(new Date).toISOString()});try{T(n);const t=await bf.toggleExperimentTodo(e.id,!e.is_done);t&&T(t)}catch(r){console.error("Failed to toggle todo:",r),T(t)}})(e)},onUpdateDueDate:(e,t)=>{(async(e,t)=>{const n=null===S||void 0===S?void 0:S[e],r=s(s({},n||{}),{},{id:e,due_date:t||null,updated_at:(new Date).toISOString()});try{T(r);const n=await bf.updateExperimentTodo(e,{dueDate:t||null});n&&T(n)}catch(o){console.error("Failed to update todo due date:",o),n&&T(n)}})(e,t)},onMoveUp:e=>{Be(e,"up")},onMoveDown:e=>{Be(e,"down")},onDelete:e=>{(async e=>{const t=null===S||void 0===S?void 0:S[e];try{O(e),await bf.deleteExperimentTodo(e)}catch(n){console.error("Failed to delete todo:",n),t&&T(t)}})(e)},editingTodoId:W,editingTodoTitle:Y,onStartEdit:e=>{H(e.id),G(e.title)},onEditChange:G,onCommitEdit:(e,t)=>{(async(e,t)=>{const n=t.trim();if(!n)return;const r=null===S||void 0===S?void 0:S[e],o=s(s({},r||{}),{},{id:e,title:n.slice(0,120),updated_at:(new Date).toISOString()});try{T(o);const t=await bf.updateExperimentTodo(e,{title:n.slice(0,120)});H(null),G(""),t&&T(t)}catch(i){console.error("Failed to update todo:",i),r&&T(r)}})(e,t)},onCancelEdit:()=>{H(null),G("")},userById:te})}),(0,il.jsx)("div",{className:"stepper-dot ".concat("decide"===$?"active":"")}),(0,il.jsxs)("div",{className:"experiment-section experiment-section-decision phase-card phase-card-decide",onFocusCapture:()=>Z("decide"),onClick:()=>Z("decide"),children:[(0,il.jsx)("div",{className:"experiment-section-header",children:(0,il.jsx)("div",{className:"experiment-section-title",children:"Test result"})}),(0,il.jsxs)("div",{className:"experiment-section-content",children:[(0,il.jsxs)("div",{className:"side-panel-section",children:[(0,il.jsx)("div",{className:"side-panel-section-title",children:"Evidence"}),(0,il.jsx)("div",{className:"side-panel-inline evidence-add-buttons",children:["quote","kpi","link","note"].map(e=>(0,il.jsxs)("button",{type:"button",className:"side-panel-chip",onClick:()=>(async e=>{if(null===I||void 0===I||!I.node)return;const t=window.prompt("Add evidence");if(!t)return;const n="temp-".concat(Date.now()),r=[{id:n,node_id:I.node.id,type:e,content:t,quality:"medium",source:"customer",created_at:(new Date).toISOString()},...U];B(r),N(I.node.id,r);const o={type:e,content:t,quality:"medium",source:"customer",workspaceId:I.node.workspaceId};try{const e=await bf.createEvidence(I.node.id,o);if(!e||!e.id)return console.error("[Evidence] createEvidence returned no row:",e),B(e=>{const t=e.filter(e=>e.id!==n);return N(I.node.id,t),t}),void alert("Evidence was not saved. Check the console for details.");B(t=>{const r=t.map(t=>t.id===n?e:t);return N(I.node.id,r),r})}catch(i){console.error("Failed to add evidence:",i),B(e=>{const t=e.filter(e=>e.id!==n);return N(I.node.id,t),t}),alert(i.message||"Failed to save evidence. If this persists, run database migrations (see migration 032_create_evidence_items.sql).")}})(e),children:["+ ",e]},e))}),F?(0,il.jsx)("div",{className:"side-panel-empty",children:"Loading evidence\u2026"}):(0,il.jsx)("div",{className:"evidence-list",children:U.map(e=>(0,il.jsxs)("div",{className:"evidence-row evidence-quality-".concat((e.quality||"medium").toLowerCase()),children:[(0,il.jsx)("textarea",{value:e.content,onChange:t=>((e,t)=>{const n=U.map(n=>n.id===e?s(s({},n),{},{content:t}):n);B(n),null!==I&&void 0!==I&&I.node&&N(I.node.id,n),xe.current&&clearTimeout(xe.current),Se.current=String(e).startsWith("temp-")?null:{itemId:e},xe.current=setTimeout(()=>{xe.current=null;const t=ke.current.find(t=>t.id===e);t&&!String(e).startsWith("temp-")?(Se.current=null,bf.updateEvidence(e,s(s({},t),{},{content:t.content})).then(t=>{B(n=>{const r=n.map(n=>n.id===e?s(s({},n),t):n);return null!==I&&void 0!==I&&I.node&&N(I.node.id,r),r})}).catch(e=>console.error("Failed to save evidence:",e))):Se.current=null},500)})(e.id,t.target.value),onBlur:()=>{if(xe.current){clearTimeout(xe.current),xe.current=null;const t=ke.current.find(t=>t.id===e.id);t&&Ve(e.id,t)}},placeholder:"Quote, metric, or note\u2026",spellCheck:!1,className:"evidence-content-input",rows:2}),(0,il.jsxs)("div",{className:"evidence-row-meta",children:[(0,il.jsxs)("select",{value:e.type,onChange:t=>Ve(e.id,s(s({},e),{},{type:t.target.value})),children:[(0,il.jsx)("option",{value:"quote",children:"Quote"}),(0,il.jsx)("option",{value:"kpi",children:"KPI"}),(0,il.jsx)("option",{value:"screenshot",children:"Screenshot"}),(0,il.jsx)("option",{value:"link",children:"Link"}),(0,il.jsx)("option",{value:"note",children:"Note"}),(0,il.jsx)("option",{value:"call_summary",children:"Call Summary"})]}),(0,il.jsxs)("select",{value:e.quality,onChange:t=>Ve(e.id,s(s({},e),{},{quality:t.target.value})),children:[(0,il.jsx)("option",{value:"low",children:"Low"}),(0,il.jsx)("option",{value:"medium",children:"Medium"}),(0,il.jsx)("option",{value:"high",children:"High"})]}),(0,il.jsxs)("select",{value:e.source,onChange:t=>Ve(e.id,s(s({},e),{},{source:t.target.value})),children:[(0,il.jsx)("option",{value:"customer",children:"Customer"}),(0,il.jsx)("option",{value:"analytics",children:"Analytics"}),(0,il.jsx)("option",{value:"internal",children:"Internal"}),(0,il.jsx)("option",{value:"sales",children:"Sales"})]}),(0,il.jsx)("button",{type:"button",className:"evidence-delete-btn",onClick:()=>(async e=>{const t=U.filter(t=>t.id!==e);if(B(t),null!==I&&void 0!==I&&I.node&&N(I.node.id,t),!String(e).startsWith("temp-"))try{await bf.deleteEvidence(e)}catch(n){console.error("Failed to delete evidence:",n)}})(e.id),title:"Remove evidence",children:"Delete"})]})]},e.id))})]}),(0,il.jsxs)("div",{className:"side-panel-field",children:[(0,il.jsx)("label",{htmlFor:"result-decision",children:"Result"}),(0,il.jsx)("select",{id:"result-decision",value:Ae?"ongoing":el(L.resultDecision)||"ongoing",disabled:Ae,onChange:e=>(e=>{const t=s(s({},L),{},{resultDecision:e});z(t),_&&C(_,{resultDecision:e});const n=Ne(D,t);Ce("saving"),We(n,{refresh:!1})})(e.target.value||null),children:Qs.map(e=>(0,il.jsx)("option",{value:e.value,children:e.label},e.value))}),Ie&&(0,il.jsx)("div",{className:"phase-helper",children:"Open todos: result is Ongoing until all are done."}),!Ie&&Pe&&(0,il.jsx)("div",{className:"phase-helper",children:"Set status to Designed experiment before deciding."})]}),(0,il.jsxs)("div",{className:"side-panel-field",children:[(0,il.jsx)("label",{htmlFor:"result-summary",children:"Result Summary"}),(0,il.jsx)("textarea",{id:"result-summary",value:L.resultSummary,onChange:e=>ze("resultSummary",e.target.value),rows:2})]})]})]})]})]}):(0,il.jsxs)(il.Fragment,{children:[(0,il.jsxs)("div",{className:"side-panel-field",children:[(0,il.jsx)("label",{htmlFor:"side-title",children:"Title"}),(0,il.jsx)("input",{id:"side-title",value:D.title,onChange:e=>Le("title",e.target.value,{immediate:!0}),onBlur:De,onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),De())},placeholder:"Title"})]}),(0,il.jsxs)("div",{className:"side-panel-field",children:[(0,il.jsx)("label",{htmlFor:"side-description",children:"Description"}),(0,il.jsx)("textarea",{id:"side-description",value:D.description,onChange:e=>Le("description",e.target.value),onBlur:De,placeholder:"Add a short description",rows:4})]}),(0,il.jsxs)("div",{className:"side-panel-field",children:[(0,il.jsxs)("label",{htmlFor:"side-status",className:"side-panel-label-row",children:["Status",D.status&&(0,il.jsx)("span",{className:"status-chip",style:{background:ol.status[D.status]||"#94a3b8"}})]}),(0,il.jsxs)("select",{id:"side-status",value:D.status||"",onChange:e=>Le("status",e.target.value,{immediate:!0}),children:[(0,il.jsx)("option",{value:"",children:"No status"}),Xs.map(e=>(0,il.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,il.jsxs)("div",{className:"side-panel-field",children:[(0,il.jsx)("label",{htmlFor:"side-owner",children:"Owner"}),(0,il.jsxs)("select",{id:"side-owner",value:D.owner||"",onChange:e=>Le("owner",e.target.value,{immediate:!0}),children:[(0,il.jsx)("option",{value:"",children:"Unassigned"}),R.map(e=>(0,il.jsx)("option",{value:e.value,children:e.label},e.value))]})]})]}),"solution"===I.type&&(0,il.jsxs)("div",{className:"side-panel-section",children:[(0,il.jsx)("div",{className:"side-panel-section-title",children:"Sub-solutions"}),(0,il.jsx)("button",{type:"button",className:"side-panel-btn side-panel-btn-secondary",onClick:()=>null===y||void 0===y?void 0:y("add-child",{parentKey:_,childType:"solution"}),children:"+ Add Sub-Solution"})]}),"opportunity"===I.type&&(0,il.jsxs)("div",{className:"side-panel-sections-opportunity",children:[("journey"===b||(null===A||void 0===A?void 0:A.journeyStage)||(null===A||void 0===A?void 0:A.journey_stage))&&(0,il.jsxs)("div",{className:"side-panel-section",children:[(0,il.jsx)("div",{className:"side-panel-section-title",children:"Journey stage"}),(0,il.jsxs)("select",{value:null!==(p=null!==(v=null===A||void 0===A?void 0:A.journeyStage)&&void 0!==v?v:null===A||void 0===A?void 0:A.journey_stage)&&void 0!==p?p:"",onChange:async e=>{const t=e.target.value||null;C(_,{journeyStage:t});try{await bf.updateOpportunity(I.node.id,{journeyStage:t}),null===y||void 0===y||y()}catch(n){console.error("Failed to update journey stage",n)}},"aria-label":"Journey stage",className:"side-panel-select",children:[(0,il.jsx)("option",{value:"",children:"Unassigned"}),Ol.map(e=>(0,il.jsx)("option",{value:e.id,children:e.label},e.id))]})]}),(0,il.jsxs)("div",{className:"side-panel-section",children:[(0,il.jsx)("div",{className:"side-panel-section-title",children:"Sub-opportunities"}),(0,il.jsx)("button",{type:"button",className:"side-panel-btn side-panel-btn-secondary",onClick:()=>null===y||void 0===y?void 0:y("add-child",{parentKey:_,childType:"opportunity"}),children:"+ Add Sub-Opportunity"})]}),(0,il.jsxs)("div",{className:"side-panel-section",children:[(0,il.jsx)("div",{className:"side-panel-section-title",children:"Hypotheses"}),(0,il.jsxs)("div",{className:"todo-input-row",children:[(0,il.jsx)("input",{value:ae,placeholder:"Add a hypothesis...",maxLength:240,onChange:e=>se(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),Ke())}}),(0,il.jsx)("button",{type:"button",onClick:()=>{Ke()},children:"Add"})]}),oe?(0,il.jsx)("div",{className:"side-panel-empty",children:"Loading hypotheses\u2026"}):(0,il.jsxs)("div",{className:"hypothesis-list",children:[ne.map(e=>(0,il.jsxs)("div",{className:"hypothesis-row",children:[le===e.id?(0,il.jsx)("input",{className:"hypothesis-input",value:ue,onChange:e=>de(e.target.value),onBlur:()=>{qe(e.id,{statement:ue.trim()}),ce(null),de("")},onKeyDown:t=>{"Enter"===t.key&&(t.preventDefault(),qe(e.id,{statement:ue.trim()}),ce(null),de("")),"Escape"===t.key&&(ce(null),de(""))}}):(0,il.jsx)("button",{type:"button",className:"hypothesis-statement",onClick:()=>{ce(e.id),de(e.statement)},children:e.statement}),(0,il.jsxs)("select",{value:e.status||"untested",onChange:t=>{qe(e.id,{status:t.target.value})},children:[(0,il.jsx)("option",{value:"untested",children:"Untested"}),(0,il.jsx)("option",{value:"supported",children:"Supported"}),(0,il.jsx)("option",{value:"disproven",children:"Disproven"})]}),(0,il.jsxs)("div",{className:"hypothesis-actions",children:[(0,il.jsx)("button",{type:"button",onClick:()=>{(async e=>{null!==I&&void 0!==I&&I.node&&"opportunity"===I.type&&(fe(e.id),ve(e.statement||Gs.solution),ge(""))})(e)},children:"Propose a solution to test this hypothesis"}),(0,il.jsx)("button",{type:"button",onClick:()=>{(async e=>{try{await bf.deleteHypothesis(e),await Fe()}catch(t){console.error("Failed to delete hypothesis:",t)}})(e.id)},children:"\u2715"})]}),he===e.id&&(0,il.jsxs)("div",{className:"hypothesis-propose",children:[(0,il.jsx)("label",{htmlFor:"solution-title-".concat(e.id),children:"What solution or intervention do you want to try?"}),(0,il.jsx)("input",{id:"solution-title-".concat(e.id),value:pe,onChange:e=>ve(e.target.value),placeholder:"Solution title"}),(0,il.jsx)("textarea",{value:me,onChange:e=>ge(e.target.value),placeholder:"Description (optional)",rows:2}),(0,il.jsxs)("div",{className:"hypothesis-propose-actions",children:[(0,il.jsx)("button",{type:"button",onClick:()=>fe(null),children:"Cancel"}),(0,il.jsx)("button",{type:"button",className:"primary",onClick:()=>{(async e=>{if(null===I||void 0===I||!I.node||"opportunity"!==I.type)return;const t=pe.trim();if(t)try{var n,r;const o=I.node.workspaceId||(null===(n=I.parent)||void 0===n?void 0:n.workspaceId)||(null===(r=I.root)||void 0===r?void 0:r.workspaceId)||null,i=await bf.createSolution(I.node.id,{title:t,description:me.trim()||null,workspaceId:o}),a=await bf.createExperiment(i.id,{type:"custom",title:e.statement,hypothesis:e.statement,hypothesisId:e.id,status:"draft"});fe(null),ve(""),ge(""),null===y||void 0===y||y(),null!==a&&void 0!==a&&a.id&&j(nl("test",a.id))}catch(o){console.error("Failed to create solution + experiment:",o),alert(o.message||"Failed to create solution and experiment")}})(e)},children:"Create solution & experiment"})]})]})]},e.id)),0===ne.length&&(0,il.jsx)("div",{className:"side-panel-empty",children:"No hypotheses yet."})]})]})]}),!1,(0,il.jsxs)("div",{className:"side-panel-actions",children:[(0,il.jsxs)("div",{className:"side-panel-save-state side-panel-save-state-".concat(Ee),children:["saving"===Ee&&"Saving...","saved"===Ee&&"All changes saved","error"===Ee&&"Save failed"]}),"outcome"===I.type&&(0,il.jsx)("button",{className:"side-panel-delete",type:"button",onClick:async()=>{var e;if("outcome"!==(null===I||void 0===I?void 0:I.type)||null===(e=I.node)||void 0===e||!e.id)return;if(window.confirm("Delete this outcome and all its children?"))try{await bf.deleteOutcome(I.node.id),_&&j(null),null===y||void 0===y||y("delete-node",{nodeKey:_})}catch(t){console.error("Failed to delete outcome:",t),alert(t.message||"Failed to delete outcome")}},children:"Delete outcome"})]})]}):null]})};const Mf=function(t){let{isOpen:n,nodes:r,onClose:o,onSelect:i}=t;const[a,s]=(0,e.useState)(""),l=(0,e.useMemo)(()=>{const e=a.trim().toLowerCase();return e?r.filter(t=>{var n;return null===(n=t.title)||void 0===n?void 0:n.toLowerCase().includes(e)}).slice(0,12):r.slice(0,12)},[r,a]);return n?(0,il.jsx)("div",{className:"command-backdrop",onClick:o,children:(0,il.jsxs)("div",{className:"command-modal",onClick:e=>e.stopPropagation(),children:[(0,il.jsx)("div",{className:"command-title",children:"Jump to\u2026"}),(0,il.jsx)("input",{className:"command-input-field",autoFocus:!0,placeholder:"Search nodes",value:a,onChange:e=>s(e.target.value)}),(0,il.jsxs)("div",{className:"command-results",children:[l.map(e=>(0,il.jsxs)("button",{type:"button",className:"command-result",onClick:()=>{null===i||void 0===i||i(e.key),s("")},children:[(0,il.jsx)("span",{children:e.title||"Untitled"}),(0,il.jsx)("span",{className:"command-type",children:e.type})]},e.key)),0===l.length&&(0,il.jsx)("div",{className:"command-empty",children:"No matches."})]})]})}):null};const Lf=function(){var t,n;const[r,o]=(0,e.useState)([]),[i,a]=(0,e.useState)([]),[l,c]=(0,e.useState)([]),[u,d]=(0,e.useState)(!0),[h,f]=(0,e.useState)(null),[p,v]=(0,e.useState)(!1),[m,y]=(0,e.useState)(null),[w,b]=(0,e.useState)(null),[_,x]=(0,e.useState)([]),[S,k]=(0,e.useState)([]),[E,C]=(0,e.useState)(0),[N,j]=(0,e.useState)(!1),[T,O]=(0,e.useState)(!1),[I,P]=(0,e.useState)(!1),[A,R]=(0,e.useState)("tree"),[D,M]=(0,e.useState)(!1),[L,z]=(0,e.useState)(!1),[U,B]=(0,e.useState)(!1),[F,K]=(0,e.useState)(!1),[q,V]=(0,e.useState)(!1),W=(0,e.useRef)(null),[H,Y]=(0,e.useState)(()=>{try{return"true"===localStorage.getItem("treeflow:todoOpen")}catch(e){return!1}}),[G,X]=(0,e.useState)([]),[J,$]=(0,e.useState)(()=>{try{return JSON.parse(localStorage.getItem("treeflow:lastActiveByUser")||"{}")}catch(e){return{}}}),[Z,Q]=(0,e.useState)(()=>{try{return JSON.parse(localStorage.getItem("treeflow:lastNodeByUser")||"{}")}catch(e){return{}}}),ee=(0,e.useRef)(null),te=(0,e.useRef)(0),ne=(0,e.useRef)(0),re=(0,e.useRef)(0),oe=(0,e.useRef)(!1),{state:{viewMode:ie,treeStructure:ae,selectedKey:se,nodeOverrides:le,todosById:ce},actions:{setViewMode:ue,setTreeStructure:de,setNodeOverride:he,setSelectedKey:fe,setRenamingKey:pe,setFocusKey:ve,setTodos:me,upsertTodo:ge}}=vl(),ye=!1,we=e=>"string"===typeof e&&(e.startsWith("team:")||e.startsWith("personal:")),be=e=>{if(!e||!we(e))return e;if(e.startsWith("personal:")){const t=e.replace("personal:",""),n=_.find(e=>"personal"===e.type&&e.owner_id===t);return(null===n||void 0===n?void 0:n.id)||e}return e},_e=(0,e.useRef)({outcomes:null,teams:null,cacheTime:0}),xe=(0,e.useMemo)(()=>{if(!h)return[];const e=i.map(e=>{var t;return{id:"team:".concat(e.id),name:e.name,type:"team",owner_id:e.created_by||h.id,legacyTeamId:e.id,memberCount:e.memberCount||(null===(t=e.members)||void 0===t?void 0:t.length)||1}}),t=Array.from(new Set(r.map(e=>e.teamId).filter(Boolean))).filter(t=>!e.some(e=>e.legacyTeamId===t)).map(e=>({id:"team:".concat(e),name:"Team Workspace",type:"team",owner_id:h.id,legacyTeamId:e,memberCount:1}));return[...e,...t]},[i,h,r]),Se=(0,e.useMemo)(()=>{const e=_.length>0?[..._]:[];return!e.some(e=>"personal"===e.type)&&h&&e.unshift({id:"personal:".concat(h.id),name:"Personal Workspace",type:"personal",owner_id:h.id,legacyTeamId:null,memberCount:1}),xe.forEach(t=>{e.some(e=>e.id===t.id||e.legacyTeamId===t.legacyTeamId)||e.push(t)}),e},[xe,h,_]),ke=(0,e.useMemo)(()=>Se.find(e=>e.id===m)||null,[m,Se]),Ee=be(m),Ce=we(Ee)?null:Ee,Ne=we(m)&&(null===ke||void 0===ke?void 0:ke.legacyTeamId)||null,je="tree"===A&&"tree"===ie,Te=(0,e.useMemo)(()=>{const e=Date.now();return new Set(Object.entries(J).filter(t=>{let[,n]=t;return e-Number(n)<3e5}).map(e=>{let[t]=e;return t}))},[J]),Oe=(0,e.useMemo)(()=>{if(null===h||void 0===h||!h.id)return"Member";if((null===ke||void 0===ke?void 0:ke.owner_id)===h.id)return"Owner";const e=G.find(e=>e.user_id===h.id);return"owner"===(null===e||void 0===e?void 0:e.role)?"Owner":"viewer"===(null===e||void 0===e?void 0:e.role)?"Viewer":"Editor"},[null===ke||void 0===ke?void 0:ke.owner_id,null===h||void 0===h?void 0:h.id,G]),Ie=(0,e.useMemo)(()=>Object.values(ce||{}),[ce]),Pe=(0,e.useMemo)(()=>Ie.filter(e=>!e.is_done).length,[Ie]),Ae=(0,e.useMemo)(()=>{if(!m)return[];const e=Se.find(e=>e.id===m);return e?r.filter(t=>t.workspaceId?t.workspaceId===m:"personal"===e.type?!t.teamId:t.teamId===e.legacyTeamId):[]},[m,r,Se]),Re=(0,e.useMemo)(()=>w?Ae.filter(e=>e.decisionSpaceId===w):[],[w,Ae]);(0,e.useEffect)(()=>{h&&"tree"===A&&hc(Re)&&B(!0)},[h,A,Re]);const De=(0,e.useMemo)(()=>{const e=zl(Re||[],le||{},{treeStructure:ae}),t={};return Object.values(e.nodesByKey||{}).forEach(e=>{t[e.key]=e.title}),t},[Re,le,ae]),Me=(0,e.useMemo)(()=>{const e=zl(Ae||[],le||{},{treeStructure:ae}),t={},n={};return l.forEach(e=>{n[e.id]=e}),Object.values(e.nodesByKey||{}).forEach(r=>{if("test"!==r.type)return;const o=e.nodesByKey[r.parentKey],i=o?e.nodesByKey[o.parentKey]:null,a=i?e.nodesByKey[i.parentKey]:null,s=[null===o||void 0===o?void 0:o.title,null===i||void 0===i?void 0:i.title,null===a||void 0===a?void 0:a.title].filter(Boolean).join(" \u2192 ");t[r.id]={id:r.id,title:r.title,description:r.description,testType:r.testType||r.type,breadcrumb:s,ownerId:r.owner||null,ownerUser:r.owner?n[r.owner]:null}}),t},[Ae,le,l,ae]),Le=(0,e.useMemo)(()=>S.find(e=>e.id===w)||null,[S,w]),ze=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{const t=Date.now();if(!e&&_e.current.outcomes&&t-_e.current.cacheTime<3e4)return console.log("Using cached outcomes"),o(_e.current.outcomes),_e.current.outcomes;const n=await bf.getOutcomes();return o(n||[]),_e.current.outcomes=n||[],_e.current.cacheTime=t,n}catch(t){return console.error("Error loading data:",t),_e.current.outcomes||o([]),_e.current.outcomes||[]}},Ue=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{const t=Date.now();if(!e&&_e.current.teams&&t-_e.current.cacheTime<3e4)return console.log("Using cached teams"),a(_e.current.teams),_e.current.teams;const n=await bf.getTeams();return a(n||[]),_e.current.teams=n||[],_e.current.cacheTime=t,n}catch(t){throw console.error("Error loading teams:",t),a([]),t}};(0,e.useEffect)(()=>{let e=!0;(async()=>{try{ye;const t=await bf.getCurrentUser();if(!e)return;t&&(f(t),Promise.allSettled([ze(),Ue()]))}catch(t){ye}finally{e&&d(!1)}})();const{data:{subscription:t}}=ff.auth.onAuthStateChange(async(t,n)=>{if(e)if(n){var r,i;const e={id:n.user.id,email:n.user.email,name:(null===(r=n.user.user_metadata)||void 0===r?void 0:r.name)||n.user.email,profile:{id:n.user.id,email:n.user.email,name:(null===(i=n.user.user_metadata)||void 0===i?void 0:i.name)||n.user.email,role:"user"}};f(e),Promise.allSettled([ze(),Ue()]),bf.claimPendingMemberships().catch(e=>{console.warn("Failed to claim memberships",e)})}else f(null),o([]),a([])});return()=>{e=!1,t.unsubscribe()}},[]),(0,e.useEffect)(()=>{h&&(async()=>{try{const e=await bf.getUsers();c(e||[])}catch(e){console.error("Failed to load users:",e)}})()},[h]);const Be=async e=>{f(e),ze(),Ue();try{await bf.claimPendingMemberships()}catch(t){console.warn("Failed to claim memberships",t)}},Fe=e=>e.startsWith("/work")||e.startsWith("/dashboard")?(window.history.replaceState({},"","/tree"),"tree"):"tree",Ke=()=>{const e=window.location.pathname.match(/workspaces\/([^/]+)\/spaces\/?([^/]*)/);return e?{workspaceId:decodeURIComponent(e[1]),spaceId:e[2]?decodeURIComponent(e[2]):null}:null},qe=()=>{try{return JSON.parse(localStorage.getItem("treeflow:lastSpaceByWorkspace")||"{}")}catch(e){return{}}},Ve=(e,t)=>{if(!e||!t)return;const n=qe();n[e]=t,localStorage.setItem("treeflow:lastSpaceByWorkspace",JSON.stringify(n))},We=async e=>{var t;const n=be(e);if(!n)return null;if(we(n))return k([]),b(null),window.history.replaceState({},"","/workspaces/".concat(encodeURIComponent(n),"/spaces/")),null;let r=await bf.listDecisionSpaces(n);if(!r||0===r.length)try{await bf.createDecisionSpace(n,{name:"Default"}),r=await bf.listDecisionSpaces(n)}catch(a){console.warn("Could not create default decision space:",a)}if(k(r||[]),!r||0===r.length)return b(null),window.history.replaceState({},"","/workspaces/".concat(encodeURIComponent(n),"/spaces/")),null;const o=qe()[n],i=(null===(t=r.find(e=>e.id===o))||void 0===t?void 0:t.id)||r[0].id;return b(i),Ve(n,i),window.history.replaceState({},"","/workspaces/".concat(encodeURIComponent(n),"/spaces/").concat(encodeURIComponent(i))),i};(0,e.useEffect)(()=>{h&&(async()=>{try{var e;let c=await bf.listWorkspaces(),u=!1,d=null;if(c&&0!==c.length)x(c);else{var t;V(!0);let e=null;try{d=await bf.createMyDefaultWorkspace(),c=await bf.listWorkspaces(),u=!0}catch(s){console.warn("Default workspace creation failed, trying legacy path:",s),e=await bf.createWorkspace({name:"Personal Workspace",type:"personal",ownerEmail:null===h||void 0===h?void 0:h.email}),await bf.createDecisionSpace(e.id,{name:"Default"}),c=await bf.listWorkspaces(),u=!0}x(null!==(t=c)&&void 0!==t&&t.length?c:e?[e]:[])}if(null!==(e=c)&&void 0!==e&&e.length&&u){var n,r,o;const e=c[0].id;if(y(e),localStorage.setItem("treeflow:workspace",e),null!==(n=d)&&void 0!==n&&n.created&&null!==(r=d)&&void 0!==r&&r.workspace_id&&null!==(o=d)&&void 0!==o&&o.decision_space_id){const t=d.decision_space_id;k([{id:t,workspace_id:d.workspace_id,name:"Default",description:null,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}]),b(t),Ve(e,t),window.history.replaceState({},"","/workspaces/".concat(encodeURIComponent(e),"/spaces/").concat(encodeURIComponent(t))),oe.current=!0,setTimeout(()=>{oe.current=!1},0)}else{var i,a;let t=await bf.listDecisionSpaces(e);if(null===(i=t)||void 0===i||!i.length)try{await bf.createDecisionSpace(e,{name:"Default"}),t=await bf.listDecisionSpaces(e)}catch(l){console.warn("Create default decision space:",l)}if(null!==(a=t)&&void 0!==a&&a.length){const n=t[0].id;k(t),b(n),Ve(e,n),window.history.replaceState({},"","/workspaces/".concat(encodeURIComponent(e),"/spaces/").concat(encodeURIComponent(n))),oe.current=!0,setTimeout(()=>{oe.current=!1},0)}}}}catch(c){console.error("Failed to load workspaces:",c)}finally{V(!1)}})()},[h,E]),(0,e.useEffect)(()=>{if(!h||_.length>0)return;const e=setTimeout(()=>C(e=>e+1),2500);return()=>clearTimeout(e)},[h,_.length]),(0,e.useEffect)(()=>{if(!h||_.length>0)return;const e=Date.now();if(e-re.current<4e3)return;re.current=e;(async()=>{V(!0);try{let s=null;try{s=await bf.createMyDefaultWorkspace()}catch(i){console.warn("createMyDefaultWorkspace failed, trying legacy:",i);const e=await bf.createWorkspace({name:"Personal Workspace",type:"personal",ownerEmail:h.email});await bf.createDecisionSpace(e.id,{name:"Default"})}const l=await bf.listWorkspaces();if(null!==l&&void 0!==l&&l.length){var e,t,n;x(l);const i=l[0].id;if(y(i),localStorage.setItem("treeflow:workspace",i),null!==(e=s)&&void 0!==e&&e.created&&null!==(t=s)&&void 0!==t&&t.workspace_id&&null!==(n=s)&&void 0!==n&&n.decision_space_id){const e=s.decision_space_id;k([{id:e,workspace_id:s.workspace_id,name:"Default",description:null,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}]),b(e),Ve(i,e),window.history.replaceState({},"","/workspaces/".concat(encodeURIComponent(i),"/spaces/").concat(encodeURIComponent(e))),oe.current=!0,setTimeout(()=>{oe.current=!1},0)}else{var r,o;let e=await bf.listDecisionSpaces(i);if(null===(r=e)||void 0===r||!r.length)try{await bf.createDecisionSpace(i,{name:"Default"}),e=await bf.listDecisionSpaces(i)}catch(a){console.warn("Create default decision space after signup:",a)}if(null!==(o=e)&&void 0!==o&&o.length){const t=e[0].id;k(e),b(t),Ve(i,t),window.history.replaceState({},"","/workspaces/".concat(encodeURIComponent(i),"/spaces/").concat(encodeURIComponent(t))),oe.current=!0,setTimeout(()=>{oe.current=!1},0)}}}}catch(s){console.warn("Ensure default workspace failed:",s)}finally{V(!1)}})()},[h,_.length]),(0,e.useEffect)(()=>{var e;if(u||!h)return;if(oe.current)return;const t=Ke(),n=Se[0]&&!we(Se[0].id)?Se[0].id:null,r=localStorage.getItem("treeflow:workspace"),o=(null===t||void 0===t?void 0:t.workspaceId)||n||r||(null===(e=Se[0])||void 0===e?void 0:e.id)||null,i=be(o);if(!i)return;const a=m===i;if(a||(y(i),localStorage.setItem("treeflow:workspace",i)),o&&i!==o){const e="/workspaces/".concat(encodeURIComponent(i),"/spaces/").concat(encodeURIComponent((null===t||void 0===t?void 0:t.spaceId)||""));window.history.replaceState({},"",e)}if(null!==t&&void 0!==t&&t.spaceId)return b(t.spaceId),void Ve(i,t.spaceId);w&&a||We(i)},[u,h,Se,m,w]),(0,e.useEffect)(()=>{if(u||!h||!m||we(m))return;const e=Ke();(null===e||void 0===e?void 0:e.workspaceId)===m&&(null!==e&&void 0!==e&&e.spaceId||w||We(m))},[u,h,m,w]);const He=async()=>{if(Ee)try{const e=await bf.listWorkspaceTodos(Ee);me(e||[])}catch(e){console.warn("Failed to load todos",e)}else me([])};(0,e.useEffect)(()=>{h&&He()},[Ee,h]),(0,e.useEffect)(()=>{localStorage.setItem("treeflow:todoOpen",String(H))},[H]),(0,e.useEffect)(()=>{h&&(async()=>{if(Ee&&!we(Ee))try{const e=await bf.listWorkspaceMembers(Ee);X(e||[])}catch(e){console.warn("Failed to load workspace members",e)}else X([])})()},[Ee,h]),(0,e.useEffect)(()=>{if(null===h||void 0===h||!h.id)return;const e=()=>{const e=Date.now();e-ne.current<3e4||(ne.current=e,$(t=>{const n=s(s({},t),{},{[h.id]:e});return localStorage.setItem("treeflow:lastActiveByUser",JSON.stringify(n)),n}))},t=()=>e();return window.addEventListener("mousemove",t),window.addEventListener("keydown",t),window.addEventListener("click",t),e(),()=>{window.removeEventListener("mousemove",t),window.removeEventListener("keydown",t),window.removeEventListener("click",t)}},[null===h||void 0===h?void 0:h.id]),(0,e.useEffect)(()=>{if(null===h||void 0===h||!h.id||!se)return;const e=De[se]||se;Q(t=>{const n=s(s({},t),{},{[h.id]:e});return localStorage.setItem("treeflow:lastNodeByUser",JSON.stringify(n)),n})},[se,De,null===h||void 0===h?void 0:h.id]);const Ye=(0,e.useMemo)(()=>{if("tree"!==A)return new Set;const e=zl(Re||[],le||{},{treeStructure:ae}),t=new Set;return Object.values(e.nodesByKey||{}).forEach(e=>{"test"===e.type&&e.id&&t.add(e.id)}),t},[A,Re,le,ae]);(0,e.useEffect)(()=>{const e=()=>{const e=Ke();if(null!==e&&void 0!==e&&e.workspaceId){const t=be(e.workspaceId);y(t),localStorage.setItem("treeflow:workspace",t),null!==e&&void 0!==e&&e.spaceId?(b(e.spaceId),Ve(t,e.spaceId)):We(t)}};return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)},[]),(0,e.useEffect)(()=>{m&&localStorage.setItem("treeflow:workspace",m)},[m]),(0,e.useEffect)(()=>{if(!m)return;if(oe.current)return;const e=S.length>0&&S.some(e=>e.workspace_id===m);w&&e||We(m)},[m,w,S]),(0,e.useEffect)(()=>{const e=m||"default",t=localStorage.getItem("treeflow:view:".concat(e)),n=localStorage.getItem("treeflow:structure:".concat(e)),r=(()=>{const e=new URLSearchParams(window.location.search).get("view");return"tree"===e||"list"===e?e:null})();ue(r||t||"tree"),"journey"!==n&&"classic"!==n||de(n)},[m,ue,de]),(0,e.useEffect)(()=>{const e=m||"default";ie&&localStorage.setItem("treeflow:view:".concat(e),ie)},[ie,m]),(0,e.useEffect)(()=>{const e=m||"default";ae&&localStorage.setItem("treeflow:structure:".concat(e),ae)},[ae,m]),(0,e.useEffect)(()=>{const e=e=>{(e.metaKey||e.ctrlKey)&&"k"===e.key.toLowerCase()&&(e.preventDefault(),M(!0))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),(0,e.useEffect)(()=>{R(Fe(window.location.pathname));const e=()=>R(Fe(window.location.pathname));return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)},[]),(0,e.useEffect)(()=>{const e=e=>{"Escape"===e.key&&(M(!1),fe(null),pe(null))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[fe,pe]),(0,e.useEffect)(()=>{const e=e=>{var t;if(null!==e&&void 0!==e&&null!==(t=e.message)&&void 0!==t&&t.includes("ResizeObserver loop completed"))return e.preventDefault(),e.stopImmediatePropagation(),!0};return window.addEventListener("error",e,!0),()=>window.removeEventListener("error",e,!0)},[]);const Ge=async(e,t)=>{if(e)try{let g=!0,y=null;const b=(e,t)=>{if(!e||!t)return;const n=rl(e);if(!n)return;const{type:r,id:i}=n,a=Object.entries(t).reduce((e,t)=>{let[n,r]=t;return void 0!==r&&(e[n]=r),e},{}),l=e=>(e||[]).map(e=>"solution"===r&&e.id===i?s(s({},e),a):s(s({},e),{},{tests:(e.tests||[]).map(e=>"test"===r&&e.id===i?s(s({},e),a):e),subSolutions:l(e.subSolutions)})),c=e=>(e||[]).map(e=>"opportunity"===r&&e.id===i?s(s({},e),a):s(s({},e),{},{solutions:l(e.solutions),subOpportunities:c(e.subOpportunities)}));o(e=>"outcome"===r?(e||[]).map(e=>e.id===i?s(s({},e),a):e):(e||[]).map(e=>s(s({},e),{},{opportunities:c(e.opportunities||[])})))};if("patch-node"===e){g=!1;const{nodeKey:e,changes:n}=t||{};return void b(e,n)}if("delete-node"===e){g=!1;const{nodeKey:e}=t||{};if(!e)return;const n=rl(e);if(!n)return;return"outcome"===n.type&&(await bf.deleteOutcome(n.id),o(e=>(e||[]).filter(e=>e.id!==n.id))),"opportunity"===n.type&&(await bf.deleteOpportunity(n.id),o(e=>(e||[]).map(e=>s(s({},e),{},{opportunities:(e.opportunities||[]).filter(e=>e.id!==n.id)})))),"solution"===n.type&&(await bf.deleteSolution(n.id),o(e=>(e||[]).map(e=>s(s({},e),{},{opportunities:(e.opportunities||[]).map(e=>s(s({},e),{},{solutions:(e.solutions||[]).filter(e=>e.id!==n.id)}))})))),"test"===n.type&&(await bf.deleteTest(n.id),o(e=>(e||[]).map(e=>s(s({},e),{},{opportunities:(e.opportunities||[]).map(e=>s(s({},e),{},{solutions:(e.solutions||[]).map(e=>s(s({},e),{},{tests:(e.tests||[]).filter(e=>e.id!==n.id)}))}))})))),fe(null),void pe(null)}if("add-outcome"===e){var n;if(Ce&&!w)return void P(!0);const e=Ce?w:null,d=null!==(n=null===t||void 0===t?void 0:t.initialTitle)&&void 0!==n?n:Gs.outcome,h=await bf.createOutcome({title:d,workspaceId:Ce,teamId:Ne,decisionSpaceId:e});if(h){var r,i,a,l,c,u;y=s(s({},h),{},{workspaceId:null!==(r=null!==(i=h.workspaceId)&&void 0!==i?i:Ce)&&void 0!==r?r:null,teamId:null!==(a=null!==(l=h.teamId)&&void 0!==l?l:Ne)&&void 0!==a?a:null,decisionSpaceId:null!==(c=null!==(u=h.decisionSpaceId)&&void 0!==u?u:e)&&void 0!==c?c:null,opportunities:h.opportunities||[]});const t=_e.current.outcomes||[],n=[y,...t.filter(e=>e.id!==y.id)];_e.current.outcomes=n,_e.current.cacheTime=Date.now(),o(n)}if(null!==h&&void 0!==h&&h.id){const e=nl("outcome",h.id);fe(e),pe(e)}}if("add-child"===e){var d,h,f;const e=rl(t.parentKey);if(!e)return;const{type:n,id:r}=e,o=null!==(d=null===t||void 0===t?void 0:t.initialTitle)&&void 0!==d?d:Gs.opportunity,i=null!==(h=null===t||void 0===t?void 0:t.initialTitle)&&void 0!==h?h:Gs.solution,a=null!==(f=null===t||void 0===t?void 0:t.initialTitle)&&void 0!==f?f:Gs.test;if("opportunity"===t.childType&&"outcome"===n){var p;const e=null!==(p=t.journeyStage)&&void 0!==p?p:null,n=e&&e!==Il?e:null,i=await bf.createOpportunity(r,{title:o,workspaceId:Ce,journeyStage:n});null!==i&&void 0!==i&&i.id&&fe(nl("opportunity",i.id))}if("opportunity"===t.childType&&"journey"===n){const e=(r||"").split(":"),t=e[0],n=e[1]||null;if(!t)return;const i=n&&n!==Il?n:null,a=await bf.createOpportunity(t,{title:o,workspaceId:Ce,journeyStage:i});null!==a&&void 0!==a&&a.id&&fe(nl("opportunity",a.id))}if("opportunity"===t.childType&&"opportunity"===n){var v;const e=Fl(Re||[],t.parentKey),n=null===e||void 0===e||null===(v=e.root)||void 0===v?void 0:v.id;if(!n)return;const i=await bf.createOpportunity(n,{title:o,workspaceId:Ce,parentOpportunityId:r});null!==i&&void 0!==i&&i.id&&fe(nl("opportunity",i.id))}if("solution"===t.childType&&"opportunity"===n){const e=await bf.createSolution(r,{title:i,workspaceId:Ce});null!==e&&void 0!==e&&e.id&&fe(nl("solution",e.id))}if("solution"===t.childType&&"solution"===n){var m;const e=Fl(Re||[],t.parentKey),n=null===e||void 0===e||null===(m=e.opportunity)||void 0===m?void 0:m.id;if(!n)return;const o=await bf.createSolution(n,{title:i,workspaceId:Ce,parentSolutionId:r});null!==o&&void 0!==o&&o.id&&fe(nl("solution",o.id))}if("test"===t.childType&&"solution"===n){const e=await bf.createTest(r,{title:a,description:"",testTemplate:null,testType:"custom",testStatus:"draft",successCriteria:null,timebox:null,workspaceId:Ce});null!==e&&void 0!==e&&e.id&&fe(nl("test",e.id))}}if("rename"===e){g=!1;const e=rl(t.nodeKey);if(!e)return;he(t.nodeKey,{title:t.title}),b(t.nodeKey,{title:t.title}),"outcome"===e.type&&await bf.updateOutcome(e.id,{title:t.title}),"opportunity"===e.type&&await bf.updateOpportunity(e.id,{title:t.title}),"solution"===e.type&&await bf.updateSolution(e.id,{title:t.title}),"test"===e.type&&await bf.updateTest(e.id,{title:t.title})}if("set-confidence"===e){g=!1;const e=rl(t.nodeKey);if(!e)return;const n=null!=t.score?Math.min(100,Math.max(0,Number(t.score))):null;he(t.nodeKey,{confidenceScore:n}),"opportunity"===e.type&&await bf.updateOpportunity(e.id,{confidenceScore:n}),"solution"===e.type&&await bf.updateSolution(e.id,{confidenceScore:n})}if("promote-sub-solution"===e){const e=rl(t.nodeKey);if(!e||"solution"!==e.type)return;await bf.updateSolution(e.id,{parentSolutionId:null})}if(g){const e=await ze(!0);await Ue(!0),y&&!(e||[]).some(e=>e.id===y.id)&&o(e=>{const t=(e||[]).filter(e=>e.id!==y.id);return[y,...t]})}}catch(g){console.error("Failed to update board:",g),alert(g.message||"Failed to update board")}else await Promise.all([ze(!0),Ue(!0)])},Xe=e=>{if("work"===e)return R("tree"),void window.history.pushState({},"","/tree");R(e),Ee&&window.history.pushState({},"","/workspaces/".concat(encodeURIComponent(Ee),"/spaces/").concat(encodeURIComponent(w||"")))},Je=e=>{"tree"!==A&&Xe("tree"),fe(e),ve(e),"tree"!==ie&&ue("tree")},$e=(0,e.useMemo)(()=>{const e=zl(Re||[],le||{},{treeStructure:ae});return Object.values(e.nodesByKey||{})},[Re,le,ae]);return h||u?u?(0,il.jsx)("div",{className:"app",children:(0,il.jsx)("div",{className:"loading",children:"Loading..."})}):q?(0,il.jsx)("div",{className:"app app-setting-up",children:(0,il.jsxs)("div",{className:"setting-up-card",children:[(0,il.jsx)("div",{className:"setting-up-spinner","aria-hidden":"true"}),(0,il.jsx)("p",{className:"setting-up-title",children:"We're setting things up for you"}),(0,il.jsx)("p",{className:"setting-up-subtitle",children:"Creating your workspace and decision space\u2026"})]})}):(0,il.jsxs)("div",{className:"app ".concat(H?"todo-open":""),children:[(0,il.jsxs)("header",{className:"top-bar top-bar-overlay",children:[(0,il.jsxs)("div",{className:"top-bar-left",children:[(0,il.jsx)("div",{className:"app-title",children:"TreeFlow"}),(0,il.jsx)("div",{className:"board-selector workspace-select",children:(0,il.jsxs)("select",{value:m||"",onChange:e=>{const t=e.target.value;"__create_team__"!==t?(te.current=Date.now(),y(t),b(null),localStorage.setItem("treeflow:workspace",t),t&&("tree"===A?(window.history.pushState({},"","/workspaces/".concat(encodeURIComponent(t),"/spaces/")),We(t)):window.history.pushState({},"","/".concat(A)))):O(!0)},className:"board-select",children:[Se.map(e=>(0,il.jsxs)("option",{value:e.id,children:[e.name," ","personal"===e.type?"\xb7 Private":"\xb7 ".concat(e.memberCount||1," members")]},e.id)),(0,il.jsx)("option",{disabled:!0,children:"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500"}),(0,il.jsx)("option",{value:"__create_team__",children:"+ Create team workspace\u2026"})]})}),(0,il.jsx)("button",{type:"button",className:"workspace-team-trigger",onClick:()=>z(e=>!e),"aria-label":"Open team drawer",children:"Team"}),"tree"===A&&(0,il.jsx)("div",{className:"board-selector decision-space-select",children:(0,il.jsxs)("select",{value:w||"",onChange:e=>{const t=e.target.value;"__create_space__"!==t?(b(t),Ve(m,t),m&&t&&"tree"===A&&window.history.pushState({},"","/workspaces/".concat(encodeURIComponent(m),"/spaces/").concat(encodeURIComponent(t)))):P(!0)},className:"board-select",children:[S.map(e=>(0,il.jsx)("option",{value:e.id,children:e.name},e.id)),(0,il.jsx)("option",{disabled:!0,children:"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500"}),(0,il.jsx)("option",{value:"__create_space__",children:"+ New Decision Space\u2026"})]})})]}),(0,il.jsxs)("div",{className:"top-bar-center",children:[(0,il.jsxs)("div",{className:"top-bar-nav",role:"group","aria-label":"Views",children:[(0,il.jsx)("button",{className:"top-bar-nav-btn ".concat("tree"===A&&"tree"===ie?"active":""),type:"button",onClick:()=>{Xe("tree"),ue("tree")},children:"Tree"}),(0,il.jsx)("button",{className:"top-bar-nav-btn ".concat("tree"===A&&"list"===ie?"active":""),type:"button",onClick:()=>{Xe("tree"),ue("list")},children:"List"})]}),(0,il.jsxs)("select",{className:"top-bar-nav-select",value:ie,onChange:e=>{const t=e.target.value;"tree"!==t&&"list"!==t||(Xe("tree"),ue(t))},"aria-label":"Select view",children:[(0,il.jsx)("option",{value:"tree",children:"Tree"}),(0,il.jsx)("option",{value:"list",children:"List"})]})]}),(0,il.jsxs)("div",{className:"top-bar-right",children:["team"===(null===ke||void 0===ke?void 0:ke.type)&&(0,il.jsx)("button",{className:"top-button",type:"button",onClick:()=>j(!0),children:"Members"}),G.length>0&&(0,il.jsx)("button",{type:"button",className:"team-avatar-trigger",onClick:()=>z(e=>!e),"aria-label":"Open team drawer",children:(0,il.jsx)(wl,{users:G.map(e=>e.profile).filter(Boolean),size:22,max:3,showPresence:!0,activeIds:Te,ownerId:(null===(t=G.find(e=>"owner"===e.role))||void 0===t?void 0:t.user_id)||null})}),(0,il.jsx)("input",{className:"command-input top-bar-command",placeholder:"\u2318K Search or command","aria-label":"Command palette",ref:ee}),(0,il.jsx)(lc,{ref:W,onCreate:()=>Ge("add-outcome"),label:"Outcome",disabled:!Ce}),(0,il.jsx)("button",{className:"top-button",type:"button",children:"Filters"}),(0,il.jsxs)("div",{className:"help-menu-wrap",children:[(0,il.jsx)("button",{type:"button",className:"top-button",onClick:()=>K(e=>!e),"aria-expanded":F,"aria-haspopup":"true",children:"Help"}),F&&(0,il.jsxs)(il.Fragment,{children:[(0,il.jsx)("div",{className:"help-menu-backdrop",onClick:()=>K(!1),"aria-hidden":"true"}),(0,il.jsx)("div",{className:"help-menu-dropdown",children:(0,il.jsx)("button",{type:"button",className:"help-menu-item",onClick:()=>{dc(!1),B(!0),K(!1)},children:"Restart Tutorial"})})]})]}),(0,il.jsx)("button",{onClick:()=>v(!0),className:"top-button",children:(null===h||void 0===h?void 0:h.name)||(null===h||void 0===h?void 0:h.email)||(null===h||void 0===h||null===(n=h.profile)||void 0===n?void 0:n.name)||"User"}),(0,il.jsx)("button",{onClick:async()=>{try{await bf.logout()}catch(e){console.error("Error logging out:",e)}f(null),o([]),a([])},className:"top-button ghost",children:"Logout"})]})]}),p&&(0,il.jsx)(Pf,{user:h,workspace:ke,workspaceRole:Oe,onUpdate:e=>{f(e)},onClose:()=>v(!1)}),(0,il.jsx)("main",{className:"app-main ".concat(""),children:"tree"===A&&(0,il.jsx)(sc,{outcomes:Re,outcomesCount:Re.length,workspaceName:null===ke||void 0===ke?void 0:ke.name,decisionSpaceName:null===Le||void 0===Le?void 0:Le.name,users:l,onUpdate:Ge,onAddOutcome:()=>Ge("add-outcome")})}),(0,il.jsx)(Of,{isOpen:H,todos:Ie,users:l,testMetaById:Me,highlightedIds:Ye,onOpenTest:e=>{e&&Je("test:".concat(e))},onToggleTodo:async e=>{const t=null===ce||void 0===ce?void 0:ce[e.id],n=s(s({},t||e),{},{is_done:!e.is_done,updated_at:(new Date).toISOString()});try{ge(n);const t=await bf.toggleExperimentTodo(e.id,!e.is_done);t&&ge(t)}catch(r){console.warn("Failed to toggle todo",r),t&&ge(t)}},onAssignOwner:async(e,t)=>{try{await bf.updateTest(e,{owner:t||null}),await ze(!0),await He()}catch(n){console.warn("Failed to assign owner",n)}},onClose:()=>Y(!1)}),!H&&(0,il.jsxs)("button",{type:"button",className:"todo-pill",onClick:()=>Y(!0),"aria-label":"Open todos",children:[(0,il.jsx)(g,{}),(0,il.jsx)("span",{children:"Todos"}),(0,il.jsx)("span",{className:"todo-pill-count",children:Pe})]}),je&&se&&(0,il.jsx)("div",{className:"canvas-scrim",onClick:()=>fe(null)}),(0,il.jsx)(Df,{outcomes:Re||[],users:l,onUpdate:Ge,isDrawer:je,treeStructure:ae}),(0,il.jsx)(kf,{isOpen:L,onClose:()=>z(!1),workspace:ke,members:G,currentUserId:null===h||void 0===h?void 0:h.id,activeMap:Z,activeIds:Te}),(0,il.jsx)(Mf,{isOpen:D,nodes:$e,onClose:()=>M(!1),onSelect:e=>{M(!1),Je(e)}}),N&&ke&&(0,il.jsx)(_f,{workspace:s(s({},ke),{},{isOwner:ke.owner_id===(null===h||void 0===h?void 0:h.id)}),currentUserId:null===h||void 0===h?void 0:h.id,onClose:()=>j(!1)}),T&&(0,il.jsx)(xf,{onClose:()=>O(!1),ownerEmail:null===h||void 0===h?void 0:h.email,onCreated:e=>{O(!1),x(t=>t.some(t=>t.id===e.id)?t:[...t,e]),y(e.id),b(null),window.history.pushState({},"","/workspaces/".concat(encodeURIComponent(e.id),"/spaces/"))}}),I&&m&&(0,il.jsx)(Sf,{onClose:()=>P(!1),onCreated:e=>{P(!1),k(t=>[...t,e]),b(e.id),window.history.pushState({},"","/workspaces/".concat(encodeURIComponent(m),"/spaces/").concat(encodeURIComponent(e.id)))},workspaceId:be(m)}),(0,il.jsx)(fc,{isOpen:U,onClose:()=>B(!1),outcomes:Re,treeStructure:ae,onCreateOutcome:e=>Ge("add-outcome",{initialTitle:e}),onUpdate:Ge,addOutcomeButtonRef:W}),h&&(0,il.jsx)(mc,{context:{workspaceName:null===ke||void 0===ke?void 0:ke.name,decisionSpaceName:null===Le||void 0===Le?void 0:Le.name,url:"undefined"!==typeof window?window.location.href:"",mode:"journey"===ae?"Journey":"Classic",selectedNodeId:se||void 0},onSendFeedback:bf.sendFeedback})]}):(0,il.jsx)(If,{onLogin:Be})};!function(){const e="ResizeObserver loop";window.addEventListener("error",function(t){var n,r;if(null!==t&&void 0!==t&&null!==(n=t.message)&&void 0!==n&&null!==(r=n.includes)&&void 0!==r&&r.call(n,e))return t.stopImmediatePropagation(),t.preventDefault(),!0},!0);const t=window.onerror;window.onerror=function(n){if("string"===typeof n&&n.includes(e))return!0;for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return!!t&&t.apply(this,[n,...o])}}();class zf extends e.Component{constructor(){super(...arguments),this.state={error:null}}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e,t){console.error("App error:",e,t)}render(){return this.state.error?(0,il.jsxs)("div",{style:{padding:24,fontFamily:"system-ui",maxWidth:640,color:"#333"},children:[(0,il.jsx)("h1",{style:{color:"#c00"},children:"Something went wrong"}),(0,il.jsx)("pre",{style:{overflow:"auto",background:"#f5f5f5",padding:16,borderRadius:8},children:this.state.error.message}),(0,il.jsx)("p",{style:{color:"#666"},children:"Check the browser console for full details."})]}):this.props.children}}t.createRoot(document.getElementById("root")).render((0,il.jsx)(e.StrictMode,{children:(0,il.jsx)(zf,{children:(0,il.jsx)(pl,{children:(0,il.jsx)(Lf,{})})})}))})()})();
//# sourceMappingURL=main.7d252ea3.js.map